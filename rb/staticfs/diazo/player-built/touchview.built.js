(function(){var e=this,t=e._,i={},n=Array.prototype,a=Object.prototype,r=Function.prototype,o=n.push,s=n.slice,l=n.concat,c=a.toString,d=a.hasOwnProperty,h=n.forEach,u=n.map,p=n.reduce,f=n.reduceRight,v=n.filter,g=n.every,m=n.some,w=n.indexOf,_=n.lastIndexOf,y=Array.isArray,b=Object.keys,x=r.bind,S=function(e){return e instanceof S?e:this instanceof S?void(this._wrapped=e):new S(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.4.4";var C=S.each=S.forEach=function(e,t,n){if(null!=e)if(h&&e.forEach===h)e.forEach(t,n);else if(e.length===+e.length){for(var a=0,r=e.length;r>a;a++)if(t.call(n,e[a],a,e)===i)return}else for(var o in e)if(S.has(e,o)&&t.call(n,e[o],o,e)===i)return};S.map=S.collect=function(e,t,i){var n=[];return null==e?n:u&&e.map===u?e.map(t,i):(C(e,function(e,a,r){n[n.length]=t.call(i,e,a,r)}),n)};var T="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=S.bind(t,n)),a?e.reduce(t,i):e.reduce(t);if(C(e,function(e,r,o){a?i=t.call(n,i,e,r,o):(i=e,a=!0)}),!a)throw new TypeError(T);return i},S.reduceRight=S.foldr=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=S.bind(t,n)),a?e.reduceRight(t,i):e.reduceRight(t);var r=e.length;if(r!==+r){var o=S.keys(e);r=o.length}if(C(e,function(s,l,c){l=o?o[--r]:--r,a?i=t.call(n,i,e[l],l,c):(i=e[l],a=!0)}),!a)throw new TypeError(T);return i},S.find=S.detect=function(e,t,i){var n;return k(e,function(e,a,r){return t.call(i,e,a,r)?(n=e,!0):void 0}),n},S.filter=S.select=function(e,t,i){var n=[];return null==e?n:v&&e.filter===v?e.filter(t,i):(C(e,function(e,a,r){t.call(i,e,a,r)&&(n[n.length]=e)}),n)},S.reject=function(e,t,i){return S.filter(e,function(e,n,a){return!t.call(i,e,n,a)},i)},S.every=S.all=function(e,t,n){t||(t=S.identity);var a=!0;return null==e?a:g&&e.every===g?e.every(t,n):(C(e,function(e,r,o){return(a=a&&t.call(n,e,r,o))?void 0:i}),!!a)};var k=S.some=S.any=function(e,t,n){t||(t=S.identity);var a=!1;return null==e?a:m&&e.some===m?e.some(t,n):(C(e,function(e,r,o){return a||(a=t.call(n,e,r,o))?i:void 0}),!!a)};S.contains=S.include=function(e,t){return null==e?!1:w&&e.indexOf===w?-1!=e.indexOf(t):k(e,function(e){return e===t})},S.invoke=function(e,t){var i=s.call(arguments,2),n=S.isFunction(t);return S.map(e,function(e){return(n?t:e[t]).apply(e,i)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.where=function(e,t,i){return S.isEmpty(t)?i?null:[]:S[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},S.findWhere=function(e,t){return S.where(e,t,!0)},S.max=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-(1/0);var n={computed:-(1/0),value:-(1/0)};return C(e,function(e,a,r){var o=t?t.call(i,e,a,r):e;o>=n.computed&&(n={value:e,computed:o})}),n.value},S.min=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return C(e,function(e,a,r){var o=t?t.call(i,e,a,r):e;o<n.computed&&(n={value:e,computed:o})}),n.value},S.shuffle=function(e){var t,i=0,n=[];return C(e,function(e){t=S.random(i++),n[i-1]=n[t],n[t]=e}),n};var P=function(e){return S.isFunction(e)?e:function(t){return t[e]}};S.sortBy=function(e,t,i){var n=P(t);return S.pluck(S.map(e,function(e,t,a){return{value:e,index:t,criteria:n.call(i,e,t,a)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var E=function(e,t,i,n){var a={},r=P(t||S.identity);return C(e,function(t,o){var s=r.call(i,t,o,e);n(a,s,t)}),a};S.groupBy=function(e,t,i){return E(e,t,i,function(e,t,i){(S.has(e,t)?e[t]:e[t]=[]).push(i)})},S.countBy=function(e,t,i){return E(e,t,i,function(e,t){S.has(e,t)||(e[t]=0),e[t]++})},S.sortedIndex=function(e,t,i,n){i=null==i?S.identity:P(i);for(var a=i.call(n,t),r=0,o=e.length;o>r;){var s=r+o>>>1;i.call(n,e[s])<a?r=s+1:o=s}return r},S.toArray=function(e){return e?S.isArray(e)?s.call(e):e.length===+e.length?S.map(e,S.identity):S.values(e):[]},S.size=function(e){return null==e?0:e.length===+e.length?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,i){return null!=e?null==t||i?e[0]:s.call(e,0,t):void 0},S.initial=function(e,t,i){return s.call(e,0,e.length-(null==t||i?1:t))},S.last=function(e,t,i){return null!=e?null==t||i?e[e.length-1]:s.call(e,Math.max(e.length-t,0)):void 0},S.rest=S.tail=S.drop=function(e,t,i){return s.call(e,null==t||i?1:t)},S.compact=function(e){return S.filter(e,S.identity)};var D=function(e,t,i){return C(e,function(e){S.isArray(e)?t?o.apply(i,e):D(e,t,i):i.push(e)}),i};S.flatten=function(e,t){return D(e,t,[])},S.without=function(e){return S.difference(e,s.call(arguments,1))},S.uniq=S.unique=function(e,t,i,n){S.isFunction(t)&&(n=i,i=t,t=!1);var a=i?S.map(e,i,n):e,r=[],o=[];return C(a,function(i,n){(t?n&&o[o.length-1]===i:S.contains(o,i))||(o.push(i),r.push(e[n]))}),r},S.union=function(){return S.uniq(l.apply(n,arguments))},S.intersection=function(e){var t=s.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=l.apply(n,s.call(arguments,1));return S.filter(e,function(e){return!S.contains(t,e)})},S.zip=function(){for(var e=s.call(arguments),t=S.max(S.pluck(e,"length")),i=new Array(t),n=0;t>n;n++)i[n]=S.pluck(e,""+n);return i},S.object=function(e,t){if(null==e)return{};for(var i={},n=0,a=e.length;a>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},S.indexOf=function(e,t,i){if(null==e)return-1;var n=0,a=e.length;if(i){if("number"!=typeof i)return n=S.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,a+i):i}if(w&&e.indexOf===w)return e.indexOf(t,i);for(;a>n;n++)if(e[n]===t)return n;return-1},S.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(_&&e.lastIndexOf===_)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var a=n?i:e.length;a--;)if(e[a]===t)return a;return-1},S.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),a=0,r=new Array(n);n>a;)r[a++]=e,e+=i;return r},S.bind=function(e,t){if(e.bind===x&&x)return x.apply(e,s.call(arguments,1));var i=s.call(arguments,2);return function(){return e.apply(t,i.concat(s.call(arguments)))}},S.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},S.bindAll=function(e){var t=s.call(arguments,1);return 0===t.length&&(t=S.functions(e)),C(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var i={};return t||(t=S.identity),function(){var n=t.apply(this,arguments);return S.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},S.delay=function(e,t){var i=s.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(s.call(arguments,1)))},S.throttle=function(e,t){var i,n,a,r,o=0,s=function(){o=new Date,a=null,r=e.apply(i,n)};return function(){var l=new Date,c=t-(l-o);return i=this,n=arguments,0>=c?(clearTimeout(a),a=null,o=l,r=e.apply(i,n)):a||(a=setTimeout(s,c)),r}},S.debounce=function(e,t,i){var n,a;return function(){var r=this,o=arguments,s=function(){n=null,i||(a=e.apply(r,o))},l=i&&!n;return clearTimeout(n),n=setTimeout(s,t),l&&(a=e.apply(r,o)),a}},S.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},S.wrap=function(e,t){return function(){var i=[e];return o.apply(i,arguments),t.apply(this,i)}},S.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},S.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},S.keys=b||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)S.has(e,i)&&(t[t.length]=i);return t},S.values=function(e){var t=[];for(var i in e)S.has(e,i)&&t.push(e[i]);return t},S.pairs=function(e){var t=[];for(var i in e)S.has(e,i)&&t.push([i,e[i]]);return t},S.invert=function(e){var t={};for(var i in e)S.has(e,i)&&(t[e[i]]=i);return t},S.functions=S.methods=function(e){var t=[];for(var i in e)S.isFunction(e[i])&&t.push(i);return t.sort()},S.extend=function(e){return C(s.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},S.pick=function(e){var t={},i=l.apply(n,s.call(arguments,1));return C(i,function(i){i in e&&(t[i]=e[i])}),t},S.omit=function(e){var t={},i=l.apply(n,s.call(arguments,1));for(var a in e)S.contains(i,a)||(t[a]=e[a]);return t},S.defaults=function(e){return C(s.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e};var I=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof S&&(e=e._wrapped),t instanceof S&&(t=t._wrapped);var a=c.call(e);if(a!=c.call(t))return!1;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=i.length;r--;)if(i[r]==e)return n[r]==t;i.push(e),n.push(t);var o=0,s=!0;if("[object Array]"==a){if(o=e.length,s=o==t.length)for(;o--&&(s=I(e[o],t[o],i,n)););}else{var l=e.constructor,d=t.constructor;if(l!==d&&!(S.isFunction(l)&&l instanceof l&&S.isFunction(d)&&d instanceof d))return!1;for(var h in e)if(S.has(e,h)&&(o++,!(s=S.has(t,h)&&I(e[h],t[h],i,n))))break;if(s){for(h in t)if(S.has(t,h)&&!o--)break;s=!o}}return i.pop(),n.pop(),s};S.isEqual=function(e,t){return I(e,t,[],[])},S.isEmpty=function(e){if(null==e)return!0;if(S.isArray(e)||S.isString(e))return 0===e.length;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!(!e||1!==e.nodeType)},S.isArray=y||function(e){return"[object Array]"==c.call(e)},S.isObject=function(e){return e===Object(e)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){S["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),S.isArguments(arguments)||(S.isArguments=function(e){return!(!e||!S.has(e,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(e){return"function"==typeof e}),S.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},S.isNaN=function(e){return S.isNumber(e)&&e!=+e},S.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return d.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,i){for(var n=Array(e),a=0;e>a;a++)n[a]=t.call(i,a);return n},S.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var $={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};$.unescape=S.invert($.escape);var O={escape:new RegExp("["+S.keys($.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys($.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(e){S[e]=function(t){return null==t?"":(""+t).replace(O[e],function(t){return $[e][t]})}}),S.result=function(e,t){if(null==e)return null;var i=e[t];return S.isFunction(i)?i.call(e):i},S.mixin=function(e){C(S.functions(e),function(t){var i=S[t]=e[t];S.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),L.call(this,i.apply(S,e))}})};var A=0;S.uniqueId=function(e){var t=++A+"";return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(e,t,i){if(S.isFunction(e))return t?e(t):e;var n;i=S.defaults({},i,S.templateSettings);var a=new RegExp([(i.escape||N).source,(i.interpolate||N).source,(i.evaluate||N).source].join("|")+"|$","g"),r=0,o="__p+='",s=e;e.replace(a,function(t,i,n,a,s){return o+=e.slice(r,s).replace(M,function(e){return"\\"+R[e]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(o+="';\n"+a+"\n__p+='"),r=s+t.length,t}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(l){throw l.source=o,l}if(t)return n(t,S);var c=function(e){return n.call(this,e,S)};return c.source="function("+(i.variable||"obj")+"){\n"+o+"}",c.textsource=s,c},S.chain=function(e){return S(e).chain()};var L=function(e){return this._chain?S(e).chain():e};S.mixin(S),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];S.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],L.call(this,i)}}),C(["concat","join","slice"],function(e){var t=n[e];S.prototype[e]=function(){return L.call(this,t.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),define("underscore",function(e){return function(){var t;return t||e._}}(this)),function(){var e,t=this,i=t.Backbone,n=[],a=n.push,r=n.slice,o=n.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="0.9.10";var s=t._;!s&&"undefined"!=typeof require&&(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=/\s+/,c=function(e,t,i,n){if(!i)return!0;if("object"==typeof i)for(var a in i)e[t].apply(e,[a,i[a]].concat(n));else{if(!l.test(i))return!0;i=i.split(l),a=0;for(var r=i.length;r>a;a++)e[t].apply(e,[i[a]].concat(n))}},d=function(e,t){var i,n=-1,a=e.length;switch(t.length){case 0:for(;++n<a;)(i=e[n]).callback.call(i.ctx);break;case 1:for(;++n<a;)(i=e[n]).callback.call(i.ctx,t[0]);break;case 2:for(;++n<a;)(i=e[n]).callback.call(i.ctx,t[0],t[1]);break;case 3:for(;++n<a;)(i=e[n]).callback.call(i.ctx,t[0],t[1],t[2]);break;default:for(;++n<a;)(i=e[n]).callback.apply(i.ctx,t)}},n=e.Events={on:function(e,t,i){return c(this,"on",e,[t,i])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:i,ctx:i||this}),this):this},once:function(e,t,i){if(!c(this,"once",e,[t,i])||!t)return this;var n=this,a=s.once(function(){n.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,i),this},off:function(e,t,i){var n,a,r,o,l,d,h,u;if(!this._events||!c(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(o=e?[e]:s.keys(this._events),l=0,d=o.length;d>l;l++)if(e=o[l],n=this._events[e]){if(r=[],t||i)for(h=0,u=n.length;u>h;h++)a=n[h],(t&&t!==a.callback&&t!==a.callback._callback||i&&i!==a.context)&&r.push(a);this._events[e]=r}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&d(i,t),n&&d(n,arguments),this},listenTo:function(e,t,i){var n=this._listeners||(this._listeners={}),a=e._listenerId||(e._listenerId=s.uniqueId("l"));return n[a]=e,e.on(t,"object"==typeof t?this:i,this),this},stopListening:function(e,t,i){var n=this._listeners;if(n){if(e)e.off(t,"object"==typeof t?this:i,this),!t&&!i&&delete n[e._listenerId];else{"object"==typeof t&&(i=this);for(var a in n)n[a].off(t,i,this);this._listeners={}}return this}}};n.bind=n.on,n.unbind=n.off,s.extend(e,n);var h=e.Model=function(e,t){var i,n=e||{};this.cid=s.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(n=this.parse(n,t)||{}),(i=s.result(this,"defaults"))&&(n=s.defaults({},n,i)),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};s.extend(h.prototype,n,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,a,r,o,l,c,d;if(null==e)return this;if("object"==typeof e?(a=e,i=t):(a={})[e]=t,i||(i={}),!this._validate(a,i))return!1;r=i.unset,o=i.silent,e=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=s.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in a&&(this.id=a[this.idAttribute]);for(n in a)t=a[n],s.isEqual(d[n],t)||e.push(n),s.isEqual(c[n],t)?delete this.changed[n]:this.changed[n]=t,r?delete d[n]:d[n]=t;if(!o)for(e.length&&(this._pending=!0),t=0,n=e.length;n>t;t++)this.trigger("change:"+e[t],this,d[e[t]],i);if(l)return this;if(!o)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._changing=this._pending=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t,i={};for(t in this.attributes)i[t]=void 0;return this.set(i,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,i,n=!1,a=this._changing?this._previousAttributes:this.attributes;for(i in e)s.isEqual(a[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,i,n){return e.set(e.parse(i,n),n)?void(t&&t(e,i,n)):!1},this.sync("read",this,e)},save:function(e,t,i){var n,a,r=this.attributes;return null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,!n||i&&i.wait||this.set(n,i)?(i=s.extend({validate:!0},i),this._validate(n,i)?(n&&i.wait&&(this.attributes=s.extend({},r,n)),void 0===i.parse&&(i.parse=!0),a=i.success,i.success=function(e,t,i){e.attributes=r;var o=e.parse(t,i);return i.wait&&(o=s.extend(n||{},o)),s.isObject(o)&&!e.set(o,i)?!1:void(a&&a(e,t,i))},e=this.isNew()?"create":i.patch?"patch":"update","patch"===e&&(i.attrs=n),e=this.sync(e,this,i),n&&i.wait&&(this.attributes=r),e):!1):!1},destroy:function(e){e=e?s.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(e,t,a){(a.wait||e.isNew())&&n(),i&&i(e,t,a)},this.isNew())return e.success(this,null,e),!1;var a=this.sync("delete",this,e);return e.wait||n(),a},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||P();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,t||{}),!1):!0}});var u=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))};s.extend(u.prototype,n,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var i,n,r,l,c,d,h,u,p,f;for(h=[],u=t.at,p=this.comparator&&null==u&&0!=t.sort,f=s.isString(this.comparator)?this.comparator:null,i=0,n=e.length;n>i;i++)(r=this._prepareModel(l=e[i],t))?(c=this.get(r))?t.merge&&(c.set(l===r?r.attributes:l,t),p&&!d&&c.hasChanged(f)&&(d=!0)):(h.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)):this.trigger("invalid",this,l,t);if(h.length&&(p&&(d=!0),this.length+=h.length,null!=u?o.apply(this.models,[u,0].concat(h)):a.apply(this.models,h)),d&&this.sort({silent:!0}),t.silent)return this;for(i=0,n=h.length;n>i;i++)(r=h[i]).trigger("add",r,this,t);return d&&this.trigger("sort",this,t),this},remove:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var i,n,a,r;for(i=0,n=e.length;n>i;i++)(r=this.get(e[i]))&&(delete this._byId[r.id],delete this._byId[r.cid],a=this.indexOf(r),this.models.splice(a,1),this.length--,t.silent||(t.index=a,r.trigger("remove",r,this,t)),this._removeReference(r));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null!=e?(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e]):void 0},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return s.invoke(this.models,"get",e)},update:function(e,t){t=s.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var i,n,a,r,o=[],l=[],c={};if(s.isArray(e)||(e=e?[e]:[]),t.add&&!t.remove)return this.add(e,t);for(n=0,a=e.length;a>n;n++)i=e[n],r=this.get(i),t.remove&&r&&(c[r.cid]=!0),(t.add&&!r||t.merge&&r)&&o.push(i);if(t.remove)for(n=0,a=this.models.length;a>n;n++)i=this.models[n],c[i.cid]||l.push(i);return l.length&&this.remove(l,t),o.length&&this.add(o,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,i,n){e[n.update?"update":"reset"](i,n),t&&t(e,i,n)},this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(e,t,a){a.wait&&i.add(e,a),n&&n(e,t,a)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"===e||"remove"===e)&&i!==this||("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,i){t||(t=this.comparator);var n=s.isFunction(t)?t:function(e){return e.get(t)};return s.sortedIndex(this.models,e,n,i)}}),s.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(e){u.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}}),s.each(["groupBy","countBy","sortBy"],function(e){u.prototype[e]=function(t,i){var n=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,n,i)}});var p=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},f=/\((.*?)\)/g,v=/(\(\?)?:\w+/g,g=/\*\w+/g,m=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(p.prototype,n,{initialize:function(){},route:function(t,i,n){return s.isRegExp(t)||(t=this._routeToRegExp(t)),n||(n=this[i]),e.history.route(t,s.bind(function(a){a=this._extractParameters(t,a),n&&n.apply(this,a),this.trigger.apply(this,["route:"+i].concat(a)),this.trigger("route",i,a),e.history.trigger("route",this,i,a)},this)),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes)for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(m,"\\$&").replace(f,"(?:$1)?").replace(v,function(e,t){return t?e:"([^/]+)"}).replace(g,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var w=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,y=/^\/+|\/+$/g,b=/msie [\w.]+/,x=/\/$/;w.started=!1,s.extend(w.prototype,n,{interval:50,getHash:function(e){return(e=(e||this).location.href.match(/#(.*)$/))?e[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(x,"");e.indexOf(i)||(e=e.substr(i.length))}else e=this.getHash();return e.replace(_,"")},start:function(t){if(w.started)throw Error("Backbone.history has already been started");w.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState),t=this.getFragment();var i=document.documentMode,i=b.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);return this.root=("/"+this.root+"/").replace(y,"/"),i&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,t=this.location,i=t.pathname.replace(/[^\/]$/,"$&/")===this.root,this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!i?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&i&&t.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment+t.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),w.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(e,t){if(!w.started)return!1;if(t&&!0!==t||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var i=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,i){i?(i=e.href.replace(/(javascript:|#).*$/,""),e.replace(i+"#"+t)):e.hash="#"+t}}),e.history=new w;var S=e.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},C=/^(\S+)\s*(.*)$/,T="model collection el id attributes className tagName events".split(" ");s.extend(S.prototype,n,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=s.result(this,"events"))){this.undelegateEvents();for(var t in e){var i=e[t];if(s.isFunction(i)||(i=this[e[t]]),!i)throw Error('Method "'+e[t]+'" does not exist');var n=t.match(C),a=n[1],n=n[2],i=s.bind(i,this),a=a+(".delegateEvents"+this.cid);""===n?this.$el.on(a,i):this.$el.on(a,n,i)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),s.extend(this,s.pick(e,T)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className")),t=e.$("<"+s.result(this,"tagName")+">").attr(t),this.setElement(t,!1)}}});var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.sync=function(t,i,n){var a=k[t];s.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var r={type:a,dataType:"json"};if(n.url||(r.url=s.result(i,"url")||P()),null!=n.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){r.type="POST",n.emulateJSON&&(r.data._method=a);var o=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),o?o.apply(this,arguments):void 0}}"GET"!==r.type&&!n.emulateJSON&&(r.processData=!1);var l=n.success;n.success=function(e){l&&l(i,e,n),i.trigger("sync",i,e,n)};var c=n.error;return n.error=function(e){c&&c(i,e,n),i.trigger("error",i,e,n)},t=n.xhr=e.ajax(s.extend(r,n)),i.trigger("request",i,t,n),t},e.ajax=function(){return e.$.ajax.apply(e.$,arguments)},h.extend=u.extend=p.extend=S.extend=w.extend=function(e,t){var i,n=this;i=e&&s.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,t);var a=function(){this.constructor=i};return a.prototype=n.prototype,i.prototype=new a,e&&s.extend(i.prototype,e),i.__super__=n.prototype,i};var P=function(){throw Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t;return t||e.Backbone}}(this)),define("text",["module"],function(e){"use strict";var t,i,n,a,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),d=l&&location.hostname,h=l&&(location.port||void 0),u=[],p=e.config&&e.config()||{};
return t={version:"2.0.5+",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=r[t];try{e=new ActiveXObject(i)}catch(n){}if(e){r=[i];break}}return e},parseName:function(e){var t,i,n,a=!1,r=e.indexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!o||r>1)?(t=e.substring(0,r),i=e.substring(r+1,e.length)):t=e,n=i||t,r=n.indexOf("!"),-1!==r&&(a="strip"===n.substring(r+1),n=n.substring(0,r),i?i=n:t=n),{moduleName:t,ext:i,strip:a}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,a){var r,o,s,l=t.xdRegExp.exec(e);return l?(r=l[2],o=l[3],o=o.split(":"),s=o[1],o=o[0],!(r&&r!==i||o&&o.toLowerCase()!==n.toLowerCase()||(s||o)&&s!==a)):!0},finishLoad:function(e,i,n,a){n=i?t.strip(n):n,p.isBuild&&(u[e]=n),a(n)},load:function(e,i,n,a){if(a.isBuild&&!a.inlineText)return void n();p.isBuild=a.isBuild;var r=t.parseName(e),o=r.moduleName+(r.ext?"."+r.ext:""),s=i.toUrl(o),u=p.useXhr||t.useXhr;!l||u(s,c,d,h)?t.get(s,function(i){t.finishLoad(e,r.strip,i,n)},function(e){n.error&&n.error(e)}):i([o],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,n)})},write:function(e,i,n,a){if(u.hasOwnProperty(i)){var r=t.jsEscape(u[i]);n.asModule(e+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,i,n,a,r){var o=t.parseName(i),s=o.ext?"."+o.ext:"",l=o.moduleName+s,c=n.toUrl(o.moduleName+s)+".js";t.load(l,n,function(i){var n=function(e){return a(c,e)};n.asModule=function(e,t){return a.asModule(e,c,t)},t.write(e,l,n,r)},r)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(i=require.nodeRequire("fs"),t.get=function(e,t){var n=i.readFileSync(e,"utf8");0===n.indexOf("\ufeff")&&(n=n.substring(1)),t(n)}):"xhr"===p.env||!p.env&&t.createXhr()?t.get=function(e,i,n,a){var r,o=t.createXhr();if(o.open("GET",e,!0),a)for(r in a)a.hasOwnProperty(r)&&o.setRequestHeader(r.toLowerCase(),a[r]);p.onXhr&&p.onXhr(o,e),o.onreadystatechange=function(t){var a,r;4===o.readyState&&(a=o.status,a>399&&600>a?(r=new Error(e+" HTTP status: "+a),r.xhr=o,n(r)):i(o.responseText))},o.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,a="utf-8",r=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),a)),l="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),i.append(n);null!==(n=s.readLine());)i.append(o),i.append(n);l=String(i.toString())}finally{s.close()}t(l)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,a=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var i,r,o={},s=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),i.init(s,1,0,!1),r=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),r.init(i,"utf-8",i.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(i.available(),o),r.close(),i.close(),t(o.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),t}),define("text!interaction_view/template/message.tpl",[],function(){return'<div class="status <%=type%>">\n<p><%=msg%></p>\n<a href="#" class="close">Close</a>\n</div>'}),define("text!interaction_view/template/slidenumber.tpl",[],function(){return'<%if(slidelength>1){%>\n<% if(iDetail.slideno_horizontal){%>\n<nav class="iView nav-horizen slidenumber" data-id="<%=id%>" style="left:<%=iDetail.slideno_horizontal_data.x%>px;top:<%=iDetail.slideno_horizontal_data.y%>px;" data-x="<%=iDetail.slideno_horizontal_data.x%>" data-y="<%=iDetail.slideno_horizontal_data.y%>">\n    <%for(i=0;i<slidelength;i++){%><li class="<%=0==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>\n<% if(iDetail.slideno_vertical){%>\n<nav class="iView nav-vertical slidenumber" data-id="<%=id%>" style="left:<%=iDetail.slideno_vertical_data.x%>px;top:<%=iDetail.slideno_vertical_data.y%>px;" data-x="<%=iDetail.slideno_vertical_data.x%>" data-y="<%=iDetail.slideno_vertical_data.y%>">\n    <%for(i=0;i<slidelength;i++){%><li class="<%=0==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>\n<% } %>\n'}),define("text!interaction_view/template/imgpreview.tpl",[],function(){return'<div class="btn-group action-control" style="position: absolute;left: 0;top: 0;z-index: 100001;background: transparent;width: 100%;height: 100%;">\n    <button class="btn preview-left enabled" href="#" rel="tooltip" data-original-title="PREV" style="color: #FFF;position: absolute;left: 0;top: 50%;background-color: transparent;background: none;">\n        <i class="icon-chevron-left icon-2x"></i>\n    </button>\n    <button class="btn preview-right enabled" href="#" rel="tooltip" data-original-title="NEXT" style="color: #FFF;background: transparent;position: absolute;right: 0px;top: 50%;">\n        <i class="icon-chevron-right icon-2x"></i>\n    </button>\n</div>'}),function(){function e(e,t,i,n){function a(e){return void 0===e||null===e||(e=e.get?e.get():"function"==typeof e?e():e.value||e),e}if(void 0===i||!i.shift)throw"TypeError: invalid arguments\n"+i+" is not an array";n=Object.assign({keep:!0},n);var r=Object.getOwnPropertyDescriptor(e,t),o=r||{};if(n.keep!==!1){var s=i[i.length-1];o.get=function(){return a(s)},delete o.value,delete o.writable}var l={configurable:!0,get:function(){return 0==i.length?(Object.defineProperty(e,t,o),e[t]):a(i.shift())}};Object.defineProperty(e,t,l)}function t(){return window._g||(window._g={}),window._g=$.extend(!0,{},window._g,r),n=r=void 0,window._g}var n,r;return n=r={uuid:function(e){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}if(e){for(var i="";e--;)i+=t();return i}return t()+t()+t()+t()+t()+t()+t()+t()},changeURLPar:function(e,t,i){decodeURI(i)==i&&(i=encodeURI(i));var n,a=e.split("#")[0];if(-1!=a.indexOf("?")){var r="";r=a.substr(a.indexOf("?")+1);var o,s="",l="",c="0";if(-1!=r.indexOf("&")){o=r.split("&");for(var d=0;d<o.length;d++){if(o[d].split("=")[0]==t){if(""==i)continue;l=i,c="1"}else l=o[d].split("=")[1];s=s+o[d].split("=")[0]+"="+l+"&"}s=s.substr(0,s.length-1),"0"==c&&""!=i&&s==r&&(s=s+"&"+t+"="+i)}else-1!=r.indexOf("=")?(o=r.split("="),o[0]==t?(l=i,c="1"):l=o[1],""!=l&&(s=o[0]+"="+l),"0"==c&&s==r&&""!=i&&(s=s+"&"+t+"="+i)):""!=i&&(s=t+"="+i);n=a.substr(0,a.indexOf("?")),""!=s&&(n=n+"?"+s)}else n=""!=i?a+"?"+t+"="+i:a;return e.indexOf("#")>0&&(n=n+"#"+e.split("#")[1]),n},getUrlParameterByName:function(e,t){var i=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("([\\?&]"+i+"=([^&#]*))+"),a=n.exec("undefined"!=typeof t&&t||location.search);return null==a?null:decodeURIComponent(a[a.length-1].replace(/\+/g," "))},replaceUrlParameterByName:function(e,t,i){var n=t.split("=")[1];return this.changeURLPar(i,e,n)},getHashParameterByName:function(e){var t=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),i=new RegExp("[\\#&]"+t+"=([^&#]*)"),n=i.exec(location.hash);return null==n?null:decodeURIComponent(n[1].replace(/\+/g," "))},replaceHashParameterByName:function(e,t){var i=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("[\\#&]"+i+"=([^&#]*)"),a=n.exec(location.hash);return location.hash.replace(a[0].substr(1),t)},parseTemplate:function(e){var t=null;return"function"==typeof e&&(t=e),"string"==typeof e&&(t=_.template(e)),t},getHost:function(e){var t="null";("undefined"==typeof e||null==e)&&(e=window.location.href);var i=/.*\:\/\/([^\/]*).*/,n=e.match(i);return"undefined"!=typeof n&&null!=n&&(t=n[1]),t},isEpub360Domain:function(e){for(var t=["epub360.com","epub360.com.cn","epub360.cn","creatby.com"],i=_g.getHost(e),n=!1,a=0;a<t.length;a++)if(i.indexOf(t[a])>0){n=!0;break}return n},renderT:function(e,t,i,n,a){if(!e)return!1;t||(t={});var r=n||null,o=$.extend(!0,{},t);if(r&&"undefined"!=typeof _gDebug&&_gDebug&&_g.debug&&_g.debug.enabled&&_g.debug.query_user_template(r)&&!a&&(e=_g.debug.query_user_template(r)),i){var s={};s[i]=o,o=s}var l=_g.parseTemplate(e);r&&_g.debug&&_g.debug.enabled&&(_g.debug.template[r]={data:o,template:"string"==typeof e?e:e.textsource,debug:!0});var c=$(l(o));return r&&_g.debug&&_g.debug.enabled&&(_g.debug.template[r].el=c),_g.generator&&(_g.generator.autoWidget(c),(c.hasClass("c-slimscroll")||c.find(".c-slimscroll").length)&&_g.generator.autoScroll(c)),c.find("[data-toggle=tooltip],.c-tooltip-btn").each(function(){var e=$(this),t=$(this).data().template;t?require(["text!"+t],function(){var i=require("text!"+t);e.tooltip({template:i})}):$(this).tooltip()}),c},domExist:function(e,t){return t||(t=document),"string"==typeof e&&(e=$(e)),$.contains(t.documentElement,e[0])},browserSupport:function(e){var t=!1,i={msie:1,chrome:1,mozilla:1,safari:1,opera:1,success:null,fail:null};e=e?$.extend(!0,{},i,e):$.extend(!0,{},i);var n=parseInt($.browser.version,10);return $.browser.msie&&1==e.msie||$.browser.chrome&&1==e.chrome||$.browser.mozilla&&1==e.mozilla||$.browser.safari&&1==e.safrai&&$.browser.opera&&1==e.opera?t=!0:$.browser.msie&&0==e.msie||$.browser.chrome&&0==e.chrome||$.browser.mozilla&&0==e.mozilla||$.browser.safari&&0==e.safrai&&$.browser.opera&&0==e.opera?t=!1:($.browser.msie&&(t=n>=e.msie),$.browser.chrome&&(t=n>=e.chrome),$.browser.mozilla&&(t=n>=e.mozilla),$.browser.opera&&(t=n>=e.opera),$.browser.safari&&(t=n>=e.safari)),t?e.success&&e.success():e.fail&&e.fail(),t},array:{moveup:function(e,t){var i=e.indexOf(t);return i>0&&(e=_g.array.swap(e,i,i-1)),e},movedown:function(e,t){var i=e.indexOf(t);return i<e.length&&(e=_g.array.swap(e,i,i+1)),e},swap:function(e,t,i){return e[t]=e.splice(i,1,e[t])[0],e},move2first:function(e,t){var n=[];for(n.push(t),i=0;i<e.length;i++)e[i]!=t&&n.push(e[i]);return n},move2last:function(e,t){var n=[];for(i=0;i<e.length;i++)e[i]!=t&&n.push(e[i]);return n.push(t),n},randomPick:function(e){return e[Math.floor(Math.random()*e.length)]},maptree:function(e){var t={treesource:null,mapdata:null,idAttribute:"id"};if(e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),!e.treesource||!e.mapdata)return[];var i=[];return _.each(e.treesource,function(t){t.children&&(t.children=_g.array.maptree({treesource:t.children,mapdata:e.mapdata,idAttribute:e.idAttribute}));var n=_.find(e.mapdata,function(i){return i[e.idAttribute]==t[e.idAttribute]});n&&(t=$.extend(!0,t,n)),i.push(t)}),i},toDict:function(e,t){var n,a={};for(i=0;i<e.length;i++)n=e[i][t],a[n]=e[i];return a},treeToList:function(e,t,i){var n={childrenKey:"children",parentKey:"parent",idAttribute:"id"};if(t=t?$.extend(!0,{},n,t):$.extend(!0,{},n),!e)return[];var a=[];return _.each(e,function(n){if(n[t.childrenKey].length){var r=_g.array.toTreeList(n[t.childrenKey],t,i?i:e);for(j=0;j<r.length;j++)a.push(r[j]);n.children=_.pluck(n.children,"id")}else delete n.children;a.push(n)}),a},listToTree:function(e,t,i){var n={childrenKey:"children",parentKey:"parent",idAttribute:"id"};t=t?$.extend(!0,{},n,t):$.extend(!0,{},n);var a=[];return i&&(e=_.map(e,function(e){return"string"==typeof e&&(e=_.find(i,function(i){return i[t.idAttribute]==e})),e})),_.each(e,function(n){var r=$.extend(!0,{},n);i||r[t.parentKey],r[t.childrenKey]&&r[t.childrenKey].length?(r[t.childrenKey]=_g.array.listToTree(r[t.childrenKey],t,i?i:e),a.push(r)):a.push(r)}),a}},object:{jsonparse:function(e){if(!e)return null;try{return a=JSON.parse(e)}catch(t){return e}},equal:function(e,t){},treeToArray:function(e){},getKeyByValue:function(e,t){try{var i=_.keys(e)[_.values(e).indexOf(t)];return i}catch(n){return}}},string:{randomGenerate:function(e){e=e?e:10;for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",n=0;e>n;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},getUrlExt:function(e){return e.match(/(.[^.]+|)$/)[0]},getUrlNameWithOutExt:function(e){return e.substr(0,e.lastIndexOf("."))||e},getFileNameByPath:function(e){return e.replace(/^.*[\\\/]/,"")},string2boolean:function(e){return"true"==e?!0:!1},capitalize:function(e){return e=e.substring(0,1).toUpperCase()+e.substring(1)},rmfirst:function(e){return e.replace(/^.(\s+)?/,"")},rmlast:function(e){return e.replace(/(\s+)?.$/,"")},isPureEng:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(t.charCodeAt(i)>=48&&t.charCodeAt(i)<=57||t.charCodeAt(i)>=65&&t.charCodeAt(i)<=90||t.charCodeAt(i)>=97&&t.charCodeAt(i)<=122))return!1;return!0},isEng:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(32==t.charCodeAt(i)||t.charCodeAt(i)>=48&&t.charCodeAt(i)<=57||t.charCodeAt(i)>=65&&t.charCodeAt(i)<=90||t.charCodeAt(i)>=97&&t.charCodeAt(i)<=122))return!1;return!0},isPureChi:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(t.charCodeAt(i)>=19968&&t.charCodeAt(i)<=64041))return!1;return!0},isChi:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(32==t.charCodeAt(i)||t.charCodeAt(i)>=19968&&t.charCodeAt(i)<=64041))return!1;return!0},autoName:function(e,t,i,n){e||(e=""),i||(i=""),n||(n=1);var a=e+n+i;return-1!=t.indexOf(a)?_g.string.autoName(e,t,i,n+1):a}},"boolean":{randomPick:function(){return!!Math.round(1*Math.random())}},number:{random:function(e,t){return"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=100),Math.random()*(t-e)+e},randomInt:function(e,t){return"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=100),Math.floor(Math.random()*(t-e+1))+e},round:function(e,t){var i=e;void 0==typeof t&&(t=.5);var n=parseInt(e),a=e-n;i=t>a?n:n+1},rgbToHex:function(e,t,i){return"#"+((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},hexToRgb:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,i,n){return t+t+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},decimal:function(e,t){return Number(e.toFixed(t))}},hasTouch:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}(),inIframe:function(){try{return window.self!==window.top}catch(e){return!0}},supportFlash:function(){return"undefined"!=typeof swfobject&&0!==swfobject.getFlashPlayerVersion().major?!0:!1},isMSIE11:function(){return!!navigator.userAgent.match(/Trident\/7\./)},getRGBA:function(e,t){if(t=void 0!=t?Number(t):1,!e)return"transparent";if(-1!=e.indexOf("rgb("))var i=e.replace(/rgb\((.*)\)/,"$1").split(","),n="rgba("+i[0]+","+i[1]+","+i[2]+","+t+")";else{var i=_g.number.hexToRgb(e);if(i)var n="rgba("+i.r+","+i.g+","+i.b+","+t+")";else n="rgba(255,255,255,1)"}return n},weixinShare:function(){if("undefined"!=typeof wx_permissions&&wx_permissions.onMenuShareTimeline){var e=message_link+(message_link.indexOf("disableHistoryStart=0")>=0?"#page/"+interaction_view.currentPage:""),t=shareTitle==bookTitle?descContent:shareTitle;wx.onMenuShareAppMessage({title:bookTitle,desc:t,link:e,imgUrl:imgUrl,trigger:function(e){_gaq.push(["_trackEvent","weixin","share","appmessage","click"])},success:function(e){_gaq.push(["_trackSocial","Wechat","appmessage",ga_opt_target,ga_opt_pagePath])},cancel:function(e){_gaq.push(["_trackEvent","weixin","share","appmessage","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","appmessage",JSON.stringify(e)])}}),wx.onMenuShareTimeline({title:shareTitle,link:e,imgUrl:imgUrl,trigger:function(e){_gaq.push(["_trackEvent","weixin","share","timeline","click"])},success:function(e){_gaq.push(["_trackSocial","Wechat","timeline",ga_opt_target,ga_opt_pagePath])},cancel:function(e){_gaq.push(["_trackEvent","weixin","share","timeline","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","timeline",JSON.stringify(e)])}}),wx.onMenuShareQQ({title:bookTitle,desc:t,link:e,imgUrl:imgUrl,trigger:function(e){_gaq.push(["_trackEvent","weixin","share","QQ","click"])},complete:function(e){_gaq.push(["_trackEvent","weixin","share","QQ","complete"])},success:function(e){_gaq.push(["_trackSocial","Wechat","QQ",ga_opt_target,ga_opt_pagePath])},cancel:function(e){_gaq.push(["_trackEvent","weixin","share","QQ","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","QQ",JSON.stringify(e)])}}),wx.onMenuShareWeibo({title:shareTitle,desc:descContent,link:message_link,imgUrl:imgUrl,trigger:function(e){_gaq.push(["_trackEvent","weixin","share","Weibo","click"])},complete:function(e){_gaq.push(["_trackEvent","weixin","share","Weibo","complete"])},success:function(e){_gaq.push(["_trackSocial","Wechat","Weibo",ga_opt_target,ga_opt_pagePath])},cancel:function(e){_gaq.push(["_trackEvent","weixin","share","Weibo","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","Weibo",JSON.stringify(e)])}})}}},n.EventHandler=function(){function e(){this.queue=[]}return e.prototype={add:function(e){this.queue.push(e)},del:function(e){e?this.queue.forEach(function(t,i){t===e&&this.queue.splice(i,1)},this):this.queue=[]},dispatch:function(e,t){this.queue.forEach(function(i){"function"==typeof i&&i.call(t,e)},this)}},e}(),n.dynamicGetter=e,"undefined"==typeof require?t():void define("_g/base",["jquery","underscore","backbone"],function(){return t()})}(window),function(){var e={log:function(e){console.log(e)},serverError:function(e,t){$(document).trigger("serverError"),0===t.readyState&&_g.error.errorSend()},errorSend:function(){try{if(0==epub360.variable.network_error_time)epub360.variable.network_error_time=1,interaction.message("error","网络连接超时，请检查您的网络并重新保存。");else{var e="出错了",t="网络连接超时，无法保存您的操作，可能您的网络状况不稳定，请检查您的网络并重新保存。";interaction.modalAlert(e,t)}}catch(i){}}};"undefined"==typeof require?(window._g||(window._g={}),window._g.error=e):define("_g/error",["_g/base"],function(){return window._g.error=e,window._g.error})}(window),function(){var e={buttonGroupT:['<div class="_g_btn_group <%=opts.className||""%>">',"</div>"].join(""),buttonT:'   <button class="btn _g_btn _g_btn_confirm <%=opts.className||""%>" type="button" data-name="<%=opts.name%>"><%=opts.name%></button>',buttonGroupList:[],scale:function(e,t){$(e).css("zoom",t).css("-moz-transform","scale("+t+")").css("-o-transform","scale("+t+")")},center:function(e){var t={containment:null};return e="string"==typeof e?{containments:null,Item:e}:e?$.extend({},t,e):t,e.Item?void $(e.Item).css({left:"50%",top:"50%","margin-top":function(){return-($(this).height()/2+50)},"margin-left":function(){return-($(this).width()/2)}}):!1},centerImage:function(e){var t={containment:null,parentWidth:null,parentHeight:null,width:null,height:null,setParent:!0};if(e=e?$.extend({},t,e):t,!e.Item||!e.containment)return!1;var i=0;return e.setParent&&$(e.containment).css({"line-height":e.parentHeight+"px","text-align":"center"}),e.width/e.height>=e.parentWidth/e.parentHeight?($(e.Item).css({width:"100%",height:"auto","verticle-align":"middle"}),i=e.parentWidth,height=e.parentWidth/(e.width/e.height)):($(e.Item).css({width:"auto",height:"100%","verticle-align":"middle"}),height=e.parentHeight,i=e.parentHeight*(e.width/e.height)),{width:i,height:height}},fitImage:function(e){if(!e)return!1;if(e.fit||(e.fit=0),e.containment)switch($(e.containment).css({"background-repeat":"no-repeat","background-position":"50% 50%"}),e.fit){case 0:$(e.containment).css({"background-size":"100%"});break;case 1:$(e.containment).css({"background-size":"contain"});break;case 2:$(e.containment).css({"background-size":"cover"})}else e.items&&$(e.items).each(function(){var t=$(this);void 0==e.width&&(e.width=$(this).width()),void 0==e.height&&(e.height=$(this).height());var i=e.width,n=e.height,a=$(this).parent();if(e.parentHeight=e.parentHeight||a.height(),e.parentWidth=e.parentWidth||a.width(),0==e.fit&&(t.css({width:"100%",height:"100%",top:"",left:""}),t.addClass("fullsize bk_full"),t.removeClass("bk_contain bk_cover"),i=e.parentWidth,n=e.parentHeight),1==e.fit)if(a.css({"line-height":e.parentHeight-(e.borderH||0)+"px"}),e.useMargin||(a.css("text-align","center"),a.removeClass("bk_cover bk_full"),a.addClass("aligncenter bk_contain")),e.width/e.height>=e.parentWidth/e.parentHeight){if(i=e.parentWidth,n=e.parentWidth/(e.width/e.height),t.css({width:"100%",height:"auto","vertical-align":"middle",left:"",top:"",display:"inline-block",position:"relative"}),e.useMargin){var r=e.parentWidth/(e.width/e.height);t.css("margin-top",(e.parentHeight-r)/2+"px"),t.css("margin-bottom",(e.parentHeight-r)/2+"px"),t.css({"margin-left":0,"margin-right":0}),t.css("position","absolute")}}else if(n=e.parentHeight,i=e.parentHeight*(e.width/e.height),t.css({width:"auto",height:"100%","vertical-align":"top",left:"",top:"",display:"inline-block",position:"relative"}),e.useMargin){var o=e.parentHeight*(e.width/e.height);t.css("margin-left",(e.parentWidth-o)/2+"px"),t.css("margin-right",(e.parentWidth-o)/2+"px"),t.css({"margin-top":0,"margin-bottom":0}),t.css("position","absolute")}2==e.fit&&(a.css({"line-height":e.parentHeight+"px","text-align":"center",overflow:"hidden"}),a.removeClass("bK_full bk_contain"),a.addClass("aligncenter overflowhidden bk_cover"),e.width/e.height>=e.parentWidth/e.parentHeight?(t.css({width:e.parentHeight*e.width/e.height+"px",height:e.parentHeight+"px","verticle-align":"middle",position:"absolute",left:"-"+(e.parentHeight*e.width/e.height-e.parentWidth)/2+"px",top:0,"max-width":"none"}),e.useMargin&&(t.css("left",""),t.css("margin-left","-"+(e.parentHeight*e.width/e.height-e.parentWidth)/2+"px"))):(t.css({position:"absolute",width:e.parentWidth+"px",height:e.parentWidth/(e.width/e.height)+"px","verticle-align":"middle",top:"-"+(e.parentWidth/(e.width/e.height)-e.parentHeight)/2+"px",left:0,"max-height":"none"}),e.useMargin&&(t.css("top",""),t.css("margin-top","-"+(e.parentWidth/(e.width/e.height)-e.parentHeight)/2+"px")))),e.explicitSize&&t.css({width:i,height:n})})},opacity:function(e,t){},addShade:function(e){var t={name:"_g_shadow",zindex:99999,color:"#000000",opacity:.8,containment:"body"};e=e?$.extend({},t,e):t,$(containment).append('<div id="'+e.name+'" style="z-index:'+e.zindex+";background:"+e.color+";opacity:"+e.opacity+';"></div>')},addButtonGroup:function(e){var t={containment:null,position:0,name:"_g_button"+_g.uuid(),className:null,confirmButton:{name:"确认",enable:!0,className:"btn-small btn-primary",onClick:null},cancelButton:{name:"取消",enable:!0,className:"btn-small",onClick:null},remove:function(){e.$el&&e.$el.remove()},getButton:function(t){return e.$el.find('[data-name="'+t+'"]')},addButton:function(t){var i={name:null,className:null,onClick:null};return t=t?$.extend(!0,{},i,t):i,t.name?(e.$el.append(_.template(_g.ui.buttonT,{opts:t})),void(t.onClick&&e.getButton(t.name).on("click",function(){t.onClick()}))):!1},removeButton:function(t){t&&e.$el.find('[data-name="'+t+'"]').remove()}};return e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),e.containment?(0==e.position?($(e.containment).append(_.template(_g.ui.buttonGroupT,{opts:e})),e.$el=$(e.containment).children("._g_btn_group")):($(_.template(_g.ui.buttonGroupT,{opts:e})).insertAfter($(e.containment)),e.$el=$(e.containment).next("._g_btn_group")),e.confirmButton.enable&&e.addButton(e.confirmButton),e.cancelButton.enable&&e.addButton(e.cancelButton),e):!1},contenteditable:function(e){var t={eventType:0,mutiple:0,element:null,callback:null,type:0,enableControl:!1};return e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),e.onKeyDown=function(t,i){var n=t.keyCode?t.keyCode:t.which;13==n&&0==e.mutiple&&(e.enableClose=!0,e.$this.blur(),$(document).off("keydown",e.onKeyDown),e.result())},e.result=function(){if(e.$this.data("before")!==e.$this.html()){e.$this.data("before",e.$this.html());var t=0==e.type?e.$this.text():e.$this.html();e.callback&&e.callback(t)}},e.enableEdit=!1,e.element?void(e.element&&(e.$this=$(e.element),e.$this.addClass("_g_contenteditable"),0==e.eventType&&$(e.element).attr("contenteditable","true"),1==e.eventType&&($(e.element).attr("contenteditable","false"),$(e.element).on("dblclick",function(){$(this).attr("contenteditable","true"),$(this).focus()})),$(e.element).on("focus",function(){return e.focus?!1:(e.focus=!0,e.$this.data("before",e.$this.html()),$(document).on("keydown",e.onKeyDown),e.enableControl&&(e.buttonGroup=_g.ui.addButtonGroup({containment:e.$this,position:1,confirmButton:{onClick:function(){e.enableClose=!0,e.$this.blur()}},cancelButton:{onClick:function(){e.enableClose=!0,e.$this.html(e.$this.data("before")),e.$this.blur()}}})),e.$this)}).on("blur",function(t){if(e.enableControl){if(!e.enableClose)return e.$this.focus(),!1;e.enableClose=!1,e.buttonGroup.remove()}return e.focus=!1,$(document).off("keydown",e.onKeyDown),1==e.eventType&&$(e.element).attr("contenteditable","false"),e.result(),!1}))):!1},sortByIds:function(e){var t={containment:null,items:"li",ids:null};e=e?$.extend({},t,e):t,e.containment&&e.ids&&_.each(e.ids,function(t){if($(e.containment).children(e.items+'[id="'+t+'"]').length>0){var i=$(e.containment).children(e.items+'[id="'+t+'"]').detach();$(e.containment).append(i)}})},sortTreeByIds:function(e,t){var i={containment:null,items:"li",ids:null,childrenKey:"children",wrap:"ul",wrapClass:null};e=e?$.extend({},i,e):i,e.containment&&e.ids&&(e.root=t||e.containment,_.each(e.ids,function(i){if($(e.root).find(e.items+'[id="'+i.id+'"]').length>0){var n=$(e.root).find(e.items+'[id="'+i.id+'"]').detach();$(e.containment).is(e.wrap)||$(e.containment).children(e.wrap).length||($(e.containment).append(document.createElement(e.wrap)),e.containment=$(e.containment).children(e.wrap)),e.wrapClass&&$(e.containment).addClass(e.wrapClass),$(e.containment).append(n)}i[e.childrenKey]&&_g.ui.sortTreeByIds({containment:$(e.containment).find(e.items+'[id="'+i.id+'"]'),items:e.items,ids:i[e.childrenKey],childrenKey:e.childrenKey,wrapClass:e.wrapClass},t?t:e.containment)}))},findById:function(e){var t={containment:null,id:null};return e=e?$.extend({},t,e):t,e.containment&&e.id?$(e.containment).find('[id="'+e.id+'"],[data-id="'+e.id+'"]').first():[]},moveTo:function(e){var t={containment:null,sourceId:null,targetId:null,wrap:null,wrapClass:null,position:0};if(e=e?$.extend({},t,e):t,!e.containment)return!1;var i=_g.ui.findById({containment:e.containment,id:e.sourceId}),n=_g.ui.findById({containment:e.containment,id:e.targetId});e.wrap&&(0==n.has(e.wrap).length?(n.append(document.createElement(e.wrap)),n=n.children(e.wrap),e.wrapClass&&n.addClass(e.wrapClass)):n=n.children(e.wrap));var a=i.detach();0==e.position?n.prepend(a):n.append(a)},getTreeIds:function(e){var t={containment:null,items:null,idAttribute:"id",wrap:"ul"};e=e?$.extend({},t,e):t;var i=[];if(!e.containment||!e.items)return!1;if(e.wrap)if($(e.containment).is(e.wrap));else{if(!($(e.containment).children("ul").length>0))return[];e.containment=$(e.containment).children("ul")}return $(e.containment).children(e.items).each(function(){var t={};t.id=$(this).attr(e.idAttribute),t.children=_g.ui.getTreeIds({containment:$(this),items:e.items,idAttribute:e.idAttribute,wrap:e.wrap}),i.push(t)}),i},dialog:function(e){},createDomMask:function(e){var t={containment:null,item:null,x:null,y:null,height:null,width:null,moveTo:function(t){e.offsetX=0-t.x,e.offsetY=0-t.y,$(e.item).css("left",e.offsetX),$(e.item).css("top",e.offsetY)},resize:function(t){$(e.containment).width(t.w),$(e.containment).height(t.h)}};return e=e?$.extend({},t,e):t,e.containment&&e.item?($(e.containment).css("overflow","hidden"),e.moveTo({x:e.x,y:e.y}),e.resize({w:e.width,h:e.height}),e):!1},clearSelection:function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var e=window.getSelection();e.removeAllRanges()}},isOverflowed:function(e){var t={x:!1,y:!1},i=0;return $.zoom&&1!=$.zoom&&(i=2),$(e)[0].offsetHeight+i<$(e)[0].scrollHeight&&(t.y=$(e)[0].scrollHeight||1),$(e)[0].offsetWidth+i<$(e)[0].scrollWidth&&(t.x=$(e)[0].scrollWidth||1),t}};"undefined"==typeof require?(window._g||(window._g={}),window._g.ui=e):define("_g/ui",["jquery","_g/base","_g/error"],function(){return window._g.ui=e,window._g.ui})}(window),function(){var e={get passiveFalse(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(i){}var n=e?{passive:!1}:!1;return Object.defineProperty(this,"passiveFalse",{value:n}),n},getValueByType:function(e,t){switch(t=t?t.toLowerCase():t){case"number":return Number(e);case"boolean":return"false"==e?!1:"true"==e?!0:Boolean(e);case"numberboolean":return"false"==e?0:"true"==e?1:Boolean(e)?1:0;case"string":return String(e);case"object":return _g.object.jsonparse(e);default:return e}},bindPopOver:function(e){var t={containment:null,trigger:"click",getData:null,callback:null,onChange:null};return e=e?$.extend(!0,{},t,e):t,e.containment?void $(e.containment).find(".c-popover-btn").on(e.trigger,function(){var t=$(this).data();if(e.getData){var i=require("text!"+t.template),n=e.getData(this);t.content=_g.renderT(i,n,"data","text!"+t.template)}t.container=t.container?$(t.container):$(this).closest(".c-popover-containment")[0],t.container||(t.container="body"),t.viewport={selector:$(this).closest(".c-popover-viewport")[0],padding:t.padding||0},t.viewport.selector||(t.viewport.selector="body"),t.elm=$(this),t.callback=e.callback,t.beforeClose=e.beforeClose,t.onChange=e.onChange,t.onShow=e.onShow,t.onClose=e.onClose,t.getContent=function(){var t=e.getData(this);return _g.renderT(i,t,"data")};_g.form.popover(t);return!1}):!1},bindListAction:function(e){var t={containment:null,listClass:".c-list",callback:null};if(e=e?$.extend(!0,{},t,e):t,!e.containment)return!1;if(!e.containment.hasClass(e.listClass)&&!e.containment.find(e.listClass).length)return!1;var i=e.containment.hasClass(e.listClass)?e.containment.data():e.containment.find(e.listClass).first().data();e.containment.find(".c-list-add").on("click",function(t){if(e.callback){var n=_g.util.serializeValue({containment:e.containment});e.callback("add",i.target,n,t.currentTarget)}return!1}),e.containment.find(".c-list-remove").on("click",function(t){return e.callback&&callback("remove",i.target,t.currentTarget),!1})},bindFormChange:function(e){var t={containment:null,$item:null,callback:null,silentDisplay:!1};if(e=e?$.extend(!0,{},t,e):t,!e.containment)return!1;$(e.containment).find(".slider").each(function(){var t=$(this).find("input"),i=t.data();if(i.target){var n=$(e.containment).find('[name="'+i.target+'"]');n.on("change",function(){var e=t.slider("getValue");e!=Number($(this).val())&&t.slider("setValue",Number($(this).val()))}),t.on("slide",function(e){var t=Number(n.val());t!=e.value&&(n.closest(".spinner").spinner("value",e.value),n.trigger("change"))})}}),$(e.containment).find("[rel=form]").each(function(){var t=$(this).data();if(void 0!=t.value)if($(this).find("[data-value]").removeClass("active"),t.mutiple||t.multiple){var n=t.value.split(",");for(i=0;i<n.length;i++)$(this).find('[data-value="'+n[i]+'"]').addClass("active")}else $(this).find('[data-value="'+t.value+'"]').addClass("active");var a=$(this);$(this).find("[data-value]").on("click",function(){var i=!1,n=$(this).data("value");if(t.silentdisplay||a.find("[data-show]").text($(this).text()||n),t.multiple||t.mutiple){$(this).hasClass("active")?$(this).removeClass("active"):t.silentdisplay||$(this).addClass("active");var r=[];a.find("[data-value]").each(function(){var e=$(this).data("value");$(this).hasClass("active")&&r.push(_g.util.getValueByType(e,t.type))}),r=r.join(","),console.log(r),a.data("value",r),t.value=r,i=!0}else $(this).hasClass("active")||(n=_g.util.getValueByType(n,t.type),
a.data("value",n),$(this).addClass("active"),$(this).siblings().length?$(this).siblings().removeClass("active"):$(this).parent().siblings().children().removeClass("active"),t.value=n,i=!0);e.callback&&i&&e.callback(a,e,t)})});var n=e.$item?e.$item:"input,textarea,select";$(e.containment).find(n).on("change",function(){var t=$(this).data();t.name=$(this).attr("name")||$(this).attr("id"),e.callback&&e.callback($(this),e,t)}),e.createIndex&&_g.util.createFormIndex({containment:e.containment})},serializeValue:function(e){var t={containment:null,typeAttr:"data-type",attrAttr:"data-attr",allowEmpty:!0};if(e=e?$.extend({},t,e):t,!e.containment)return!1;var i=e.containment,n={},a=function(t,i){if("disabled"!=t.attr("disabled")){var a=t.attr("name")||t.attr("id"),r=(t.attr(e.typeAttr),t.attr(e.attrAttr));a&&(r?("object"!=typeof n[r]&&(n[r]={}),n[r][a]=i):n[a]=i)}},r=function(e,t){if("disabled"!=e.attr("disabled")){var i=e.data(),a=i.name,r=(i.type,i.attr);a&&(r?("object"!=typeof n[r]&&(n[r]={}),n[r][a]=t):n[a]=t)}};return $(i).find('input[type="text"],input[type="email"],input[type="tel"],input[type="hidden"],textarea').each(function(){var t=($(this).attr("name")||$(this).attr("id"),$(this).attr(e.typeAttr)),i=($(this).attr(e.attrAttr),_g.util.getValueByType($(this).val(),t));a($(this),i)}),$(i).find('input[type="checkbox"]').each(function(){var t=$(this).attr("name")||$(this).attr("id"),i=$(this).attr(e.typeAttr),r=$(this).attr(e.attrAttr);r&&"object"!=typeof n[r]&&(n[r]={});var o=r?n[r][t]?n[r][t]:[]:n[t]?n[t]:[];"checked"==$(this).attr("checked")?"boolean"==i||"numberboolean"==i?o=_g.util.getValueByType($(this).attr("data-reverse")?!1:!0,i):o.push(_g.util.getValueByType($(this).val(),i)):("boolean"==i||"numberboolean"==i)&&(o=_g.util.getValueByType($(this).attr("data-reverse")?!0:!1,i)),a($(this),o)}),$(i).find('input[type="radio"]:checked').each(function(){var t=($(this).attr("name")||$(this).attr("id"),$(this).attr(e.typeAttr)),i=($(this).attr(e.attrAttr),_g.util.getValueByType($(this).val(),t));a($(this),i)}),$(i).find("select").each(function(){var t,i=$(this).attr("name")||$(this).attr("id"),r=$(this).attr(e.typeAttr),o=$(this).attr(e.attrAttr),s=Boolean($(this).attr("data-mutiple"));s?(o&&"object"!=typeof n[o]&&(n[o]={}),t=o?n[o][i]?n[o][i]:[]:n[i]?n[i]:[],t.push($(this).val())):t=_g.util.getValueByType($(this).val(),r),a($(this),t)}),$(i).find("[rel=form]").each(function(){var e=$(this).data();if(e.mutiple||e.multiple)if(void 0!=e.value)var t=e.value;else var t="";else var t=_g.util.getValueByType(e.value,e.type);r($(this),t)}),n},createFormIndex:function(e){var t={containment:null,typeAttr:"data-type",attrAttr:"data-attr"};if(e=e?$.extend({},t,e):t,!e.containment)return!1;var i=e.containment;if(!$(i).data().formindex&&!e.force){var n={},a=function(e,t,i,a,r){t&&(e?(n[e]||(n[e]={}),n[e][t]?"radio"==r||"checkbox"==r&&"boolean"!=a?n[e][t].els.push(i):n[e][t].el=i:n[e][t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type}):n[t]?"radio"==r||"checkbox"==r&&"boolean"!=a?n[t].els.push(i):n[t].el=i:n[t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type})},r=function(e,t,i,a,r){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].el=i:n[e][t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type,rel:!0,multiple:r}):n[t]?n[t].el=i:n[t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type,rel:!0,multiple:r})},o=function(e,t,i){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].slider=i:n[e][t]={slider:i}):n[t]?n[t].slider=i:n[t]={slider:i})},s=function(e,t,i){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].colorpicker=i:n[e][t]={colorpicker:i}):n[t]?n[t].colorpicker=i:n[t]={colorpicker:i})},l=function(e,t,i){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].spinner=i:n[e][t]={spinner:i}):n[t]?n[t].spinner=i:n[t]={spinner:i})};$(i).find("input,textarea,select").each(function(){var t=$(this).attr("name")||$(this).attr("id"),i=$(this).attr(e.typeAttr),n=$(this).attr(e.attrAttr);a(n,t,$(this),i,this.type)}),$(i).find("[rel=form]").each(function(){var e=$(this).data();r(e.attr,e.name,$(this),e.type,e.multiple||e.mutiple)}),$(i).find(".slider").each(function(){var t=$(this).find("input"),i=t.data();if(i.target){var n=i.target,a=$(e.containment).find('[name="'+i.target+'"]');o(a.attr("data-attr"),n,$(this).find("input"))}}),$(i).find(".c_color_el").each(function(){var e=$(this).data();if(e.colorpicker){var t=$(this).find("input");s(t.attr("data-attr"),t.attr("name"),e.colorpicker)}}),$(i).find(".spinner").each(function(){var e=$(this).data();if(e.spinner){var t=$(this).find("input");l(t.attr("data-attr"),t.attr("name"),e.spinner)}}),$(i).data("formindex",n)}return n},renderFormInfo:function(e){if(!e.containment)return!1;var t=$(e.containment).data().formindex;if(t){e.keys||(e.keys=["value"]);for(var i=0;i<e.keys.length;i++)_.each(e[e.keys[i]],function(n,a){"value"==e.keys[i]?_.isObject(n)?t[a]&&_.each(n,function(e,i){t[a][i]&&(_g.util.setFormItemValue(t[a][i],e),t[a][i].slider&&t[a][i].slider.slider("setValue",e))}):t[a]&&(_g.util.setFormItemValue(t[a],n),t[a].slider&&t[a].slider.slider("setValue",n)):"name"==e.keys[i]&&(_.isObject(n)?t[a]&&_.each(n,function(e,i){t[a][i]&&_g.util.setFormItemName(t[a][i],e)}):t[a]&&_g.util.setFormItemName(t[a],n))})}},setFormItemValue:function(e,t){if(e||(e={}),e.colorpicker)return void e.colorpicker.setValue(t,{silent:!0});if(e.spinner)return void e.spinner.value(t);if(e.rel){if(e.multiple){e.el.find("[data-value]").removeClass("active");for(var i=0;i<t.length;i++)e.el.find('[data-value="'+t[i]+'"]').addClass("active")}else e.el.find('[data-value="'+t+'"]').addClass("active").siblings().removeClass("active"),e.el.find("[data-show]").html(e.el.find('[data-value="'+t+'"]').html());return void e.el.data("value",t)}if("number"==e.type&&(t=Number(t)),"INPUT"==e.tag)if("checkbox"==e._type)if("boolean"==e.type)t?e.el.attr("checked","checked"):e.el.removeAttr("checked");else for(var i=0;i<e.els.length;i++)_.include(t,"number"==e.type?Number(e.els[i].val()):e.els[i].val())?e.els[i].attr("checked","checked"):e.els[i].removeAttr("checked");else if("radio"==e._type)if("boolean"==e.type)t?e.el.attr("checked","checked"):e.el.removeAttr("checked");else for(var i=0;i<e.els.length;i++)t==("number"==e.type?Number(e.els[i].val()):e.els[i].val())?e.els[i].attr("checked","checked"):e.els[i].removeAttr("checked");else e.el.val(t);else"TEXTAREA"==e.tagName?e.el.html(t):e.el.val(t)},setFormItemName:function(e,t){if(e||(e={}),e.els.length>1)for(var i=0;i<e.els.length;i++)e.els[i].attr("name",t);else{if(e.rel)return e.el.attr("data-name",t),void e.el.data("name",t);e.el.attr("name",t)}},disableLink:function(e){var t={containment:null,linkitem:"a",enabled:!0},i=e.linkitem||t.linkitem;return e=e?$.extend(!0,{},t,e):t,e.linkitem=i,e.containment?(e.func=function(){return!1},e.enable=function(){$(e.containment).find(e.linkitem).each(function(){$(this).on("click",e.func),e.enabled=!0})},e.disable=function(){$(e.containment).find(e.linkitem).each(function(){$(this).off("click",e.func),e.enabled=!1})},e.enable(),e):!1},domExist:function(e,t){return t||(t=document),"string"==typeof e&&(e=$(e)),$.contains(t.documentElement,e[0])},getImageSizeBySrc:function(e,t,i){var n=new Image;n.onload=function(){if(i&&(this.width>i||this.height>i)){var e=this.width/this.height;e>1?(this.width=i,this.height=this.width/e):(this.height=i,this.width=this.height*e)}t&&t(this.width,this.height)},n.src=e},htmlspecialchars:function(e){function t(e,t,i){for(var n=e.length,a=0;n>a;a++)re=new RegExp(e[a],"ig"),i=i.replace(re,"string"==typeof t?t:t[a]?t[a]:t[0]);return i}return"string"!=typeof e?e:t(["&","<",">",'"',"&lt;br&gt;"],["&amp;","&lt;","&gt;","&quot;","<br>"],e)},toggleActive:function(e){$(e).css("-moz-transition","all 0.5s").css("-webkit-transition","all 0.5s").css("-ms-transition","all 0.5s").css("-o-transition","all 0.5s").css("transition","all 0.5s"),$(e).css("opacity","0.5").css("background-color","#f80"),setTimeout(function(){$(e).css("opacity","1").css("background-color","#fff")},500)}};"undefined"==typeof require?(window._g||(window._g={}),window._g.util=e,e=void 0):define("_g/util",["jquery","_g/base"],function(){return window._g.util=e,e=void 0,window._g.util})}(window),function(){var _g_mvc={saveHandle:function(e,t){200==e.code?t("success","成功"):t("error",e.msg)},_loadTemplate:function(e,t){},_CollectionforSaveAll:function(){var e=Backbone.Model.extend({initialize:function(){this.set("id","GlobalSave")},sync:function(e,t,i){var n=this.data;this.attributes=n,"create"!=e&&("update"==e&&(i.url=this.url),"delete"!=e&&"read"!=e&&(Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,i)))}});return new e},createModel:function(opts){var defaults={defaults:{},autoIndex:!0,autoUpdate:!0,autoRemove:!0,enableSync:!0,createUrl:null,updateUrl:null,removeUrl:null,fetchUrl:null,staticFetchUrl:null,staticRemoveUrl:null,staticCreateUrl:null,staticUpdateUrl:null,fetchUrlName:null,removeUrlName:null,createUrlName:null,updateUrlName:null,restful:!1,debug:!1,bindChange:null,bindRemove:null,callback:null,initView:null,patchKeys:null,initialize:function(){if(this.iViewlist=[],this.iCollectionlist=[],this.get("id"))this.preset();else if(this.set("isNew",!0),this.autoIndex){var prefix=this.get("type")||this.get("iType")||"M";this.set("id",prefix+"_"+_g.uuid(4)),this.preset()}else this.save({},{wait:!0,success:function(model,response){var returned=eval(response);("Success"==returned.Status||200==returned.code)&&model.set("id",returned.ID.toString()),model.preset()}})},patchSave:function(callback,opts){if(opts||(opts={}),this.patchKeys&&this.patchKeys.length){var values=_.pick(this.toJSON(),this.patchKeys);this.save(values,{wait:!0,silent:opts.silent,patch:!0,success:function(model,response){if(callback){var returned=eval(response);callback(returned)}},error:function(e,t){_g.error.serverError("save_"+e.name),opts.onError&&opts.onError()}})}else this.save()},sync:function(e,t,i){var n,a="undefined"!=typeof _gDebug&&_gDebug||this.debug;if(!this.enableSync)return!1;if("create"==e){var r=this.createUrlName||this.createUrl;if(_g.debug&&_g.debug.enabled&&(_g.debug.data[r]={}),n=a?_g.debug&&_g.debug.query_user_data(r)?_g.debug.query_user_data(r):this.staticCreateUrl||this.createUrl:this.createUrl,!n)return;i.url=n}if("update"==e||"patch"==e){var r=this.updateUrlName||this.updateUrl;if(_g.debug&&_g.debug.enabled&&(_g.debug.data[r]={}),n=a?_g.debug&&_g.debug.query_user_data(r)?_g.debug.query_user_data(r):this.staticUpdateUrl||this.updateUrl:this.updateUrl,!n)return;i.url=n}if("delete"==e){var r=this.removeUrlName||this.removeUrl;if(_g.debug&&_g.debug.enabled&&(_g.debug.data[r]={}),n=a?_g.debug&&_g.debug.query_user_data(r)?_g.debug.query_user_data(r):this.staticRemoveUrl||this.removeUrl:this.removeUrl,!n)return;i.url=n}if("read"==e){var r=this.fetchUrlName||this.fetchUrl;if(n=a?this.staticFetchUrl:this.fetchUrl,_g.debug&&_g.debug.enabled&&(_g.debug.data[r]={}),n=a?_g.debug&&_g.debug.query_user_data(r)?_g.debug.query_user_data(r):this.staticFetchUrl||this.fetchUrl:this.fetchUrl,!n)return;i.url=n}i.url="string"==typeof i.url?i.url:i.url(t.attributes),this.restful||(Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0),Backbone.sync(e,t,i)},addView:function(e,t){if("function"==typeof t&&(this[e]=new t({model:this})),"object"==typeof t){var i=_g.mvc.createView(t);this[e]=new i({model:this})}this[e]&&this.iViewlist.push(this[e])},addCollection:function(e,t){if("function"==typeof t&&(this[e]=new t),"object"==typeof view){var i=_g.mvc.createCollection(t);this[e]=new i}this[e]&&this.iCollectionlist.push(this[e])},preset:function(){this.callback&&this.callback(this);var e=this;this.autoUpdate&&this.on("change",function(){e.updateAllViews()}),this.autoRemove&&this.on("destroy",function(e,t,i){e.removeAllViews(),e.bindRemove&&e.bindRemove(e,i)}),this.bindChange&&this.bindChange(),this.initView&&this.addView("iview",this.initView)},updateAllViews:function(){_.each(this.iViewlist,function(e){e.$el&&e.update()})},removeView:function(e){this[e]&&(this[e].remove(),this.iViewlist=_.reject(this.iViewlist,function(t){return t==this[e]}),this[e]=null)},removeAllViews:function(e){_.each(this.iViewlist,function(t){t.$el&&(e?t.undelegateEvents():t.remove())})}};opts=opts?$.extend(!0,{},defaults,opts):defaults;var Model=Backbone.Model.extend(opts);return Model},createView:function(e){var t={template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!0,position:1,parseData:null,callback:null,bindChange:null,parseTemplate:null,templateKey:null,templateName:null,afterRender:null,afterUpdate:null,initialize:function(){_.bindAll(this),this.autoRender&&this.render(),this.callback&&this.callback(this)},createEl:function(){var e,t=this.model.toJSON();return this.parseData&&(t=this.parseData()),e=this.parseTemplate?this.parseTemplate(this.template):this.template,_g.renderT(e,t,this.templateKey,this.templateName)},render:function(e,t){if(!this.model||!this.template)return!1;if(!_g.util.domExist(this.$el)){if(!e&&!this.containment)return!1;e||(e=$(this.containment)),t||(t=this.position),this.wrap&&!$(this.containment).is(this.wrap)&&(0==$(this.containment).children(this.wrap).length&&$(this.containment).append(document.createElement(this.wrap)),e=$(this.containment).children(this.wrap),this.containment&&this.wrapClassName&&e.addClass(this.wrapClassName));var i=this.createEl(),n=i;return this.setElement(n),1==t?e.append(n):e.prepend(n),this.className&&this.$el.addClass(this.className),this.afterRender&&this.afterRender(this),this}var i=this.createEl(),n=i;this.undelegateEvents(),this.$el.replaceWith(n),this.setElement(n),this.afterUpdate&&this.afterUpdate(this)},update:function(){this.render()},afterUpdate:function(){this.afterRender&&this.afterRender(this)},events:{}};e=e?$.extend(!0,{},t,e):t;var i=Backbone.View.extend(e);return i},createCollection:function(e){var t={enableSync:!1,fetchUrl:null,staticFetchUrl:null,saveUrl:null,staticSaveUrl:null,debug:!1,bindRemove:!1,bindReset:!0,bindAdd:null,callback:null,patchKeys:null,name:null,initialize:function(){var e=this;this.bindRemove&&this.on("remove",function(t){"function"==typeof e.bindRemove?e.bindRemove(t):t.removeAllViews()}),this.bindReset&&this.on("reset",function(t,i){"function"==typeof e.bindReset?e.bindReset(t,i):_.each(i.previousModels,function(e){e.removeAllViews()}),e.afterReset&&e.afterReset(t,i)}),this.bindAdd&&this.on("add",function(t){e.bindAdd()}),this.callback&&this.callback(this)},sortByIds:function(e){var t=this;this.reset(_.map(e,function(e){return t.get(e)}),{silent:!0})},sync:function(e,t,i){var n="undefined"!=typeof _gDebug&&_gDebug||this.debug;if(!this.enableSync)return!1;if("read"==e){var a=n?this.staticFetchUrl?this.staticFetchUrl:this.fetchUrl:this.fetchUrl?this.fetchUrl:this.staticFetchUrl;if(!a)return;i.url=a}return i.url?(i.url="string"==typeof i.url?i.url:i.url(t.toJSON()),this.resetful||(Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0),void Backbone.sync(e,t,i)):!1},getAll:function(e){var t=this;this.fetch({success:function(t,i){e&&e(i)},error:function(){_g.error.serverError("get_"+t.name)}})},saveAll:function(e){var t=this,i="undefined"!=typeof _gDebug&&_gDebug||this.debug,n=i?this.staticSaveUrl?this.staticSaveUrl:this.saveUrl:this.saveUrl?this.saveUrl:this.staticSaveUrl;if(!n)return!1;var a=_g.mvc._CollectionforSaveAll();this.patchKeys&&this.patchKeys.length?a.data=_.map(this.toJSON(),function(e){var i=$.extend(!0,{},e);return i=_.pick(i,t.patchKeys)}):a.data=this.toJSON(),a.url=n,a.save({},{wait:!0,success:function(t,i){e&&e(i)},error:function(){_g.error.serverError("save_"+t.name)}})},refreshView:function(e){var t={containment:null,viewname:null};e=e?$.extend({},t,e):t,this.length>0&&(_.each(this.at(0).iViewlist,function(t){containment=e.containment||t.containment,containment&&(t.wrap&&!$(containment).is(t.wrap)?$(containment).children(t.wrap).empty():$(containment).empty())}),this.each(function(t){e.containment&&(t.iview.containment=e.containment),e.viewname?t[viewname].update():t.iview.update()}))},removeAllViews:function(e){this.each(function(t){t.removeAllViews(e)})}};e=e?$.extend(!0,{},t,e):t;var i=Backbone.Collection.extend(e);return i},createTreeByData:function(e){var t,i={collection:null,data:null,treeLevel:0,parent:null},n=e.parent;if(e=e?$.extend(!0,{},i,e):i,e.parent=n,!e.collection||!e.data)return null;var a=$.extend(!0,[],e.data);if("function"==typeof e.collection)t=new e.collection;else{var r=_g.mvc.createCollection(e.collection);t=new r}return t.parent=n,t.refreshTreeView=function(e){this.refreshView(e),this.each(function(t){t.icollection.refreshTreeView({containment:t.iview.$el,viewname:e?e.viewname:null})})},t.getModels=function(){var e=_g.mvc.getTreeModels(t);return e},t.getModelsJSON=function(){var e=t.getModels();return e=_.map(e,function(e){return e.toJSON()})},t.getModel=function(e){return _g.mvc.getTreeModel(t,e)},t.on("add",function(i){i.treeLevel=e.treeLevel,i.icollection=_g.mvc.createTreeByData({collection:e.collection,data:[],treeLevel:e.treeLevel+1}),t.parent&&(t.View="object"==typeof t.View?$.extend(!0,{},t.View,{containment:t.parent.iview.$el}):t.View.extend({containment:t.parent.iview.$el})),i.addView("iview",t.View),_g.ui.sortByIds({containment:i.iview.wrap?i.iview.$el.parent(i.iview.wrap):i.iview.$el.parent(),ids:t.pluck("id")}),i.icollection.parent=i,i.icollection.View=t.View}),t.saveAll=function(e){var t="undefined"!=typeof _gDebug&&_gDebug||this.debug,i=t&&this.staticSaveUrl?this.staticSaveUrl:this.saveUrl;if(!i)return!1;var n=_g.mvc._CollectionforSaveAll();n.data=_g.mvc.getTreeData(this),n.url=i,n.save({},{wait:!0,success:function(t,i){e&&e(i)},error:function(){}})},_.each(a,function(i){var n;n=i.children?$.extend(!0,[],i.children):[],delete i.children,t.add(i,{silent:!0});var a=t.at(t.length-1);a.treeLevel=e.treeLevel,console.log(n),a.icollection=_g.mvc.createTreeByData({collection:e.collection,data:n,treeLevel:e.treeLevel+1,parent:a})}),t},createTreeView:function(e){var t={collection:null,view:null,containment:null,wrap:null,wrapClassName:null,template:null,className:null,parseTemplate:null,templateKey:null,templateName:null,update:function(e){if(!this.model||!this.template||!this.containment)return!1;if(_g.util.domExist(this.$el)){var t=this.createEl(),i=null;this.wrap&&(i=this.$el.children(this.wrap).detach()),this.undelegateEvents(),this.$el.replaceWith(t),this.setElement(t)}else this.render();this.afterUpdate&&this.afterUpdate(this)}},i=e.collection;e=e?$.extend(!0,{},t,e):t;var n={};if(e.collection=i,!e.collection||!e.view)return!1;e.containment&&(n.containment=e.containment),e.wrap&&(n.wrap=e.wrap),e.template&&(n.template=e.template),e.templateKey&&(n.templateKey=e.templateKey),e.templateName&&(n.templateName=e.templateName),e.parseTemplate&&(n.parseTemplate=e.parseTemplate),e.parseData&&(n.parseData=e.parseData),e.callback&&(n.callback=e.callback),e.wrapClassName&&(n.wrapClassName=e.wrapClassName),e.className&&(n.className=e.className),n.update=e.update;var a="function"==typeof e.view?e.view.extend(n):$.extend(!0,e.view,n);e.collection.View=a,e.collection.each(function(t){if(t.addView("iview",a),t.icollection){if(e.useJquerySel){var i=e.containment.children('[id="'+t.id+'"]');if(e.wrap)if(i.children(e.wrap+e.wrapClassName?"."+e.wrapClassName:"").length)i=i.children(e.wrap+e.wrapClassName?"."+e.wrapClassName:"");else{var n=$(document.createElement(e.wrap));i.append(n),e.wrapClassName&&n.addClass(e.wrapClassName),i=n}}else{"string"!=typeof e.containment&&(e.containment=e.containment.selector);var i=e.containment+(e.wrap?" >"+e.wrap:"")+' >[id="'+t.id+'"]'}_g.mvc.createTreeView({collection:t.icollection,view:e.view,wrapClassName:e.wrapClassName,containment:i,wrap:e.wrap||null,template:e.template||null,useJquerySel:e.useJquerySel})}})},sortTreeByIds:function(e){var t=function(i,n,r){return i?(i.reset([],{silent:e.silent}),_.each(n,function(n){n.children=n.children||[];var o=a.get(n.id);o.treeLevel=r,o.icollection=t(o.icollection,n.children,r+1),i.add(o,{silent:e.silent}),o.collection=i}),i):null},i={collection:null,ids:null,treeLevel:0,silent:!0},n=e.collection;if(e=e?$.extend(!0,{},i,e):i,e.collection=n,!e.collection||!e.ids)return!1;var a=new Backbone.Collection;a.add(_g.mvc.getTreeModels(e.collection));var r=t(e.collection,e.ids,e.treeLevel);return r},getTreeModels:function(e){var t=[];return e.each(function(e){if(t.push(e),e.icollection)for(var i=_g.mvc.getTreeModels(e.icollection),n=0;n<i.length;n++)t.push(i[n])}),t},getTreeModel:function(e,t){if(!e||!t)return!1;var i=_g.mvc.getTreeModels(e);return _.find(i,function(e){return e.id==t})},getTreeData:function(e,t){var i=[];return e.each(function(e){var n=$.extend(!0,{},e.toJSON());t&&t.filter&&(n=_.pick(n,t.filter)),e.icollection&&(n.children=_g.mvc.getTreeData(e.icollection,t)),i.push(n)}),i},moveTo:function(e){void 0==e.silent&&(e.silent=!0);var t=null;if(void 0!=e.fromIndex&&void 0!=e.toIndex)t=e.collection.at(e.fromIndex),e.collection.remove(t,{silent:e.silent}),e.collection.add(t,{at:e.toIndex,silent:e.silent});else if(void 0!=e.sourceId&&void 0!=e.targetId&&void 0!=e.position){t=e.collection.get(e.sourceId),e.collection.remove(t,{silent:e.silent});var i=e.collection.get(e.targetId),n=e.collection.indexOf(i);if(-1==e.position)var a=n;else var a=n+1;e.collection.add(t,{at:a,silent:e.silent})}}};"undefined"==typeof require?(window._g||(window._g={}),window._g.mvc=_g_mvc,_g_mvc=void 0):define("_g/mvc",["jquery","backbone","_g/base","_g/ui","_g/util"],function(){return window._g.mvc=_g_mvc,_g_mvc=void 0,window._g.mvc})}(window),define("text!interaction_view/template/page.tpl",[],function(){return'<section class="Presentation" id="<%=id%>">\n    <div class="interaction-area typo">\n      <div class="interaction-view"></div>\n   </div>\n</section>'}),define("text!interaction_view/template/pagegroup.tpl",[],function(){return'<section class="group" id="<%=id%>"></section>'}),define("interaction_view/view/page",["_g/mvc","text!interaction_view/template/page.tpl","text!interaction_view/template/pagegroup.tpl"],function(){var e={template:require("text!interaction_view/template/page.tpl"),className:null,containment:"div.slides",wrap:null,wrapClassName:null,autoRender:!0,position:1,parseData:null,callback:function(){"page_group"!=this.model.get("type")&&(this.overlays=this.model.get("overlays"),this.animations=this.model.get("animations"),this.actions=this.model.get("actions")),("page"==this.model.get("type")||"config"==this.model.get("type"))&&this.renderbg()},bindChange:null,parseTemplate:function(){var e=this.model.get("type");return"page_group"==e?_g.parseTemplate(require("text!interaction_view/template/pagegroup.tpl")):_g.parseTemplate(require("text!interaction_view/template/page.tpl"))},render:function(e,t){if(!this.model||!this.template)return!1;if(!$.contains(document.documentElement,this.$el[0])){if(interaction_view.foredit){if(!e&&!this.containment)return!1;e||(e=$(this.containment)),t||(t=this.position),this.wrap&&!$(this.containment).is(this.wrap)&&(0==$(this.containment).children(this.wrap).length&&$(this.containment).append(document.createElement(this.wrap)),e=$(this.containment).children(this.wrap),this.containment&&this.wrapClassName&&e.addClass(this.wrapClassName))}var i,n;return $(".reveal section#"+this.model.id).length>0?(i=$(".reveal section#"+this.model.id)[0],n=i,this.setElement(n)):interaction_view.foredit&&(i=this.createEl(),n=i,this.setElement(n),1==t?e.append(n):e.prepend(n)),this.model.attributes.is_flow&&(this.$el.addClass("page_flowed"),this.model.is_flow=!0),this.afterRender&&this.afterRender(this),this}var i=this.createEl(),n=i;this.$el.replaceWith(n),this.setElement(n),this.afterUpdate&&this.afterUpdate(this)},renderbg:function(){var e=this.$el;if(2==interaction_view.screen_mode&&(e=this.$el.children()),this.model.get("picture")&&e.css({"background-image":"url("+this.model.get("picture")+")","background-size":"contain","background-position":"center center","background-repeat":"no-repeat"}),interaction_view.forpreview){var t=this.model.get("bg_color"),i=this.model.get("bg_opacity"),n=-1==t.indexOf("rgba")?_g.getRGBA(t,i):t;this.$el.css({"background-color":n})}},prepareLoad:function(){for(var e=this,t=[],i=0;i<e.animations.length;i++){var n=$.extend(!0,{},e.animations[i]);n.pageid=e.model.id,e.isMaster&&(n.pagetype="master"),e.isBackground&&(n.pagetype="background"),e.isConfig&&(n.pagetype="config"),t.push(n)}e.model.iAnimationlist.reset(t);for(var a=[],i=0;i<e.overlays.length;i++){var n=$.extend(!0,{},e.overlays[i]);interaction_view.model[n.iType]&&(n.pageid=e.model.id,n.zIndex=i,e.isMaster?(n.pagetype="master","Audio"==n.iType&&n.iDetail.iAutoplay&&!interaction_view.hasbgsound&&(interaction_view.hasbgsound=!0,n.isBgsound=!0)):e.isConfig&&(n.pagetype="config"),a.push(new interaction_view.model[n.iType](n)))}e.model.iOverlaylist.reset(a),e.model.iOverlaylist.each(function(e){e.iview.setZindex()});for(var r=[],i=0;i<e.actions.length;i++){var n=$.extend(!0,{},e.actions[i]);n.pageid=e.model.id,e.isMaster&&(n.pagetype="master"),e.isConfig&&(n.pagetype="config"),r.push(n)}e.model.iActionlist.reset(r)},startLoad:function(){0==this.model.ipreloadlist.length?interaction_view.finishPagePreload(this.model.id,this.model):this.model.ipreloadlist.preload()},afterpreload:function(){var e=this;e.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),e.hasRenderActionlist?e.model.iActionlist.each(function(e){e.iview&&(_.include([0,1,2,4,6,7,14,15,20,21,99],e.get("iType"))?e.iview.render({init:!1}):3==e.get("iType")&&interaction_view.isWeixin&&52==e.get("iDetail").results[0].iAction&&e.iview.patchPlay($(document),e.iview))}):(e.hasRenderActionlist={},e.model.iActionlist.each(function(e){e.iview&&e.iview.render({init:!0})}))},clearPageLoad:function(){if(this.model.isRedirect)return void presentation.pageClearCenter(this.model.id);if(this.model.get("loaded")){var e=this.$el.find(".interaction-view");e.empty(),this.model.iAnimationlist&&this.model.iAnimationlist.timeline&&this.model.iAnimationlist.timeline.kill(),this.model.isStartLoad=!1,this.model.playFinished=!1,this.ipreloadlist=new interaction_view.collection.Preload,interaction_view.events.clearRelatedEvents(this.model.id),this.model.unset("loaded",{silent:!0}),this.model.iview.$el.hasClass("dragConnector")&&connector.removeDragController(this.model.iview.$el),this.model.firstPlayFinished=!0}presentation.pageClearCenter(this.model.id)}};return e}),define("interaction_view/view/subcontainer",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,afterload:function(){var e=this;overlays=_.filter(e.model.suboverlays,function(t){return t.path=e.model.iOverlaylist.path,t.isSubOverlay=!0,interaction_view.model[t.iType]}),overlays=_.map(overlays,function(e){return new interaction_view.model[e.iType](e)}),e.model.iOverlaylist.reset(overlays),e.startSubLoad()},startSubLoad:function(){var e=this;0==e.model.ipreloadlist.length?e.model.iview.afterSubOverlayPreload():e.model.ipreloadlist.preload()}});return t});var _eT={RichText:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iText nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow-y:hidden;padding:0;margin:0;">',"<% if(iDetail.iStaticImage&&iDetail.iImg&&iDetail.iImg[0]){%>",'<img class="el_wrap" src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:auto;"/>',"<% }else{%>",'<div class="el_wrap" style="position:absolute;width:100%;height:100%;<%=iDetail.iStyle%>"><%=iDetail.iText%></div>',"<% } %>","</div>","</div>"].join(""),Paragraph:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iParagraph Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;padding:0;margin:0;line-height:1.5;">',"<% if(iDetail.iStaticImage&&iDetail.iImg&&iDetail.iImg[0]){%>",'<div class="paragraph nanoscrollbar el_wrap" style="position:absolute;left:0; top: 0 ;background-color:transparent;width:100%;height:100%;padding:0;margin:0;overflow:hidden;">','<img src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:auto;"/>',"</div>","<% }else{%>",'<div class="paragraph nanoscrollbar el_wrap" style="position:absolute;left:0; top: 0 ;background-color:transparent;width:100%;height:100%;padding:0;margin:0;overflow:hidden;<%=iDetail.iStyle||""%>">','<div style="text-align:inherit;width:100%;height:100%;font-size: inherit;color: inherit;font-family: inherit;font-weight:inherit;" class="iText"><%=iDetail.iText%></div>',"</div>","<% } %>","</div>","</div>"].join(""),TextLabel:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTextLabel nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow-y:hidden;<%=iDetail.iStyle%>">',"<% if(iDetail.iStaticImage&&iDetail.iImg&&iDetail.iImg[0]){%>",'<img src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:auto;"/>',"<% }else{%>",'<div style="position:absolute;width:100%;height:100%;<%=iDetail.iStyle%>"><%=iDetail.iText%></div>',"<% } %>","</div>","</div>"].join(""),Image:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iImage Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iMask?"overflow:hidden;":""%>">',"<%if(iDetail.iImg&&iDetail.iImg[0]){%>","<% if(iDetail.iMask){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else if(iDetail.iEraser||iDetail.iEditable||iDetail.iQrcode){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context iScrollPrevent" style="width:100%;height:100%;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else{%>",'<div class="image_wrap el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;background-image:url(<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>);<%=iDetail.iStyle%>">',"<% } %>","<%}%>","</div>","</div>"].join(""),ImageBlock:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iImageBlock Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">',"<%if(iDetail.iImg&&iDetail.iImg[0]){%>","<% if(iDetail.iMask){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else if(iDetail.iImgMask){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:100%;height:100%;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else if(iDetail.iEraser||iDetail.iEditable||iDetail.iQrcode){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context iScrollPrevent" style="width:100%;height:100%;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else{%>",'<div class="image_wrap el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;background-image:url(<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>);<%=iDetail.iStyle%>">',"<% } %>","<%}%>","</div>","</div>"].join(""),
Link:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iLink Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>"></div>',"</div>"].join(""),SearchInput:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iSearchInput Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">','<form class="search" style="position:relative; cursor:default;">','<input type="text" autofocus placeholder="输入关键字" class="input-medium search-query" style="cursor:default; width:<%=iCommon[iPageDirection].iWidth-14%>px; height:<%=iCommon[iPageDirection].iHeight-2%>px; line-height:<%=iCommon[iPageDirection].iHeight-2%>px; border-radius:8px; border-color:<%=iDetail.border_color%>; color:<%=iDetail.text_color%>; background-color:transparent;">','<button class="btn" type="submit" style="cursor:default; position:absolute; top:0; right:0; display:block; width:30px; height:<%=iCommon[iPageDirection].iHeight-2%>px; line-height:30px; background:none; border:none; margin:0 0 0 -30px; padding:0; text-shadow:none; color:#ccc;">','<i class="icon-search"></i>',"</button>","</form>","</div>","</div>"].join(""),Input:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iInput Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<input type="<%=iDetail.iKind%>"  value="<%=iDetail.initial%>"  <% if(iDetail.required == "on"){ %> required <%}%>   placeholder="<%=iDetail.placeholder%>" class="input-medium search-query c-input" style=" width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px; line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>"> ',"</div>","</div>"].join(""),Textarea:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTextarea Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<textarea class="<%if(!interaction_view.ismobile){%>noScroll<%}%>" <% if(iDetail.required == "on"){ %> required <%}%>  placeholder="<%=iDetail.placeholder%>"   style="cursor:default; width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>"><%=iDetail.initial%></textarea>	 ',"</div>","</div>"].join(""),Select:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iInput Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<select class="input-medium search-query c-select" style="cursor:default; width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px; line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">			',"<option></option>","</select>","</div>","</div>"].join(""),SelectBox:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iSelectBox Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<input type="<%=iDetail.type%>" class="input-medium search-query" style="','vertical-align:"middle";','padding:0px;margin:0;" id="<%=id+pageid+"box"%>"> <label for="<%=id+pageid+"box"%>" ><span style="display:inline;<%=iDetail.iStyle%>"><%=iDetail.label%></span></label>',"</div>","</div>"].join(""),Tree:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTree Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">		 ',"</div>","</div>"].join(""),Grid:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iGrid Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Gallery:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iGallery Element nanoscrollbar" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),PageIndex:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iPageIndex Element nanoscrollbar" style="overflow:hidden;position:absolute;left: -<%=parseInt(iCommon[iPageDirection].iWidth/2,10)-0.5%>px; top: -<%=parseInt(iCommon[iPageDirection].iHeight/2,10)-0.5%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Cell:['<div class="iView static hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="position:absolute; left: <%=iCommon[iPageDirection].iStartx%>px; top: <%=iCommon[iPageDirection].iStarty%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iCell Element" style="overflow:hidden;position:absolute;left: 0px; top:0px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">',"		</div>","</div>"].join(""),TabBar:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTabBar Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),WebContent:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="i<%=iType%> nanoscrollbar Element iMouseWheel disableMouseWheelY disableMouseWheelX disableDragX disableDragY" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;-webkit-overflow-scrolling:touch;overflow:auto;<%=iDetail.iStyle%>">','<iframe style="position:absolute;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;min-height:<%=iCommon[iPageDirection].iHeight%>px;height:100%;border:none;overflow:visible;"></iframe>',"</div>","</div>"].join(""),Slide:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iSlide Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="slidecontent overflowhidden" style="position:absolute;width:100%;height:100%;line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%if(iDetail.iImg){%>","<%_.each(iDetail.iImg,function(i,index){%>",'<%if(_g.getUrlParameterByName("-playmode")=="1"){%>','<img data-index="<%=index%>" id="<%=preload_id[index]%>" class="Context" style="width:100%;height:100%;position:absolute;margin:auto;display:inline;verticle-align:middle;">',"<%}else{ %>",'<img data-index="<%=index%>" id="<%=preload_id[index]%>" class="Context" style="width:100%;height:100%;position:absolute;margin:auto;display:inline;verticle-align:middle;">',"<%}%>","<%})%>","<%}%>","</div>","</div>","</div>"].join(""),CycleImage:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iCycleImage Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="slidecontent overflowhidden" style="position:absolute;width:100%;height:100%;line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>","</div>"].join(""),Video:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iVideo Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Audio:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iAudio Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Button:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iButton Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">',"<%if(iDetail.iconNormal&&iDetail.iconNormal[0]){%>",'<img class="Context iconNormal" id="<%=preload_id[0]%>" style="width:100%;height:100%;position:absolute;">',"<%}%>","<%if(iDetail.iconActive&&iDetail.iconActive[0]){%>",'<img class="Context iconActive" id="<%=preload_id[1]%>" style="width:100%;height:100%;position:absolute;display:none;">',"<%}%>","</div>","</div>","</div>"].join(""),Map:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iMap nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">','<iframe style="width: 100%; height: 100%;" src="<%=interaction_view.getMapUrl(iDetail.iText) + "&view=view"%>" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>',"</div>","</div>"].join(""),LayerRef:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iLayerRef Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="layer-mask" style="position:absolute;width:100%;height:100%;overflow:hidden;<%=iDetail.iStyle%>">',"<%if(iDetail.layer_ids&&iDetail.layer_ids.length>0){%>",'<div class="layer-content" style="position:absolute;width:100%;height:100%;">',"<% _.each(iDetail.layer_ids,function(layerid){ %>","<% if(interaction_view.ilayerlist.get(layerid)){ %>",'<div class="layer-item" data-index="<%=iDetail.layer_ids.indexOf(layerid)%>" data-id="<%=layerid%>" style="position:absolute;opacity:0;width:<%=interaction_view.ilayerlist.get(layerid).toJSON().layer_width%>px;height:<%=interaction_view.ilayerlist.get(layerid).toJSON().layer_height%>px;left:0px;right:0px;">','<div href="" class="layer-bg" style="position:absolute;width:100%;height:100%;text-align:center;line-height:<%=interaction_view.ilayerlist.get(layerid).toJSON().layer_height%>px;background-color:<%=interaction_view.ilayerlist.get(layerid).toJSON().bg_color%>;opacity:<%=interaction_view.ilayerlist.get(layerid).toJSON().bg_opacity%>">','<% if(interaction_view.ilayerlist.get(layerid).get("picture")){ %>','<img src="<%=interaction_view.ilayerlist.get(layerid).get("picture")%>" style="<%=(interaction_view.ilayerlist.get(layerid).toJSON().layer_width>=interaction_view.ilayerlist.get(layerid).toJSON().layer_height)?"width:auto;height:100%;":"width:100%;height:auto;"%>margin:auto">',"<% } %>","</div>","</div>","<% } %>","<% }) %>","</div>","<% } %>","</div>  ","</div>	","</div>"].join(""),ComponentRef:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iLayerRef Element" style="position:absolute;left: 0px; top: 0px;background-color:transparent;width:100%;height:100%;">',"<%if(iDetail.layer_ids&&iDetail.layer_ids.length>0){%>",'<div class="layer-content" style="position:absolute;width:100%;height:100%;">',"<% _.each(iDetail.layer_ids,function(layerid){ %>","<% if(interaction_view.iComponentlist.get(layerid)){ %>","<% var _layer=interaction_view.iComponentlist.get(layerid).toJSON(); %>",'<div class="layer-item" data-index="<%=iDetail.layer_ids.indexOf(layerid)%>" data-id="<%=layerid%>" style="position:absolute;opacity:0;width:100%;height:100%;left:0px;right:0px;">',"</div>","<% } %>","<% }) %>","</div>","<% } %>","</div>","</div>"].join(""),Shape:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<% if (_g.device.svg()){%><div class="iShape nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;<%=iDetail.iStyle%>">',"<%=iDetail.iSvg%>","</div>","</div><% }else{ %>",'<div class="iImage Element" style="position:absolute;left: <%=-iCommon[iPageDirection].iWidth/2%>px; top: <%=-iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:100%;height:100%;position:absolute;" src="<%=iDetail.iImg[0].picture%>">  ',"</div><% } %>","</div>"].join(""),DragDrop:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iDragDrop Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">',"<%if(iDetail.iconNormal&&iDetail.iconNormal[0]){%>",'<img class="Context iconNormal" id="<%=preload_id[0]%>" style="width:100%;height:100%;position:absolute;">',"<%}%>","<%if(iDetail.iconActive&&iDetail.iconActive[0]){%>",'<img class="Context iconActive" id="<%=preload_id[1]%>" style="width:100%;height:100%;position:absolute;display:none;">',"<%}%>","</div>","</div>","</div>"].join(""),Variable:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iVariable nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%=iDetail.initial%>","</div>","</div>"].join(""),Timer:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTimer nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%=iDetail.formatTime%>","</div>","</div>"].join(""),InfoList:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iInfoList Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="info-content iMouseWheel disableMouseWheelY disableDragY" style="min-width:100%;<%=iDetail.iStyle%>">','<div style="margin-top: -38px;height: 38px;color:#999;">','<div style="text-align: center; font-size: 12px;height:19px;">E<% if (typeof epub360!="undefined"&&epub360.settings&& ["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type) >=0 ){ %>Epub360技术支持<% } %></div>','<div class="pullDown" style="text-align: center;font-size: 12px;">下拉刷新</div>',"</div>",'<div class="lists"></div>','<div class="pullUp" style="display:none;text-align: center;font-size: 12px; color:#999;">上拉加载更多</div>',"</div>","</div>","</div>"].join(""),ChartList:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iChartList Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="info-content iMouseWheel disableMouseWheelY disableDragY" style="min-width:100%;<%=iDetail.iStyle%>">','<div style="margin-top: -38px;height: 38px;color:#999;">','<div style="text-align: center; font-size: 12px;height:19px;"><% if (typeof epub360!="undefined"&&epub360.settings&& ["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type) >=0 ){ %>Epub360技术支持<% } %></div>','<div class="pullDown" style="text-align: center;font-size: 12px;">下拉刷新</div>',"</div>",'<div class="lists"></div>',"</div>","</div>","</div>"].join(""),UserSVG:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iUserSVG Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%=iDetail.iSvg%>","</div>","</div>"].join(""),FormView:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="i<%=iType%> nanoscrollbar Element iMouseWheel disableMouseWheelY disableMouseWheelX disableDragX disableDragY" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;-webkit-overflow-scrolling:touch;overflow:auto;<%=iDetail.iStyle%>">',"<% if(interaction_view.getWebContentSrc(iDetail)&&interaction_view.getWebContentSrc(iDetail).src){%>",'<iframe src="<%=interaction_view.getWebContentSrc(iDetail).src||""%>" style="position:absolute;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;min-height:<%=iCommon[iPageDirection].iHeight%>px;height:100%;border:none;overflow:visible;"></iframe>',"<% } %>","<% if(interaction_view.getWebContentSrc(iDetail)&&interaction_view.getWebContentSrc(iDetail).content){%>",'<iframe style="position:absolute;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;min-height:<%=iCommon[iPageDirection].iHeight%>px;height:100%;border:none;overflow:visible;"></iframe>',"<% } %>","</div>","</div>"].join(""),Avatar:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iAvatar Element" style="visibility: hidden; position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">',"<%if(iDetail.iconNormal&&iDetail.iconNormal[0]){%>",'	<div class="thumb" style="width:<%=(iCommon[iPageDirection].iWidth-iDetail.borderW)%>px;height:<%=(iCommon[iPageDirection].iHeight-iDetail.borderH)%>px;overflow:hidden;position:absolute;<%=iDetail.iStyle%> background-image:url(<%=iDetail.iconNormal[0].picture%>);"></div>',"<%}%>","</div>","</div>"].join(""),AvatarList:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iAvatarList Element nanoscrollbar" style="visibility: hidden; position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">','<div class="info-content iMouseWheel disableMouseWheelY disableDragY">','<div style="margin-top: -38px;height: 38px;color:#999;">','<div style="text-align: center; font-size: 12px;height:19px;">E<% if (typeof epub360!="undefined"&&epub360.settings&& ["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type) >=0 ){ %>Epub360技术支持<% } %></div>','<div class="pullDown" style="text-align: center;font-size: 12px;">下拉刷新</div>',"</div>",'<div class="lists">',"<% for(i=0;i<18;i++){ %>",'	<div class="avatar" style="text-align:center; padding:5px; float:left;">','		<div class="thumb" style="width: 36px; height: 36px; border-radius: 18px; background: #999 url(http://qty83k.creatby.com/materials/origin/9691dee74ea33a01f494c7e085956c8c_origin.jpg) no-repeat 50% 50%;background-size: cover;"></div>','		<div class="title" style="font-size: 12px;width: 100%; overflow: hidden; word-wrap: normal;">Jason</div>',"	</div>","<% } %>","</div>",'<div class="pullUp" style="display:none;text-align: center;font-size: 12px; color:#999;">上拉加载更多</div>',"</div>",'<% if(!interaction_view.forpreview){ %><div class="info-template" style="opacity: 0;">','	<div class="avatar" style="text-align:center; padding:5px; float:left;">','		<div class="thumb" style="width: 36px; height: 36px; border-radius: 18px; background: #999 url(http://qty83k.creatby.com/materials/origin/9691dee74ea33a01f494c7e085956c8c_origin.jpg) no-repeat 50% 50%;background-size: cover;"></div>','		<div class="title" style="font-size: 12px;width: 100%; overflow: hidden; word-wrap: normal;">Jason</div>',"	</div>","</div><% } %>","</div>","</div>"].join(""),Plugin:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="i<%=iType%> nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;-webkit-overflow-scrolling:touch;overflow:auto;">',"</div>","</div>"].join(""),Container:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;overflow: hidden;<%=iDetail.iStyle%>">',"</div>","</div>","</div>"].join("")};_eT.TextButton=_eT.Paragraph,_eT.BookButton=_eT.TextLabel,_eT.Vote=_eT.SelectButton=_eT.SubmitButton=_eT.WeixinCamera=_eT.WeixinVoice=_eT.Button,_eT.LayerSlide=_eT.LayerRef,_eT.InitButton=_eT.Button,_eT.QQVideo=_eT.Video,_eT.others=['<div class="iView dynamic hide empty_view <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px;">',"</div>"].join(""),window.funcT={};for(i in _eT){var key=i,value=_eT[i];funcT["_"+key]=_.template(value)}define("interaction_view/template/t_for_v2",function(){}),define("interaction_view/model/base",["jquery","backbone","text!interaction_view/template/message.tpl","text!interaction_view/template/slidenumber.tpl","text!interaction_view/template/imgpreview.tpl","interaction_view/view/subcontainer","interaction_view/template/t_for_v2"],function(){var e=(require("text!interaction_view/template/message.tpl"),require("text!interaction_view/template/slidenumber.tpl")),t=require("text!interaction_view/template/imgpreview.tpl");window.interaction_view={model:{Base:Backbone.Model.extend({defaults:{iType:"iBasetype",iCommon:null,iDetail:null,iPage:null,iParentModel:null,template:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,callback:null},initialize:function(){this.id?(this.setcollection(),this.setmodel()):(this.set("id","e_"+this.cid),this.setcollection(),this.setmodel())},savemodel:function(e){},setmodel:function(){this.onInitialize&&this.onInitialize(),this.page=interaction_view.ipagelist.getPage(this.get("pageid"))||interaction_view.imasterlist.get(this.get("pageid"))||interaction_view.ibackgroundlist.get(this.get("pageid")),this.setlist(),this.setview(),this.setsyncmodel()},createPath:function(){var e=interaction_view.createPath({path:this.get("path"),isSubOverlay:this.get("isSubOverlay"),page_id:this.get("pageid"),model:this});return e},setSubOverlays:function(){var e=this;e.suboverlays=this.getSubOverlays(),e.iOverlaylist=new interaction_view.collection.list,e.iAnimationlist=new interaction_view.collection.Animation,e.iActionlist=new interaction_view.collection.Action,e.ipreloadlist=new interaction_view.collection.Preload,e.subcontainer=e.ipreloadlist.subcontainer=e.iOverlaylist.subcontainer=e.iAnimationlist.subcontainer=e.iActionlist.subcontainer=!0,e.ipreloadlist.path=e.iOverlaylist.path=e.iAnimationlist.path=e.iActionlist.path=this.createPath(),e.ipreloadlist.pagetype=e.iOverlaylist.pagetype=e.iAnimationlist.pagetype=e.iActionlist.pagetype="sub"},getSubOverlays:function(){return this.get("suboverlays")},setlist:function(){},setresourcesmodel:function(){},setsyncmodel:function(){},setcollection:function(){},setview:function(){},url:function(){},sync:function(e,t,i){}})},collection:{Base:Backbone.Collection.extend({iSync:!1,initialize:function(){this.setonadd(),this.setonremove()},setonadd:function(){},setonremove:function(){},url:"",sync:function(e,t,i){},parse:function(e){},resetViewStatus:function(){this.each(function(e){e.iview.resetStatus()})}}),list:Backbone.Collection.extend({iSync:!0,url:"",setonadd:function(){this.on("add",function(e){})},setonremove:function(){},sync:function(e,t,i){"read"==e&&(i.url=context_url+"/overlayinit.json"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,i)},parse:function(e){},resetViewStatus:function(){this.each(function(e){e.iview.resetStatus()})},resetBindings:function(){this.each(function(e){"Binding"==e.get("iType")&&e.iview.resetBindingStatus()})}})},view:{Base:Backbone.View.extend({initialize:function(e){_.bindAll(this),this.initstart()},initstart:function(){this.preload(),this.renderDynamicElement(),this.render()},events:{},options:{},
change:function(e){},bindImageSwitch:function(e,t){if($("body > #imagepreview").find("button.preview-left").on("click",function(){return e.iview.preview_left(t),!1}),$("body > #imagepreview").find("button.preview-right").on("click",function(){return e.iview.preview_right(t),!1}),interaction_view.ismobile){var i=this;$("body > #imagepreview").hammer().on("dragleft",function(e){return i.dragimage="left",e.gesture.preventDefault(),!1}),$("body > #imagepreview").hammer().on("dragright",function(e){return i.dragimage="right",e.gesture.preventDefault(),!1}),$("body > #imagepreview").hammer().on("dragend",function(n){return"right"==i.dragimage&&e.iview.preview_left(t),"left"==i.dragimage&&e.iview.preview_right(t),i.dragimage=null,n.gesture.preventDefault(),!1})}},initPage:function(){var e=this.model.get("pageid");if(this.model.iPageId=e,this.model.set("isMasterOverlay",!1),this.model.set("isBackgroundOverlay",!1),this.model.set("isConfigOverlay",!1),this.pagetype=this.model.get("pagetype"),this.iType=this.model.get("iType"),"LayerRef"==this.pagetype){var t=this.model.get("parentpageid"),i=this.model.get("layerid"),n=interaction_view.getParentpage(t);this.model.page=n.iOverlaylist.get(e).layer[i];var a=n.iOverlaylist.get(e);this.container=a.iview.$el.find(".layer-content").children(".layer-item[data-id="+i+"]"),this.model.iPageId=t,this.model.layer_id=i}else if("master"==this.pagetype)interaction_view.touchview?this.container=$(".reveal"):this.container=$('.reveal .Presentation[id="'+interaction_view.currentPage+'"]').find(".interaction-view"),this.model.set("isMasterOverlay",!0),this.model.isMasterOverlay=!0;else if("background"==this.pagetype)interaction_view.touchview?this.container=$(".reveal"):this.container=$('.reveal .Presentation[id="'+interaction_view.currentPage+'"]').find(".interaction-view"),this.model.set("isBackgroundOverlay",!0),this.model.isBackgroundOverlay=!0;else if("config"==this.pagetype)this.container=$(".config_wrap").find(".interaction-view"),this.model.set("isConfigOverlay",!0),this.model.isConfigOverlay=!0,this.model.page=interaction_view.iconfiglist.at(0);else if(this.model.get("isSubOverlay")){this.path=this.model.get("path");var r=interaction_view.getContainerModelByPath(this.path);this.container=r.iview.$el.children(".Element"),this.model.page=interaction_view.getContainerModelByPath(this.path)}else e?this.container=$('.reveal .Presentation[id="'+this.model.get("pageid")+'"]').find(".interaction-view"):this.container=$(".interaction-view")},renderStaticElement:function(){},renderDynamicElement:function(){this.initPage();var e=this.iType,t=this.model.toJSON();this.detail=t.iDetail,this.zIndex=t.zIndex,this.iSlideNumber=t.iSlideNumber,this.isStatic=t.isStatic;var i=funcT["_"+e]?funcT["_"+e](this.model.toJSON()):funcT._others(t);if(!("WebContent"!=e&&i.indexOf("<script")>-1)){var n=["WebContent","Paragraph","RichText","UserSVG","Variable","Map","Plugin","FormView","CC","clist","ctemplate"];if(n.indexOf(e)<0&&(i=interaction_view.isEvilCode(i)),i){this.container.append(i),this.setElement(this.container.find('div.iView[id="'+this.model.id+'"]').first()),interaction_view.LOCAL_DEBUG&&(this.$el.find("img").each(function(){this.src&&(this.src=this.src.replace("qn","os"))}),this.$el.find(".el_wrap").each(function(){if($(this).css("background-image")){var e=$(this).css("background-image");$(this).css("background-image",e.replace("qn","os"))}}));var a=this.common=this.getcommon();this.x=a.iStartx+a.iWidth/2,this.y=a.iStarty+a.iHeight/2,this.staticX=a.iStartx,this.staticY=a.iStarty,this.originWidth=a.iWidth,this.originHeight=a.iHeight,this.setSizeAdapt(),this.setScreenAdapt();var r=this.model.page.is_flow&&("WebContent"==this.iType||"CC"==this.iType||"clist"==this.iType);this.isStatic||r||-1==this.$el[0].className.indexOf("empty_view")&&interaction_view.setPos(this.$el[0],{x:this.x,y:this.y}),"master"==this.pagetype&&this.$el.addClass("master masterhide"),"background"==this.pagetype&&this.$el.addClass("background"),("CycleImage"==e||"Slide"==e||"Button"==e)&&this.setRatiofixxed(),this.iSlideNumber&&this.renderSlideNumber()}}},setSizeAdapt:function(){if(!("undefined"!=typeof Reveal&&Reveal.adapt||this.detail.isConfigOverlay))return!1;var e=this.detail||{};if(e.iSizeAdapt&&_.isObject(e.iSizeAdapt_data)&&_.keys(e.iSizeAdapt_data).length){var t=!1,i=null;if(e.iScreenAdapt&&(t=!0),e.iSizeAdapt&&(e.iScreenAdapt=!0,this.model.set("iDetail",e,{silent:!0})),t)switch(e.iScreenAdapt_data){case 1:e.iSizeAdapt_data.left=!0,e.iSizeAdapt_data.top=!0;break;case 2:e.iSizeAdapt_data.top=!0;break;case 3:e.iSizeAdapt_data.top=!0,e.iSizeAdapt_data.right=!0;break;case 4:e.iSizeAdapt_data.left=!0;break;case 5:break;case 6:e.iSizeAdapt_data.right=!0;break;case 7:e.iSizeAdapt_data.left=!0,e.iSizeAdapt_data.bottom=!0;break;case 8:e.iSizeAdapt_data.bottom=!0;break;case 9:e.iSizeAdapt_data.bottom=!0,e.iSizeAdapt_data.right=!0}e.iSizeAdapt_data.left&&e.iSizeAdapt_data.right&&e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom?i=12:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom&&e.iSizeAdapt_data.left?i=15:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom&&e.iSizeAdapt_data.right?i=16:e.iSizeAdapt_data.bottom&&e.iSizeAdapt_data.right&&e.iSizeAdapt_data.left?i=13:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.right&&e.iSizeAdapt_data.left?i=14:e.iSizeAdapt_data.left&&e.iSizeAdapt_data.right?i=10:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom?i=11:(e.iSizeAdapt_data.top&&(i=17),e.iSizeAdapt_data.left&&(i=20),e.iSizeAdapt_data.right&&(i=18),e.iSizeAdapt_data.bottom&&(i=19)),i&&(e.iScreenAdapt_data=i,this.model.set("iDetail",e,{silent:!0}))}},setScreenAdapt:function(){if(!("undefined"!=typeof Reveal&&Reveal.adapt||this.detail.isConfigOverlay))return!1;var e=this.detail||{};if(!this.model.isMasterOverlay&&!this.model.isBackgroundOverlay&&!e.iScreenAdapt)return!1;if(this.model.isMasterOverlay||this.model.isBackgroundOverlay?(this.$el.addClass("fixed"),this.model.get("isStatic")||this.$el.css({left:0,top:0})):this.model.get("isStatic")||this.$el.css({left:0,top:0}),e.iScreenAdapt){var t=e.iScreenAdapt_data;1!=t&&interaction_view.adapt.elements.push({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t}),interaction_view.adapt.adjustElement({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t})}else t=e.iScreenAdapt?e.iScreenAdapt_data:null,interaction_view.adapt.elements.push({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t}),interaction_view.adapt.adjustElement({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t});interaction_view.adapt.excute({view:this,adapt:t,type:interaction_view.getPageType2(this.model),model:this.model})},renderSlideNumber:function(){if(this.model.get("iSlideNumber")){this.getdetail();if(this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').remove(),this.getSlideLength()>1){var t=this.model.toJSON();t.slidelength=this.getSlideLength(),this.$el.parent().append(_.template(e,t)),this.hasSlideNumber=!0,this.setSlideNumberPosition()}}},renderBackGroud:function(){var e=this.getdetail();if(!e.iStyle){var t=e.bg_color,i=void 0!=e.bg_opacity?Number(e.bg_opacity):1;if(t){var n=_g.number.hexToRgb(t);t="rgba("+n.r+","+n.g+","+n.b+","+i+")"}else t="transparent";this.$el.children(".Element").css({background:t})}},setSlideNumberPosition:function(){this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').each(function(){var e=$(this).actual?$(this).actual("outerWidth",{includeMargin:!0}):$(this).width(),t=$(this).actual?$(this).actual("outerHeight",{includeMargin:!0}):$(this).height();$(this).css({left:$(this).attr("data-x")-e/2,top:$(this).attr("data-y")-t/2})})},setSlideNumberDisplay:function(){this.getSlideLength()>1&&(this.$el.children(".Element").is(":hidden")?this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').hide():this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').show())},setFullView:function(e){var i=this;$("body").children("#imagepreview").remove(),$("body").append('<div id="imagepreview" style="z-index:10000;width:100%;height:100%;position:absolute;left:0;top:0;background:#000;"><button type="button" class="close" style="display:block;position: absolute; top: 10px; right: 10px; z-index: 9999; width: 32px; height: 32px; line-height: 32px; margin: 0; padding: 0; font-size: 32px; color: #ddd; box-shadow: 0; text-shadow: 0 1px 0 white; text-align: center; filter: alpha(opacity=100); -khtml-opacity: 1; opacity: 1;">×</button><img src="'+e.picture+'"</div>'),i.isFullSwitch()&&($("body > #imagepreview").append(t),i.bindImageSwitch(e.model,e.index)),_g.ui.fitImage({fit:1,items:"#imagepreview > img",width:e.width,height:e.height}),$("#imagepreview").on("click",function(){$(this).remove()}).css("line-height","initial"),$("#imagepreview button.close").on("click",function(){$(this).remove()})},fullviewIndex:function(e){var t=this,i=this.getdetail();if("undefined"!=typeof wx_permissions&&wx_permissions.previewImage)wx.previewImage({current:i.iImg[e].picture,urls:_.map(i.iImg,function(e){return e.picture})});else{var n={picture:i.iImg[e].picture,width:i.iImg[e].width,height:i.iImg[e].height,model:t.model,index:e};t.setFullView(n)}},preload:function(){},afterpreload:function(){this.setZindex(),this.setElementDisplay(),this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".Element").attr("style"),this.preloaded=!0},setSlideImageDisplay:function(){var e=this,t=this.getdetail();if(this.imageDisplay=t.iDisplay,t.iImg&&0!=t.iImg.length){if(!this.imageDisplay)return!1;var i=this.getcommon();_.each(t.iImg,function(n){_g.ui.fitImage({items:e.$el.find(".slidecontent").children()[t.iImg.indexOf(n)],parentWidth:i.iWidth,parentHeight:i.iHeight,width:n.width,height:n.height,fit:e.imageDisplay,useMargin:!0})})}},setRatiofixxed:function(){var e=this,t=this.getdetail();if(t.ratiofixxed&&t.iImg&&0!=t.iImg.length){var i=this.getcommon();_.each(t.iImg,function(n){var a=_g.ui.centerImage({containment:e.$el.find(".slidecontent"),Item:e.$el.find(".slidecontent").children()[t.iImg.indexOf(n)],parentWidth:i.iWidth,parentHeight:i.iHeight,width:n.width,height:n.height,setParent:!1});a.width<i.iWidth&&(e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-left",(i.iWidth-a.width)/2+"px"),e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-right",(i.iWidth-a.width)/2+"px")),a.height<i.iHeight&&(e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-top",(i.iHeight-a.height)/2+"px"),e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-bottom",(i.iHeight-a.height)/2+"px"))})}},setElementInitDisplay:function(){var e=this.model.toJSON().iDetail;e.iHidden||!1;if(this.$el.children(".Element").length>0&&interaction_view.setPos(this.$el.children(".Element")[0],{scale:1}),"LayerRef"!=this.model.attributes.iType&&this.$el.children(".Element").find(".el_wrap").length&&(this.wrap_el=this.$el.children(".Element").find(".el_wrap").first()),!_.isNaN(Number(e.init_opacity))){var t=Number(e.init_opacity);1>=t&&t>=0&&(this.$el[0].style.opacity=Number(e.init_opacity))}e.init_rotation=Number(e.init_rotation)||Number(e.rotate),_.isNaN(e.init_rotation)&&(e.init_rotation=0),this.model.init_rotation=e.init_rotation;var i=this.wrap_el?this.wrap_el[0]:this.$el.children(".Element")[0];i&&"undefined"!=typeof TweenMax&&interaction_view.transform.update(e,i,!0)},setElementDisplay:function(){this.setElementInitDisplay();var e=this.model.toJSON().iDetail,t=e.iHidden||!1,i=this.model.page.iAnimationlist.where({overlay_id:this.model.id}),n=!1;if(i&&i[0]&&i[0].toJSON().iType>=20&&i[0].toJSON().iType<=60)this.$el.addClass("hide");else if(i&&i[0]&&_.include([101,102,103,104,601,701],i[0].toJSON().iType)||n){var a=i&&i[0]&&_.include([101,102,103,104,601,701],i[0].toJSON().iType)?i[0]:n[0],r=-9999,o=-9999;if(a._animation&&a._animation.css&&(r=a._animation.css.x,o=a._animation.css.y),101==a.toJSON().iType){t&&this.$el.addClass("hide");this.getcommon().iWidth,this.getcommon().iHeight;interaction_view.ismobile||_g.browserSupport({msie:9})?interaction_view.setPos(this.$el[0],{x:r,y:o}):$(this.$el[0]).css("margin",r+"px 0px 0px "+o+"px").removeClass("hide").show()}if(102==a.toJSON().iType&&(interaction_view.ismobile||_g.browserSupport({msie:9}))&&(t&&this.$el.addClass("hide"),interaction_view.setPos(this.$el.children(".Element")[0],{scale:0})),103==a.toJSON().iType&&(t&&this.$el.addClass("hide"),this.$el[0].style.opacity=0),104==a.toJSON().iType&&this.$el.addClass("hide"),601==a.toJSON().iType&&this.$el.addClass("hide"),701==i[0].toJSON().iType){var e=i[0].toJSON().iDetail;this.$el.removeClass("hide"),"undefined"!=typeof TweenMax&&TweenMax.set(this.$el.find("svg").find("rect, circle, ellipse, polyline, path, line, polygon"),{drawSVG:e.startx+" "+e.starty,force3D:interaction_view.force3D})}}else t?this.$el.addClass("hide"):"Video"!=this.model.get("iType")&&this.$el.removeClass("hide");e.init_classname&&this.$el.children(".Element").addClass(e.init_classname),this.hideClass=this.$el.hasClass("hide"),e.iDevicePatch&&interaction_view.isIos&&this.$el.children(".Element").addClass("iDevicePatch")},setOtherDisplay:function(){},setZindex:function(){if("Binding"==this.iType||"DragDropGroup"==this.iType)return!1;if("Audio"==this.iType&&!this.detail.iControl)return!1;var e=0;"master"==this.pagetype?e+=2e3:"background"!=this.pagetype&&(e+=1e3),this.detail&&this.detail.isConfigOverlay&&(e+=500);var t=this.zIndex||0,i=t+e,n="LayerRef"!=this.pagetype?t+e/10+.1:t/10,a=this.$el;if(a){var r={x:this.x,y:this.y};window.docConst.IS_OVERLAY_Z3D&&(r.z=n),a.data("iview-positon",r),a.css({"z-index":i}),window.docConst.IS_OVERLAY_Z3D&&interaction_view.setPos(a,r)}this.iSlideNumber&&this.$el.parent().children('nav.slidenumber[data-id="'+this.model.id+'"]').css("z-index",i),this.model.zIndex=i},setMaskSlipable:function(e){var t=this,i=this.getMoveRange();if(i.x&&e.containment.addClass("iMouseWheel disableMouseWheelX disableDragX"),i.y&&e.containment.addClass("iMouseWheel disableMouseWheelY disableDragY"),i.x||i.y){var n=0,a=0;this.scrollview=new _g.scrollview({containment:e.containment,contentel:e.contentel,mask_width:this.$el.children(".Element").width(),mask_height:this.$el.children(".Element").height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:e.content_x,content_y:e.content_y,scrollX:i.x>0?!0:!1,scrollY:i.y>0?!0:!1,onScrollStart:function(){n=t.scrollview._getCurrentPosition().x,a=t.scrollview._getCurrentPosition().y;var r=window.ScrollPage.getExtendInfo();if(r.x&&i.x||r.y&&i.y){var o=window.ScrollPage.getCurrentScroll();o&&o.disable()}e.onScrollStart&&e.onScrollStart()},onScrolling:function(r){var o,s;if(i.x>0){r.controller?t.scrollstart=!0:t.scrollstart=!1;var l=r.deltaX-n;(Math.abs(r.deltaX)>i.x+30||r.deltaX>30)&&e.containment.addClass("is_exceededX");var c=Math.abs(r.deltaX)/i.x;t.onBindingChangeTo({type:0,delta:l,deltarate:c,cdirection:0}),o=r.deltaX}if(i.y>0){var d=r.deltaY-a;(Math.abs(r.deltaY)>i.y+30||r.deltaY>30)&&e.containment.addClass("is_exceededY");var c=Math.abs(r.deltaY)/i.y;t.onBindingChangeTo({type:0,delta:d,deltarate:c,cdirection:1}),s=r.deltaY}e.onScrolling&&e.onScrolling(e.containment,r,o,s)},onScrollend:function(){t.scrollstart=!1,e.containment.removeClass("is_exceededY"),e.containment.removeClass("is_exceededX");var n=window.ScrollPage.getExtendInfo();if(n.x||n.y){var a=window.ScrollPage.getCurrentScroll();if(!a)return;(n.x&&i.x||n.y&&i.y)&&window.ScrollPage.fixGestureState(),a.enable()}e.onScrollEnd&&e.onScrollEnd()}});var r=this.getdetail();r.iGravity&&(r.iMask&&r.iMask_data&&!r.iMask_data.iSlipable&&e.containment.addClass("noevents"),_e.orientation&&_e.orientation.orientationEvents.push({scrollX:i.x>0?!0:!1,scrollY:i.y>0?!0:!1,speed:i.y?i.y/1200:i.x/1200,func:function(e,n){if(interaction_view.currentPage==t.model.iPageId||"background"==t.model.get("pagetype")){if(t.scrollstart)return;if(e&&(t.scrollview.iScroll.x+e>0&&(e=-t.scrollview.iScroll.x),t.scrollview.iScroll.x+e<-i.x&&(e=-t.scrollview.iScroll.x-i.x)),n&&(t.scrollview.iScroll.y+n>0&&(n=-t.scrollview.iScroll.y),t.scrollview.iScroll.y+n<-i.y&&(n=-t.scrollview.iScroll.y-i.y)),i.x>0){var a=Math.abs(t.scrollview.iScroll.x+e)/i.x;t.onBindingChangeTo({type:0,delta:e,deltarate:a,cdirection:0})}if(i.y>0){var a=Math.abs(t.scrollview.iScroll.y+n)/i.y;t.onBindingChangeTo({type:0,delta:n,deltarate:a,cdirection:1})}t.scrollview.iScroll.scrollBy(e,n)}}})),this.$el.addClass("hascontrols")}},getMoveRange:function(){var e=this.getLayerContentSize(),t=e.width,i=e.height,n=this.getcommon();return{x:t-n.iWidth,y:i-n.iHeight}},checkMaskPos:function(e,t){var i=(this.getdetail(),!0),n=this.getLayerContentSize(),a=n.width,r=n.height;return e.left>0&&(e.left=0,i=!1),e.top>0&&(e.top=0,i=!1),Math.abs(e.left)+t.width>a&&(e.left=-(a-t.width),i=!1),Math.abs(e.top)+t.height>r&&(e.top=-(r-t.height),i=!1),i?null:{left:e.left,top:e.top}},render:function(){},renderCentrolPos:function(e){document.getElementById(this.model.id).style.left=e.x-100+"px",document.getElementById(this.model.id).style.top=e.x-100+"px"},destroy:function(e,t){},getAnimations:function(){var e=this.model.page.iAnimationlist.where({overlay_id:this.model.id});return e.length?e:null},getcommon:function(){var e=null;return e=this.model.get("iCommon")[iPageDirection]},getdetail:function(){return this.model.get("iDetail")},resetStatus:function(){this.$el.attr("style",this.copyelstyle),this.$el.children(".Element").attr("style",this.copyelementstyle),this.hideClass?this.$el.addClass("hide"):this.$el.removeClass("hide"),this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),this.resetOtherStatus&&this.resetOtherStatus()},sendToPreload:function(e){var t=$.extend({},{parentpageid:this.model.get("parentpageid"),overlay_id:this.model.id,elementtype:this.model.get("iType"),pageid:this.model.get("pageid"),pagetype:this.model.get("pagetype"),layerid:this.model.get("layerid")},e),i=new interaction_view.model.Preload(t);return this.preloadmodel=i,i},playTimeline:function(){if(this.autoplay){if(this.timeline){if(this.$el.children(".Element").is(":hidden"))return;this.repeat||this.timeline.time()!=this.timeline.duration()?this.timeline.play(null,!1):this.timeline.play(0,!1)}}else if(this.autoplay=!0,this.useIndex)this._setCanvasLoopSwitch(),this.timeline.play(),this.timeline.playing=!0;else{if(this.timeline&&this.timeline.kill(),this.timeline=new TimelineMax({paused:!0,repeat:this.repeat,onComplete:this.setRewind}),this.setTimeline(),this.setSlideDisplayAll(),this.$el.children(".Element").is(":hidden"))return;this.timeline&&this.timeline.play(null,!1)}},pauseTimeline:function(){this.timeline&&this.timeline.pause()},stopTimeline:function(){this.autoplay=!1,this.useIndex?(this.timeline.pause(),this.currentIndex=this._start,this.ctx.clearRect(0,0,this.canvas_width,this.canvas_height),this.drawCanvas(this.img_src[this._start],this._start)):(this.timeline.kill(),this.timeline=new TimelineMax({paused:!0,repeat:this.repeat}),this.setTimeline(),this.timeline.pause(1e-5),this.setSlideElementsDisplay&&this.setSlideElementsDisplay())},setRewind:function(){if(!this.timeline)return!1;var e=this,t=this.getdetail(),i=this.delay,n=function(){setTimeout(function(){e.useIndex?(e.timeline.pause(),e.timeline.playing=!1,e.currentIndex=e._start,e.drawCanvas(e.img_src[e.currentIndex],e.currentIndex)):(e.timeline.pause(1e-5),e.currentIndex=0)},1e3*i)},a=t.iRepeat?-1:0,r=t.iRewind;return this.model.onAnimationStart&&(interaction_view.events.onAnimationEnd(this.model.onAnimationStart),this.model.onAnimationStart=null),a||!r?null:void n()},_setCanvasLoopSwitch:function(e){var t=this,i=this.delay,n=this.getdetail();this.autoplay||(i=2);var a=this._start;return!this.direction&&this.currentIndex>this._start&&this.currentIndex<this._end?a=this.currentIndex:this.direction&&this.currentIndex<this._start&&this.currentIndex>this._end&&(a=this.currentIndex),e&&this.timeline&&(this.timeline.kill(),this.timeline=null),this.timeline=interaction_view.createLoop({delay:i,paused:!0,repeat:this.repeat,onComplete:this.setRewind,duration:this.repeat?this.slidelength*i:(this.slidelength+1)*i,callback:function(){var e=n.iImg[a].picture;return t.drawCanvas(e,a),t.onTimelineUpdate(a),t.onChangeSlideTo(a),a!=t._end||t.repeat?void(a=t.direction?a-1>=t._end?a-1:t._start:a+1<=t._end?a+1:t._start):(t.timeline.pause(),t.timeline.playing=!1,void t.setRewind())},time:function(){}}),a},setNone:function(){var e=this,t=0,n=this.delay;for(this.autoplay||(n=.5),i=0;i<this.slidelength;i++){if(i==this.slidelength-1&&!this.repeat)return;var a=this.slideel.children('[data-index="'+i+'"]');this.timeline.add(TweenMax.to(a,1e-5,{css:{opacity:1}}),t),this.timeline.add(TweenMax.to(a,1e-5,{css:{opacity:0},onUpdateParams:[i+1<this.slidelength?i+1:0],onUpdate:this.onTimelineUpdate}),t+1e-5+n);var r=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]');this.timeline.add(TweenMax.to(r,1e-5,{css:{opacity:0}}),t),this.timeline.add(TweenMax.to(r,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:e.onChangeSlideTo}),t+1e-5+n),i==this.slidelength-1&&this.timeline.add(TweenMax.to(a,1e-5,{css:{opacity:0}}),t+1e-5+n),t+=n+2e-5}},setFade:function(){var e,t,n=this,a=0,r=this.delay;for(this.autoplay||(r=0),i=0;i<this.slidelength;i++)if(0==i&&(e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,0,{css:{opacity:1},onCompleteParams:[0],onComplete:n.onChangeSlideTo}),a),a+=r),i==this.slidelength-1){if(!this.repeat)break;e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:1}}),a),this.timeline.add(TweenMax.fromTo(e,.5,{opacity:1},{opacity:0,onUpdateParams:[i+1<this.slidelength?i+1:0],onUpdate:this.onTimelineUpdate,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),a+.50001),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1}}),a),this.timeline.add(TweenMax.fromTo(t,.5,{opacity:1},{opacity:1,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:n.onChangeSlideTo}),a+.50001),a+=r+.50002}else e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:1}}),a),this.timeline.add(TweenMax.fromTo(e,.5,{opacity:1},{opacity:1,onUpdateParams:[i+1<this.slidelength?i+1:0],onUpdate:this.onTimelineUpdate,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),a+.50001),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:0}}),a),this.timeline.add(TweenMax.fromTo(t,.5,{opacity:0},{opacity:1,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:n.onChangeSlideTo}),a+.50001),a+=r+.50002},setSlip:function(){var e,t,n=this,a=0,r=this.delay;for(this.autoplay||(r=0),i=0;i<this.slidelength&&(i!=this.slidelength-1||this.repeat);i++){var o=this.getParamsForSlide(i).param,s=this.getParamsForSlide(i+1<this.slidelength?i+1:0).param1;o.onUpdateParams=[i+1<this.slidelength?i+1:0],o.onUpdate=this.onTimelineUpdate,o.immediateRender=!1,s.immediateRender=!1;var l=_g.number.decimal(a,5);0==i&&(e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,0,{css:{opacity:1},immediateRender:!1,onCompleteParams:[0],onComplete:n.onChangeSlideTo}),l),a+=r);var l=_g.number.decimal(a,5),c=_g.number.decimal(a+1e-5,5),d=_g.number.decimal(a+.50001,5);e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:1}}),l),this.timeline.add(TweenMax.fromTo(e,.5,{css:{left:"0%",top:"0%",ease:"Linear.easeNone"},immediateRender:!1},_.clone(o)),c),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),d),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1}}),l),this.timeline.add(TweenMax.fromTo(t,.5,_.clone(s),{top:"0%",left:"0%",ease:"Linear.easeNone",immediateRender:!1}),c),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0,i],onComplete:n.onChangeSlideTo}),d),i==this.slidelength-1&&this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),d),a+=r+.50002}},setFlip:function(){var e,t,n,a=this,r=0,o=this.delay,s=this.getdetail(),l=s.iSlidetype?s.iSlidetype:0,c=180;for("横向"==l||0==Number(l)?(l=0,n={rotationY:0},TweenLite.set(this.slideel,{rotationY:0})):(l=1,n={rotationX:0},TweenLite.set(this.slideel,{rotationX:0})),this.autoplay||(o=0),TweenLite.set(this.$el.children(".Element"),{perspective:800}),TweenLite.set(this.slideel,{transformStyle:"preserve-3d"}),TweenLite.set(this.slideel.children(),{backfaceVisibility:"hidden"}),i=0;i<this.slidelength&&(i!=this.slidelength-1||this.repeat);i++){n.onUpdateParams=[i+1<this.slidelength?i+1:0],n.onUpdate=this.onTimelineUpdate,l?n.rotationX="+=180cw":n.rotationY="-=180cw",0==i&&(e=this.slideel.children('[data-index="'+i+'"]'),l?this.timeline.add(TweenMax.to(e,0,{rotationX:180==c?0:180,opacity:1,onCompleteParams:[0],onComplete:a.onChangeSlideTo}),r):this.timeline.add(TweenMax.to(e,0,{rotationY:180==c?0:180,opacity:1,onCompleteParams:[0],onComplete:a.onChangeSlideTo}),r),r+=o);var d=_g.number.decimal(r,5),h=_g.number.decimal(r+1e-5,5),u=_g.number.decimal(r+.50001,5);e=this.slideel.children('[data-index="'+i+'"]'),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),l?this.timeline.add(TweenMax.to(e,1e-5,{rotationX:180==c?0:180,opacity:1}),d):this.timeline.add(TweenMax.to(e,1e-5,{rotationY:180==c?0:180,opacity:1}),d),this.timeline.add(TweenMax.to(this.slideel,.5,_.clone(n)),h),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),u),l?this.timeline.add(TweenMax.to(t,1e-5,{css:{rotationX:c,opacity:1}}),d):this.timeline.add(TweenMax.to(t,1e-5,{css:{rotationY:c,opacity:1}}),d),this.timeline.add(TweenMax.to(t,1e-5,{onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:a.onChangeSlideTo}),u),i==this.slidelength-1&&this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),u),r+=o+.50002,c=180==c?0:180}},setFlow:function(){function e(e){t.onTimelineUpdate(e),t.setElementTo(e),!t.getdetail().iRepeat&&t.getdetail().iRewind&&e>=t.slidelength-1&&TweenMax.to(t.slideel.find('[data-index="'+e+'"]'),.3,{opacity:1,onComplete:function(){t.CoverFlow.coverflow("select",0)}})}var t=this,n=0,a=this.delay;for(this.autoplay||(a=0),i=0;i<this.slidelength&&(i!=this.slidelength-1||this.repeat);i++){0==i&&(n+=a);var r=this.slideel.find('[data-index="'+i+'"]');this.timeline.add(TweenMax.to(r,.3,{opacity:1,onUpdateParams:[i+1<t.slidelength?i+1:0],onUpdate:e}),n),n+=a+.3}},onBindingChangeTo:function(e){interaction_view.events.onBingChangeTo({type:e.type,page_id:this.model.page.id?this.model.page.id:this.model.get("layerid"),id:this.model.id,delta:e.delta,deltarate:e.deltarate,cdirection:e.cdirection})},onTimelineUpdate:function(e){var t=this.timeline.time();interaction_view.events.onBingChangeTo({type:0,page_id:this.model.page.id?this.model.page.id:this.model.get("layerid"),id:this.model.id,delta:-1,deltarate:t/this.timeline.duration(),cdirection:null})},onChangeSlideTo:function(e,t){this.currentIndex=e,this.model.trigger("slideTo",e),this.model.get("iSlideNumber")&&this.changeSlideNumber()},changeSlideNumber:function(){var e=this.$el.parent().children('nav.slidenumber[data-id="'+this.model.id+'"]').children(":nth-child("+(this.currentIndex+1)+")");e.each(function(){$(this).addClass("active").siblings().removeClass("active")})},onExecuteBinding:function(e){if("LayerRef"==this.model.get("iType"))return void this.onExecuteBindingForLayerRef(e);var t=this;if(this.slideel&&this.slidelength>1&&this.timeline){var i=this.timeline.duration();if(this.repeat?singletime=i/this.slidelength:singletime=i/(this.slidelength-1),0==e.type){t.useIndex||t.setSlideDisplayAll(),a=e.deltarate*i;var n=parseInt(a/singletime,10);t.slideChangePatch(e.delta,n),t.onChangeSlideTo(n),t.useIndex?(t.indexTime=a,t.drawCanvas(t.img_src[n],n),t.autoplay&&(t.autoplay=!1,t.timeline.pause(a),t.timeline.playing=!1)):t.timeline.seek(a)}else{if(t.useIndex)var a=t.indexTime;else var a=t.timeline.time();console.log("stop at delta"+e.delta),"CycleImage"!=t.model.get("iType")&&(a/singletime-parseInt(a/singletime,10)<.2?(a=parseInt(a/singletime,10)*singletime,n=parseInt(a/singletime,10)):a/singletime-parseInt(a/singletime,10)>.8?(a=(parseInt(a/singletime,10)+1)*singletime,n=parseInt(a/singletime,10)):(a=parseInt(a/singletime,10)*singletime,n=parseInt(a/singletime,10),e.delta<0&&i>a&&(a+=singletime,n=parseInt(a/singletime,10)))),console.log(a),(0==a||1e-5==a)&&(a=1e-5,e.reset&&e.revert&&(a=t.repeat?1e-5:t.timeline.duration(),n=parseInt(a/singletime,10))),n>t.slidelength-1&&(n=0),t.useIndex?(t.indexTime=a,void 0!=n&&t.drawCanvas(t.img_src[n],n)):t.timeline.seek(a),t.useIndex||t.setSlideDisplay(n),t.onChangeSlideTo(n)}}},setSlideDisplay:function(e,t){this.autoplay||(this.slideel.children('[data-index="'+e+'"]').css({display:"block",opacity:1}),t&&this.slideel.children('[data-index="'+e+'"]').css("opacity",1),"LayerSlide"==this.model.get("iType")&&(this.onShow(e),this.onBeforeHide(e)),this.slideel.children('[data-index="'+e+'"]').siblings().hide(),t&&this.slideel.children('[data-index="'+e+'"]').siblings().css("opacity",0),"LayerSlide"==this.model.get("iType")&&this.onHide(e))},setSlideDisplayAll:function(){this.slideel.children().css("display","block")},setElementTo:function(e){var t=this,i=this.getdetail();if("Flow"==i.iFade){var n=t.CoverFlow.children(".ui-state-active").index(),a=i.iImg.length-1;return"prev"==e?e=0>=n?a:n-1:"next"==e?e=n>=a?0:n+1:"first"==e?e=0:"last"==e&&(e=a),0>e&&(e=0),e>a&&(e=a),void t.CoverFlow.coverflow("select",e)}if(_.include(["first","last","prev","next"],e));else{if(NaN==Number(e)||this.currentIndex==Number(e))return;e=Number(e)}var r,o,s=i.iRepeat,l=!1,c=null;if(this.slidelength&&!(e>=this.slidelength)){var d=_g.number.decimal(this.timeline.duration(),5);if(r=s?_g.number.decimal(d/this.slidelength,5):_g.number.decimal(d/(this.slidelength-1),5),"first"==e)c=1e-5;else if("last"==e)c=(this.slidelength-1)*r;else if("prev"==e){l=!0;var h=!0;if(!s&&0==this.currentIndex)return!1;o=0==this.currentIndex?this.slidelength-1:this.currentIndex-1,c=o*r,1e-5==c&&(c=0)}else if("next"==e){l=!0;var u=!0;if(!s&&this.currentIndex==this.slidelength-1)return!1;o=this.currentIndex==this.slidelength-1?0:this.currentIndex+1,c=o*r,1e-5==c&&(c=0)}else{if(!(Number(e)>=0&&Number(e)<this.slidelength))return!1;c=r*parseInt(e,10)+1e-5}if(console.log(c),0==c&&(c=1e-5),e=t.useIndex&&o?o:parseInt(c/r,10),e>this.slidelength-1&&(e=0),"None"!=this.iFade&&"LoopSwitch"!=this.iFade&&l){if(t.setSlideDisplayAll(),u)var p=1e-5==c?d:c;if(h){var f=_g.number.decimal(t.timeline.time(),5);(0==f||1e-5==f)&&t.timeline.seek(d-1e-5);var p=c}this.timeline.tweenTo(p,{onComplete:function(){u&&1e-5==c&&t.timeline.seek(1e-5),console.log("stop at "+t.timeline.time()),t.setSlideDisplay(e),t.onChangeSlideTo(e),t.onBindingChangeTo({type:1,delta:0})}})}else{t.useIndex?(t.indexTime=c,t.drawCanvas(t.img_src[e],e),t.autoplay&&(t.autoplay=!1,t.timeline.pause(c),t.timeline.playing=!1)):t.timeline.seek(c,!1);Math.abs(this.timeline.time()/this.timeline.duration());t.useIndex||this.setSlideDisplay(e),this.onChangeSlideTo(e),this.onBindingChangeTo({type:1,delta:0})}}},setElementToDirect:function(e){var t=this,i=this.getdetail();if("Flow"==i.iFade){var n=t.CoverFlow.children(".ui-state-active").index(),a=i.iImg.length-1;
return"prev"==e?e=0>=n?a:n-1:"next"==e?e=n>=a?0:n+1:"first"==e?e=0:"last"==e&&(e=a),0>e&&(e=0),e>a&&(e=a),void t.CoverFlow.coverflow("select",e)}if(_.include(["first","last","prev","next"],e));else{if(NaN==Number(e)||this.currentIndex==Number(e))return;e=Number(e)}var r,o,s=i.iRepeat,l=!1,c=null;if(this.slidelength&&!(e>=this.slidelength)){var d=_g.number.decimal(this.timeline.duration(),5);if(r=s?_g.number.decimal(d/this.slidelength,5):_g.number.decimal(d/(this.slidelength-1),5),"first"==e)c=1e-5;else if("last"==e)c=(this.slidelength-1)*r;else if("prev"==e){l=!0;if(!s&&0==this.currentIndex)return!1;o=0==this.currentIndex?this.slidelength-1:this.currentIndex-1,c=o*r,1e-5==c&&(c=0)}else if("next"==e){l=!0;if(!s&&this.currentIndex==this.slidelength-1)return!1;o=this.currentIndex==this.slidelength-1?0:this.currentIndex+1,c=o*r,1e-5==c&&(c=0)}else{if(!(Number(e)>=0&&Number(e)<this.slidelength))return!1;c=r*parseInt(e,10)+1e-5}console.log(c),0==c?c=1e-5:e=parseInt(c/r,10),e>this.slidelength-1&&(e=0),this.currentIndex=e,this.currentSlideIndex=e,t.timeline.pause(c),t.setSlideDisplay(e),t.changeSlideNumber()}},slideChangePatch:function(e,t){var n=this;if(e>0)for(i=n.currentIndex;i>t;i--)0>i&&(i=n.slidelength-1),i!=n.currentIndex&&n.onChangeSlideTo(i);if(0>e)for(i=n.currentIndex;t>i;i++)i>n.slidelength-1&&(i=0),i!=n.currentIndex&&n.onChangeSlideTo(i)},addControlClass:function(){var e=this.getdetail(),t=e.iSlidetype?e.iSlidetype:0;this.$el.children(".Element").addClass("iMouseWheel"),"横向"==t||0==Number(t)?this.$el.children(".Element").addClass("enableMouseWheelX disableDragX"):this.$el.children(".Element").addClass("enableMouseWheelY disableDragY")},removeControlClass:function(){this.$el.children(".Element").removeClass("iMouseWheel").removeClass("enableMouseWheelX disableDragX").removeClass("enableMouseWheelY disableDragY")},control:function(){if(this.controled)return void(this.canSlip?this.addControlClass():this.removeControlClass());var e=(_g.touch.support,"touchstart"),t="touchmove",i="touchend";eCancel="touchcancel";var n,a=this,r=this.getdetail(),o=0,s=0;this.indexTime=0;var l,c=0,d=0,h=0,u=0,p=!1,f=!1,v=null,g=null,m=null,w=this.$el.children(".Element").width(),_=r.iSlidetype?r.iSlidetype:0,y=this.timeline.duration(),b="横向"==_||0==Number(_)?0:1;n=this.repeat?this.singletime=y/this.slidelength:this.singletime=y/(this.slidelength-1);var x=this.repeat,S=function(e){if(("Slide"!=a.model.get("iType")||a.canSlip)&&(l=0,u=0,a.autoplay&&(a.indexTime=a.timeline.time()),o=a.useIndex?a.indexTime:a.timeline.time(),p=!0,m=a.slideel.children(":visible").first().index(),console.log("control start"),"Slide"==a.model.attributes.iType&&a.autoplay)){a.autoplay=!1;var t=a.rmbLast;if(a.resetTimeline)var i=a.resetTimeline();y=i.duration,n=i.singletime,a.rmbLast=t,a.rmbLast&&(m=t,a.setElementToDirect(t)),a.reseted=!0}},C=function(e,t,i){if("Slide"!=a.model.get("iType")||a.canSlip){a.useIndex||a.setSlideDisplayAll(),e>y&&(x?e-=y:(u+=1,u>5&&a.model.get("iSlideNumber")&&(0==b?a.$el.children(".Element").addClass("is_exceededX"):a.$el.children(".Element").addClass("is_exceededY")),e=y)),0>e&&(x?e=y+e:(u+=1,console.log(y-e),u>5&&a.model.get("iSlideNumber")&&(0==b?a.$el.children(".Element").addClass("is_exceededX"):a.$el.children(".Element").addClass("is_exceededY")),e=1e-5));var r=e/y;if(a.onBindingChangeTo({type:0,delta:t,deltarate:r,cdirection:b}),"CycleImage"==a.model.get("iType")){var s=parseInt(e/n);if(s>a.slidelength-1&&(s=0),s==a.currentIndex)return e;i||a.slideChangePatch(t,s),a.onChangeSlideTo(s)}return console.log(e),a.useIndex?(a.indexTime=e,a.drawCanvas(a.img_src[s],s),a.autoplay&&(a.autoplay=!1,a.timeline.pause(o),a.timeline.playing=!1)):a.timeline.seek(e),e}},T=function(e){if(("Slide"!=a.model.get("iType")||a.canSlip)&&"CycleImage"!=a.model.get("iType")){var t;o=a.useIndex?a.indexTime:a.timeline.time(),"CycleImage"!=a.model.get("iType")?(1e-5==o&&(o=0),o/n-parseInt(o/n,10)<.2?(o=parseInt(o/n,10)*n,t=parseInt(o/n,10)):o/n-parseInt(o/n,10)>.8?(o=(parseInt(o/n,10)+1)*n,t=parseInt(o/n,10)):(o=parseInt(o/n,10)*n,t=parseInt(o/n,10),0>e&&y>o&&(o+=n,t+=1)),o=Math.round(o/n)*n+1e-5):t=parseInt(o/n,10),console.log("final time is"+o),0==o&&(o=1e-5),t>a.slidelength-1&&(t=0),a.useIndex?(a.drawCanvas(a.img_src[t],t),a.onChangeSlideTo(t),a.onBindingChangeTo({type:1,delta:e})):a.timeline.tweenTo(o,{onComplete:function(){a.useIndex||a.setSlideDisplay(t),a.onChangeSlideTo(t),a.onBindingChangeTo({type:1,delta:e})}})}};if(_g.touch.support){var k,P,E;this.$el.children(".Element").on(e,function(e){if(e=e.originalEvent.touches[0],!a.testControl(e.target))return!1;if(!$(this).hasClass("is_exceededX")&&!$(this).hasClass("is_exceededY")){v=c=e.pageX,g=d=e.pageY,k=e.pageX,P=e.pageY,E=!0;e.target;s=0,S()}}),this.$el.children(".Element").on(t,function(e){if(e=e.originalEvent.touches[0],$(this).hasClass("is_exceededX")||$(this).hasClass("is_exceededY"))return void(p=!1);if(p&&null!=v){if(l="横向"==_||0==Number(_)?e.pageX-v:e.pageY-g,h="横向"==_||0==Number(_)?e.pageX-c:e.pageY-d,moveOppositeDirection="横向"==_||0==Number(_)?e.pageY-d:e.pageX-c,console.log("direction"+h),console.log("oppsite"+moveOppositeDirection),Math.abs(h)<=2&&Math.abs(moveOppositeDirection)>12){var t="横向"==_||0==Number(_)?"is_exceededX":"is_exceededY";return void $(this).addClass(t)}if(c=e.pageX,d=e.pageY,0==l)return;return s="CycleImage"==a.model.get("iType")?o-l/w*y:o-l/w*n,C(s,h),!1}}),this.$el.children(".Element").on(i,function(e){return e=e.originalEvent.touches[0],E=!1,p?(0!=l?(T(l),$(Reveal.options.containment).hammer("reset")):(a.setSlideDisplay(m),interaction_view.ismobile&&a.$el.children(".Element").trigger("tap"),$(Reveal.options.containment).hammer("reset")),p=!1,console.log("control stop"),$(Reveal.options.containment).hammer().trigger("dragend"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))}),this.$el.children(".Element").on(eCancel,function(e){return e=e.originalEvent.touches[0],p?(0!=l?(T(l),$(Reveal.options.containment).hammer("reset")):a.setSlideDisplay(m),p=!1,console.log("control cancel"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))})}if(this.$el.children(".Element").on("mousedown",function(e){return a.testControl(e.target)?void($(this).hasClass("is_exceededX")||$(this).hasClass("is_exceededY")||(s=0,v=c=e.pageX,g=d=e.pageY,S())):!1}),this.$el.children(".Element").on("mousemove",function(e){if($(this).hasClass("is_exceededX")||$(this).hasClass("is_exceededY"))return void(p=!1);if(p&&null!=v){if(l="横向"==_||0==Number(_)?e.pageX-v:e.pageY-g,h="横向"==_||0==Number(_)?e.pageX-c:e.pageY-d,c=e.pageX,d=e.pageY,0==l)return;return s="CycleImage"==a.model.get("iType")?o-l/w*y:o-l/w*n,C(s,h),e.preventDefault(),!1}}),this.$el.children(".Element").on("mouseup",function(e){return p?(0!=l?(T(l),e.preventDefault(),e.stopPropagation(),$(Reveal.options.containment).hammer("reset")):(a.setSlideDisplay(m),$(e.currentTarget).trigger("tap"),$(Reveal.options.containment).hammer("reset"),window.ScrollPage.fixGestureState()),p=!1,console.log("control stop"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))}),this.$el.children(".Element").on("mouseleave",function(e){return p?(0!=l?(T(l),e.preventDefault(),$(Reveal.options.containment).hammer("reset")):a.setSlideDisplay(m),p=!1,console.log("control cancel"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))}),this.$el.children(".Element").on("wheelstart",function(e,t){$(e.target).is(this)&&(s=0,v=c=0,g=d=0,l=0,o=a.useIndex?a.indexTime:a.timeline.time(),m=a.slideel.children(":visible").first().index(),f=!0,console.log("control start"))}),this.$el.children(".Element").on("wheelmove",function(e,t){if($(e.target).is(this)){if(!f)return!1;var i=_g.mousewheel.getMouseWheel(t),r=i.x,u=i.y;if(void 0!=r||void 0!=u){var p=Math.max(-1,Math.min(1,r)),v=Math.max(-1,Math.min(1,u)),g=30;console.log("before currentX is "+c),c+=p*g,d+=v*g,console.log("after currentX is "+c),console.log("wheelX is"+p),l="横向"==_||0==Number(_)?p:v,console.log("control moving");var m=1;if(l){h="横向"==_||0==Number(_)?p:v;var w="横向"==_||0==Number(_)?c:d;if(w){"CycleImage"==a.model.get("iType")&&(m=a.slidelength>50?a.slidelength/50:1);var b="横向"==_||0==Number(_)?m*$(this).width():m*$(this).height();w>b&&(w=b),-b>w&&(w=-b),"横向"==_||0==Number(_)?c=w:d=w,s="CycleImage"==a.model.get("iType")?o-w/b*y:o-w/$(this).width()*n,C(s,h)}}}}}),this.$el.children(".Element").on("wheelend",function(e,t){if(!f)return!1;var i="横向"==_||0==Number(_)?c:d;T(i),console.log("control end"),c=d=0,f=!1}),"CycleImage"==a.model.get("iType")&&r.iGravity){var D=a.slidelength>50?a.slidelength/50:1;_e.orientation&&_e.orientation.orientationEvents.push({scrollX:"横向"==_||0==Number(_),scrollY:!("横向"==_||0==Number(_)),page_id:a.model.iPageId,speed:1,func:function(e,t,i,n){if(interaction_view.currentPage==a.model.iPageId){var r=a.$el.children(".Element"),l="横向"==_||0==Number(_)?e:t;if(!l)return;l=parseInt(l),deltaend=-l;var c="横向"==_||0==Number(_)?D*r.width():D*r.height();s=o-deltaend/c*y,console.log(s),a.indexTime=o=C(s,l,!0)}}})}this.controled=!0},getParamsForFade:function(e){param.opacity=1,param1.opacity=0},getParamsForSlide:function(e){var t=this.getdetail(),i=t.iSlidetype?t.iSlidetype:0,n=this.slideel.children('[data-index="'+e+'"]');_.include(["Slide","Gallery","CycleImage"],this.model.get("iType"))&&(n=this.slideel);var a={ease:"Linear.easeNone"},r={ease:"Linear.easeNone"};return"横向"==i||0==Number(i)?(a.opacity=1,a.left="-100%",r.left="100%",r.opacity=1):(a.opacity=1,a.top="-"+n.css("height"),r.top=n.css("height"),r.opacity=1),{param:a,param1:r}},getParamsForSlip:function(e){return param},getSlideDuration:function(){var e;this.getdetail();return 0==this.slidelength?0:e="CycleImage"!=this.model.get("iType")?(this.delay+.50002)*this.slidelength:(this.delay+2e-5)*this.slidelength},onShow:function(){this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),_.include(["Slide","LayerSlide"],this.model.get("iType"))&&this.autoplay&&this.playTimeline(),_.include(["PageIndex","Gallery","Grid"],this.model.get("iType"))&&this.resetOtherStatus(),this.otherOnShow&&this.otherOnShow()},onBeforeHide:function(){_.include(["Slide","LayerSlide"],this.model.get("iType"))&&this.timeline&&(this.timeline.paused()||this.timeline.pause())},onHide:function(){this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),this.otherOnHide&&this.otherOnHide()},loadSubOverlay:function(e){var t=require("interaction_view/view/subcontainer");t=_g.mvc.createView(t),this.subview=new t({model:this.model}),this.preloadmodel=e,this.subview.afterload()},clearPreload:function(){this.$el.children(".Element").length&&this.$el.children(".Element").find("img").each(function(){$(this).attr("src","")})}})}},window.iOverlaylist=new interaction_view.collection.Base,interaction_view.iOverlaylist=new interaction_view.collection.list,interaction_view.currentPage=null}),define("interaction_view/model/action",["interaction_view/model/base"],function(){interaction_view.model.Action=interaction_view.model.Base.extend({defaults:{page_id:null,ref_id:null,index:null,layer_id:null,overlay_id:null},setcollection:function(){},setview:function(e){if(this.pageid=this.get("pageid"),this.parentpageid=this.get("parentpageid"),this.iPage_id=this.pageid,this.app_id=this.get("app_id"),"LayerRef"==this.get("pagetype")){var t=this.get("parentpageid"),i=this.get("layerid"),n=interaction_view.getParentpage(t);this.parentpage=n,this.page=n.iOverlaylist.get(this.pageid).layer[i],this.iPage_id=t}else this.get("path")?(this.path=this.get("path"),this.page=interaction_view.getContainerModelByPath(this.path)):this.page=interaction_view.getParentpage(this.pageid);this.iview=new interaction_view.view.Action({model:this})},setsyncmodel:function(){},actionpatch:function(){var e=this,t=this.get("iDetail");"LayerRef"==this.get("pagetype")&&(this.get("layer_id")||this.set("layer_id",this.get("layerid"))),5!=t.results[0].iAction&&t.results[0].iAction<7&&(6==t.results[0].iAction&&"string"==typeof t.results[0].values&&(t.results[0].values=[{id:t.results[0].values,page_id:e.pageid}]),t.results[0].values=_.map(t.results[0].values,function(t){return"object"!=typeof t?{id:t,page_id:e.pageid}:t})),this.set("iDetail",t)}}),interaction_view.collection.Action=interaction_view.collection.Base.extend({initialize:function(){this.setonadd(),this.setonremove()},model:interaction_view.model.Action,setonadd:function(){this.on("add",function(e){})},onSingleComplete:function(){},onUpdate:function(){},onTotalComplete:function(){},resetStatus:function(){this.each(function(e){e.iview.resetStatus()})}}),interaction_view.view.Action=interaction_view.view.Base.extend({initstart:function(){},renderanimations:function(){this.timeline&&this.timeline.kill()&&this.timeline.clear(!0);var e=this,t=t||this,i=(this.model.toJSON(),this.values);if(i&&i.length){var n=animateTimeline.generateTimeline({onStart:null,ids:i,iPage_id:this.model.iPage_id,page:this.model.page,paused:!0,foraction:!0});e.timeline=n,t.recordHash(i,n),e.timeline&&e.timeline.play(0)}},onComplete:function(){},events:{},renderDynamicElement:function(){},recordHash:function(e,t){var i=i||this,n=interaction_view.getPage(interaction_view.currentPage),a=n.runtimeCache=n.runtimeCache||{};a.timelineControl=a.timelineControl||{from:{page:n,master:interaction_view.imasterlist.at(0),background:interaction_view.ibackgroundlist.at(0)},hashMap:{}};var r=i.hashFlag(e);a.timelineControl.hashMap[r]={list:e,timeline:t}},hashFlag:function(e){var t=e.reduce(function(e,t){var n=""+t.id.slice(-6)+t.page_id.slice(-6);for(i=0;i<n.length;i++)char=n.charCodeAt(i),e=(e<<5)+e+char;return e},5381);return t},getClassification:function(){if(!this.ref_id){if(_.isNumber(this.index)&&this.overlaymodel)return 4;if(this.animation_id)return 5;if(!_.isNumber(this.index)&&this.overlaymodel)return 1;if(!this.overlaymodel){if(this.overlay_id==this.model.page.id)return 2;if(interaction_view.ilayerlist.get(this.overlay_id)||interaction_view.iComponentlist.get(this.overlay_id))return 3}}if(this.ref_id&&"LayerRef"==this.model.get("pagetype")&&this.model.pageid==this.ref_id&&this.model.parentpageid==this.page_id){if(_.isNumber(this.index)&&this.overlaymodel)return 4;if(this.animation_id)return 5;if(!_.isNumber(this.index)&&this.overlaymodel)return 1;if(!this.overlaymodel){if(this.overlay_id==this.model.page.id)return 2;if(interaction_view.ilayerlist.get(this.overlay_id)||interaction_view.iComponentlist.get(this.overlay_id))return 3}}return 0},patchForLayerActionExecActions:function(e,t){if(e.model.attributes.layer_id)for(var i=0;i<t.length;i++)t[i].pagetype||t[i].ref_id||(t[i].pagetype=e.model.attributes.pagetype,t[i].ref_id=e.model.attributes.ref_id,t[i].layer_id=e.model.attributes.layer_id,t[i].layerid=e.model.attributes.layerid,t[i].parentpageid=e.model.attributes.parentpageid,t[i].page_id||(t[i].page_id=e.model.attributes.page_id),t[i].pageid||(t[i].pageid=e.model.attributes.pageid))},render:function(e){e||(e={});var t=this.model.toJSON();this.actionCate="组件",this.app_id=t.app_id,this.iType=t.iType,this.overlay_id=t.overlay_id,this.page_id=t.page_id,this.ref_id=t.ref_id,this.index=t.index,this.animation_id=t.animation_id,this.layer_id=t.layer_id;var i=t.iDetail;if(i&&i.results&&(6!=this.iType&&7!=this.iType||this.animation_id)){var n=this;if(this.actiontype=i.results[0].iAction,this.values=i.results[0].values,this.app_id){this.actionCate="应用",this.renderforapplication();var a=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[];return void(a&&interaction_view.PluginManage.ActionExecutes[this.actiontype]&&interaction_view.PluginManage.ActionExecutes[n.actiontype].setExecuteActions&&interaction_view.PluginManage.ActionExecutes[n.actiontype].setExecuteActions(n,a,e))}if(120!=this.iType&&150!=this.iType&&151!=this.iType){if(this.overlaymodel=this.model.page?this.model.page.iOverlaylist.get(this.overlay_id):null,99==this.iType)if(this.customType=i.customType,this.customType&&interaction_view.PluginManage.Actions[this.customType]){var r={type:this.customType,view:this,func:function(e,t){n.executeAction(n,e,t)}};interaction_view.PluginManage.Actions[this.customType](r,e)}else this.renderforoverlay(e);else{var o=this.getClassification();if(!o)return;switch(o){case 1:this.renderforoverlay(e);break;case 2:this.actionCate="页面",this.renderforpage();break;case 3:this.actionCate="Layer",this.renderforlayer();break;case 4:this.actionCate="幻灯",this.renderforslideindex();break;case 5:this.actionCate="动画",this.renderforanimationaction()}}var a=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[];if(a&&(n.patchForLayerActionExecActions(n,a),interaction_view.PluginManage.ActionExecutes[this.actiontype]&&interaction_view.PluginManage.ActionExecutes[n.actiontype].setExecuteActions&&interaction_view.PluginManage.ActionExecutes[n.actiontype].setExecuteActions(n,a,e)),this.preloadactions=[],101==this.actiontype&&(this.preloadactions=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[],this.preloadactions.length&&(this.preload_hash="pre_"+_g.uuid(3),_e.preloadpage.renderActions(this.preloadactions,this.preload_hash))),102==this.actiontype){var s=[],l=this.model.toJSON().id,c=this.page_id;s=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[];for(var d=0;d<s.length;d++){var h=$.extend(!0,{},s[d]),u=new interaction_view.model.Action(h);u.iview.render(),function(e){var t={userdatasave_hash:c+"_"+l,func:function(t){e.iview.executeAction(e.iview,t)}};interaction_view.events.userdataSaveEvents.push(t)}(u)}}if(82==this.actiontype){var p=[],l=this.model.toJSON().id;p=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[];for(var d=0;d<p.length;d++){var h=$.extend(!0,{},p[d]),u=new interaction_view.model.Action(h);u.iview.render(),function(e){var t={sharedatasave_hash:l,func:function(t){e.iview.executeAction(e.iview,t)}};interaction_view.events.sharedataSaveEvents.push(t)}(u)}}}}},renderforoverlay:function(e){var t=this,i={type:this.iType,page_id:this.page_id,overlay_id:this.overlay_id,layer_id:this.layer_id,func:function(e){t.executeAction(t,e)}};switch(this.layer_id&&(i.iPage_id=this.model.iPage_id),this.iType){case 8:case 9:case 10:case 11:case 12:i.drop_type=this.iType,i.path=this.path,_.include([11,12],this.iType)?(i.type="dragdropgroup",interaction_view.events.dragDropGroupEvents.push(i)):(i.type="dragdrop",interaction_view.events.dragDropEvents.push(i));break;case 18:case 19:case 16:case 17:i.condition=String(this.model.attributes.condition),interaction_view.events.timerEvents.push(i);break;case 22:i.condition=String(this.model.attributes.condition),interaction_view.events.variableEvents.push(i);break;case 23:interaction_view.events.voteEvents.push(i);break;case 54:interaction_view.events.paragraphEvents.push(i);break;case 41:interaction_view.events.eraserEvents.push(i);break;case 71:case 72:interaction_view.events.WeixinCameraEvents.push(i);break;case 73:interaction_view.events.collisionEvents.push(i);break;case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:interaction_view.events.userListEvents.push(i);break;case 82:case 83:interaction_view.events.contactFormEvents.push(i);break;case 100:case 101:case 102:case 103:case 104:case 105:case 110:case 111:case 140:case 141:case 130:case 131:case 160:case 161:interaction_view.events.systemVariableEvents.push(i);break;case 99:break;default:var n="tap",a=this.overlaymodel.iview.$el;if(20==this.iType?n="mouseenter":21==this.iType?n="mouseleave":(14==this.iType||15==this.iType)&&(n="hold"),this.overlaymodel.iview.$el.css("cursor","pointer"),this.overlaymodel.iview.$el.addClass("hasaction"),_.include(["Slide","LayerSlide","CycleImage","Vote"],this.overlaymodel.iview.iType)&&(a=a.children(".Element")),_.include(["Button"],this.overlaymodel.iview.iType)&&console.log("button"),1==this.iType&&(a=this.overlaymodel.iview.$el.find("img.iconNormal")),2==this.iType&&(a=this.overlaymodel.iview.$el.find("img.iconActive")),this.model.attributes.iDetail.dom_id)return void a.hammer({hold_timeout:200}).on(n,"[es-id="+this.model.attributes.iDetail.dom_id+"]",function(e){var i=$(this).parents(".contentGridRow:first");return i.length||(i=$(this).parents(".grid-item:first")),t.executeAction(t,null,{$dom:i}),"hold"==n||"tap"==n?(e.gesture.preventDefault(),!1):void 0});if(!a)return;if(!a.hammer)return;interaction_view.ismobile&&"hold"==n&&52==t.actiontype&&this.patchPlay(a,t,this.iType);a.hammer({hold_timeout:200}).on(n,function(e){if(0==t.iType&&_.include(["Paragraph"],t.overlaymodel.iview.iType)&&interaction_view.environment.Paragraph.state()&&!t.overlaymodel.attributes.iDetail.iStaticImage)return!1;if(_.include(["Slide","LayerSlide","CycleImage","Button","Vote"],t.overlaymodel.iview.iType)&&t.overlaymodel.iview.slipable&&!$(e.target).is(e.currentTarget))return!1;if(15==t.iType){if(interaction_view.ismobile)var i="touchend touchcancel";else var i="mouseup";var a=!1;$(document).one(i,function(){!a&&t.executeAction(t)&&(a=!0)})}else if(t.executeAction(t),0===t.iType&&_.include(["Link","Image","ImageBlock","TextButton","UserSVG"],t.overlaymodel.iview.iType)){e.gesture.preventDefault();try{var r=document.activeElement.tagName;-1!=["SELECT","INPUT","TEXTAREA"].indexOf(r)&&document.activeElement.blur()}catch(e){}return!1}return"hold"==n?(e.gesture.preventDefault(),!1):void 0})}},renderforanimationaction:function(){var e=this,t=this.model.page.iAnimationlist.get(this.animation_id);if(t){var i={type:"animation",page_id:this.page_id,overlay_id:this.overlay_id,animation_id:this.animation_id,path:this.path,layer_id:this.layer_id,func:function(t){e.executeAction(e,t)}};this.layer_id&&(i.iPage_id=this.model.iPage_id),6==this.iType&&interaction_view.events.animationStartEvents.push(i),7==this.iType&&interaction_view.events.animationEndEvents.push(i)}},renderforlayer:function(){var e=this,t=this.model.get("layerid"),i=this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).toJSON().iDetail.layer_ids.indexOf(t);return-1==i?!1:(0==this.iType&&this.model.parentpage&&this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.children(".Element").on("click",function(t){return!$(t.target).is(t.currentTarget)&&$(t.currentTarget).find(".layer-content").first().children().length>1?!1:void(e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex==i&&e.testControlforLayer(t)&&e.executeAction(e))}),3==this.iType&&(interaction_view.isWeixin&&52==e.actiontype&&this.patchPlay($(document),e),interaction_view.events.pageStartEvents.push({type:"page",page_id:e.model.pageid,layer_id:this.model.get("layerid"),func:function(t){e.executeAction(e,t)}})),void(4==this.iType&&this.model.parentpage&&(this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.addClass("hasDblClick"),this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.children(".Element").on("dblclick",function(t){$(t.target).closest(".layer-item").index()==e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex&&e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex==i&&e.testControlforLayer(t)&&e.executeAction(e)}),interaction_view.touchview&&this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.children(".Element").hammer().on("doubletap",function(t){$(t.target).closest(".layer-item").index()==e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex&&e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex==i&&e.testControlforLayer(t)&&e.executeAction(e)}))))},renderforpage:function(){var e=this;if(0==this.iType)interaction_view.events.pageClickEvents.push({type:interaction_view.getPageType(e),page_id:e.model.page.id,func:function(t){e.executeAction(e,t)}});else if(3==this.iType)interaction_view.isWeixin&&52==e.actiontype&&this.patchPlay($(document),e),interaction_view.events.pageStartEvents.push({type:"page",page_id:e.model.page.id,func:function(t){e.executeAction(e,t)}});else if(4==this.iType)interaction_view.events.pageDblClickEvents.push({type:interaction_view.getPageType(e),page_id:e.model.page.id,func:function(t){e.executeAction(e,t)}});else if(51==this.iType)interaction_view.events.pageWXShareSuccessEvents.push({type:interaction_view.getPageType(e),page_id:e.model.page.id,func:function(t){e.executeAction(e,t)}});else if(_.include([36,37,38,39],this.iType)){interaction_view.events.pageSwipeEvents.push({type:interaction_view.imasterlist.length&&e.model.page.id==interaction_view.imasterlist.at(0).id?"master":"page",page_id:e.model.page.id,func:function(t){e.executeAction(e,t)},swipeType:this.iType});var t={36:"onSwipeUp",37:"onSwipeDown",38:"onSwipeLeft",39:"onSwipeRight"}[this.iType],i=$(Reveal.getSlideItemById(e.model.page.id)),n=i.data("swipeActionSet")||{};n[t]=!0,i.data("swipeActionSet",n)}else _.include([40],this.iType)?interaction_view.events.pageShakeEvents.push({type:interaction_view.imasterlist.length&&e.model.page.id==interaction_view.imasterlist.at(0).id?"master":"page",page_id:e.model.page.id,func:function(t){e.executeAction(e,t)}}):80==this.iType?"undefined"!=typeof configpage&&configpage.actions.push({func:function(t){e.executeAction(e,t)}}):60==this.iType&&interaction_view.events.orientationChangeEvents.push({type:interaction_view.imasterlist.length&&e.model.page.id==interaction_view.imasterlist.at(0).id?"master":"page",page_id:e.model.page.id,func:function(t){e.executeAction(e,t)}})},patchPlay:function(e,t){e.one("touchstart",function(e){if(interaction_view.isWeixin&&"VIDEO"==e.target.tagName&&!Reveal.getUp()&&!Reveal.getDown())return!1;var i=t.model.attributes.iDetail.results[0].values;i&&_.each(i,function(e){var i=e.page_id,n=interaction_view.getAnimationPage(i,t.model.page),a=n.iOverlaylist.get(e.id);if(a)var r=a.poster&&a.poster.is(":hidden");if(a&&a.media&&"undefined"!=typeof a.media.currentTime&&a.iview&&!a.media.patchPlayed){try{var o=a.media.currentTime>0&&!a.media.paused&&!a.media.ended&&a.media.readyState>2;o||(a.media.play(),a.media.pause(a),a.media.seek(a,0))}catch(s){}!r&&a.poster&&a.poster.show(),a.media.patchPlayed=!0}})})},renderforslideindex:function(){if("CycleImage"!=this.overlaymodel.iview.iType&&"Slide"!=this.overlaymodel.iview.iType,!(this.overlaymodel.iview.slideel&&this.overlaymodel.iview.slidelength>0&&this.overlaymodel.iview.slidelength>this.index))return!1;var e=this;0==this.iType&&(this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').addClass("hasaction"),this.overlaymodel.iview.useIndex&&this.overlaymodel.iview.$el.children(".Element").addClass("hasaction"),"Flow"==this.overlaymodel.iview.detail.iFade?this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').hammer().on("tap",function(t){return e.overlaymodel.iview.currentIndex!=e.index||e.overlaymodel.iview.CoverFlow.data("CoverFlowDisableClick")?void 0:(setTimeout(function(){e.executeAction(e)},300),t.gesture.preventDefault(),!1)}):this.overlaymodel.iview.$el.children(".Element").on("tap",function(t){return e.overlaymodel.iview.slipable&&!$(t.target).is(t.currentTarget)?!1:e.overlaymodel.iview.currentIndex==e.index?(setTimeout(function(){e.executeAction(e)},300),t.preventDefault(),!1):void 0})),5==this.iType&&interaction_view.events.elementChangeToEvents.push({type:"slide",page_id:e.model.iPage_id,overlay_id:this.overlaymodel.id,index:this.index,func:function(t){e.executeAction(e,t)}}),4==this.iType&&(this.overlaymodel.iview.$el.addClass("hasDblClick"),this.overlaymodel.iview.useIndex?(this.overlaymodel.iview.$el.children(".Element").on("dblclick",function(t){e.overlaymodel.iview.currentIndex==e.index&&e.executeAction(e)}),interaction_view.ismobile&&this.overlaymodel.iview.$el.children(".Element").hammer().on("doubletap",function(t){e.overlaymodel.iview.currentIndex==e.index&&e.executeAction(e)})):(this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').on("dblclick",function(t){e.executeAction(e)}),interaction_view.ismobile&&this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').hammer().on("doubletap",function(t){e.executeAction(e)})))},renderforapplication:function(){var e=this;70==this.iType&&interaction_view.events.formSubmitEvents.push({type:70,id:this.app_id,func:function(t){e.executeAction(e,t)}})},executeAction:function(e,t,i){if("undefined"!=typeof Reveal&&Reveal&&Reveal.isOverview()&&3!=e.iType)return!1;if(!e.model||!e.model.iPage_id||-1==Reveal.slideIdsArray.indexOf(e.model.iPage_id)||e.model.iPage_id==interaction_view.currentPage){var n;if(interaction_view.DEBUG&&(n={iType:99==this.iType?this.customType:this.iType,actionType:this.actiontype,page_id:e.model.pageid,overlay_id:this.overlaymodel?this.overlaymodel.id:"",animation_id:this.animation_id,layer_id:this.layer_id,app_id:this.app_id,index:this.index,category:this.actionCate}),t||(t=interaction_view.queue),e.model.attributes.layer_id&&(interaction_view.expression.InsideLayerRange=e.model.page),0==e.actiontype&&t.immediate(e.renderanimations,null,{debug:n}),1==e.actiontype&&t.immediate(e.rendershow,null,{debug:n}),2==e.actiontype&&t.immediate(e.renderhide,null,{debug:n}),6==e.actiontype&&t.immediate(e.setElementTo,null,{debug:n}),5==e.actiontype&&(interaction_view.foredit?global.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderpage,null,{debug:n})),7==e.actiontype&&(interaction_view.foredit?global.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderoverview,null,{debug:n})),8==e.actiontype&&(interaction_view.foredit?global.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.rendershare,null,{debug:n})),10==e.actiontype&&(interaction_view.foredit?global.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderurl,null,{debug:n})),16==e.actiontype&&(interaction_view.foredit?global.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.rendertel,null,{debug:n})),15==e.actiontype&&_g.device.android()&&window.collecting&&window.collecting.startFunction){var a=function(){var e=interaction_view.currentPage,t=interaction_view.ipagelist.getPage(e);if(t){var i=t.toJSON().nav&&t.toJSON().nav.thumbnail?t.toJSON().nav.thumbnail:null,n=interaction_view.doc.toJSON().title;window.collecting.startFunction(n,i,e)}};t.immediate(a,null,{debug:n})}if(this.overlaymodel&&"Button"==this.overlaymodel.toJSON().iType&&this.overlaymodel.get("isTabBarButton")&&t.immediate(e.syncTabButtons,null,{debug:n}),_.include([17,18,19,20,21,52,53,54,60,72,73,100],e.actiontype))if(20==e.actiontype){var a=function(){e.renderNormal(e.actiontype,this)};t.add(a,null,{debug:n})}else t.immediate(function(){e.renderNormal(e.actiontype,null,{debug:n})});if(_.include([50],e.actiontype)&&t.immediate(e.renderWXShareImg,null,{debug:n}),_.include([51],e.actiontype)&&t.immediate(function(){e.renderWXShare(e.actiontype,null,{debug:n})}),_.include([56,57],e.actiontype)&&t.immediate(function(){e.renderParagraph(e.actiontype,null,{debug:n})}),_.include([58],e.actiontype)&&t.immediate(function(){e.setButtonToActive(e.actiontype,null,{debug:n})}),70==e.actiontype&&t.immediate(function(){window.setTimeout(function(){e.submitForm(e.actiontype,null,{debug:n})},500)}),71==e.actiontype){var a=function(){e.setFormValue(this)};t.add(a)}_.include([59],e.actiontype)&&t.immediate(e.renderreplaceresource,null,{debug:n}),61==e.actiontype&&e.playElementTo(),80==e.actiontype&&(interaction_view.foredit?interaction.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderSharePage,null,{debug:n})),81==e.actiontype&&(interaction_view.foredit?interaction.message("warning","请使用预览全部模式预览该功能"):t.immediate(function(){e.renderShareMode(e.actiontype,null,{debug:n})})),82==e.actiontype&&(interaction_view.foredit?interaction.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderSharedataSubmit,null,{debug:n})),90==e.actiontype&&(interaction_view.foredit?interaction.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderEvents,null,{debug:n})),110==e.actiontype&&t.immediate(e.renderJS,null,{
debug:n}),101==e.actiontype&&(interaction_view.foredit?interaction.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderPreloadPages,null,{debug:n})),102==e.actiontype&&(interaction_view.foredit?interaction.message("warning","请使用预览全部模式预览该功能"):t.immediate(e.renderUserdataSubmit,null,{debug:n})),interaction_view.PluginManage.ActionExecutes[e.actiontype]&&interaction_view.PluginManage.ActionExecutes[e.actiontype].exec&&interaction_view.PluginManage.ActionExecutes[e.actiontype].exec(e,t,n,i)}},rendershare:function(){interaction_view.ismobile||share(interaction_view.doc.toJSON().title,context_url+"/player")},renderoverview:function(){Reveal.toggleOverview(!0)},renderclick:function(){},rendershow:function(){var e=this,t=this.values;t&&_.each(t,function(t){var i=t.page_id,n=interaction_view.getAnimationPage(i,e.model.page),a=n.iOverlaylist.get(t.id);if(a&&a.iview&&a.iview.$el)if(t.dom_id)a.iview.$el.find("[es-id="+t.dom_id+"]").show();else{if(a.iview&&a.iview.$el&&a.iview.$el.children()&&!a.iview.$el.children().is(":hidden"))return;a.iview.onBeforeShow&&a.iview.onBeforeShow(),a.iview.$el.removeClass("hide"),a.iview.onShow&&a.iview.onShow()}})},renderhide:function(){var e=this,t=this.values;t&&_.each(t,function(t){var i=t.page_id,n=interaction_view.getAnimationPage(i,e.model.page),a=n.iOverlaylist.get(t.id);a&&a.iview&&a.iview.$el&&(t.dom_id?a.iview.$el.find("[es-id="+t.dom_id+"]").hide():(a.iview.onBeforeHide&&a.iview.onBeforeHide(),a.iview.$el.addClass("hide"),a.iview.onHide&&a.iview.onHide()))})},renderpage:function(){var e=this.model.toJSON().iDetail,t=this.values,i=e.results[0].iActionDetail?e.results[0].iActionDetail.redirect:0,n=e.results[0].iActionDetail&&e.results[0].iActionDetail.transition?e.results[0].iActionDetail.transition:0,a=interaction_view.getVarsOp(interaction_view.currentPage,[0,2]);if(a.beginWithAT(t)){var r=interaction_view.ipagelist.getPages().length;t=Math.round(a.var2val(t)),0>t&&(t=0),t>r-1&&(t=r-1),t=interaction_view.ipagelist.getPages()[t]?interaction_view.ipagelist.getPages()[t].id:null}t&&presentation.gotopagebyargs(t,n,i)},renderSharePage:function(){var e=(this.model.toJSON().iDetail,this.values),t=e||"first";("current"==t||interaction_view.share_page_id!=t)&&(interaction_view.share_page_id=t,interaction_view.weixin.share())},renderShareMode:function(e){switch(e){case 81:interaction_view.environment.Sharedata.reset()}},renderurl:function(){function e(){if(interaction_view.ismobile){var e=window.location.href;void 0===window.__wxjs_is_wkwebview&&(e=_g.changeURLPar(e,"pageid",interaction_view.currentPage),window.history.pushState({},"",e)),window.location.href=i}else window.open(i,"_blank")}if(0!=this.values.length&&!_.isEmpty(this.values[0].url)){var t,i=this.values[0].url;if(t=i.match(/(http:\/\/|https:\/\/)([\w.:]+)/),0==i.indexOf("@"))return void window.open(i,"_blank");if(["/","."].indexOf(i[0])>-1)return void(window.location.href=i);if(t&&t.length>2&&t[2]==window.location.host)return void(window.location.href=i);if(-1==i.indexOf("://")&&(i="http://"+i),window.location.href.indexOf("query_string")>0&&(i+=i.indexOf("?")>=0&&"&"+window.location.search.replace("?","")||window.location.search),t=i.match(/\w+:\/\//),t&&-1==["https://","http://"].indexOf(i.match(/\w+:\/\//)[0]))return void(window.location.href=i);var n=interaction_view.checkicp(i);return 200!=n?414==n?void interaction_view.errorAlert('<div>该网址被腾讯电脑管家检测为危险，停止访问!</div><div class="url">'+i+"</div>"):void(wx_config.LOGO?interaction_view.confirmBox('<div>新打开网址无法确定是否安全，是否继续访问?</div><div class="url">'+i+"</div>",e):e()):void e()}},rendertel:function(){if(interaction_view.ismobile&&0!=this.values.length&&!_.isEmpty(this.values[0].url)){var e=new promise.Promise,t=this.values[0].url;return interaction_view.expression.id2values(t,function(t){window.location="tel:"+t,e.done()}),e}},renderVariable:function(e,t){var i=new promise.Promise,n=_g.uuid(2);if(e&&e.iview)e.iview.setVariable?(DB.Cache.addSwitch(n),e.iview.setVariable(t.oper,t.value,null,function(){i.done(),DB.Cache.closeSwitch(n)})):e.iview.updateText?(DB.Cache.addSwitch(n),interaction_view.expression.id2values(t.value,function(t){e.iview.updateText(t,addtourl=1),i.done(),DB.Cache.closeSwitch(n)})):e.iview.updateDom?(DB.Cache.addSwitch(n),interaction_view.expression.id2values(t.value,function(a){e.iview.updateDom(t.dom_id,a),i.done(),DB.Cache.closeSwitch(n)})):i.done();else if(e=interaction_view.globallist.get(t.id)){var a=e.attributes.iDetail,r=t.id,o=Number(t.oper);switch(o){case 0:DB.Cache.addSwitch(n),interaction_view.expression.id2values(t.value,function(e){var t=e;interaction_view.expression.setGlobal(r,t),i.done(),DB.Cache.closeSwitch(n)});break;case 1:DB.Cache.addSwitch(n),interaction_view.expression.id2values(t.value,function(t){var a;0==e.attributes.iDetail.iKind?(_.isNaN(Number(e.attributes.iDetail.initial))||(e.attributes.iDetail.initial=Number(e.attributes.iDetail.initial)),a=e.attributes.iDetail.initial+Number(t)):a=e.attributes.iDetail.initial+t,interaction_view.expression.setGlobal(r,a),i.done(),DB.Cache.closeSwitch(n)});break;case 2:DB.Cache.addSwitch(n),interaction_view.expression.id2values(t.value,function(t){0==e.attributes.iDetail.iKind&&(_.isNaN(Number(e.attributes.iDetail.initial))||(e.attributes.iDetail.initial=Number(e.attributes.iDetail.initial)));var a=e.attributes.iDetail.initial-t;interaction_view.expression.setGlobal(r,a),i.done(),DB.Cache.closeSwitch(n)});break;case 3:var s=interaction_view.setRandom(a);interaction_view.expression.setGlobal(r,s),i.done()}}else i.done();return i},renderNormal:function(e,t){var i=this,n=this.values,a=[];if(n){var r=_g.uuid(2);DB.Cache.addSwitch(r),_.each(n,function(t){var n=t.page_id,r=interaction_view.getAnimationPage(n,i.model.page),o=r.iOverlaylist.get(t.id);if(o&&o.iview)switch(e){case 17:o.iview.startTimer();break;case 18:o.iview.stopTimerSimple();break;case 19:o.iview.resetTimer();break;case 20:a.push(i.renderVariable(o,t));break;case 21:interaction_view.events.onVariableChanged(o.iview);break;case 52:interaction_view.media.play(o);break;case 53:interaction_view.media.pause(o);break;case 54:interaction_view.media.stop(o);break;case 60:o.iview.activeEdit&&setTimeout(function(){o.iview.activeEdit(!0)},500);break;case 72:o.iview.getInfo();break;case 73:o.iview.postInfo();break;case 100:interaction_view.events.onSystemVariableChanged(o.iview)}else a.push(i.renderVariable(o,t))}),DB.Cache.closeSwitch(r),a.length?promise.join(a).then(function(e){t&&t.done()}):t&&t.done()}},renderWXShare:function(e){var t=this.values;if(t){var i=(t.page_id,t.value);console.log("set sharing: "+i),(_g.device.mobile()||_g.device.tablet())&&(i=interaction_view.expression.id2values(i)),i&&i.replace&&(i=i.replace(/<br>+/g,"\n").replace(/"+/g,"'").replace(/<\/div><div>/g,"\n").replace(/<div>/g,"").replace(/<\/div>/g,"").replace(/'/g,"")),shareTitle=i,msgContent=shareTitle,interaction_view.weixin.share()}},renderParagraph:function(e){switch(e){case 56:interaction_view.environment.Paragraph.enable();break;case 57:interaction_view.environment.Paragraph.disable()}},renderJS:function(){if(0!=this.values.length)if(this.values[0].api&&"undefined"!=typeof e_api)try{e_api.custom[this.values[0].api]&&e_api.custom[this.values[0].api]()}catch(e){console.log(e);var log="[自定义JS执行报错] "+e;e_Debug.push(log)}else if(!_.isEmpty(this.values[0].code)){var code=_.unescape(this.values[0].code);eval(code)}},setButtonToActive:function(){if(this.values&&0!=this.values.length){var e=this,t=(this.model.toJSON().iDetail,this.values[0].id),i=this.values[0].page_id,n=interaction_view.getAnimationPage(i,e.model.page);if(t){var a=n.iOverlaylist.get(t);a&&!a.iview.active&&a.iview.$el.find("img.iconNormal").length&&a.iview.$el.find("img.iconNormal").trigger("click")}}},renderreplaceresource:function(){if(this.values&&0!=this.values.length){var e,t=this,i=this.model.toJSON().iDetail;if(overlay_id=this.values[0]?this.values[0].id:"",pageid=this.values[0]?this.values[0].page_id:"",page=interaction_view.getAnimationPage(pageid,t.model.page),overlay_id&&(e=page.iOverlaylist.get(overlay_id))){var n=e.get("iType"),a=i.results[0].iActionDetail?i.results[0].iActionDetail.replace:null,r=i.results[0].iActionDetail?i.results[0].iActionDetail.url:null,o=e.attributes.iDetail.iEditable;if(a){if(1==a&&"ImageBlock"==n&&(interaction_view.forceUpload?interaction_view.localIds&&e.iview.setweixinimage(interaction_view.localIds):"undefined"!=typeof wx_permissions&&wx_permissions.chooseImage?interaction_view.localIds?e.iview.setweixinimage(interaction_view.localIds[0]):interaction_view.weixin.chooseimage(function(t){t&&(interaction_view.localIds=t,e.iview.setweixinimage(t[0]))}):_g.device.isWeixin()?interaction_view.errorAlert("开启微信功能失败"):interaction_view.errorAlert("请在微信中操作")),2==a&&"Audio"==n)if("undefined"!=typeof wx_permissions&&wx_permissions.startRecord){var s=function(){if(interaction_view.voicelocalId){var t=e.iview.getdetail();e.voicelocalId!=interaction_view.voicelocalId&&interaction_view.voiceUploader(interaction_view.voicelocalId,function(i){e.media&&interaction_view.media.changeSrc(e,i),e.voicelocalId=interaction_view.voicelocalId,e.voiceUrl=i,t.iFile[0].file=i,e.iview.addToUrl(i)})}};interaction_view.voicelocalId?s(interaction_view.voicelocalId):interaction_view.voiceEditor(function(){s()})}else _g.device.isWeixin()?interaction_view.errorAlert("开启微信功能失败"):interaction_view.errorAlert("请在微信中操作");if(3==a||4==a){if(!r)return;interaction_view.expression.id2values(r,function(t){if("ImageBlock"==n){var i=(e.iview.$el.children(".Element").find("img"),e.iview.getdetail());"reset"==t?("undefined"!=typeof i.iImg[0].origin?(e.iview.replaceImg(i.iImg[0].origin),i.iImg[0].picture=i.iImg[0].origin):(e.iview.replaceImg(""),i.iImg[0].picture=""),o&&"undefined"!=typeof e.iview.removeFromUrl&&e.iview.removeFromUrl()):(e.iview.replaceImg(t),i.iImg[0].picture=t,o&&e.iview.addToUrl(t,0,0,1,0))}else if("Audio"==n){var i=e.iview.getdetail();e.media&&(interaction_view.media.changeSrc(e,t),interaction_view.media.play(e)),i.iFile[0].file=t,o&&e.iview.addToUrl(t)}})}if(5==a&&"ImageBlock"==n&&"undefined"!=typeof epub360_userinfo){var l=(e.iview.$el.children(".Element").find("img"),e.iview.getdetail()),r=epub360_userinfo.portrait;e.iview.replaceImg(r),l.iImg[0].picture=r,o&&e.iview.addToUrl(r,0,0,1,0)}}}}},renderWXShareImg:function(){var e=this,t=this.values;if(t&&t[0]){if("微信头像"==t[0].id)"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.portrait&&(imgUrl=epub360_userinfo.portrait);else{var i=t[0].page_id,n=interaction_view.getAnimationPage(i,e.model.page),a=n.iOverlaylist.get(t[0].id);if(a&&a.iview&&a.iview.$el){var r=a.iview.$el.find("img");if(r.length>0){var o=r.attr("src");if(0==o.indexOf("http://"))imgUrl=o;else{var s=a.iview.getdetail();imgUrl=s.iImg[0].picture}}else if(r=a.iview.$el.find(".bk_full"),r.length>0){var l=r.css("background-image"),c=/\url\((\S+)\)/.exec(l);if(null!=c){var d=c[1];/\"(\S+)\"/.exec(d)?imgUrl=/\"(\S+)\"/.exec(d)[1]:/\'(\S+)\'/.exec(d)?imgUrl=/\'(\S+)\'/.exec(d)[1]:imgUrl=d}}}}interaction_view.weixin.share()}},renderEvents:function(){var e=this.values,t="www.epub360.com";if(current_host=window.location.host,-1!=current_host.indexOf("tu960")&&(t=current_host),e.length&&e[0].opt_label&&interaction_view.book_id){var i=e[0].opt_label,n=e[0].opt_action,a="http://"+t+"/manage/book/"+interaction_view.book_id+"/event.gif?opt_category=custom&opt_action="+n+"&opt_label="+i+"&t="+_g.uuid(),r=document.createElement("img");r.src=a,r.onload=function(){}}},setElementTo:function(){if(this.values&&0!=this.values.length){var e=this,t=this.model.toJSON().iDetail,i=this.values[0].id,n=this.values[0].page_id,a=interaction_view.getAnimationPage(n,e.model.page),r=t.results[0].iActionDetail?t.results[0].iActionDetail.index:null,o=interaction_view.getVarsOp(n,[0,2]);if(o.beginWithAT(r)&&(r=o.var2val(r)),i){var s=a.iOverlaylist.get(i);s&&s.iview&&s.iview.setElementTo(r)}if(this.overlaymodel&&"Button"==this.overlaymodel.toJSON().iType){var l=this.syncbuttons(a,this.model.toJSON().overlay_id,this.values[0]);l>0&&(this.overlaymodel.iview.groupcontrol=!0)}}},playElementTo:function(){if(this.values&&0!=this.values.length){var e=this,t=this.model.toJSON().iDetail,i=this.values[0].id,n=this.values[0].page_id,a=interaction_view.getAnimationPage(n,e.model.page),r=t.results[0].iActionDetail?t.results[0].iActionDetail.mode:0,o=t.results[0].iActionDetail&&t.results[0].iActionDetail.repeat?-1:0,s=t.results[0].iActionDetail?t.results[0].iActionDetail.p_from:0,l=t.results[0].iActionDetail?t.results[0].iActionDetail.p_to:0;if(i){var c=a.iOverlaylist.get(i);if(c&&c.iview){if(4==r&&c.iview.timeline&&(c.iview.timeline.pause(),c.iview.timeline.playing=!1),0==r||1==r){var d=c.toJSON().iDetail.iImg.length;if(!d)return;0==r?(c.iview._start=0,c.iview._end=d-1,c.iview.direction=0):(c.iview.direction=1,c.iview._start=d-1,c.iview._end=0),c.iview.autoplay=!0,c.iview.repeat=o;var h=c.iview._setCanvasLoopSwitch(!0);c.iview.timeline.play(h),c.iview.timeline.playing=!0}if(2==r){c.iview._start=s,c.iview._end=l,c.iview.direction=s-l>0?1:0,c.iview.autoplay=!0,c.iview.repeat=o;var h=c.iview._setCanvasLoopSwitch(!0);c.iview.timeline.play(h),c.iview.timeline.playing=!0}if(3==r){c.iview.currentIndex||(c.iview.currentIndex=0),c.iview._start=c.iview.currentIndex,c.iview._end=l,c.iview.direction=c.iview.currentIndex-l>0?1:0,c.iview.autoplay=!0,c.iview.repeat=o;var h=c.iview._setCanvasLoopSwitch(!0);c.iview.timeline.play(h),c.iview.timeline.playing=!0}}}}},syncbuttons:function(e,t,i){var n=this,a=0,r=_.filter(this.model.page.iActionlist.toJSON(),function(e){return n.model.page.iOverlaylist.get(e.overlay_id)&&"Button"==n.model.page.iOverlaylist.get(e.overlay_id).get("iType")&&6==e.iDetail.results[0].iAction});return _.each(r,function(e){if(e.overlay_id!=t){var r=n.model.page.iOverlaylist.get(e.overlay_id);r&&r.toJSON().iDetail.isSwitch&&e.iDetail.results&&e.iDetail.results[0].values[0].id==i.id&&e.iDetail.results[0].values[0].page_id==i.page_id&&(a+=1,r.iview.resetButtonStatus())}}),a},syncTabButtons:function(){var e=this,t=this.overlaymodel.get("path"),i=interaction_view.getContainerModelByPath(t);i.iOverlaylist.each(function(t){t.id!=e.overlaymodel.id&&t.iview.resetButtonStatus()})},resetStatus:function(){this.overlaymodel.iview.$el.off("click")},testControlforLayer:function(e){var t=$(e.target).closest(".iView");if($(e.target).closest(".iView").hasClass("hasaction"))return!1;if(t){var i=t.attr("data-type");if(("Slide"==i||"CycleImage"==i)&&t.attr("data-iSlipable"))return!1}return!0},submitForm:function(){return this.values?void interaction_view.application.submitForm(this.values):!1},setFormValue:function(e){var t=this.model.toJSON().iDetail;if(!this.values)return e.done(),!1;var i=t.results[0].cid,n=t.results[0].vT,a=t.results[0].vV,r=this.values;interaction_view.expression.id2values(a,function(e){interaction_view.application.setFormData(r,i,Number(n),e)},{_promise:e})},renderPreloadPages:function(){if(this.values||this.values.length){this.model.toJSON().iDetail;_e.preloadpage.preload(this.values,this.preload_hash)}},renderUserdataSubmit:function(){var e=this;if(interaction_view.environment.Userdata.share(),this.values&&this.values.length){for(var t=[],i=0;i<this.values.length;i++){var n=this.values[i].page_id,a=interaction_view.getAnimationPage(n,e.model.page),r=this.values[i].id;if(r){var o=a.iOverlaylist.get(r);o&&o.iview&&t.push(o.iview)}}interaction_view.environment.Userdata.setitems(t,function(){interaction_view.events.onUserdataSave(e)})}},renderSharedataSubmit:function(){var e=this;interaction_view.environment.Sharedata.setitems(function(){interaction_view.events.onSharedataSave(e)})}}),interaction_view.iActionlist=new interaction_view.collection.Action}),define("interaction_view/model/animation_view",["interaction_view/model/base"],function(){interaction_view.model.Animation=interaction_view.model.Base.extend({defaults:{},setcollection:function(){},setmodel:function(){},setAnimation:function(){this._animation=new animation({collection:this.collection,animation:this.toJSON()})}}),interaction_view.collection.Animation=interaction_view.collection.Base.extend({initialize:function(){},model:interaction_view.model.Animation,setonadd:function(){this.on("add",function(e){})},setParams:function(e){if(this.repeatTweens=[],0!=this.where({iKind:0}).length){var t=this;if(this.cssAnimations=[],this.Animations=[],this.each(function(e){e.tween=null;var i=e.toJSON();return i.iType>0&&i.iType<100?void t.cssAnimations.push(i):0!=i.iKind||t.page.iOverlaylist.get(i.overlay_id)?void("undefined"!=typeof animation&&(t.Animations.push(e),e._animation=new animation({collection:t,animation:e.toJSON()}))):void(e._error=!0)}),this.cssAnimations.length&&"undefined"!=typeof Animate){this.cssitems=[];for(var i=0;i<this.cssAnimations.length;i++){var n=t.page.iOverlaylist.get(this.cssAnimations[i].overlay_id);if(n){var a={el:n.iview.$el.children(".Element"),type:this.cssAnimations[i].iType,delay:this.cssAnimations[i].iTiming.delay,duration:this.cssAnimations[i].iTiming.duration,repeat:this.cssAnimations[i].iTiming.repeat,onShow:n.iview.onShow};this.cssitems.push(a)}}this.css_timeline=new Animate({items:this.cssitems})}}},tryGlobalPage:function(e){return interaction_view.ibackgroundlist.length&&e==interaction_view.ibackgroundlist.models[0].id?interaction_view.ibackgroundlist.models[0]:interaction_view.imasterlist.length&&e==interaction_view.imasterlist.models[0].id?interaction_view.imasterlist.models[0]:null},getGlobalCache:function(){var e=interaction_view.ibackgroundlist.length&&interaction_view.ibackgroundlist.models[0].runtimeCache?interaction_view.ibackgroundlist.models[0].runtimeCache.timelineControl:{},t=interaction_view.imasterlist.length&&interaction_view.imasterlist.models[0].runtimeCache?interaction_view.imasterlist.models[0].runtimeCache.timelineControl:{};return $.extend(!0,{},e,t)},recordHashUltra:function(e,t){var i=e.Animations,n=e.iPage_id,a=a||this,r=interaction_view.getPage(interaction_view.currentPage);r.runtimeCache=r.runtimeCache||{};var o,s=r.runtimeCache,l=a.tryGlobalPage(n);l&&(l.runtimeCache=l.runtimeCache||{},l.runtimeCache.timelineControl=l.runtimeCache.timelineControl||{hashMap:{}},o=l.runtimeCache.timelineControl),s.timelineControl=s.timelineControl||{from:{page:r,master:interaction_view.imasterlist.at(0),background:interaction_view.ibackgroundlist.at(0)},hashMap:{}},s=s.timelineControl;var c=i.filter(function(e){return!(0==e.attributes.iKind&&void 0!=e.attributes.iGroup_id)}).filter(function(e){return 0==e.attributes.iTiming.waitaction}).map(function(e){return{id:e.attributes.id,page_id:e.attributes.page_id}});if(c.length){var d=a.hashFlag(c),h=c[0].page_id,u=[{page_id:h,id:"timeline"}],p=a.hashFlag(u);o&&(o.hashMap[p]={list:u,timeline:t,alias:d},o.hashMap[d]={list:c,timeline:t}),s.hashMap[p]={list:u,timeline:t,alias:d},s.hashMap[d]={list:c,timeline:t},r.runtimeCache.timelineControl=$.extend(!0,{},s,a.getGlobalCache())}},hashFlag:function(e){var t=e.reduce(function(e,t){var n=""+t.id.slice(-6)+t.page_id.slice(-6);for(i=0;i<n.length;i++)char=n.charCodeAt(i),e=(e<<5)+e+char;return e},5381);return t},setPlay:function(e){var t=t||this;if(this.Animations&&0!=this.Animations.length){var i=function(){},n=animateTimeline.generateTimeline({onStart:i,animations:this.Animations,iPage_id:this.iPage_id,page:this.page,paused:!0});this.timeline=n,t.recordHashUltra(this,n)}},play:function(){0!=this.length&&(this.setPlay(),this.timeline&&this.timeline.play(0))},playMain:function(){0!=this.length&&(this.setParams(),this.setPlay(),this.timeline&&this.timeline.play(0,!1),this.afterTimeLineCreated&&this.afterTimeLineCreated())},AddClickTween:function(e,t,i,n){interaction_view.SinglePreview||(e.pause(n),console.log(n),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","pointer"),interaction_view.events.pageClickEvents.push({type:"waitaction",page_id:t,func:function(){console.log(i),_.include([101,102,103,104],i.attributes.iType)&&(i.attributes.iTiming.delay?_g.device.android()&&101==i.attributes.iType&&window.setTimeout(function(){i._animation.showelement()},i.attributes.iTiming.delay):i._animation.showelement()),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),e.resume()}}))},AddPageSwipeTween:function(e,t,i,n,a){interaction_view.SinglePreview||(console.log(a),e.pause(a),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","pointer"),interaction_view.events.pageSwipeEvents.push({type:"waitaction",page_id:t,func:function(){_.include([101,102,103,104],n.attributes.iType)&&(n.attributes.iTiming.delay?_g.device.android()&&101==n.attributes.iType&&window.setTimeout(function(){n._animation.showelement()},n.attributes.iTiming.delay):n._animation.showelement()),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),e.resume()},swipeType:i+33}))},AddPageShakeTween:function(e,t,i,n,a){interaction_view.SinglePreview||(console.log(a),e.pause(a),interaction_view.events.pageShakeEvents.push({type:"waitaction",page_id:t,func:function(){_.include([101,102,103,104],n.attributes.iType)&&(n.attributes.iTiming.delay?_g.device.android()&&101==n.attributes.iType&&window.setTimeout(function(){n._animation.showelement()},n.attributes.iTiming.delay):n._animation.showelement()),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),e.resume()}}))},AddRepeatClickTween:function(e,t,i,n){interaction_view.SinglePreview||($('section[id="'+t+'"]').children(".interaction-view").css("cursor","pointer"),interaction_view.events.pageClickEvents.push({type:"waitaction",page_id:t,func:function(){$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),i.pause(),n._animation.stop(i)}}))},AddMediaTween:function(e){var t=e.collection.page;if(interaction_view.SinglePreview){var i=t.iAnimationlist.timeline.getLabelTime(interaction_view.PreviewItemId+"_start"),n=t.iAnimationlist.timeline.getLabelTime(e.id+"_start");if(i>n)return}var a=t.iOverlaylist.get(e.get("overlay_id")),r=e.get("iType");a.onAnimationStart={overlay_id:e.get("overlay_id"),animation_id:e.id,page_id:t.id,layer_id:e.collection.layerid},interaction_view.events.onAnimationStart(a.onAnimationStart),501==r&&("Audio"==a.get("iType")||"Video"==a.get("iType")||"QQVideo"==a.get("iType")?interaction_view.media.play(a):a.iview.playTimeline()),502==r&&("Audio"==a.get("iType")||"Video"==a.get("iType")||"QQVideo"==a.get("iType")?a.loaded&&(interaction_view.media.pause(a),a.iview.slider&&a.iview.sliderstop()):a.iview.pauseTimeline()),503==r&&("Audio"==a.get("iType")||"Video"==a.get("iType")||"QQVideo"==a.get("iType")?a.loaded&&a.media&&(a.iview.resetOtherStatus(),a.iview.slider&&(a.iview.sliderstop(),a.iview.onSliderChange(0))):a.iview.stopTimeline()),(502==r||503==r)&&a.onAnimationStart&&(interaction_view.events.onAnimationEnd(a.onAnimationStart),a.onAnimationStart=null),t.iAnimationlist.onComplete(e.id)},getMediaTime:function(e){var t=0,i=e.collection.page.iOverlaylist.get(e.toJSON().overlay_id);return i.media?("Audio"==i.get("iType")||"Video"==i.get("iType"))&&(t=i.hls?i.media.getDuration():i.media.duration):_.include(["CycleImage","Slide","LayerSlide"],i.get("iType"))&&(t=i.iview.getSlideDuration()),t},onSingleComplete:function(){},onUpdate:function(){},onTotalComplete:function(){},onComplete:function(e){},resetAnimationStatus:function(){_.each(this.repeatTweens,function(e){e.kill()}),this.repeatTweens=[],this.timeline&&this.timeline.pause(0)}}),interaction_view.view.Animation=interaction_view.view.Base.extend({initstart:function(){}})}),define("text!interaction_view/template/audiocontrol.tpl",[],function(){return'<div class="audiobar disableDragX disableDragY" style="height: 31px;width: 100%;position: absolute;">\n  <span class="audio-control status-play"></span>\n  <% if((iCommon[iPageDirection].iWidth-45)>0){%>\n  <span class="ui-slider-green ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" aria-disabled="false" style="width:<%=(iCommon[iPageDirection].iWidth-45)>0?(iCommon[iPageDirection].iWidth-45):0%>px;left: 45px;">\n    <div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min g-slider-range" style="width: 0%;background-color: #444444;">\n    </div>\n    <a class="ui-slider-handle ui-state-default ui-corner-all g-slider-handle" href="#" style="left: 0%;">\n    </a>\n  </span>\n  <% } %>\n</div>'}),define("interaction_view/model/audio",["interaction_view/model/base","text!interaction_view/template/audiocontrol.tpl"],function(){var e=require("text!interaction_view/template/audiocontrol.tpl");interaction_view.model.Audio=interaction_view.model.Base.extend({defaults:{iType:"Audio",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Audio({model:this})},setsyncmodel:function(){}}),interaction_view.view.Audio=interaction_view.view.Base.extend({events:{},bindSliderControl:function(){var e=this;this.$el.find(".audio-control").css("cursor","pointer"),this.$el.find(".audio-control").on("click",function(){return $(this).hasClass("status-play")?e.model.media&&interaction_view.media.play(e.model):$(this).hasClass("status-pause")&&(e.model.media&&interaction_view.media.pause(e.model),e.sliderstop()),!1})},render:function(t){var i=this.getdetail();i.iControl&&this.file&&(this.$el.children(".Element").append(_.template(e,this.model.toJSON())),this.$el.removeClass("hide"))},preload:function(){var e=this.getdetail();this.model.played=!1,this.model.time=0;var t;e.iFile&&e.iFile[0]&&(audio_url_src=this.getFromUrl(),t=""!=audio_url_src?audio_url_src:"undefined"!=typeof epub360&&epub360.settings&&epub360.settings.disable_stream_media?e.iFile[0].file:"undefined"==typeof cbt_data||interaction_view.forpreview?"1"==_g.getUrlParameterByName("-playmode")?(e.iFile[0].file||e.iFile[0].content)+"_audio.m3u8":"2"==_g.getUrlParameterByName("-playmode")?e.iFile[0].file||e.iFile[0].content+"?avthumb/mp3/ab/32k":e.iFile[0].file||e.iFile[0].content+"?avthumb/mp3/ab/32k":e.iFile[0].file||e.iFile[0].content,this.sendToPreload({file:t}),this.file=t)},setOtherDisplay:function(){var e=this.getdetail(),t=this;e.iControl&&this.file&&_g.slider&&(this.slider=new _g.slider({containment:this.$el,onChange:function(e){t.model.media&&interaction_view.media.seek(t.model,null,e)}}),this.bindSliderControl())},resetStatus:function(){this.resetOtherStatus()},resetOtherStatus:function(){return this.model.isBgsound?void this.$el.find(".status-play").addClass("status-pause").removeClass("status-play"):void(this.model.media&&(this.model.hls?interaction_view.media.audio.resetH(this.model):interaction_view.media.audio.reset(this.model),this.slider&&(this.sliderstop(),this.onSliderChange(0))))},sliderplay:function(){this.$el.find(".audio-control").addClass("status-pause").removeClass("status-play")},sliderstop:function(){this.$el.find(".audio-control").removeClass("status-pause").addClass("status-play")},onSliderChange:function(e){console.log("time change "+e),e>100||this.slider.change(e)},getFromUrl:function(){var e=_g.getUrlParameterByName(this.model.id,message_link);if(e||(e=_g.getHashParameterByName(this.model.id)),null==e&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var t=this.model.get("pageid"),i=interaction_view.environment.Sharedata.getitem(t,this.model.id);i&&(e=i.value)}return decodeURI(e||"")},addToUrl:function(e){var t=this.getdetail();if(e==t.iFile[0].origin)return!1;var i=this.model.id+"="+encodeURI(e),n=_g.getUrlParameterByName(this.model.id,message_link),a=0,r=message_link;if(n)encodeURI(n)!=encodeURI(e)?r=_g.replaceUrlParameterByName(this.model.id,i,message_link):a=1;else{var o="?";message_link.indexOf("?")>=0&&(o="&"),r+=o+i}if("epub360"==epub360_domain&&!a&&this.model.id!=bgsound_id&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{value:encodeURI(e)}),a||(message_link=r,interaction_view.weixin.share()),!interaction_view.forpreview){var s=_g.getHashParameterByName(this.model.id);s?encodeURI(s)!=encodeURI(e)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,i)):a=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+i):window.history.replaceState({},"","#"+i))}return a?!1:!0}})}),define("interaction_view/model/cycleimage",["interaction_view/model/base","_g/base"],function(){interaction_view.model.CycleImage=interaction_view.model.Base.extend({defaults:{iType:"CycleImage",iLock:!0,iVisibility:!0,iCommon:{},iDetail:{},iSync:!1,isSlide:!0,iZindex:"-1",iUrl:null,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.loaded=[],this.loaded_index=0,this.iImgs=[],this.iview=new interaction_view.view.CycleImage({model:this})},setsyncmodel:function(){}}),interaction_view.view.CycleImage=interaction_view.view.Base.extend({events:{},render:function(e){var t=this;this.getdetail();this.currentSlideIndex=null,this.model.on("slideTo",function(e){return null!=t.currentSlideIndex&&t.currentSlideIndex==e?!1:void(t.preloaded&&(interaction_view.events.onChangeTo(t.model.iPageId,t.model.id,e),t.currentSlideIndex=e))})},preload:function(){var e=this;this.preloaded=!1;var t,i=this.getdetail();this.img_src=[],this.img_loaded=[];if(i.iImg&&i.iImg.length){this.model._img_preload=!0;for(var n=0;n<i.iImg.length;n++)t=i.iImg[n].picture,e.img_src.push(t),e.img_loaded.push(!1);e.useIndex=!0}},afterpreload:function(e){this.slideel=this.$el.children(".Element").find(".slidecontent").first(),this.setZindex(),this.setElementDisplay(),this.renderCanvas(),this.playAnimation(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style"),this.preloaded=!0},playAnimation:function(){var e=this,t=this.detail,i=t.iSlidetype;null==i&&(i=0),this.delay=Number(t.iInterval)||.01,this.autoplay=t.iAutoplay;var n=t.iRepeat?-1:0;this.slidelength=t.iImg&&t.iImg.length||0,this.repeat=this.init_repeat=n,this.iRewind=t.iRewind,this.slipable=t.iSlipable,this.p_mode=t.p_mode||0,this.p_from=Number(t.p_from)||0,this.p_to=Number(t.p_to)||0,this.direction=this.init_direction=0,this.slidelength&&(this.p_to<0&&(this.p_to=0),this.p_from<0&&(this.p_from=0),this.p_to>this.slidelength-1&&(this.p_to=this.slidelength-1),this.p_from>this.slidelength-1&&(this.p_from=this.slidelength-1),this.p_mode||(this.p_from=0,this.p_to=this.slidelength-1),1==this.p_mode&&(this.direction=this.init_direction=1,this.p_from=this.slidelength-1,this.p_to=0),2==this.p_mode&&(this.direction=this.init_direction=this.p_from-this.p_to>0?1:0),this._start=this.p_from,this._end=this.p_to,this.setTimeline(),this.autoplay&&(this.model._autoplay=!0),this.img_preload(20,null,function(){e.drawCanvas(e.img_src[e.p_from],e.p_from),e.img_preload()}),this.onChangeSlideTo(this.p_from),this.slipable&&(this.control(),this.autoplay||this.$el.attr("data-iSlipable",!0)),this.model._reset=!0)},_autoplay:function(){this.timeline&&(this.$el.children(".Element").is(":hidden")||(this.timeline.play(),this.timeline.playing=!0))},exeutePlay:function(){},setTimeline:function(){this.iFade="LoopSwitch",this._setCanvasLoopSwitch(),this.timeline&&(this.timeline.playing=!1)},testControl:function(){return!0},resetOtherStatus:function(){if(this.slideel){var e=this.getdetail();this.autoplay=e.iAutoplay,this.repeat=this.init_repeat,this.direction=this.init_direction,
this._start=this.p_from,this._end=this.p_to,this.currentIndex=this.p_from,this.useIndex&&(this.indexTime=this.p_from),this.timeline&&(this._setCanvasLoopSwitch(!0),this.ctx.clearRect(0,0,this.canvas_width,this.canvas_height),this.drawCanvas(this.img_src[this.p_from],this.p_from),this.timeline.playing=!1)}},renderCanvas:function(){var e=this.getcommon();this.canvasId="canvas_"+_g.uuid(),this.slideel.append('<canvas id="'+this.canvasId+'" width="'+2*e.iWidth+'" height="'+2*e.iHeight+'" style="pointer-events:none;width:'+e.iWidth+"px;height:"+e.iHeight+'px;"></canvas>'),this.canvas=document.getElementById(this.canvasId),this.canvas_width=e.iWidth,this.canvas_height=e.iHeight,this.canvas&&(this.ctx=this.canvas.getContext("2d")),this.useIndex&&this.slideel.children("img").hide()},drawCanvas:function(e,t){if(e&&""!=e){var i=this;if(this.ctx||(this.ctx=this.canvas.getContext("2d")),!this.ctx)return!1;ctx=this.ctx,interaction_view.drawImg(i,e,t,ctx)}},otherOnShow:function(){if(this.img_src.length){var e;this.timeline&&(e=this.timeline.playing),this._setCanvasLoopSwitch(!0),this.drawCanvas(this.img_src[this.currentIndex],this.currentIndex),(this.model.attributes.iDetail.iAutoplay||e)&&(this.timeline.play(),this.timeline.playing=!0)}},img_preload:function(e,t,i){var n=this;if(n.slidelength){var a=n.model.loaded_index,r=1;1==n.slidelength&&(r=0);if(a>n.slidelength-1)return void(n.model.loaded_all=!0);var o=n.slidelength-a>=20?a+20-1:n.slidelength-1;n.model.loaded_index=o+1;for(var s=0,l=o-a+1;o>=a;a++)interaction_view.iImgs[n.img_src[a]]?(n.model.iImgs[a]=interaction_view.iImgs[n.img_src[a]],n.model.loaded[a]=!0,i&&s==r&&i(),++s>=l&&(t&&t(),e||n.img_preload())):(n.model.iImgs[a]=new Image,n.model.iImgs[a].onload=function(){n.model.loaded[a]=!0,interaction_view.iImgs[this.src]=this,i&&s==r&&i(),++s>=l&&(e||n.img_preload())},n.model.iImgs[a].src=n.img_src[a])}}})}),define("text!interaction_view/template/imageitem.tpl",[],function(){return'<%if(iDetail.iImg&&iDetail.iImg[0]){%>\n    <%if(typeof isSubOverlay!="undefined"&&isSubOverlay&&(typeof isLayerOverlay=="undefined"||!isLayerOverlay)){%>\n        <% if(iDetail.iMask){%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].thumbnail%>" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;">\n        <%}else{%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].thumbnail%>" style="width:100%;height:100%;position:absolute;">\n        <% } %>\n    <%}else{ %>\n        <% if(iDetail.iMask){%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].picture%>" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;">\n        <%}else{%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:100%;position:absolute;">\n        <% } %>\n    <%}%>\n<%}%>'}),define("interaction_view/model/image",["interaction_view/model/base","text!interaction_view/template/imageitem.tpl"],function(){require("text!interaction_view/template/imageitem.tpl");interaction_view.model.Image=interaction_view.model.Base.extend({defaults:{iType:"Image",iLock:!0,iVisibility:!0,iCommon:null,iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParentModel:null,iTemplate:null,iParentdiv:".interaction-view",iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){if(this.attributes.iDetail.iImg&&this.attributes.iDetail.iImg[0]&&this.attributes.iDetail.iImg[0].picture)try{this.attributes.iDetail.iImg[0].picture=this.attributes.iDetail.iImg[0].picture.replace("qin.tu960.com","qn.media.epub360.com")}catch(t){}this.iview=new interaction_view.view.Image({model:this})},setsyncmodel:function(){}}),interaction_view.view.Image=interaction_view.view.Base.extend({events:{},render:function(e){this.renderMask(),this.renderDraggable(),this.firstRender=!0,this.isEraserSet=!1,this.detail.isMasterArrow&&this.$el.addClass("master_arrow_icon")},renderMask:function(){var e=this.getdetail();e.iMask&&(this.$el.children(".Element").find("img").first().css({translate:[e.iMask_data.x,e.iMask_data.y]}),this.iScrollview&&this.iScrollview.scrollTo(e.iMask_data.x,e.iMask_data.y))},preload:function(){},getLayerContentSize:function(){var e=this.getdetail(),t={};return e.iImg&&e.iImg.length>0?(t.width=e.iMask_data.width,t.height=e.iMask_data.height,t):null},setOtherDisplay:function(){var e=this.getdetail();e.iImg&&e.iImg.length>0&&e.iMask&&e.iMask_data.iSlipable&&(this.renderMask(),this.setMaskSlipable({items:this.$el.children(".Element").find("img").first(),containment:this.$el.children(".Element").children(),contentel:this.$el.children(".Element").find("img").first(),content_x:e.iMask_data.x,content_y:e.iMask_data.y})),e.iDisplay&&e.iImg&&e.iImg.length>0&&(this.$el.children(".Element").find("img").length?_g.ui.fitImage({fit:Number(e.iDisplay),width:e.iImg[0].width,height:e.iImg[0].height,items:this.$el.children(".Element").find("img"),parentHeight:parseInt(this.$el.children(".Element").css("height")),parentWidth:parseInt(this.$el.children(".Element").css("width"))}):_g.ui.fitImage({fit:Number(e.iDisplay),containment:this.$el.children(".Element").find(".image_wrap").first()})),e.iFullview&&this.fullview(),e.iEraser&&(this.model._reset=!0,this.el_str=this.$el.children(".Element").html(),this.setEraser())},resetOtherStatus:function(){this.$el.removeClass("invisible noevents"),this.resetEraser(),this.resetDragDrop()},fullview:function(){var e=this,t=this.getdetail();t.iImg&&t.iImg.length>0&&(this.$el.addClass("hasaction"),this.$el.children(".Element").off("tap").on("tap",function(i){var n=e.getGalleryModel().toJSON().iDetail.iImg,a=e.model.get("GalleryIndex"),r=[];(null==t.iImg||0==t.iImg.length)&&e_api.console.log("iImg 为空");for(var o=0;o<n.length;o++)r.push(n[o].picture);window.epubsdk.previewImage(r[a],r)}))},setEraser:function(){var e=this.getdetail();if(e.iEraser){var t=this.getcommon();this.$el.children(".Element").css("cursor","pointer"),this.$el.children(".Element").addClass("disableDragX disableDragY"),this.$el.find("img").first().is(":hidden")?this.isEraserSet=!1:(_e.eraser&&_e.eraser.set(this.$el.find("img").first(),t.iWidth,t.iHeight,this,e.erasertype),this.isEraserSet=!0)}},resetEraser:function(){this.firstRender||this.onShow(),this.isEraserSet||this.setEraser(),this.firstRender=!1},isFullSwitch:function(){return null!=this.model.get("GalleryIndex")?!0:void 0},getGalleryModel:function(){var e=[];for(i=0;i<this.path.length;i++){if("Gallery"==this.path[i].type){e.push(this.path[i]);break}e.push(this.path[i])}var t=interaction_view.getContainerModelByPath(e);return t},repaint:function(){this.$el.children(".Element").html(this.el_str)},onShow:function(){var e=this.getdetail();e.iEraser&&(this.repaint(),this.setEraser())},getDragCopy:function(){var e=$("<div></div>").addClass("DragCopy").attr({id:this.model.id+"_drag_copy"}).css({position:"absolute",opacity:this.$el.css("opacity")});return e.html($("<div/>").attr({style:this.$el.children(".Element").attr("style")})),e.children().html(this.$el.children(".Element").children().clone()),e},getClientXY:function(e){return"ontouchend"in document?{x:e.clientX,y:e.clientY}:{x:e.gesture.center.pageX,y:e.gesture.center.pageY}},resetDragDrop:function(){if(this.getdetail().draggable){var e=this;"undefined"==typeof e.DragDrops&&(e.DragDrops=e.model.page.iOverlaylist.where({iType:"DragDrop"}),!e.DragDrops.length&&(e.DragDrops=!1)),e.DragDrops&&("undefined"==typeof e.MaxZindex&&(e.MaxZindex=e.model.page.iOverlaylist.models.length+1e3),e.Status=0,1==this.getdetail().dragend&&(e.Status=2)),e.Pos={left:e.x,top:e.y},e.Drag_opacity=.8999,e.$el.siblings(".DragCopy").remove()}},setDraggable:function(e,t,i,n){function a(){h&&(u=e.css("z-index"),h=!1),interaction_view.events.onDragStart(p),s=e.position(),window.emulateLandscape.emulateObjectPoint(s,"left","top",{size:[Reveal.slideWidth,Reveal.slideHeight]}),l=e.css("opacity"),e.css({"z-index":c.MaxZindex+100,opacity:e.css("opacity")>=1?c.Drag_opacity:e.css("opacity")}),i(e),e.stop(!0,!0),c.resetDragDropStatus()}function r(t,i,n){if(s&&s.left){var a=window.emulateLandscape.emulateDelta(t,i);t=a[0],i=a[1];var r,o=$.zoom||1,l=s.left+t/o,h=s.top+i/o,u=e.css("transform")||e.css("-webkit-transform");u.split(",");r="vertical"==d.limit?{y:h}:"horizontal"==d.limit?{x:l}:{x:l,y:h},interaction_view.setPos(e,_.extend(r,{force3D:interaction_view.force3D})),interaction_view.events.onDragging(p),c.activeDragDrop(e,n)}}function o(){u=c.model.zIndex||init_zIndex,interaction_view.events.onDragEnd(p),e.css({"z-index":u,opacity:e.css("opacity")-c.Drag_opacity<1e-5?l:e.css("opacity")}),n(e)}var s,l,c=this,d=this.getdetail(),h=!0,u=e.css("z-index");e.data({Drop:t}).addClass("disableDragX disableDragY");var p={page_id:c.model.page.id,overlay_id:c.model.id,layer_id:c.model.get("layer_id")};if(c.model.page.id||(p.layer_id=c.model.page.iOverlaylist.layerid),"ontouchend"in document){var f=!1,v=0,g=0;e.on("touchstart",function(e){e=e.originalEvent.touches[0],f=!0,v=e.clientX,g=e.clientY,a()}).on("touchmove",function(e){return e=e.originalEvent.touches[0],r(e.clientX-v,e.clientY-g,e),!1}).on("touchend touchcancel",function(e){e=e.originalEvent.touches[0],f&&o(),f=!1})}else e.hammer().on("dragstart",a).on("drag",function(e){r(e.gesture.deltaX,e.gesture.deltaY,e)}).on("dragend",o)},activeDragDrop:function(e,t){if(this.DragDrops){var i=this,n=$.zoom?$.zoom:1,a=this.getClientXY(t);$.each(i.DragDrops,function(e,t){var r=t.iview.$el.children(".Element"),o={x:r.offset().left*n,y:r.offset().top*n},s={x:o.x+r.width()*n,y:o.y+r.height()*n};a.x>=o.x&&a.x<=s.x&&a.y>=o.y&&a.y<=s.y?(0!=i.$el.parent().children("#"+i.model.id+t.id).length||t.iview.active||i.trigger_dragin_event(t),t.iview.changeStatus(!1)):t.iview.changeStatus(!0)})}},getDropXY:function(e){var t,i=e.iview.getcommon(),n=e.iview.$el.children(".Element").offset(),a=e.iview.$el;a=a.parents(".layer-content:first").length?a.parents(".layer-content:first"):a.parents(".interaction-area:first"),t=a.offset();var r={x:n.left-t.left+i.iWidth/2,y:n.top-t.top+i.iHeight/2},o=e.page.iview,s=o&&o.scrollview&&o.scrollview._getCurrentPosition()||{};return s={x:-s.x||0,y:-s.y||0},r={x:r.x+s.x,y:r.y+s.y}},resetDragDropStatus:function(){var e=this;$.each(e.DragDrops,function(t,i){i.iview.Status=0;var n=e.$el.parent().children("[data-drop="+i.id+"]");if(n.length){i.iview.Status=2;var a=n.attr("data-drag");_.include(i.iview.getdetail().element_ids,a)&&(i.iview.Status=1)}})},renderDraggable:function(){function e(e){if(1==n.dragstart){var t=i.getDragCopy();e.before(t),TweenMax.to(t,0,{x:e.position().left,y:e.position().top,force3D:interaction_view.force3D})}0==i.Status&&(i.Pos=e.position())}function t(e){var t=0;$.each(i.DragDrops,function(a,r){if(r.iview.active){r.iview.changeStatus();var o=r.iview.getdetail(),s=i.$el.parent().children("#"+i.model.id+r.id);if(o.onlyright&&!_.include(o.element_ids,i.model.id)||0!=s.length)return t=1,0!=s.length&&0==n.dragin&&(t=3,e.css({"z-index":parseInt(r.iview.$el.css("z-index"))+1}),TweenMax.to(e,.4,i.getDropXY(r))),!1;t=2,0!=r.iview.Status&&i.old_transit_back(r),i.drag_dragin(r)}}),2>t&&i.drag_dragend(1==t?1:null)}var i=this,n=this.getdetail();n.draggable&&(this.model._reset=!0,i.setDraggable(i.$el,null,e,t))},drag_dragend:function(e){var t=this.$el,i=t.position(),n=t.parent().children("#"+this.model.id+"_drag_copy");1==this.Status&&(this.Status=0),this.lastCopy&&this.lastCopy.remove()&&(this.lastCopy=null),1==(e||parseInt(this.getdetail().dragend))?(i=this.Pos,TweenMax.to(t,.4,{x:i.left,y:i.top})):0==this.Status&&(this.Pos=t.position()),TweenMax.to(n,.4,{x:i.left,y:i.top,opacity:0,force3D:interaction_view.force3D,onComplete:function(){n.remove()}})},drag_dragin:function(e){var t=this,i=this.getdetail(),n=t.$el.parent().children("#"+t.model.id+"_drag_copy");switch(parseInt(i.dragin)){case 0:if(0==t.Status&&(t.Status=1),0==t.$el.parent().children("#"+t.model.id+e.id).length){t.lastCopy&&t.lastCopy.remove()&&t.resetDragDropStatus();var a=t.getDragCopy().attr({id:t.model.id+e.id,"data-drop":e.id,"data-drag":t.model.id}).hide();t.$el.before(a),t.lastCopy=a}t.$el.css("z-index",parseInt(e.iview.$el.css("z-index"))+1),TweenMax.to(t.$el,.4,_.extend(t.getDropXY(e),{force3D:interaction_view.force3D,onComplete:function(){t.trigger_drop_event(e)}})),1==i.dragstart&&TweenMax.to(n,.4,_.extend(t.getDropXY(e),{opacity:0,force3D:interaction_view.force3D,onComplete:function(){n.remove()}}));break;case 1:1!=i.dragstart&&(n=t.getDragCopy(),t.$el.before(n)),n.attr({id:t.model.id+e.id,"data-drop":e.id,"data-drag":t.model.id}).css({"z-index":parseInt(e.iview.$el.css("z-index"))+1,opacity:n.css("opacity")-t.Drag_opacity<1e-5?1:n.css("opacity")}),TweenMax.to(n,0,{x:t.$el.position().left,force3D:interaction_view.force3D,y:t.$el.position().top}),TweenMax.to(t.$el,.4,{x:t.Pos.left,y:t.Pos.top,force3D:interaction_view.force3D}),TweenMax.to(n,.4,_.extend(t.getDropXY(e),{force3D:interaction_view.force3D,onComplete:function(){t.trigger_drop_event(e),t.renderCopyDraggable(e,n)}}));break;case 2:n.remove(),n=t.getDragCopy().attr({id:t.model.id+e.id,"data-drop":e.id,"data-drag":t.model.id}).hide(),t.$el.before(n),TweenMax.to(t.$el,0,{x:t.Pos.left,y:t.Pos.top,force3D:interaction_view.force3D,onComplete:function(){t.trigger_drop_event(e)}})}},renderCopyDraggable:function(e,t){function i(){0==n.getdetail().dragstart&&n.$el.hide()}var n=this;this.setDraggable(t,e,i,n.copy_dragend)},copy_dragend:function(e){var t=this,i=this.getdetail(),n=e.data("Drop"),a=0;if($.each(t.DragDrops,function(i,r){if(r.id==n.id)r.iview.active&&(TweenMax.to(e,.4,t.getDropXY(n)),r.iview.changeStatus(),a=1);else if(r.iview.active){n.iview.Status=0,r.iview.changeStatus();var o=r.iview.getdetail();if(o.onlyright&&!_.include(o.element_ids,t.model.id))return a=1,t.old_transit_back(n,t.model.id),!1;0!=r.iview.Status&&t.old_transit_back(r),TweenMax.to(e,.4,t.getDropXY(r)),t.$el.siblings("#"+t.model.id+r.id).remove(),e.attr({id:t.model.id+r.id,"data-drop":r.id,"data-drag":t.model.id}).css("z-index",parseInt(r.iview.$el.css("z-index"))+1),e.data("Drop",r),a=1,t.trigger_drop_event(r)}}),0==i.dragstart&&t.$el.show(),0==a){var r=e.position();0==i.dragend&&1==i.dragstart?(TweenMax.to(e,.4,{opacity:0,force3D:interaction_view.force3D,onComplete:function(){e.remove()}}),TweenMax.to(t.$el,.4,{x:r.left,y:r.top,force3D:interaction_view.force3D})):(TweenMax.to(t.$el,0,{x:e.position().left,y:e.position().top,force3D:interaction_view.force3D}),1==i.dragend&&1==i.dragstart?TweenMax.to(e,0,{x:t.Pos.left,y:t.Pos.top,force3D:interaction_view.force3D,onComplete:function(){TweenMax.to(e,.4,{opacity:0,force3D:interaction_view.force3D,onComplete:function(){e.remove()}})}}):e.remove()),t.drag_dragend()}},old_transit_back:function(e,t){var i=e.iview.$el.parent().children("[data-drop="+e.id+"]"),t=t||i.attr("data-drag");i.attr("id",t+"_drag_copy"),this.model.page.iOverlaylist.where({id:t})[0].iview.drag_dragend(1)},trigger_dragin_event:function(e){interaction_view.events.onDragDrop(e,this.model,0)},trigger_drop_event:function(e){interaction_view.events.onDragDrop(e,this.model),interaction_view.events.onDragDropGroup(e)},replaceImg:function(e){e=this.getdetail().setPrec?e+"?"+this.getdetail().setPrec:e;var t=this.$el.children(".Element").find("img");t.length?t.attr("src",e):(t=this.$el.find(".image_wrap").first(),t.length&&(e?t.css("background-image","url("+e+")"):t.css("background-image","")));try{this.model.attributes.iDetail.iImg[0]||(this.model.attributes.iDetail.iImg[0]={}),this.model.attributes.iDetail.iImg[0].picture=e}catch(i){}}})}),define("interaction_view/model/page",["_g/mvc","interaction_view/view/page"],function(){var e={defaults:{iType:"Page",position:0,description:"",title:"untitled",picture:null,preview:"",thumbnail:null,width:null,height:null,bg_color:"#FFFFFF",bg_opacity:1,show_master:!0},autoIndex:!0,callback:function(){"page_group"!=this.get("type")&&(this.iOverlaylist=new interaction_view.collection.list,this.iAnimationlist=new interaction_view.collection.Animation,this.iActionlist=new interaction_view.collection.Action,this.ipreloadlist=new interaction_view.collection.Preload,this.ipreloadlist.pageid=this.iOverlaylist.pageid=this.iAnimationlist.pageid=this.iActionlist.pageid=this.id,this.iAnimationlist.iPage_id=this.id,this.iAnimationlist.page=this)},overlays:[],actions:[],animations:[]};return _g.mvc.createModel(e)}),define("interaction_view/collection/page",["_g/mvc","interaction_view/model/page"],function(){var e={enableSync:!1,model:require("interaction_view/model/page"),getTreeModels:function(e){var t=[];return e.each(function(e){if(t.push(e),e.icollection)for(var i=_g.mvc.getTreeModels(e.icollection),n=0;n<i.length;n++)t.push(i[n])}),t},getPageModels:function(){return this.pagemodels?this.pagemodels:(this.pagemodels=this.getTreeModels(this),this.pagemodels)},getPages:function(){var e=this.getPageModels();return e=_.reject(e,function(e){return"page_group"==e.toJSON().type})},getPagesJSON:function(){var e=this.getPageModels();return e=_.reject(e,function(e){return"page_group"==e.toJSON().type}),e=_.map(e,function(e){return e.toJSON()})},getPage:function(e){var t=this.getPageModels();return _.find(t,function(t){return t.id==e})},getIndexPages:function(){var e=this.getPages();return _.filter(e,function(e){return e.get("is_index")})},getElement:function(e,t,i){if(interaction_view.ipagelist.getPage(t)||interaction_view.imasterlist.get(t)){var n=interaction_view.ipagelist.getPage(t)||interaction_view.imasterlist.get(t);return n.iOverlaylist.get(i)}return e.iOverlaylist.get(i)}};return _g.mvc.createCollection(e)}),define("interaction_view/view/layer",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,afterload:function(){var e=this,t=this.model.get("iDetail").layer_ids,i=this.model.offset?this.model.offset:{x:0,y:0};t&&0!=t.length&&(_.each(t,function(t){var n=interaction_view.ilayerlist.get(t)||interaction_view.iComponentlist.get(t);if(n){var a=n.attributes.pano_eid;e.animations=_.map(n.animations,function(i){return i.pageid=e.model.id,i.parentpageid=e.model.get("pageid"),i.pagetype="LayerRef",i.layerid=t,i.pano_eid=a,i}),e.model.layer[t].iAnimationlist.reset(e.animations),overlays=_.filter(n.overlays,function(e){return interaction_view.model[e.iType]}),overlays=_.map(overlays,function(n){var r=$.extend(!0,{},n);return r.pageid=e.model.id,r.parentpageid=e.model.get("pageid"),r.pagetype="LayerRef",r.layerid=t,r.path=e.model.layer[t].iOverlaylist.path,r.isSubOverlay=!0,r.isLayerOverlay=!0,i.x&&(r._offset_x=i.x),i.y&&(r._offset_y=i.y),r.pano_eid=a,r.iCommon.landscape.iStarty=r.iCommon.landscape.iStarty+i.y,r.iCommon.landscape.iStartx=r.iCommon.landscape.iStartx+i.x,new interaction_view.model[n.iType](r)}),e.model.layer[t].iOverlaylist.reset(overlays),e.model.layer[t].iOverlaylist.each(function(e){e.iview.setZindex()}),e.actions=_.map(n.actions,function(i){return i.pageid=e.model.id,i.parentpageid=e.model.get("pageid"),i.pagetype="LayerRef",i.layerid=t,i.pano_eid=a,i}),e.model.layer[t].iActionlist.reset(n.actions)}}),e.startLayerLoad())},startLayerLoad:function(){var e=this;_.each(this.model.layer,function(t,i){0==t.ipreloadlist.length?e.model.iview.afterlayerload(i):t.ipreloadlist.preload()})}});return t}),define("interaction_view/model/layer",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Layer",position:0,description:"",title:"untitled",picture:null,preview:"",thumbnail:null,width:null,height:null,layer_width:1024,layer_height:768,bg_color:"#FFFFFF",bg_opacity:1},callback:function(){this.actions=this.get("actions"),this.animations=this.get("animations"),this.overlays=this.get("overlays")}});return t}),define("interaction_view/collection/layer",["interaction_view/collection/page","interaction_view/model/layer"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/layer")});return t}),define("interaction_view/model/master",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Master",position:0,description:"",title:"untitled",picture:null,preview:"",thumbnail:null,width:null,height:null,bg_color:"#FFFFFF",bg_opacity:1,pageno_horizontal:{show:!1,x:500,y:20},pageno_vertical:{show:!1,x:20,y:300}}});return t}),define("interaction_view/view/master",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,isMaster:!0});return t}),define("interaction_view/collection/master",["interaction_view/collection/page","interaction_view/model/master","interaction_view/view/master"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/master")});return t}),define("interaction_view/model/background",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Background",position:0,description:"",title:"untitled",picture:null,preview:"",thumbnail:null,width:null,height:null,bg_color:"#FFFFFF",bg_opacity:1,pageno_horizontal:{show:!1,x:500,y:20},pageno_vertical:{show:!1,x:20,y:300}}});return t}),define("interaction_view/view/background",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,isBackground:!0,prepareLoad:function(){var e=this,t=this.model;t&&(e.animations=_.map(e.animations,function(t){return t.pageid=e.model.id,t.pagetype="background",t}),e.model.iAnimationlist.reset(e.animations),overlays=_.filter(e.overlays,function(t){return t.pageid=e.model.id,t.pagetype="background",interaction_view.model[t.iType]}),overlays=_.map(overlays,function(e){return new interaction_view.model[e.iType](e)}),e.model.iOverlaylist.reset(overlays),e.model.iOverlaylist.each(function(e){e.iview.setZindex()}),e.actions=_.map(e.actions,function(t){return t.pageid=e.model.id,t.pagetype="background",t}),e.model.iActionlist.reset(e.actions))}});return t}),define("interaction_view/collection/background",["interaction_view/collection/page","interaction_view/model/background","interaction_view/view/background"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/background")});return t}),define("interaction_view/model/component",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Component",bg_color:"#FFFFFF",bg_opacity:1},callback:function(){this.actions=this.get("actions"),this.animations=this.get("animations"),this.overlays=this.get("overlays")}});return t}),define("interaction_view/collection/component",["interaction_view/collection/page","interaction_view/model/component"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/component")});return t}),define("interaction_view/model/doc",["_g/mvc","interaction_view/collection/page","interaction_view/view/page","interaction_view/view/layer","interaction_view/collection/layer","interaction_view/collection/master","interaction_view/collection/background","interaction_view/collection/component"],function(){function e(e){function t(e){var t=function(e){var t=_.chain([e.layers,e.masters,e.backgrounds,e.chapter.map(function(e){return e.children})]).flatten().filter(function(e){return e}).map(function(e){return e.overlays}).flatten().filter(function(e){return e}).map(function(e){return e.iType}).uniq().value();return t}(e);return{typeUsed:t}}var i=t(e),n=!(!window.emulateLandscape.available&&!_.intersection(["layerround","layerpano","layerlongtake"],i.typeUsed.map(function(e){return e.toLowerCase()})).length);window.docConst={IS_OVERLAY_Z3D:n}}function t(){window.docConst.IS_OVERLAY_Z3D||$(".slides-wrap").css("transform","none")}var i={defaults:{id:"doc",play_mode:0},autoUpdate:!1,fetchUrl:context_url+"index.json",parse:function(i){return console.log("fetch data:",i),200==i.code?i.data?(e(i.data),t(),interaction_view.size={x:i.data.width||1024,y:i.data.height||768},"undefined"!=typeof config_player&&config_player&&(interaction_view.size={x:375,y:603}),interaction_view.screen_mode=i.data.screen_mode,i.data.force_3d&&interaction_view.ismobile?interaction_view.force3D="auto":interaction_view.force3D=!1,this.initShareApp(i),this.initEnvironment(),"undefined"!=typeof configpage&&configpage.init(i),this.initMasters(i),workEnd("-------- 1.1.1 touchinit 1 initMasters --------"),this.initBackgrounds(i),workEnd("-------- 1.1.2 touchinit 1 initBackgrounds --------"),this.initLayers(i),workEnd("-------- 1.1.3 touchinit 1 initLayers --------"),this.initPages(i),workEnd("-------- 1.1.4 touchinit 1 initPages --------"),this.initComponents(i),this.initApplications(i),"undefined"!=typeof e_api&&this.initApi(i),this.initDbs(i),this.initGlobals(i),workEnd("-------- 1.1.5 touchinit 1 initApplications --------"),interaction_view.ismobile||interaction_view.forpreview||(i.data.bg_color=void 0!=i.data.desktop_bg_color?i.data.desktop_bg_color:i.data.bg_color,i.data.bg_opacity=void 0!=i.data.desktop_bg_opacity?i.data.desktop_bg_opacity:i.data.bg_opacity,i.data.screen_mode=void 0!=i.data.desktop_screen_mode?i.data.desktop_screen_mode:i.data.screen_mode,i.data.show_excontent=void 0!=i.data.desktop_show_excontent?i.data.desktop_show_excontent:i.data.show_excontent,i.data.adapt=void 0!=i.data.desktop_adapt?i.data.desktop_adapt:i.data.adapt),_.omit(i.data,"layers","masters","chapter","organization","applications")):{}:void 0},initMasters:function(e){var t=require("interaction_view/collection/master");e.data.masters||(e.data.masters=[]),interaction_view.imasterlist=_g.mvc.createTreeByData({collection:t,data:e.data.masters})},initBackgrounds:function(e){var t=require("interaction_view/collection/master");e.data.backgrounds||(e.data.backgrounds=[]),interaction_view.ibackgroundlist=_g.mvc.createTreeByData({collection:t,data:e.data.backgrounds})},initLayers:function(e){var t=require("interaction_view/collection/layer");e.data.layers||(e.data.layers=[]),interaction_view.ilayerlist=_g.mvc.createTreeByData({collection:t,data:e.data.layers})},initComponents:function(e){var t=require("interaction_view/collection/component");e.data.components||(e.data.components=[]),interaction_view.iComponentlist=_g.mvc.createTreeByData({collection:t,data:e.data.components})},initPages:function(e){var t,i=require("interaction_view/collection/page");t=e.data.chapter,workEnd("-------- 1.1.4.2 touchinit pagedata parseOrgnization--------"),interaction_view.ipagelist=_g.mvc.createTreeByData({collection:i,data:t}),workEnd("-------- 1.1.4.3 touchinit interaction_view ipagelist--------"),_g.mvc.createTreeView({collection:interaction_view.ipagelist,view:require("interaction_view/view/page"),containment:"div.slides",wrap:null}),interaction_view.ipagelist.getPages()[0].isFirstPage=!0,workEnd("-------- 1.1.4.4 touchinit interaction_view createTreeView--------")},initApplications:function(e){interaction_view.applications=e.data.applications,interaction_view.actionforapp={},interaction_view.application.buttons=[],interaction_view.application.buttonGroups=[],_.each(interaction_view.applications,function(e){"form"==e.type&&interaction_view.application.initForm(e),e.actions&&e.actions.length&&(interaction_view.actionforapp[e.id]=new interaction_view.collection.Action,interaction_view.actionforapp[e.id].add(e.actions),interaction_view.actionforapp[e.id].each(function(e){e.iview.render()}))})},initShareApp:function(e){interaction_view.shareapp={id:""},e.data.shareapp&&""!=e.data.shareapp.id&&(interaction_view.shareapp=e.data.shareapp,interaction_view.environment.Shareapp.init())},initEnvironment:function(){interaction_view.environment.Sharedata.init(),interaction_view.environment.Userdata.init()},initApi:function(e){e_api._initialize(e.data.api_data||[])},initDbs:function(e){var e=e.data.dbs,t=Backbone.Model.extend({defaults:{id:"",querys:[],sheet_id:"",fields:[]}}),i=Backbone.Collection.extend({model:t});interaction_view.dblist=new i,_.each(e,function(e){interaction_view.dblist.add({id:e.id,querys:e.iDetail.querys,sheet_id:e.iDetail.sheet_id,fields:e.iDetail.fields})});var n=new dboperate;n.query()},initGlobals:function(e){var e=e.data.globals;interaction_view.DEBUG&&(_.find(e,function(e){return"Debug"==e.iType})||e.push({id:"debug"+_g.uuid(3),iType:"Debug",iDetail:{}}));var t=Backbone.Model.extend({initialize:function(){interaction_view.view[this.get("iType")]&&(this.iview=new(interaction_view.view[this.get("iType")])({model:this}))}}),i=Backbone.Collection.extend({model:t});interaction_view.globallist=new i,_.each(e,function(e){"GlobalVariable"==e.iType&&0==e.iDetail.iKind&&(e.iDetail.initial=(Number(e.iDetail.initial)||0).toFixed(Number(e.iDetail.precision)||0)),interaction_view.globallist.add(e)}),_.each(interaction_view.globallist.models,function(e,t){2==e.attributes.iDetail.iKind&&(e.attributes.iDetail.initial=interaction_view.setRandom(e.attributes.iDetail))})},callback:function(){}};return _g.mvc.createModel(i)}),define("text!interaction_view/template/preload.tpl",[],function(){return'<img src="<%=file%>" width="1" height="1" id="<%=id%>"/>'}),define("interaction_view/model/preload",["interaction_view/model/base","text!interaction_view/template/preload.tpl"],function(){require("text!interaction_view/template/preload.tpl");interaction_view.model.Preload=interaction_view.model.Base.extend({defaults:{iType:"Preload",iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,loaded:!1},setcollection:function(){if(this.pageid=this.get("pageid"),"LayerRef"==this.get("pagetype")){var e=this.get("parentpageid"),t=this.get("layerid"),i=interaction_view.getParentpage(e);this.page=i.iOverlaylist.get(this.pageid).layer[t]}else this.get("isSubOverlay")?(this.path=this.get("path"),this.page=interaction_view.getContainerModelByPath(this.path)):this.page=interaction_view.getParentpage(this.pageid);this.page.ipreloadlist.get(this.id)||this.page.ipreloadlist.add(this)},setview:function(e){if(this.pageid=this.get("pageid"),"LayerRef"==this.get("pagetype")){var t=this.get("parentpageid"),i=this.get("layerid"),n=interaction_view.getParentpage(t);this.page=n.iOverlaylist.get(this.pageid).layer[i]}else this.get("isSubOverlay")?(this.path=this.get("path"),this.page=interaction_view.getContainerModelByPath(this.path)):this.page=interaction_view.getParentpage(this.pageid);"master"==this.get("pagetype")&&(this.isMasterOverlay=!0),this.iview=new interaction_view.view.Preload({model:this})},setsyncmodel:function(){}}),interaction_view.collection.Preload=interaction_view.collection.Base.extend({preloadcheck:function(e,t,i){this.where({loaded:!0});if(interaction_view.ismobile||0!=t||console.log("file:"+e+" load failed!"),i.iview.afterpreload(e),0==this.where({loaded:!1}).length)if("LayerRef"==this.pagetype){var n=this.parentpageid,a=this.layerid,r=interaction_view.getParentpage(n);refmodel=r.iOverlaylist.get(this.pageid),refmodel.iview.afterlayerload(a)}else if(this.subcontainer){var o=interaction_view.getContainerModelByPath(this.path);o.iview.afterSubOverlayPreload()}else interaction_view.finishPagePreload(this.pageid)},preload:function(){this.each(function(e){e.get("loaded")||e.iview.render();
})}}),interaction_view.view.Preload=interaction_view.view.Base.extend({events:{},initstart:function(){},renderDynamicElement:function(){},render:function(){var e=this,t=this.elementmodel=e.model.page.iOverlaylist.get(this.model.get("overlay_id")),i=this.model.get("elementtype");if("Audio"==i)console.info("Audio"),this.audioPreload();else if("Video"==i)this.videoPreload();else if("QQVideo"==i)this.qqVideoPreload();else if(-1!=["LayerRef","LayerSlide","LayerLongTake","LayerRound","LayerPano","ComponentRef"].indexOf(i))this.layerPreload(this.model);else if(this.model.get("subcontainer"))this.subcontainerPreload(this.model);else{var n=e.model.toJSON().file;$('img[id="'+this.model.id+'"]').length>0&&($('img[id="'+this.model.id+'"]')[0].onload=function(){interaction_view.iImgs[n]=this},$('img[id="'+this.model.id+'"]')[0].src=n),e.model.set("loaded",!0),workEnd("-------- 4 "+this.model.id+" = "+n),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!0,t)}},audioPreload:function(){interaction_view.media.audio.init(this.model,this.elementmodel,this.model.isMasterOverlay)},videoPreload:function(){interaction_view.media.video.init(this.model,this.elementmodel,this.model.toJSON().file)},qqVideoPreload:function(){var e=this,t=this.model.toJSON().vid,i="https://h5vv.video.qq.com/getinfo?charge=0&otype=json&ehost=http%3A%2F%2Fv.qq.com&sphls=1&sb=1&nocache=0&_rnd=1474261459084&_qv_rmt=Uc82pmhDA17215iGZ=&_qv_rmt2=z7Bhn62F144649fOw=&sdtfrom=v5010";$.ajax({url:i,dataType:"jsonp",data:{callback:"tvp_request_getinfo_callback_865977",platform:11001,vids:t,defaultfmt:"auto"},jsonp:"callback",timeout:3e3,success:function(t){try{var i=t.vl.vi[0].ul.ui[0].url+t.vl.vi[0].fn+"?vkey="+t.vl.vi[0].fvkey;interaction_view.media.video.init(e.model,e.elementmodel,i)}catch(n){console.log(n),e.elementmodel.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.elementmodel.toJSON().file,!0,e.elementmodel)}},error:function(t){console.log(t),e.elementmodel.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.elementmodel.toJSON().file,!0,e.elementmodel)}})},layerPreload:function(){this.elementmodel.iview.loadLayer(this.model)},subcontainerPreload:function(){this.elementmodel.iview.loadSubOverlay(this.model)}}),interaction_view.ipreloadlist=new interaction_view.collection.Preload}),define("interaction_view/model/richtext",["interaction_view/model/base"],function(){interaction_view.model.RichText=interaction_view.model.Base.extend({defaults:{iType:"RichText",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.attributes.iDetail.iText=interaction_view.isEvilCode(this.attributes.iDetail.iText),this.iview=new interaction_view.view.RichText({model:this})},setsyncmodel:function(){}}),interaction_view.view.RichText=interaction_view.view.Base.extend({events:{},render:function(e){interaction_view.ismobile,this.scrollEl=this.$el.children(".Element"),this.model._reset=!0},resetOtherStatus:function(){var e=this;if(this.$el.children(".Element").find(".el_wrap").length){if(this.$el.children(".Element").find(".el_wrap").first().length&&_g.ui.isOverflowed(this.$el.children(".Element").find(".el_wrap").first()).y){if(!this.$el.children(".Element").hasClass("disableDragY")){var t=this.$el.find(".el_wrap").first(),i=t.height();t.wrapInner('<div class="iContent" style="font-size: inherit;color: inherit;font-family: inherit;font-weight:inherit;"></div>');var n=_g.ui.isOverflowed(t).y-i;this.scrollView=new IScroll(t[0],{mouseWheel:!0,click:!0,probeType:3,wrapperHeight:i,HWCompositing:!0}),this.scrollView.on("scroll",function(){n&&n>0&&(this.y>0?this.y>30&&e.scrollEl.addClass("is_exceededY"):Math.abs(this.y)-n>30&&e.scrollEl.addClass("is_exceededY"))}),this.scrollEl=this.$el.children(".Element"),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY")}this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY")}}else if(_g.ui.isOverflowed(this.$el.children(".Element")).y){if(!this.$el.children(".Element").hasClass("disableDragY")){var i=this.$el.children(".Element").height();this.$el.children(".Element").wrapInner('<div class="iContent"></div>');var n=_g.ui.isOverflowed(this.$el.children(".Element")).y-i;this.scrollView=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,click:!0,probeType:3,HWCompositing:!0}),this.scrollView.on("scroll",function(){n&&n>0&&(this.y>0?this.y>30&&e.scrollEl.addClass("is_exceededY"):Math.abs(this.y)-n>30&&e.scrollEl.addClass("is_exceededY"))}),this.scrollEl=this.$el.children(".Element"),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY")}this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY")}},otherOnShow:function(){this.resetOtherStatus()}})}),define("interaction_view/model/slide",["interaction_view/model/base"],function(){interaction_view.model.Slide=interaction_view.model.Base.extend({defaults:{iType:"Slide",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSlideNumber:!0,isSlide:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){var t=this.get("iDetail");t.show_title&&this.setSubOverlays(),this.iview=new interaction_view.view.Slide({model:this})},setsyncmodel:function(){}}),interaction_view.view.Slide=interaction_view.view.Base.extend({events:{},render:function(e){var t=this,i=this.getdetail();this.renderBackGroud(),this.currentSlideIndex=null,this.model.on("slideTo",function(e){return null!=t.currentSlideIndex&&t.currentSlideIndex==e?!1:(t.preloaded&&(interaction_view.events.onChangeTo(t.model.iPageId,t.model.id,e),t.currentSlideIndex=e,t.setTitle(e)),t.rmbLast=e,void(i.iRememberLast&&interaction_view.environment.Paragraph.state()&&t.addToUrl(e)))}),interaction_view.isWeixin&&interaction_view.isAndroid&&this.$el.find("img").on("click",function(e){return!$(e.target).is(e.currentTarget)||$(this).hasClass("hasaction")||i.iFullview?void 0:!1}),this.model._reset=!0},getSlideLength:function(){var e=this.getdetail();return e.iImg?e.iImg.length:0},preload:function(){var e,t=this,i=this.getdetail();this.checkImglist=_.pluck(i.iImg,"1"==_g.getUrlParameterByName("-playmode")?"thumbnail":"picture"),this.preloaded=!1;var n=[];i.iImg&&i.iImg.length&&(_.each(i.iImg,function(i){e="1"==_g.getUrlParameterByName("-playmode")?i.thumbnail:i.picture;var a=t.sendToPreload({file:e});n.push(a.id)}),i.show_title&&this.sendToPreload({file:null,subcontainer:!0,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")})),this.model.set("preload_id",n)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){var t=this;if((!e||!this.preloaded)&&(e&&(this.preloaded=this.checkImgload(e)),this.preloaded)){var i=this,n=this.getdetail();if(n.show_title&&this.preloadmodel.get("loaded"))return;if(this.setZindex(),this.setElementDisplay(),this.setSlideImageDisplay(),this.slideel=this.$el.children(".Element").find(".slidecontent").first(),this.slidelength=this.getdetail().iImg.length,t.fullview(),this.playAnimation(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style"),n.iRememberLast&&"Flow"!=n.iFade)return i.rmbLast=i.getFromUrl(),void i.setElementTo(i.rmbLast)}},afterSubOverlayPreload:function(){this.preloadmodel&&(this.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.iActionlist.each(function(e){e.iview.render()}),this.setTitle(0),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))},playAnimation:function(){this.timeline&&this.timeline.clear();var e=this.getdetail(),t=(e.iSlidetype,!1);this.$el.children(".Element").is(":hidden")&&(t=!0),this.delay=Number(e.iInterval)||2,this.autoplay=e.iAutoplay;var i=e.iRepeat?-1:0;this.iFade=e.iFade||0,this.timeline=new TimelineMax({paused:!0,repeat:i,onComplete:this.setRewind}),this.repeat=i,this.iRewind=e.iRewind,this.slipable=e.iSlipable,this.canSlip=!0,this.iDisplay=e.iDisplay,this.setTimeline(),"Flow"!=e.iFade&&(this.autoplay?this.model._autoplay=!0:this.setSlideDisplay(0),this.onChangeSlideTo(0),this.slipable&&(this.control(),this.autoplay||this.$el.attr("data-iSlipable",!0)))},_autoplay:function(){var e=!1;this.$el.children(".Element").is(":hidden")&&(e=!0),this.timeline&&(this.reseted&&(this.reseted=!1,this.resetTimeline()),(!e||interaction_view.ismobile||this.model.isMasterOverlay)&&this.timeline.play(0))},setTimeline:function(){if("Fade"==this.iFade)this.setFade(),2==this.iDisplay&&this.slideel.find("img").css("left",0);else if("Slip"==this.iFade)this.slideel.css("overflow","hidden"),this.setSlip();else if("None"==this.iFade)this.setNone();else{if("Flip"!=this.iFade)return"Flow"==this.iFade?void this.setFlowAll():void 0;2==this.iDisplay&&(this.slideel.wrapInner('<div class="slidewrap" style="width:100%;height:100%;position:absolute;"></div>'),this.slideel=this.slideel.children(".slidewrap"),this.slideel.find("img").css("left",0)),this.slideel.hasClass("overflowhidden")&&(this.slideel.removeClass("overflowhidden"),this.slideel.parent().addClass("overflowhidden").css("border",this.slideel.css("border")).css("border-radius",this.slideel.css("border-radius")),this.slideel.css("border","none").css("border-radius","0")),this.setFlip()}this.slideel.children().first().css({opacity:1,left:0,top:0}).nextAll().css("opacity",0)},setFlowAll:function(){function e(e){var t=$(e).height()||o/e.width*e.height,i=$("<canvas></canvas>").attr({width:o,height:t}).css({"float":"left"});$(e).after(i),TweenMax.to(i,0,{transform:"matrix(1, 0, 0, -1, 0, 0)"});var n=i[0].getContext("2d");n.drawImage(e,0,0,o,t);var a=n.createLinearGradient(0,0,0,t);n.globalCompositeOperation="destination-in",a.addColorStop(1,"rgba(0,0,0,0.4)"),a.addColorStop(.6,"rgba(0,0,0,0)"),a.addColorStop(0,"rgba(0,0,0,0)"),n.fillStyle=a,n.fillRect(0,0,o,t)}function t(){if(c++,n.slidelength<=c){n.slideel.children().find("img").css({width:o}).each(function(t,i){e(i)}),n.slideel.children().animate({opacity:1});var t=n.slideel.parents("section.Presentation:first").attr("style");n.slideel.parents("section.Presentation:first").css({display:"block",visibility:"hidden"}),n.CoverFlow=n.slideel.children().coverflow({active:Math.floor((n.slidelength-1)/2),overlap:.3,perspectiveY:22,duration:300,beforeselect:function(e,t){n.model.trigger("slideTo",t.index)},select:function(e,t){n.currentIndex=t.index}}).width("+=100").height("100%"),n.slideel.children().children().each(function(e,t){var i=$(t).find("img").height();$(t).width(o),$(t).children().css({position:"absolute"}),$(t).find("img").css({bottom:.3*a+"px"}),$(t).find("canvas").css({bottom:.3*a-i+"px"})}),n.slideel.parents("section.Presentation:first").attr("style",t),n.setFlow(),i(),s.iRememberLast&&(n.rmbLast=n.getFromUrl(),n.setElementTo(n.rmbLast))}}function i(){if(n.slipable){var e=["mousedown","mousemove","mouseup"];n.isTouch()&&(e=["touchstart","touchmove","touchend touchcancel"]);var t=n.CoverFlow.parent().width();n.CoverFlow.on(e[0],function(i){function a(e){n.isTouch()&&(e=e.originalEvent.touches[0]);var i=(e.clientX-r)/t;return n.isTouch()&&(i*=2),i=Math.round(i*n.slidelength),i=s-i,0>i&&(i=0),i>=n.slidelength&&(i=n.slidelength-1),n.CoverFlow.coverflow("select",i),o=!0,!1}n.isTouch()&&(i=i.originalEvent.touches[0]);var r=i.clientX,o=!1,s=n.CoverFlow.children(".ui-state-active").index();return $(document).on(e[1],a),$(document).one(e[2],function(){function t(){n.CoverFlow.data("CoverFlowDisableClick",!1)}return $(document).off(e[1],a),o&&n.CoverFlow.data("CoverFlowDisableClick",!0)&&setTimeout(t,10),!1}),n.isTouch()&&!o&&n.CoverFlow.coverflow("select",$(i.target).parent().index()),n.isTouch()?void 0:!1});var i=n.getdetail().iSlidetype?n.getdetail().iSlidetype:0;"横向"==i||0==Number(i)?n.$el.children(".Element").addClass("enableMouseWheelX disableDragX"):n.$el.children(".Element").addClass("enableMouseWheelY disableDragY")}}var n=this,a=this.getcommon().iHeight,r=this.getcommon().iWidth,o=.7*r,s=this.getdetail();n.slideel.children().removeAttr("style").wrap("<div></div>"),n.slideel.wrapInner("<div></div>"),n.slideel.children().css({opacity:0});var l=_.pluck(s.iImg,"1"==_g.getUrlParameterByName("-playmode")?"thumbnail":"picture");_.each(l,function(e,i){var n=new Image;n.src=e,n.onload=function(){n.height/n.width*o>.7*a&&(o=.7*a/n.height*n.width),t()}});var c=0},isTouch:function(){return"ontouchstart"in document},testControl:function(){return!0},resetOtherStatus:function(){if(this.slideel){var e=this,t=this.getdetail();if("Flow"!=t.iFade&&this.slideel.children().first().css({opacity:1,left:0,top:0}),this.autoplay=t.iAutoplay,this.currentIndex=0,this.currentSlideIndex=null,this.hasSlideNumber&&(this.setSlideNumberPosition(),this.changeSlideNumber()),this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY"),this.timeline){var i=Math.floor((this.slidelength-1)/2);if(this.timeline.pause(1e-5),t.iRememberLast)return e.rmbLast=e.getFromUrl(),void e.setElementTo(e.rmbLast);if("Flow"==t.iFade&&this.CoverFlow){this.currentIndex=i;try{this.CoverFlow.coverflow("select",i),this.currentIndex=i}catch(n){}}if(!this.model.attributes.iDetail.iAutoplay||this.$el.children(".Element").is(":hidden")&&!interaction_view.ismobile)this.setSlideDisplay(0);else{if("Flow"==t.iFade)return void this.timeline.play(.3*(i-1)+i*this.delay);this.timeline.play(0)}}}},immediateRender:function(){var e=this.getdetail();e.iAutoplay||this.onChangeSlideTo(0)},fullview:function(){var e=this,t=this.getdetail();t.iFullview&&e.$el.find(".Element").on("tap",function(i){i.preventDefault();var n=[];(null==t.iImg||0==t.iImg.length)&&e_api.console.log("iImg 为空");for(var a=0;a<t.iImg.length;a++)n.push(t.iImg[a].picture);window.epubsdk.previewImage(n[e.currentIndex||0],n)})},isFullSwitch:function(){var e=this.getdetail();return e.iSlipable},preview_left:function(e){e>0&&this.fullviewIndex(e-1)},preview_right:function(e){var t=this.getdetail();e<t.iImg.length-1&&this.fullviewIndex(e+1)},setTitle:function(e){var t=this.getdetail();if(t.show_title&&t.iImg&&t.iImg.length&&t.iImg[e]){var i=this.model.get("suboverlays"),n=interaction_view.formatLabel({text:t.iImg[e].title,font_size:i[0].iDetail.font_size,text_color:i[0].iDetail.text_color,iPosition:i[0].iDetail.iPosition});this.$el.find(".iTextLabel.Element").html(n)}},getFromUrl:function(e){var t=_g.getUrlParameterByName(this.model.id,e);if(t||(t=_g.getHashParameterByName(this.model.id)),null==t&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var i=this.model.get("pageid"),n=interaction_view.environment.Sharedata.getitem(i,this.model.id);n&&(t=n.value)}return t},addToUrl:function(e){var t=this.getdetail();if(!t.iRememberLast)return!1;"undefined"==typeof message_link&&(message_link=document.location.href,interaction_view.weixin.share()),"undefined"==typeof e&&(e=this.currentIndex);var i=this.model.id+"="+encodeURI(e),n=_g.getUrlParameterByName(this.model.id,message_link),a=0,r=message_link;if(n)encodeURI(n)!=encodeURI(e)?r=_g.replaceUrlParameterByName(this.model.id,i,message_link):a=1;else{var o="?";message_link.indexOf("?")>=0&&(o="&"),r+=o+i}if("epub360"==epub360_domain&&!a&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{value:encodeURI(e)}),a||(message_link=r,interaction_view.weixin.share()),!interaction_view.forpreview){var s=_g.getHashParameterByName(this.model.id);s?encodeURI(s)!=encodeURI(e)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,i)):a=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+i):window.history.replaceState({},"","#"+i))}return a?!1:!0},setControl:function(e){this.getdetail();this.addToUrl(),this.control(),this.canSlip=!0,e||this.slipable||(this.canSlip=!1)},resetTimeline:function(){var e=this,t=this.repeat;e.timeline.kill(),e.timeline=new TimelineMax({paused:!0,repeat:t,onComplete:e.setRewind}),e.setSlideDisplayAll(),e.setTimeline();var i=e.timeline.duration();if(e.repeat)var n=e.singletime=i/e.slidelength;else var n=e.singletime=i/(e.slidelength-1);return{duration:i,singletime:n}}})}),define("interaction_view/model/video",["interaction_view/model/base"],function(){interaction_view.model.Video=interaction_view.model.Base.extend({defaults:{iType:"Video",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single"}],iAnimationProperties:[{id:"iAnimation",type:"object"}]},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){void 0===this.attributes.iDetail.iDisplay&&(this.attributes.iDetail.iDisplay=1),this.iview=new interaction_view.view.Video({model:this})},setsyncmodel:function(){},getFile:function(){var e=this.get("iDetail");return e.iFile&&e.iFile[0]?e.iFile[0].file:null}}),interaction_view.view.Video=interaction_view.view.Base.extend({render:function(e){this.file,this.model._reset=!0,interaction_view.isIos&&(interaction_view.isWeixin&&this.model.attributes.iDetail.iIosAutoplay&&!this.model.page.firstPlayFinished&&this.model.page.isFirstPage?(this.model.firstplayed=!1,this.model.iosautoplay=!0,this.$el.data("element",this.model)):this.model.iosautoplay=!1)},setOtherDisplay:function(){this.model.media&&!this.model.iosautoplay&&interaction_view.media.pause(this.model)},preload:function(){var e,t=this.getdetail();if(t.iFile&&t.iFile[0]){if("undefined"!=typeof epub360&&epub360.settings&&epub360.settings.disable_stream_media)e=t.iFile[0].file;else if("undefined"==typeof cbt_data||interaction_view.forpreview){var i="undefined"!=typeof video_play_type?video_play_type:null;"1"==_g.getUrlParameterByName("-playmode")?e=(t.iFile[0].file||t.iFile[0].content)+"_1080.m3u8":"2"==_g.getUrlParameterByName("-playmode")||1===i?e=(t.iFile[0].file||t.iFile[0].content)+"":0==t.iFile[0].parse_status||void 0==t.iFile[0].parse_status?e=(t.iFile[0].file||t.iFile[0].content)+"_origin.mp4":(1==t.iFile[0].parse_status||2==t.iFile[0].parse_status)&&(e=(t.iFile[0].file||t.iFile[0].content)+"_pre.mp4")}else e=t.iFile[0].file||t.iFile[0].content;this.file=e}this.file&&(this.preloadmodel=this.sendToPreload({file:this.file}))},onPlay:function(){var e=this.model.media;e&&this.model.iosautoplay&&!this.model.firstplayed&&(this.model.firstplayed=!0)},onStop:function(){var e=this.model.media;e.currentTime=0,e.load(),this.$el.show()},resetOtherStatus:function(){if(!this.model.hided&&this.model.media){if(this.model.iosautoplay&&!this.model.firstplayed)return;this.model.hls?interaction_view.media.video.resetH(this.model,this):interaction_view.media.video.reset(this.model);var e=this.model.get("iDetail").iAutohide;if(null==e&&(e=!0),e){if(this.model.hls&&this.model.reseted)return;this.$el.addClass("hide")}else this.model.get("iDetail").iControl&&this.$el.find(".jwdisplayIcon").css({opacity:1})}}})}),define("interaction_view/model/button",["interaction_view/model/base"],function(){interaction_view.model.Button=interaction_view.model.Base.extend({defaults:{iType:"Button",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){var t=this.get("iDetail");t.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.Button({model:this})},setsyncmodel:function(){}}),interaction_view.view.Button=interaction_view.view.Base.extend({events:{},render:function(e){this.model._reset=!0},preload:function(){this.preloaded=!1,this.checkImglist=[];var e=this.getdetail(),t=[null,null];if(e.iconNormal&&e.iconNormal[0]){this.checkImglist.push(e.iconNormal[0].picture);var i=this.sendToPreload({file:e.iconNormal[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[0]=i.id}if(e.iconActive&&e.iconActive[0]){this.checkImglist.push(e.iconActive[0].picture);var i=this.sendToPreload({file:e.iconActive[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[1]=i.id}this.model.set("preload_id",t)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){function e(){void 0!=i.linktype&&-1!=i.linktype&&window.setTimeout(function(){interaction_view.renderLink(i.linktype,i)},300)}this.active=!1,this.buttonon=!1;var t=this;this.$el.css("cursor","pointer");var i=this.getdetail(),n=this.$el,a=n[0];if(i.isMasterAudio){n.addClass("master_audio_icon").find(".iconNormal").addClass("animated infinite rotate c-time-20");var r="undefined"!=typeof bgsound_autostart&&bgsound_autostart||interaction_view.forpreview;r||(this.init_reverse=!0)}var o,s,l,c,d=i.isSwitch;this.alloyFingerInstance=new AlloyFinger(a,{touchStart:function(e){d||(t.changeStatus(),t.buttonon=!0),o=s=l=0,c=e.timeStamp},touchMove:function(e){if(!o){s+=e.deltaX,l+=e.deltaY;var t=10;o=Math.abs(s)>t||Math.abs(l)>t}},touchEnd:function(i){d?o||t.changeStatus():(t.buttonon&&t.changeStatus(),t.buttonon=!1);var n=i.timeStamp-c<300;!o&&n&&e()}})},changeStatus:function(){function e(e,t){var i={play:"play",pause:"pause"}[e]||"pause";if(t.getdetail().isMasterAudio)try{var n=interaction_view.bgsound||interaction_view.imasterlist.at(0).iOverlaylist.where({iType:"Audio"})[0];interaction_view.media[i](n)}catch(a){console.log(a)}}var t=this.getdetail(),i=this,n=!i.active;if(n)this.switchStatus("active"),e("pause",this);else{if(i.groupcontrol&&t.isSwitch)return;if(i.model.get("isTabBarButton"))return;this.switchStatus("normal"),e("play",this)}},switchStatus:function(e){var t={active:!0,normal:!1,undefined:!this.active}[e]||!1;this.active=t;var i=this.$el.find("img.iconActive"),n=this.$el.find("img.iconNormal");t?(i.show(),n.hide()):(n.show(),i.hide())},getStatus:function(){return this.active},fireButtonGroupClick:function(){Backbone.trigger("buttonGroupClick:"+this.groupType,this)},setAsGroupElement:function(e){this.isGroupItem=!0,this.groupView=e,this.groupType=e.model.attributes.iType;var t=this,i=this.$el,n=i[0];this.alloyFingerInstance.destroy(),this.alloyFingerInstance=new AlloyFinger(n,{tap:function(e){t.fireButtonGroupClick()}})},resetOtherStatus:function(){this.resetButtonStatus()},resetButtonStatus:function(){var e=this.init_reverse?"active":"normal";this.switchStatus(e)}})}),define("interaction_view/model/pay",["interaction_view/model/base"],function(){interaction_view.model.Pay=interaction_view.model.Base.extend({defaults:{iType:"Pay",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Pay({model:this})},setsyncmodel:function(){}}),interaction_view.view.Pay=interaction_view.view.Base.extend({events:{},render:function(e){}})}),define("interaction_view/model/link",["interaction_view/model/base"],function(){interaction_view.model.Link=interaction_view.model.Base.extend({defaults:{iType:"Link",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Link({model:this})},setsyncmodel:function(){}}),interaction_view.view.Link=interaction_view.view.Base.extend({events:{},render:function(e){var t=this.getdetail();this.$el.on("click",function(e){void 0!=t.linktype&&-1!=t.linktype&&window.setTimeout(function(){interaction_view.renderLink(t.linktype,t)},300)})}})}),define("interaction_view/model/binding",["interaction_view/model/base"],function(){interaction_view.model.Binding=interaction_view.model.Base.extend({defaults:{iType:"Binding",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Binding({model:this})},setsyncmodel:function(){}}),interaction_view.view.Binding=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){this.detail=this.model.attributes.iDetail},render:function(e){},preload:function(){},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);var n=this,a=this.getdetail();if(this.bindings=a.iBindings,this.bindings.length>1){this.getControlBinding();_.each(this.bindings,function(e){interaction_view.events.bindingEvents.push({id:e.id,page_id:e.page_id,direction:e.direction,func:function(e){n.executeBinding(n,e)}})})}this.preloaded=!0},getControlBinding:function(){return _.find(this.bindings,function(e){return e.isControl})?_.find(this.bindings,function(e){return e.isControl}):(this.bindings[0].isControl=!0,this.bindings[0])},getOperateBindings:function(){return _.reject(this.bindings,function(e){return e.isControl})},getBindingElement:function(e,t){var i;return i=interaction_view.getParentpage(e)?interaction_view.getParentpage(e):this.model.page,i.iOverlaylist.get(t)},getDirection:function(e,t){var i=this.getControlBinding();return t.id==i.id?e.direction?1:-1:e.id==i.id?t.direction?1:-1:t.direction==e.direction?1:-1},resetBindingStatus:function(){var e,t=this;_.each(this.bindings,function(i){var n=interaction_view.ipagelist.getElement(t.model.page,i.page_id,i.id);if(n)if(i.isControl)if("offset"==i.property){var a=n.iview.getCurrentPositionRate();interaction_view.events.onBingChangeTo({type:0,page_id:n.get("pageid"),id:n.id,delta:-1,deltarate:a.left,cdirection:0}),interaction_view.events.onBingChangeTo({type:0,page_id:n.get("pageid"),id:n.id,delta:-1,deltarate:a.top,cdirection:1})}else e=n.iview.singletime?n.iview.singletime:1e-5,interaction_view.events.onBingChangeTo({type:1,page_id:n.get("pageid"),id:n.id,delta:e/n.iview.timeline.duration(),reset:!0});else"offset"==i.property&&(n.bindingfixed=!0)})},executeBinding:function(e,t){_.each(this.bindings,function(i){if(i.id!=t.id){var n=e.getDirection(i,t),a=e.getBindingElement(i.page_id,i.id);if(a){var r=$.extend(!0,{},t);r.direction=n,r.delta=n*r.delta,r.deltarate=1==n?r.deltarate:e.getRevertRate(a,r.deltarate),r.revert=1==n?!1:!0,a.iview.onExecuteBinding(r)}}})},getRevertRate:function(e,t){if("LayerRef"==e.get("iType"))return 1-t;var i=(e.iview.slidelength,1-t);return i},resetStatus:function(){}})}),define("interaction_view/model/SubContainer",["interaction_view/model/base","interaction_view/view/subcontainer"],function(){interaction_view.model.SubContainer=interaction_view.model.Base.extend({defaults:{iType:"SubContainer",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.setSubOverlays(),this.patchGridSize(),this.setiview()},createPath:function(){var e=interaction_view.createPath({path:this.get("path"),isSubOverlay:this.get("isSubOverlay"),page_id:this.get("pageid"),model:this});return e},setiview:function(){this.iview=new interaction_view.view.SubContainer({model:this})},setsyncmodel:function(){},GridPatch:!0,patchGridSize:function(){if(this.GridPatch){var e=this.get("iCommon"),t=this.get("iDetail"),i=this.get("suboverlays");e[iPageDirection].iWidth=(t.iCols+1)*t.iColspace+i[0].iCommon[iPageDirection].iWidth*t.iCols,e[iPageDirection].iHeight=(t.iRows+1)*t.iRowspace+i[0].iCommon[iPageDirection].iHeight*t.iRows,this.set("iCommon",e)}},getSubOverlays:function(){var e=(this.get("iCommon"),this.get("iDetail")),t=[],n=this.get("suboverlays"),a=n[0],r=e.iRows,o=e.iCols;for(i=0;r>i;i++)for(j=0;j<o;j++)overlay=$.extend(!0,{},a),overlay.id=overlay.id+i+j,overlay.iCommon[iPageDirection].iStartx=e.iColspace*(j+1)+j*overlay.iCommon[iPageDirection].iWidth,overlay.iCommon[iPageDirection].iStarty=e.iRowspace*(i+1)+i*overlay.iCommon[iPageDirection].iHeight,t.push(overlay);return t},createImageSubOverlay:function(e){var t=(e.iFullview,{iType:"Image",iDetail:{iMask:!1,iFullview:e.iFullview,title:e.iImg[0].title,ratiofixxed:!1,iHidden:!1,iImg:e.iImg,iAdapt:!1,iDisplay:e.iDisplay||0},iCommon:{portait:{iWidth:e.iWidth,iHeight:e.iHeight,iStartx:e.iStartx,iStarty:e.iStarty},landscape:{iWidth:e.iWidth,iHeight:e.iHeight,iStartx:e.iStartx,iStarty:e.iStarty}},id:"Img"+_g.uuid(),iHidden:e.iHidden||!1,GalleryIndex:e.index});return t},GridReverse:function(){var e=this.get("iDetail");return e.iSlidetype?!1:!0},getOverlayPositionX:function(e,t,i,n){
return this.GridReverse()?t*(i+1)+i*e.iCommon[iPageDirection].iWidth:t*(n+1)+n*e.iCommon[iPageDirection].iWidth},getOverlayPositionY:function(e,t,i,n){return this.GridReverse()?t*(n+1)+n*e.iCommon[iPageDirection].iHeight:t*(i+1)+i*e.iCommon[iPageDirection].iHeight}}),interaction_view.view.SubContainer=interaction_view.view.Base.extend({events:{},render:function(){this.renderBackGroud()},subPreLoadCheck:function(e){},preload:function(){this.model.get("iDetail");this.sendToPreload({file:null,subcontainer:!0,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")})},afterSubOverlayPreload:function(){console.log("preloadok"),this.preloadmodel&&(this.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.iActionlist.each(function(e){e.iview.render()}),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model)),interaction_view.ismobile&&_g.ui.isOverflowed(this.$el.children(".Element")).y&&this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelY disableDragY"),this.otherAfterSubOverlayPreload&&this.otherAfterSubOverlayPreload()},allowScroll:!0,resetOtherStatus:function(){return this.allowScroll?void 0:!1}})}),define("interaction_view/model/gallery",["interaction_view/model/SubContainer"],function(){interaction_view.model.Gallery=interaction_view.model.SubContainer.extend({defaults:{iType:"Gallery",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSlideNumber:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setiview:function(){this.iview=new interaction_view.view.Gallery({model:this})},getSubOverlays:function(){var e=this.get("iDetail"),t=this.get("iCommon"),n=[],a=this.get("suboverlays"),r=a[0],o=e.iRows,s=e.iCols;if(e.iMode||(e.iSlidetype?o=100:s=100),this.GridReverse()){var l=o;o=s,s=l}var c=0,d=0;if(e.iImg&&e.iImg.length){for(i=0;!(c>=e.iImg.length);i++){for(i==o&&(i=0,d+=1),j=0;j<s&&!(c>=e.iImg.length);j++){overlay=$.extend(!0,{},r),overlay.id=overlay.id+i+j+c,overlay.parent_index=d,overlay.suboverlays[0].iDetail.iText=interaction_view.formatLabel({text:_g.string.getUrlNameWithOutExt(e.iImg[c].title),font_size:overlay.suboverlays[0].iDetail.font_size,text_color:overlay.suboverlays[0].iDetail.text_color,iPosition:overlay.suboverlays[0].iDetail.iPosition}),void 0==e.show_title||e.show_title||overlay.suboverlays.shift();var h=this.createImageSubOverlay({iImg:[e.iImg[c]],iFullview:e.iFullscreen,iWidth:r.iCommon[iPageDirection].iWidth,iHeight:r.iCommon[iPageDirection].iHeight,iStartx:0,iStarty:0,iDisplay:Number(e.iDisplay),index:e.iSlipable?c:c});overlay.suboverlays.unshift(h),overlay.iCommon[iPageDirection].iStartx=this.getOverlayPositionX(overlay,e.iColspace,i,j),overlay.iCommon[iPageDirection].iStarty=this.getOverlayPositionY(overlay,e.iRowspace,i,j),overlay.iCommon[iPageDirection].iStartx>t[iPageDirection].iWidth&&(e.overflow_x=!0),overlay.iCommon[iPageDirection].iStarty>t[iPageDirection].iHeight&&(e.overflow_y=!0),n.push(overlay),c+=1}e.overflow_length=i+1}e.overflow_x&&(e.overflow_x=r.iCommon[iPageDirection].iWidth*e.overflow_length+e.iColspace*(e.overflow_length+1)),e.overflow_y&&(e.overflow_y=r.iCommon[iPageDirection].iHeight*e.overflow_length+e.iRowspace*(e.overflow_length+1)),d+=1}return e.slidelength=d,this.set("iDetail",e),n},patchGridSize:function(){if(this.GridPatch){var e=this.get("iCommon"),t=this.get("iDetail"),i=this.get("suboverlays");(t.iMode||!t.iMode&&t.iSlidetype)&&(e[iPageDirection].iWidth=(t.iCols+1)*t.iColspace+i[0].iCommon[iPageDirection].iWidth*t.iCols),(t.iMode||!t.iMode&&!t.iSlidetype)&&(e[iPageDirection].iHeight=(t.iRows+1)*t.iRowspace+i[0].iCommon[iPageDirection].iHeight*t.iRows),this.set("iCommon",e)}}}),interaction_view.view.Gallery=interaction_view.view.SubContainer.extend({otherAfterSubOverlayPreload:function(){var e=this.getSlideLength(),t=this.getdetail(),n=t.iCols*t.iRows;if(t.iMode||(n=t.iImg?t.iImg.length:0),e){var a=this.$el.children(".Element").children().detach(),r=0;for(i=0;e>i;i++)for(this.$el.children(".Element").append('<div class="gallery-content" data-index="'+i+'"></div>'),j=0;j<n;j++){var o=this.$el.children(".Element").children().eq(i);o.append(a[r]),r+=1}this.setSlidePosition()}},getSlideLength:function(){var e=this.getdetail();return e.slidelength||0},setSlidePosition:function(){var e=this.getdetail(),t=this.getcommon();e.iMode?(this.$el.children(".Element").addClass("hasSlide"),this.$el.children(".Element").css({overflow:"hidden"}),this.$el.children(".Element").children().each(function(){$(this).index();$(this).css({position:"absolute",width:"100%",height:"100%"})}),this.playAnimation()):e.iSlidetype?(this.$el.children(".Element").css({overflow:"hidden"}),this.$el.children(".Element").children().each(function(){var e=$(this).index();$(this).css({position:"absolute",left:0,top:e*t.iHeight,width:"100%",height:"100%"})}),this.galleryFlow().y&&(this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelY disableDragY"),this.scrollview=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,probeType:3,scrollX:!1,scrollY:!0,click:!0,wrapperWidth:t.iWidth,wrapperHeight:t.iHeight,scrollerWidth:t.iWidth,scrollerHeight:e.overflow_y}))):(this.$el.children(".Element").css({overflow:"hidden"}),this.$el.children(".Element").children().each(function(){var e=$(this).index();$(this).css({position:"absolute",left:e*t.iWidth,top:0,width:"100%",height:"100%"})}),this.galleryFlow().x&&(this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelX disableDragX"),this.scrollview=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,probeType:3,scrollX:!0,scrollY:!1,click:!0,wrapperWidth:t.iWidth,wrapperHeight:t.iHeight,scrollerWidth:e.overflow_x,scrollerHeight:t.iHeight})))},playAnimation:function(){var e=this,t=this.getdetail();t.iSlidetype;this.delay=Number(t.iInterval)||2,this.autoplay=t.iAutoplay,this.iFade="Slip";var i=0;this.timeline=new TimelineMax({paused:!0,repeat:i,onComplete:this.setRewind}),this.slideel=e.$el.children(".Element").first(),this.slidelength=this.getSlideLength(),this.repeat=i,this.iRewind=t.iRewind,this.slipable=!0,this.setTimeline(),this.autoplay?this.$el.children(".Element").is(":hidden")||this.timeline.play(0):this.setSlideDisplay(0),this.onChangeSlideTo(0),this.slipable&&(this.control(),this.autoplay||this.$el.attr("data-iSlipable",!0))},setTimeline:function(){if("Fade"==this.iFade)this.setFade();else if("Slip"==this.iFade)this.setSlip();else{if("None"!=this.iFade)return;this.setNone()}this.slideel.children().first().css({opacity:1,left:0,top:0}).nextAll().css("opacity",0)},testControl:function(){return!0},preview_left:function(e){e>0&&this.model.iOverlaylist.at(e-1).iOverlaylist.at(0).iview.$el.children(".Element").trigger("click")},preview_right:function(e){e<this.model.iOverlaylist.length-1&&this.model.iOverlaylist.at(e+1).iOverlaylist.at(0).iview.$el.children(".Element").trigger("click")},galleryFlow:function(){var e={x:!1,y:!1},t=(this.getcommon(),this.getdetail());return t.overflow_x&&(e.x=!0),t.overflow_y&&(e.y=!0),e},resetOtherStatus:function(){var e=this;return this.allowScroll?(this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY"),void("undefined"!=typeof wx_permissions&&wx_permissions.previewImage&&e.$el.find(".iImage.Element").click(function(t){var i=e.$el.find(".iImage.Element").index($(this));e.fullviewIndex(i)}))):!1}})}),define("interaction_view/model/Grid",["interaction_view/model/gallery"],function(){interaction_view.model.Grid=interaction_view.model.Gallery.extend({defaults:{iType:"Grid",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},getSubOverlays:function(){var e=this.get("iDetail"),t=this.get("iCommon"),n=[],a=this.get("suboverlays"),r=a[0],o=e.iRows,s=e.iCols,l=0,c=0;for(i=0;o>i;i++)for(j=0;j<s;j++)overlay=$.extend(!0,{},r),overlay.id=overlay.id+i+j+l,overlay.parent_index=c,overlay.suboverlays=_.map(overlay.suboverlays,function(t){return("TextLabel"==t.iType||"BookButton"==t.iType)&&(t.iDetail.iText=interaction_view.formatLabel({text:t.iDetail.iText,font_size:t.iDetail.font_size,text_color:t.iDetail.text_color,iPosition:t.iDetail.iPosition,radius:t.iDetail.corner_radius,border_color:t.iDetail.border_color,bg_color:t.iDetail.bg_color,border_size:t.iDetail.border_size})),"Image"==t.iType&&(t.iDetail.iDisplay=e.iDisplay),t}),overlay.suboverlays=_.reject(overlay.suboverlays,function(t){return(e.show_title||"title"!=t.iDetail.iValue)&&(e.show_description||"description"!=t.iDetail.iValue)?void 0:!0}),overlay.iCommon[iPageDirection].iStartx=this.getOverlayPositionX(overlay,e.iColspace,i,j),overlay.iCommon[iPageDirection].iStarty=this.getOverlayPositionY(overlay,e.iRowspace,i,j),overlay.iCommon[iPageDirection].iStartx>t[iPageDirection].iWidth&&(e.overflow_x=!0),overlay.iCommon[iPageDirection].iStarty>t[iPageDirection].iHeight&&(e.overflow_y=!0),n.push(overlay),l+=1;return e.slidelength=c,this.set("iDetail",e),n},setiview:function(){this.iview=new interaction_view.view.Grid({model:this})}}),interaction_view.view.Grid=interaction_view.view.Gallery.extend({allowScroll:!1})}),define("interaction_view/model/Cell",["interaction_view/model/SubContainer"],function(){interaction_view.model.Cell=interaction_view.model.SubContainer.extend({defaults:{iType:"Cell",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,isStatic:!0},setiview:function(){this.iview=new interaction_view.view.Cell({model:this})},GridPatch:!1,getSubOverlays:function(){var e=(this.get("iDetail"),this.get("suboverlays"));return e}}),interaction_view.view.Cell=interaction_view.view.SubContainer.extend({allowScroll:!1})}),define("interaction_view/model/TextLabel",["interaction_view/model/base"],function(){interaction_view.model.TextLabel=interaction_view.model.Base.extend({defaults:{iType:"TextLabel",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.TextLabel({model:this})},setsyncmodel:function(){}}),interaction_view.view.TextLabel=interaction_view.view.Base.extend({events:{},render:function(e){this.model.get("iDetail")}})}),define("interaction_view/model/TabBar",["interaction_view/model/SubContainer"],function(){interaction_view.model.TabBar=interaction_view.model.SubContainer.extend({defaults:{iType:"TabBar",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setiview:function(){this.iview=new interaction_view.view.TabBar({model:this})},GridPatch:!1,getSubOverlays:function(){var e=(this.get("iDetail"),this.get("suboverlays"));return e=_.map(e,function(e){return e.isTabBarButton=!0,e})}}),interaction_view.view.TabBar=interaction_view.view.SubContainer.extend({allowScroll:!1})}),define("interaction_view/model/SearchInput",["interaction_view/model/base"],function(){interaction_view.model.SearchInput=interaction_view.model.Base.extend({defaults:{iType:"SearchInput",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.SearchInput({model:this})},setsyncmodel:function(){}}),interaction_view.view.SearchInput=interaction_view.view.Base.extend({events:{},render:function(e){}})}),define("text!interaction_view/template/Tree_content.tpl",[],function(){return'<div class="treeview category-bookshelf inited">\n                <ul>\n                  <li>\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">所有</a></h4></div>\n                  </li>\n                  <li>\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">未分类</a></h4></div>\n                  </li>\n                  <li class="hasmenu unfold">\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">分类 1</a></h4><div class="hitarea"></div></div>\n                    <ul>\n                      <li class="active">\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;background:<%=iDetail.selected_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">分类 1.1</a></h4></div>\n                      </li>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="">分类 1.2</a></h4></div>\n                      </li>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">分类 1.3</a></h4></div>\n                      </li>\n                    </ul>\n                  </li>\n                  <li class="hasmenu unfold">\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">分类 2</a></h4><div class="hitarea"></div></div>\n                    <ul>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">分类 2.1</a></h4></div>\n                      </li>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">分类 2.2</a></h4></div>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </div>'}),define("interaction_view/model/Tree",["interaction_view/model/base","text!interaction_view/template/Tree_content.tpl"],function(){var e=require("text!interaction_view/template/Tree_content.tpl");interaction_view.model.Tree=interaction_view.model.Base.extend({defaults:{iType:"Tree",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Tree({model:this})},setsyncmodel:function(){}}),interaction_view.view.Tree=interaction_view.view.Base.extend({events:{},render:function(t){var i=this.getdetail();if(i.is_expandable){var n='<img src="'+i.iImg+'" width="41px" height="38px"><img>';this.$el.children(".Element").html(n)}else this.$el.children(".Element").html(_.template(e,this.model.toJSON()))}})}),define("interaction_view/model/PageIndex",["interaction_view/model/SubContainer"],function(){interaction_view.model.PageIndex=interaction_view.model.SubContainer.extend({defaults:{iType:"PageIndex",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setiview:function(){this.iview=new interaction_view.view.PageIndex({model:this})},getSubOverlays:function(){var e=this.get("iDetail"),t=this.get("iCommon"),n=[],a=this.get("suboverlays"),r=a[0],o=(e.iRows,e.iCols),s=0;if(this.indexpages=interaction_view.foredit?iPagelist.getIndexPages():interaction_view.ipagelist.getIndexPages(),this.indexpages.length){for(i=0;!(s>=this.indexpages.length);i++)for(j=0;j<o&&!(s>=this.indexpages.length);j++){overlay=$.extend(!0,{},r),overlay.id=overlay.id+i+j,overlay.suboverlays[1].iDetail.iText=interaction_view.formatLabel({text:this.indexpages[s].get("title"),font_size:overlay.suboverlays[1].iDetail.font_size,text_color:overlay.suboverlays[1].iDetail.text_color,iPosition:overlay.suboverlays[0].iDetail.iPosition});var l=this.indexpages[s].get("nav");overlay.suboverlays[0].iDetail.iImg=l&&l.thumbnail?[l]:[],overlay.suboverlays[0].iDetail.iDisplay=1,this.get("iDetail").show_thumb||overlay.suboverlays.shift(),this.get("iDetail").show_title||overlay.suboverlays.shift(),overlay.iCommon[iPageDirection].iStartx=e.iColspace*(j+1)+j*overlay.iCommon[iPageDirection].iWidth,overlay.iCommon[iPageDirection].iStarty=e.iRowspace*(i+1)+i*overlay.iCommon[iPageDirection].iHeight,n.push(overlay),s+=1}e.overflow_y=(this.indexpages.length+1)*e.iRowspace+overlay.iCommon[iPageDirection].iHeight*this.indexpages.length,e.overflow_y=e.overflow_y>t[iPageDirection].iHeight?e.overflow_y:null,this.set("iDetail",e,{silent:!0})}return n},patchGridSize:function(){if(this.GridPatch){var e=this.get("iCommon"),t=this.get("iDetail");t.iRows=this.indexpages.length;var i=this.get("suboverlays");e[iPageDirection].iWidth=(t.iCols+1)*t.iColspace+i[0].iCommon[iPageDirection].iWidth*t.iCols;(t.iRows+1)*t.iRowspace+i[0].iCommon[iPageDirection].iHeight*t.iRows;this.set("iCommon",e),this.set("iDetail",t)}}}),interaction_view.view.PageIndex=interaction_view.view.SubContainer.extend({otherAfterSubOverlayPreload:function(){var e=this.model.indexpages;this.$el.children(".Element").find("[data-type=Cell]").each(function(){var t=e[$(this).index()].id;$(this).children(".Element").css({cursor:"pointer"}),interaction_view.foredit||$(this).children(".Element").on("click",function(){presentation.gotopage(t,9)})});var t=this.getdetail(),i=this.getcommon();t.overflow_y&&(this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelY disableDragY"),this.$el.children(".Element").wrapInner('<div class="iContent"></div>'),this.scrollview=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,probeType:3,scrollX:!1,scrollY:!0,click:!0,wrapperWidth:i.iWidth,wrapperHeight:i.iHeight,scrollerWidth:i.iWidth,scrollerHeight:t.overflow_y}))}})}),define("text!interaction_view/template/offline_info.tpl",[],function(){return'<div class="offline-shadow" style="background: rgba(218,218,218,0.7);left:0;top:0;width:100%;height:100%;position:absolute;display: block;">\n <div class="offline-text" style="line-height:<%=iCommon[iPageDirection].iHeight%>px;text-align: center;">\n   <i class="icon-warning-sign icon-4x" style="display: inline-block;">\n    <br>\n    <span style="background: #444444;color: #FFFFFF;padding: 8px;font-size: 14px;">请在联网的状态下使用</span>\n   </i>\n </div>\n</div>\n '}),define("interaction_view/model/webcontent",["interaction_view/model/base","text!interaction_view/template/offline_info.tpl"],function(){var e=require("text!interaction_view/template/offline_info.tpl");interaction_view.model.WebContent=interaction_view.model.Base.extend({defaults:{iType:"WebContent",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.WebContent({model:this})},setsyncmodel:function(){}}),interaction_view.view.WebContent=interaction_view.view.Base.extend({events:{},render:function(){this.model.renderWebContent=!0},renderWebContent:function(e){var t=this,i=this.detail;if(!this.result){var n=this.result||interaction_view.getWebContentSrc(i);this.result=n}if(this.detail.iAsbg&&this.$el.children(".Element").removeClass("iMouseWheel disableMouseWheelY disableMouseWheelX disableDragX disableDragY"),this.result&&(this.result.src||this.result.content)){if(this.iframeStyle?(this.$el.children(".Element").html("<iframe></iframe>"),this.$el.children(".Element").find("iframe").first().attr("style",this.iframeStyle)):this.iframeStyle=this.$el.children(".Element").find("iframe").first().attr("style"),n=this.result,n&&n.src){var a=this.$el.children(".Element").find("iframe").first()[0];a&&(a.src=n.src,a.onload=function(){})}else n&&n.content&&(this.hasContent=n.content);i.iOnline&&(interaction_view.isOnline||(null==interaction_view.isOnline?_g.device.online(web_url+"diazo/img/favicon.png",function(){interaction_view.isOnline=!0},function(){interaction_view.isOnline=!1,t.renderOfflineInfo()}):t.renderOfflineInfo())),this.detail.iAsbg&&(this.$el.find(".iframe_mask").length||$('<div class="iframe_mask absolutecenter"></div>').insertAfter(this.$el.find("iframe").first()))}},renderOfflineInfo:function(){this.$el.children(".Element").append(_.template(e,this.model.toJSON()))},clearWebContent:function(){this.$el.children(".Element").find("iframe").first().remove()},otherOnShow:function(){},onPlay:function(){this.hasContent&&(this.$el.children(".Element").find("iframe").first()[0].contentWindow.document.write(this.hasContent),this.$el.children(".Element").find("iframe").first()[0].contentWindow.document.body&&(this.$el.children(".Element").find("iframe").first()[0].contentWindow.document.body.style.margin=0,this.$el.children(".Element").find("iframe").first()[0].contentWindow.document.body.style.padding=0),this.$el.children(".Element").find("iframe").data("content",this.hasContent))}})}),define("interaction_view/model/shape",["interaction_view/model/base"],function(){interaction_view.model.Shape=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){interaction_view.isAndroid&&interaction_view.isWeixin&&this.attributes.iDetail.iSvg&&(this.attributes.iDetail.iSvg=this.attributes.iDetail.iSvg.replace(/<filter.*<\/filter>/g,"")),this.iview=new interaction_view.view.Shape({model:this})},setsyncmodel:function(){}}),interaction_view.view.Shape=interaction_view.view.Base.extend({events:{},render:function(e){var t=this.$el.find(".Element").width()+.5,i=this.$el.find(".Element").height()+.5;this.$el.find("svg").width(t),this.$el.find("svg").height(i)},resetOtherStatus:function(){},otherOnShow:function(){this.resetOtherStatus()}})}),define("interaction_view/model/BookButton",["interaction_view/model/TextLabel"],function(){interaction_view.model.BookButton=interaction_view.model.TextLabel.extend({defaults:{iType:"BookButton",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setiview:function(){this.iview=new interaction_view.view.BookButton({model:this})}}),interaction_view.view.BookButton=interaction_view.view.TextLabel.extend({allowScroll:!1})}),define("interaction_view/model/dragdrop",["interaction_view/model/base","interaction_view/model/button"],function(){interaction_view.model.DragDrop=interaction_view.model.Base.extend({defaults:{iType:"DragDrop",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.DragDrop({model:this})},setsyncmodel:function(){}}),interaction_view.view.DragDrop=interaction_view.view.Base.extend({events:{},render:function(e){this.model._reset=!0},preload:function(){this.preloaded=!1,this.checkImglist=[];var e=this.getdetail(),t=[null,null];if(e.iconNormal&&e.iconNormal[0]){this.checkImglist.push(e.iconNormal[0].picture);var i=this.sendToPreload({file:e.iconNormal[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[0]=i.id}if(e.iconActive&&e.iconActive[0]){this.checkImglist.push(e.iconActive[0].picture);var i=this.sendToPreload({file:e.iconActive[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[1]=i.id}this.model.set("preload_id",t)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.Status=0},switchStatus:interaction_view.view.Button.prototype.switchStatus,changeStatus:function(e){void 0!==e&&(this.active=e);var t=this.active?"normal":"active";this.switchStatus(t)},resetOtherStatus:function(){var e=this;e.resetButtonStatus(),e.DragDropGroups=[],$.each(e.model.page.iOverlaylist.where({iType:"DragDropGroup"}),function(t,i){_.include(i.iview.getdetail().element_ids,e.model.id)&&e.DragDropGroups.push(i)})},resetButtonStatus:function(){this.switchStatus("normal")}})}),define("interaction_view/model/dragdropgroup",["interaction_view/model/base"],function(){interaction_view.model.DragDropGroup=interaction_view.model.Base.extend({defaults:{iType:"DragDropGroup",iVisibility:!0,iCommon:null,iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iOptions:{createfocus:!0},iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.DragDropGroup({model:this})},setsyncmodel:function(){}}),interaction_view.view.DragDropGroup=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){var e=this.model.toJSON();this.detail=e.iDetail},render:function(e){this.model._reset=!0},preload:function(){},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0}})}),define("interaction_view/model/variable",["interaction_view/model/base"],function(){interaction_view.model.Variable=interaction_view.model.Base.extend({defaults:{},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.attributes.iDetail.initial=interaction_view.isEvilCode(this.attributes.iDetail.initial),this.iview=new interaction_view.view.Variable({model:this})},setsyncmodel:function(){}}),interaction_view.view.Variable=interaction_view.view.Base.extend({events:{},resetOtherStatus:function(){this.showRandom(),this.updateText(this.origin,addtourl=0)},updateText:function(e,t){var i=this.getdetail();if(e&&(i.initial=e),this.isKindNum())if(_.isNaN(Number(i.initial))||interaction_view.isPersonId(i.initial))i.initial=i.initial;else{var n=Number(i.initial);n>0&&i.initial[0]&&"0"===i.initial[0]||(i.initial=(Number(i.initial)||0).toFixed(Number(i.precision)||0))}this.$el.find(".Element").html(interaction_view.Txt2Html(i.initial)),t&&this.addToUrl()},render:function(e){var t=this.getdetail();this.iHorizontal=["left","center","right"],t.iEditable&&(t.initial=this.getFromUrl()),""!=$.trim(t.randlist)&&(t.randlist=_.compact(t.randlist.split(/[^0-9]/g))),this.isKindRandom()&&t.iRepeatable&&(this.Random={available:[],used:[]}),this.updateText("",addtourl=0),this.$el.find(".Element").css("font-size",t.font_size).css("color",t.font_color).css("text-align",this.iHorizontal[t.iPosition]),this.origin=t.initial,this.model._reset=!0},setVariable:function(e,t,i,n){var a=this,r=this.getdetail(),o=_g.uuid(2);if((!this.isKindText()||1!=e&&2!=e&&3!=e)&&!(this.isKindRandom()&&3!=e||!this.isKindRandom()&&3==e)&&(!this.isKindNum()||"NaN"!=Number(t).toString()||interaction_view.expression.isVar(t)))switch(e=Number(e),this.isKindNum()&&(r.initial=Number(r.initial)),e){case 0:DB.Cache.addSwitch(o),interaction_view.expression.id2values(t,function(e){r.initial=e,a.updateText("",addtourl=0),a.triggerVarChange(),n&&n(e),DB.Cache.closeSwitch(o)},{_promise:i});break;case 1:DB.Cache.addSwitch(o),interaction_view.expression.id2values(t,function(e){_.isNaN(Number(e))||(e=Number(e)),r.initial+=e,a.updateText("",addtourl=0),a.triggerVarChange(),n&&n(e),DB.Cache.closeSwitch(o)},{_promise:i});break;case 2:DB.Cache.addSwitch(o),interaction_view.expression.id2values(t,function(e){_.isNaN(Number(e))||(e=Number(e)),r.initial-=e,a.updateText("",addtourl=0),a.triggerVarChange(),n&&n(e),DB.Cache.closeSwitch(o)},{_promise:i});break;case 3:var s=this.setRandom();a.updateText("",addtourl=0),a.triggerVarChange(),n&&n(s),i&&i.done()}},triggerVarChange:function(){var e=this.getdetail();1==e.immediate&&interaction_view.events.onVariableChanged(this)},isKindNum:function(){var e=this.getdetail();return 0==e.iKind},isKindText:function(){var e=this.getdetail();return 1==e.iKind},isKindRandom:function(){var e=this.getdetail();return 2==e.iKind},showRandom:function(){this.isKindRandom()&&(this.origin=this.setRandom())},setRandom:function(){var e=this.getdetail();if(e.iRepeatable){this.isUseup(e);var t;do t=this.getRandom(e);while(_.contains(this.Random.used,t));this.Random.used.push(t),e.initial=t}else e.initial=this.getRandom(e);return e.initial},isUseup:function(e){(!e.randlist&&this.Random.used.length>=e.range[1]-e.range[0]+1||e.randlist&&this.Random.used.length>=e.randlist.length)&&(this.Random.used=[]);
},getRandom:function(e){return e.randlist?e.randlist[_.random(0,e.randlist.length-1)]:_.random(e.range[0],e.range[1])},getFromUrl:function(e){var t=_g.getUrlParameterByName(this.model.id,e);if(t||0==t||(t=_g.getHashParameterByName(this.model.id)),t||0==t||(t=this.getdetail().initial),"epub360"==epub360_domain&&""!=interaction_view.environment.Userdata.id)if(1==interaction_view.environment.Userdata.status)interaction_view.environment.Userdata.addView(this);else{var i=this.model.get("pageid"),n=interaction_view.environment.Userdata.getitem(i,this.model.id);n&&(t=n.value)}return t},addToUrl:function(e){var t=this.getdetail();if(!t.iEditable)return!1;if("undefined"==typeof message_link&&(message_link=document.location.href,interaction_view.weixin.share()),"undefined"==typeof e&&(e=t.initial),"epub360"==epub360_domain&&""!=interaction_view.environment.Userdata.id){this.model.get("pageid");return interaction_view.environment.Userdata.setitem(this,{value:e}),!0}return exist?!1:!0}})}),function(){var e={readCookie:function(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var a=i[n];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null},load:function(e,t){return _g.ajax.get(e,t)},get:function(e,t){var i={url:null,dataType:"JSON",staticUrl:null,callback:null,parseData:null,debug:!1,name:null,retry:!1,retrydelay:0};"string"==typeof e?(i.url=e,i.callback=t,e=i):e=e?$.extend(!0,{},i,e):$.extend(!0,{},i),_g.debug&&_g.debug.enabled&&(e.name||(e.name=e.url),_g.debug.data[e.name]={});var n="undefined"!=typeof _gDebug&&_gDebug||e.debug,a=n?_g.debug&&_g.debug.query_user_data(e.name)?_g.debug.query_user_data(e.name):e.staticUrl||e.url:e.url;if(!a)return!1;var r=$.ajax({url:a,type:"GET",data:"",dataType:e.dataType,beforeSend:e.beforeSend,success:function(t){_g.debug&&_g.debug.enabled&&(_g.debug.data[e.name].data=$.extend(!0,{},t)),n&&e.parseData&&(t=e.parseData(t)),e.callback&&e.callback(t)},error:function(t){_g.error.serverError(null,t),e.onError&&e.onError(0)},timeout:1e5});return r},post:function(e,t,i){var n={url:null,data:null,dataType:"JSON",staticUrl:null,callback:null,debug:!1,name:null,retry:!1,retrydelay:0,type:"POST"};"string"==typeof e?(n.url=e,n.callback=i,n.data=t,e=n):e=e?$.extend(!0,{},n,e):$.extend(!0,{},n),_g.debug&&_g.debug.enabled&&(e.name||(e.name=e.url),_g.debug.data[e.name]={}),e.type=e.type||"POST";var a="undefined"!=typeof _gDebug&&_gDebug||e.debug,r=a?_g.debug&&_g.debug.query_user_data(e.name)?_g.debug.query_user_data(e.name):e.staticUrl||e.url:e.url;if(!r)return!1;var o=$.ajax({url:r,type:a?"GET":e.type,data:e.data,dataType:e.dataType,traditional:e.traditional,beforeSend:e.beforeSend,success:function(t){try{epub360.variable.network_error_time=0}catch(i){}_g.debug&&_g.debug.enabled&&(_g.debug.data[e.name].data=$.extend(!0,{},t)),e.callback&&e.callback(t)},error:function(t){_g.error.serverError(e.name,t),e.onError&&e.onError(0)},timeout:1e5});return o},"delete":function(e,t){var i={url:null,data:null,dataType:"JSON",staticUrl:null,callback:null,debug:!1,name:null,retry:!1,retrydelay:0},n={};"string"==typeof e?(i.url=e,i.callback=t,i.data=n,e=i):e=e?$.extend(!0,{},i,e):$.extend(!0,{},i),_g.debug&&_g.debug.enabled&&(e.name||(e.name=e.url),_g.debug.data[e.name]={});var a="undefined"!=typeof _gDebug&&_gDebug||e.debug,r=a?_g.debug&&_g.debug.query_user_data(e.name)?_g.debug.query_user_data(e.name):e.staticUrl||e.url:e.url;if(!r)return!1;var o=$.ajax({url:r,type:"DELETE",data:e.data,dataType:e.dataType,traditional:e.traditional,beforeSend:e.beforeSend,success:function(t){_g.debug&&_g.debug.enabled&&(_g.debug.data[e.name].data=$.extend(!0,{},t)),e.callback&&e.callback(t)},error:function(t){_g.error.serverError(e.name,t),e.onError&&e.onError(0)},timeout:1e5});return o},dataGenerate:function(e){var t={dataSource:null,map:null,key:null,count:0};if(e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),!e.dataSource||!e.map)return e.dataSource;var n=e.key?e.dataSource[e.key]:e.dataSource;if(!n[0])return e.dataSource;for(i=0;i<e.count;i++){var a={},r=n[0];_.each(r,function(t,i){var n;if(e.map[i]){switch(e.map[i]){case"uuid":n=_g.uuid();break;case"randompick":n=_g.array.randomPick(r[i]);break;case"string":n=_g.string.randomGenerate(10);break;case"number":n=_g.number.randomInt();break;case"boolean":n=_g["boolean"].randomPick();break;default:n=r[i]}a[i]=n}else a[i]=r[i]}),n.push(a)}return n.shift(),e.key?e.dataSource[e.key]=n:e.dataSource=n,e.dataSource},testSpeed:function(e){function t(){var e=(a-n)/1e3,t=8*o,i=(t/e).toFixed(2),r=(i/1024).toFixed(2);(r/1024).toFixed(2)}var i={file:null,fileSize:0,callback:null};if(e=e?$.extend(!0,{},i,e):$.extend(!0,{},i),!e.file)return!1;var n,a,r=e.file+"?n="+Math.random(),o=e.fileSize,s=new Image;s.onload=function(){a=(new Date).getTime(),t()},n=(new Date).getTime(),s.src=r}};"undefined"==typeof require?(window._g||(window._g={}),window._g.ajax=e,e=void 0):define("_g/ajax",["jquery","_g/base","_g/error"],function(){return window._g.ajax=e,e=void 0,window._g.ajax})}(window),define("interaction_view/model/vote",["_g/ajax","interaction_view/model/base","interaction_view/model/button"],function(){interaction_view.model.Vote=interaction_view.model.Base.extend({defaults:{iType:"Vote",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.get("iDetail");this.setSubOverlays(),this.iview=new interaction_view.view.Vote({model:this})},setsyncmodel:function(){}}),interaction_view.view.Vote=interaction_view.view.Base.extend({events:{},getInitialValue:function(){return parseInt(this.model.get("iDetail").initial)||0},render:function(e){var t=this;this.voteUrl||(this.voteUrl=encodeURI(context_url+this.model.iPageId+"/vote/"+t.model.id+"/")),this.noVoted()&&(this.waitForVoted=!0,this.$el.hide()),this.$el.addClass("hasaction"),this.resetOtherStatus(),interaction_view.environment.Votes.add(this.model)},preload:function(){this.preloaded=!1,this.checkImglist=[];var e=this.getdetail(),t=[null,null];if(e.iconNormal&&e.iconNormal[0]){this.checkImglist.push(e.iconNormal[0].picture);var i=this.sendToPreload({file:e.iconNormal[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[0]=i.id}if(e.iconActive&&e.iconActive[0]){this.checkImglist.push(e.iconActive[0].picture);var i=this.sendToPreload({file:e.iconActive[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[1]=i.id}this.sendToPreload({file:null,subcontainer:!0,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")}),this.model.set("preload_id",t)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.$el.css("cursor","pointer")},bindClick:function(){var e=this;e.vote||(e.vote=function(){e.model.get("suboverlays")[0].iDetail.iValue+=1,e.changeStatus(),_g.ajax.post({dataType:"JSON",url:e.voteUrl,data:{value:1},callback:function(t){var i=e.getInitialValue();t.num_votes&&(e.model.get("suboverlays")[0].iDetail.iValue=t.num_votes+i,interaction_view.environment.Votes.update(e.model),e.model.set("value",t.num_votes+i),e.model.set("voted",1),e.model.set("position",t.position+i),e.changeStatus())}})});var t="tap";this.isVoted()?this.$el.hammer().off(t,e.vote):(this.binded||this.$el.hammer().one(t,e.vote),this.binded=!0)},switchStatus:interaction_view.view.Button.prototype.switchStatus,changeStatus:function(){this.waitForVoted||(this.$el.show(),this.isVoted()?this.switchStatus("active"):this.switchStatus("normal")),this.setTitle()},resetOtherStatus:function(){var e=this;this.isVoted()&&this.$el.show(),_g.ajax.get({dataType:"JSON",url:e.voteUrl,callback:function(t){e.waitForVoted=!1;var i=e.getInitialValue();t.num_votes?(e.model.get("suboverlays")[0].iDetail.iValue=t.num_votes+i,e.model.set("value",t.num_votes+i),e.model.set("voted",t.vote_value),e.model.set("position",t.position+i)):(e.model.get("suboverlays")[0].iDetail.iValue=i,e.model.set("value",i),e.model.set("voted",0),e.model.set("position",i)),e.bindClick(),e.changeStatus(),e.waitForVoted2&&(e.triggerVoted(),e.waitForVoted2=!1)}})},triggerVoted:function(){this.noVoted()?this.waitForVoted2=!0:this.isVoted()&&interaction_view.events.onVoted(this)},setTitle:function(){var e=(this.getdetail(),this.model.get("suboverlays")),t=e[0].iDetail.iValue,i=interaction_view.formatLabel({text:"Jason"==t?"Name":t,font_size:e[0].iDetail.font_size,text_color:e[0].iDetail.text_color,iPosition:e[0].iDetail.iPosition});this.$el.find(".iTextLabel.Element").html(i)},afterSubOverlayPreload:function(){this.preloadmodel&&(this.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.iActionlist.each(function(e){e.iview.render()}),this.setTitle(),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))},isVoted:function(){return this.model.get("voted")},noVoted:function(){return"undefined"==typeof this.model.get("voted")}})}),define("text!interaction_view/template/prompt.tpl",[],function(){return'<div class="<%=class_name%>" style="display:none;">\n	<div class="modalArea" style="position: fixed;top: 50%;left: 50%;z-index: 10003;background: white;box-shadow: 0 0 60px rgba(0, 0, 0, .25); width: 480px;height: 235px; margin-left: -240px;margin-top: -120px;text-align: center;">\n		<div class="alert" style="text-align:left; margin-bottom: 0px;">输入文字 :</div>\n		<div style="padding: 10px 10px 10px;">\n			<textarea style="resize: none; width: 96%;height: 120px;border: 0px;" autofocus="autofocus"></textarea>\n			<div style="margin: 10px;">\n				<button type="button" style="margin-right: 40px;border-radius: 18px 18px;padding: 7px 28px;" class="btn btn-default cancel">取消</button>\n				<button type="button" style="border-radius: 18px 18px;padding: 7px 28px;" class="btn btn-danger ok">确认</button>\n			</div>\n		</div>\n	</div>\n	<div class="modal-backdrop fade in" style="z-index: 10002;"></div>\n</div>'}),define("interaction_view/model/paragraph",["interaction_view/model/base","text!interaction_view/template/prompt.tpl"],function(){var e=require("text!interaction_view/template/prompt.tpl");interaction_view.model.Paragraph=interaction_view.model.Base.extend({defaults:{iType:"Paragraph",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.attributes.iDetail.iText=interaction_view.isEvilCode(this.attributes.iDetail.iText),this.iview=new interaction_view.view.Paragraph({model:this})},setsyncmodel:function(){}}),interaction_view.view.Paragraph=interaction_view.view.Base.extend({events:{},render:function(e){var t=this;if(this.scrollEl=this.$el.children(".Element"),this.textel=this.$el.find(".iText"),this.originContent=this.model.attributes.iDetail.iText,"undefined"==typeof this.userContent&&(this.userContent=this.originContent),"undefined"==typeof message_link&&(message_link=location.href,interaction_view.weixin.share()),this.model.attributes.iDetail.iEditable){var i=this.model.attributes.iDetail.iEditable?message_link:data_link,n=_g.getUrlParameterByName(this.model.id,i);if(null==n&&(n=_g.getHashParameterByName(this.model.id)),null==n&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var a=this.model.get("pageid"),r=interaction_view.environment.Sharedata.getitem(a,this.model.id);r&&(n=r.iText)}n&&this.updateText(n,addtourl=0)}this.renderEdit(),this.model.attributes.iDetail.iEditable&&this.$el.find(".iParagraph").addClass("editable"),this.renderlink&&window.setTimeout(function(){t.renderlink()},300),this.model._reset=!0},resetOtherStatus:function(){var e=this;if(this.$el.children(".Element").find(".paragraph").length){if(this.$el.children(".Element").find(".paragraph").first().children("div").length&&_g.ui.isOverflowed(this.$el.children(".Element").find(".paragraph").first().children("div")).y){if(!this.$el.children(".Element").hasClass("disableDragY")){var t=this.$el.find(".paragraph").first().children("div"),i=t.height();t.wrapInner('<div class="iContent" style="font-size: inherit;color: inherit;font-family: inherit;font-weight:inherit;"></div>');var n=_g.ui.isOverflowed(t).y-i;this.scrollView=new IScroll(t[0],{mouseWheel:!0,click:!0,probeType:3,wrapperHeight:i,HWCompositing:!0}),this.scrollView.on("scroll",function(){console.log(this.y),n&&n>0&&(this.y>0?this.y>30&&e.scrollEl.addClass("is_exceededY"):Math.abs(this.y)-n>30&&e.scrollEl.addClass("is_exceededY"))}),this.scrollEl=this.$el.children(".Element"),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY")}this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY")}}else if(_g.ui.isOverflowed(this.$el.children(".Element")).y){if(!this.$el.children(".Element").hasClass("disableDragY")){var i=this.$el.children(".Element").height();this.$el.children(".Element").wrapInner('<div class="iContent"></div>');var n=_g.ui.isOverflowed(this.$el.children(".Element")).y-i;this.scrollView=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,click:!0,probeType:3}),this.scrollView.on("scroll",function(){console.log(this.y),n&&n>0&&(this.y>0?this.y>30&&e.scrollEl.addClass("is_exceededY"):Math.abs(this.y)-n>30&&e.scrollEl.addClass("is_exceededY"))}),this.scrollEl=this.$el.children(".Element"),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY")}this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY")}},otherOnShow:function(){this.resetOtherStatus()},renderEdit:function(){var t=this,i=this.getdetail();if(!i.iStaticImage&&i.iEditable){var n="ParagraphInput",a=_.template(e,{class_name:n});t.activeEdit=function(e){if(interaction_view.environment.Paragraph.state()||e){var i=$("."+n);i.length||(i=$(a).appendTo("body")),i.show().attr("paragraph-id",t.model.id);var r=i.find(".modalArea");interaction_view.ismobile&&r.width($(document).width()),_g.ui.center({Item:r}),i.find("button.cancel").one("click",function(){i.remove()}),i.find("button.ok").one("click",function(){i.attr("paragraph-id")==t.model.id&&(i.remove(),t.updateText("<div>"+i.find("textarea").val().replace(/\n/g,"</div><div>")+"</div>",addtourl=1))}),i.find("textarea").val(t.userContent.replace(/<br>/g,"\n").replace(/<\/div><div>/g,"\n").replace("<div>","").replace("</div>",""));var o=function(){i.find("textarea").focus().click(function(){$(this).focus()})};setTimeout(o,300)}},t.$el.on("click",function(){t.activeEdit()})}},updateText:function(e,t){if("undefined"!=typeof e){e&&e.match&&e.match(/\n/g)&&(e="<div>"+e.replace(/\n/g,"</div><div>")+"</div>"),e=""+e,this.userContent=e;var i=e.replace(/<div>/g,"(div)").replace(/<\/div>/g,"(/div)");i=_g.util.htmlspecialchars(i);var n=i.replace(/\(div\)/g,"<div>").replace(/\(\/div\)/g,"</div>");this.textel.html(n),this.$el.children(".Element").removeClass("disableDragY");var a=!1;t&&(this.addToUrl(e),a=!0),this.model.attributes.iDetail.iText=n,this.resetOtherStatus(),a&&interaction_view.events.onParagraphChanged(this)}},addToUrl:function(e){var t=this.model.id+"="+encodeURI(e),i=this.model.attributes.iDetail.iEditable?message_link:data_link,n=_g.getUrlParameterByName(this.model.id,i),a=0;if(n)encodeURI(n)!=encodeURI(e)?i=_g.replaceUrlParameterByName(this.model.id,t,i):a=1;else{var r="?";i.indexOf("?")>=0&&(r="&"),i+=r+t}if("epub360"==epub360_domain&&!a&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{iText:e}),a||(this.model.attributes.iDetail.iEditable?(message_link=i,interaction_view.weixin.share()):data_link=i),!interaction_view.forpreview&&!interaction_view.weixin.shareable()&&this.model.attributes.iDetail.iEditable){var o=_g.getHashParameterByName(this.model.id);o?encodeURI(o)!=encodeURI(e)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,t)):a=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+t):window.history.replaceState({},"","#"+t))}return a?!1:!0}})}),define("interaction_view/model/input",["interaction_view/model/base"],function(){interaction_view.model.Input=interaction_view.model.Base.extend({defaults:{iType:"Input",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Input({model:this})},setsyncmodel:function(){}}),interaction_view.view.Input=interaction_view.view.Base.extend({events:{},render:function(e){var t=this,i=/^(\w)+(.\w+)*@(\w)+(.\w+)*((\.\w+)+)$/,n=interaction_view.MOBILEREG;this.$el.find("input").on("input",function(){console.log($(this).val()),interaction_view.events.onFormEvent(t.model,$(this).val())});var a=interaction_view.events.onFormButtonRender(this.model);a.value&&this.$el.find("input").val(a.value),this.setFormFieldType(a.field),this.$el.find("input").on("blur",function(){var e=$(this).val(),t=$(this).attr("type");switch(t){case"email":if(""==e)return;i.test(e)||(interaction_view.errorAlert("请输入正确的电子邮箱地址!"),$(this).focus());break;case"tel":if(""==e)return;n.test(e)||(interaction_view.errorAlert("请输入正确的手机号码!"),$(this).focus())}})},resetOtherStatus:function(){var e=interaction_view.events.onFormButtonRender(this.model);e.value&&this.$el.find("input").val(e.value)},setFormFieldType:function(e){if(e&&interaction_view.ismobile){var t="text";console.log(e);var i=e.i.field_type;"number"==i&&(t="number"),"email"==i&&(t="email"),"url"==i&&(t="url"),"text"!=t&&this.$el.find("input")[0].setAttribute("type",t)}},setVariable:function(e,t,i,n){var a=this;1!=e&&2!=e&&3!=e&&interaction_view.expression.id2values(t,function(e){a.$el.find("input").val(e),n&&n(e)},{_promise:i})}})}),define("interaction_view/model/textarea",["interaction_view/model/base"],function(){interaction_view.model.Textarea=interaction_view.model.Base.extend({defaults:{iType:"Textarea",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Textarea({model:this})},setsyncmodel:function(){}}),interaction_view.view.Textarea=interaction_view.view.Base.extend({events:{},render:function(e){var t=this;this.$el.find("textarea").on("input",function(){console.log($(this).val()),interaction_view.events.onFormEvent(t.model,$(this).val())});var i=interaction_view.events.onFormButtonRender(this.model);i.value&&this.$el.find("textarea").html(i),this.model._reset=!0},resetOtherStatus:function(){var e=interaction_view.events.onFormButtonRender(this.model);e.value&&this.$el.find("textarea").html(e)},setVariable:function(e,t,i,n){var a=this;1!=e&&2!=e&&3!=e&&interaction_view.expression.id2values(t,function(e){a.$el.find("textarea").val(e),n&&n(e)},{_promise:i})}})}),define("interaction_view/model/selectbutton",["interaction_view/model/button"],function(){interaction_view.model.SelectButton=interaction_view.model.Button.extend({defaults:{iType:"SelectButton",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setview:function(e){var t=this.get("iDetail");t.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.SelectButton({model:this})}}),interaction_view.view.SelectButton=interaction_view.view.Button.extend({events:{},render:function(e){var t=interaction_view.events.onFormButtonRender(this.model);t.value&&this.switchStatus("active")},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");var t=this.getdetail();if(t.isSwitch)this.$el.on("click",function(t){interaction_view.isAndroid&&t.preventDefault(),e.changeStatus()});else{if(interaction_view.ismobile)var i="touchstart",n="touchend";else var i="mousedown",n="mouseup";this.$el.on(i,function(t){interaction_view.isAndroid&&t.preventDefault(),e.buttonon=!0,e.changeStatus()}),this.$el.on(n,function(t){interaction_view.isAndroid&&t.preventDefault(),e.buttonon&&(e.buttonon=!1,e.changeStatus())})}},changeStatus:function(){var e=this.getdetail(),t=this,i=!this.active;if(i)this.switchStatus("active"),e.isSwitch&&interaction_view.events.onFormEvent(t.model,t.active);else{if(t.groupcontrol&&e.isSwitch)return;if(interaction_view.application.isBindingButton(t.model))return;if(t.model.get("isTabBarSelectButton"))return;this.switchStatus("normal"),interaction_view.events.onFormEvent(t.model,t.active)}},resetOtherStatus:function(){this.resetButtonStatus()},resetButtonStatus:function(){var e=interaction_view.events.onFormButtonRender(this.model),t=e.value?"active":"normal";this.switchStatus(t)}})}),define("interaction_view/model/submitbutton",["interaction_view/model/button"],function(){interaction_view.model.SubmitButton=interaction_view.model.Button.extend({defaults:{iType:"SubmitButton",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setview:function(e){var t=this.get("iDetail");t.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.SubmitButton({model:this})}}),interaction_view.view.SubmitButton=interaction_view.view.Button.extend({events:{},render:function(e){},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");var t=this.getdetail();if(t.isSwitch)this.$el.on("click",function(t){interaction_view.isAndroid&&t.preventDefault(),e.changeStatus(),interaction_view.events.onFormEvent(e.model)});else{if(interaction_view.ismobile)var i="touchstart",n="touchend";else var i="mousedown",n="mouseup";this.$el.on(i,function(t){interaction_view.isAndroid&&t.preventDefault(),e.buttonon=!0,e.changeStatus()}),this.$el.on(n,function(t){interaction_view.isAndroid&&t.preventDefault(),e.buttonon&&(e.buttonon=!1,e.changeStatus(),window.setTimeout(function(){interaction_view.events.onFormEvent(e.model)},500))})}},changeStatus:function(){var e=!this.active;if(e)this.switchStatus("active");else{if(this.groupcontrol&&this.getdetail().isSwitch)return;if(this.model.get("isTabBarSubmitButton"))return;this.switchStatus("normal")}},resetOtherStatus:function(){this.resetSubmitButtonStatus()},resetSubmitButtonStatus:function(){this.switchStatus("normal")}})}),define("interaction_view/model/selectbox",["interaction_view/model/base"],function(){interaction_view.model.SelectBox=interaction_view.model.Base.extend({defaults:{iType:"SelectBox",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.SelectBox({model:this})},setsyncmodel:function(){}}),interaction_view.view.SelectBox=interaction_view.view.Base.extend({events:{},render:function(e){var t=this;this.$el.find("input").on("change",function(){if(t.isGroupItem)t.fireButtonGroupClick();else{var e=$(this).is(":checked");if(interaction_view.events.onFormEvent(t.model,e),$(this).closest(".layer-mask").length){var i=this;setTimeout(function(){e?$(i).attr("checked","checked"):$(i).removeAttr("checked")},100)}}});var i=interaction_view.events.onFormButtonRender(this.model);i.value&&this.$el.find("input").attr("checked","checked"),null!=i.field&&"radio"==i.field.i.field_type&&this.$el.find("input")[0].setAttribute("type","radio")},resetOtherStatus:function(){this.resetButtonStatus()},resetButtonStatus:function(){interaction_view.application.isBindingButton(this.model)&&(this.isRadio=!0,this.$el.find("input")[0].setAttribute("type","radio"));var e=interaction_view.events.onFormButtonRender(this.model);e.value?this.$el.find("input").attr("checked","checked"):this.$el.find("input").removeAttr("checked")},switchStatus:function(e){var t={active:!0,normal:!1}[e]||!1;this.$el.find("input").prop("checked",t)},getStatus:function(){return this.$el.find("input").prop("checked")},fireButtonGroupClick:function(){Backbone.trigger("buttonGroupClick:"+this.groupType,this)},setAsGroupElement:function(e){this.isGroupItem=!0,this.groupView=e,this.groupType=e.model.attributes.iType}})}),define("interaction_view/model/imageblock",["interaction_view/model/image"],function(){interaction_view.model.ImageBlock=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){""!=this.toJSON().iDetail.setPrec&&this.toJSON().iDetail.iImg&&this.toJSON().iDetail.iImg[0]&&(this.toJSON().iDetail.iImg[0].picture=this.toJSON().iDetail.iImg[0].picture+"?"+this.toJSON().iDetail.setPrec),this.iview=new interaction_view.view.ImageBlock({model:this})},setsyncmodel:function(){}}),interaction_view.view.ImageBlock=interaction_view.view.Base.extend({render:function(){this.renderMask(),this.renderDraggable(),this.firstRender=!0,this.isEraserSet=!1,this.renderEdit(),this.renderImgMask();var e=this.$el.find(".Element");e.css("-moz-border-radius-topleft",e.css("border-top-left-radius")),e.css("-moz-border-radius-topright",e.css("border-top-right-radius")),e.css("-moz-border-radius-bottomleft",e.css("border-bottom-left-radius")),e.css("-moz-border-radius-bottomright",e.css("border-bottom-right-radius")),e.css("-webkit-border-top-left-radius",e.css("border-top-left-radius")),e.css("-webkit-border-top-right-radius",e.css("border-top-right-radius")),e.css("-webkit-border-bottom-left-radius",e.css("border-bottom-left-radius")),e.css("-webkit-border-bottom-right-radius",e.css("border-bottom-right-radius"));var t=this.getdetail();void 0!=t.linktype&&-1!=t.linktype?e.on("click",function(e){return window.setTimeout(function(){interaction_view.renderLink(t.linktype,t)},300),!1}):interaction_view.isWeixin&&interaction_view.isAndroid&&e.find("img").on("click",function(e){e.preventDefault()})},getArgs:function(){var e=this,t=this.getdetail();if(t.iEditable){var i=e.getFromUrl().split(",");if(i.length<5)return;t.iImg[0].picture=i[0]||t.iImg[0].picture,e.args=i,e.model._rotate=i[4],e.model._scale=i[3],e.model._x=i[1],e.model._y=i[2]}},preload:function(){this.getArgs()},immediateRender:function(){interaction_view.isIos&&(this.repaint(),this.setEraser())},setOtherDisplay:function(){var e=this.getdetail(),t=this.$el.children(".Element").find("img").first();if(this.args){this.$el.find("img").attr("src")!=this.args[0]&&this.$el.find("img").attr("src",this.args[0]);var i=this.args[4],n=this.args[3],a=this.args[1],r=this.args[2],o="rotate("+i+"deg) scale("+n+") skew(0deg) translate("+a+"px ,"+r+"px)";return t.css({"-webkit-transform":o,width:"100%",height:"auto"}),void t.parent().css({overflow:"hidden"})}var e=this.getdetail();e.iImg&&e.iImg.length>0&&e.iMask&&(this.renderMask(),(e.iMask_data.iSlipable||e.iGravity)&&this.setMaskSlipable({items:this.$el.children(".Element").find("img").first(),containment:this.$el.children(".Element").children(),contentel:this.$el.children(".Element").find("img").first(),content_x:e.iMask_data.x,content_y:e.iMask_data.y})),e.iDisplay&&e.iImg&&e.iImg.length>0&&(this.$el.children(".Element").find("img").length?_g.ui.fitImage({fit:Number(e.iDisplay),width:e.iImg[0].width,height:e.iImg[0].height,items:this.$el.children(".Element").find("img"),parentHeight:parseInt(this.$el.children(".Element").css("height")),parentWidth:parseInt(this.$el.children(".Element").css("width"))}):_g.ui.fitImage({fit:Number(e.iDisplay),containment:this.$el.children(".Element").find(".image_wrap").first()})),e.iFullview&&this.fullview(),e.iEraser&&(this.model._reset=!0,this.el_str=this.$el.children(".Element").html(),interaction_view.isIos||this.setEraser())},getFromUrl:function(){var e=_g.getUrlParameterByName(this.model.id,message_link);if(e||(e=_g.getHashParameterByName(this.model.id)),null==e&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var t=this.model.get("pageid"),i=interaction_view.environment.Sharedata.getitem(t,this.model.id);i&&(e=i.value)}return decodeURI(e||"")},removeFromUrl:function(){var e=_g.getUrlParameterByName(this.model.id,message_link);e&&(message_link=_g.replaceUrlParameterByName(this.model.id,"",message_link),message_link=message_link.replace("&&","&").replace("?&","?"),interaction_view.weixin.share());var t=_g.getHashParameterByName(this.model.id);if(t){var i=_g.replaceHashParameterByName(this.model.id,"");window.history.replaceState({},"",i.replace("#&","#").replace("&&","&"))}return e||t?!0:!1},addToUrl:function(e,t,i,n,a){var r=this.getdetail(),o=(e==r.iImg[0].origin?"":e)+","+t+","+i+","+n+","+a,s=this.model.id+"="+encodeURI(o),l=_g.getUrlParameterByName(this.model.id,message_link),c=0,d=message_link;if(l)encodeURI(l)!=encodeURI(s)?d=_g.replaceUrlParameterByName(this.model.id,s,message_link):c=1;else{var h="?";message_link.indexOf("?")>=0&&(h="&"),d+=h+s}if("epub360"==epub360_domain&&!c&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{value:encodeURI(o)}),c||this.model.attributes.iDetail.iEditable&&(message_link=d,interaction_view.weixin.share()),!interaction_view.forpreview){var u=_g.getHashParameterByName(this.model.id);u?encodeURI(u)!=encodeURI(s)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,s)):c=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+s):window.history.replaceState({},"","#"+s));
}return c?!1:!0},renderMask:function(){var e=this.getdetail();e.iMask&&(this.$el.children(".Element").find("img").first().css({translate:[e.iMask_data.x,e.iMask_data.y]}),this.iScrollview&&this.iScrollview.scrollTo(e.iMask_data.x,e.iMask_data.y))},renderImgMask:function(){function e(e,t){for(var i in t)e[i]=t[i],e["-webkit-"+i]=t[i]}var t=this.getdetail();if(t.iImgMask){var i=t,n=i.iImgMaskUrl?"url("+i.iImgMaskUrl+")":"none",a=i.iImgMask_data.iMaskImgRepeat?"repeat":"no-repeat",r=i.iImgMask_data.iMaskImgSize,o=i.iImgMask_data.iMaskImgPos;i.iMaskImgSize&&(r="100% 100%",o="0% 0%");var s={};e(s,{"mask-image":n,"mask-repeat":a,"mask-position":o,"mask-size":r}),this.$el.children(".Element").find("img").first().css(s)}},renderEdit:function(){var e=this,t=this.getdetail();t.iEditable&&(e.activeEdit=function(t){(interaction_view.environment.Paragraph.state()||t)&&(interaction_view.forceUpload?interaction_view.localIds?setTimeout(function(){e.setweixinimage(interaction_view.localIds)},100):interaction_view.weixin.chooseimage(function(t){t&&(interaction_view.localIds=t,e.setweixinimage(t))}):"undefined"!=typeof wx_permissions&&wx_permissions.chooseImage&&(interaction_view.localIds?setTimeout(function(){e.setweixinimage(interaction_view.localIds[0])},100):interaction_view.weixin.chooseimage(function(t){t&&(interaction_view.localIds=t,e.setweixinimage(t[0]))})))},e.$el.children(".Element").on("click",function(){e.activeEdit(!0)}))},setweixinimage:function(e){var t=this,i=e;t.model.localId&&t.model.localId==i||(interaction_view.forceUpload?t.replaceImg(i):interaction_view.weixin.processLocalId(e,function(e){t.replaceImg(e)}));var n=this.getcommon(),a=n.iWidth,r=n.iHeight,o=this.model,s=o.attributes.iDetail.iEditable;interaction_view.imageEditor(this.model,a,r,i,function(n,a,r,l){return o._x=n,o._y=a,o._scale=r,o._rotate=l,t.model.localId&&t.model.localId==i?void(s&&t.addToUrl(t.model.pic,n,a,r,l)):(_g.device.ios()&&interaction_view.weixin.processLocalId(e,function(e){t.replaceImg(e)}),void interaction_view.imageUploader(i,function(e){t.replaceImg(e),t.model.localId=i,t.model.pic=e;var o=t.getdetail();o.iImg[0].picture=e,s&&t.addToUrl(e,n,a,r,l)}))},t.setweixinimage)},resetOtherStatus:interaction_view.view.Image.prototype.resetOtherStatus,fullview:interaction_view.view.Image.prototype.fullview,getLayerContentSize:interaction_view.view.Image.prototype.getLayerContentSize,setEraser:interaction_view.view.Image.prototype.setEraser,resetEraser:interaction_view.view.Image.prototype.resetEraser,isFullSwitch:interaction_view.view.Image.prototype.isFullSwitch,getGalleryModel:interaction_view.view.Image.prototype.getGalleryModel,repaint:interaction_view.view.Image.prototype.repaint,onShow:interaction_view.view.Image.prototype.onShow,getDragCopy:interaction_view.view.Image.prototype.getDragCopy,getClientXY:interaction_view.view.Image.prototype.getClientXY,resetDragDrop:interaction_view.view.Image.prototype.resetDragDrop,setDraggable:interaction_view.view.Image.prototype.setDraggable,activeDragDrop:interaction_view.view.Image.prototype.activeDragDrop,getDropXY:interaction_view.view.Image.prototype.getDropXY,resetDragDropStatus:interaction_view.view.Image.prototype.resetDragDropStatus,renderDraggable:interaction_view.view.Image.prototype.renderDraggable,drag_dragend:interaction_view.view.Image.prototype.drag_dragend,drag_dragin:interaction_view.view.Image.prototype.drag_dragin,renderCopyDraggable:interaction_view.view.Image.prototype.renderCopyDraggable,copy_dragend:interaction_view.view.Image.prototype.copy_dragend,old_transit_back:interaction_view.view.Image.prototype.old_transit_back,trigger_dragin_event:interaction_view.view.Image.prototype.trigger_dragin_event,trigger_drop_event:interaction_view.view.Image.prototype.trigger_drop_event,replaceImg:interaction_view.view.Image.prototype.replaceImg})}),define("interaction_view/model/weixincamera",["interaction_view/model/button"],function(){interaction_view.model.WeixinCamera=interaction_view.model.Button.extend({defaults:{iType:"WeixinCamera",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null},setview:function(e){var t=this.get("iDetail");t.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.WeixinCamera({model:this})}}),interaction_view.view.WeixinCamera=interaction_view.view.Button.extend({events:{},render:function(e){},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");this.getdetail();if(interaction_view.ismobile)var t="touchstart",i="touchend";else var t="mousedown",i="mouseup";this.$el.on(t,function(t){e.buttonon=!0,e.changeStatus()}),this.$el.on(i,function(t){e.buttonon&&(e.buttonon=!1,e.changeStatus(),interaction_view.forceUpload?window.setTimeout(function(){interaction_view.weixin.chooseimage(function(t){t?(interaction_view.localIds=t,interaction_view.events.onWeixinEvent(e,71)):interaction_view.events.onWeixinEvent(e,72)})},500):_g.device.isWeixin()?window.setTimeout(function(){interaction_view.weixin.chooseimage(function(t){t?(interaction_view.localIds=t,interaction_view.events.onWeixinEvent(e,71)):interaction_view.events.onWeixinEvent(e,72)})},500):interaction_view.errorAlert("请在微信中操作"))})},changeStatus:function(){this.switchStatus()},resetOtherStatus:function(){this.resetWeixinCameraStatus()},resetWeixinCameraStatus:function(){this.switchStatus("normal")}})}),define("interaction_view/model/weixinvoice",["interaction_view/model/button"],function(){interaction_view.model.WeixinVoice=interaction_view.model.Button.extend({defaults:{iType:"WeixinVoice",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null},setview:function(e){var t=this.get("iDetail");t.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.WeixinVoice({model:this})}}),interaction_view.view.WeixinVoice=interaction_view.view.Button.extend({events:{},render:function(e){},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");this.getdetail();if(interaction_view.ismobile)var t="touchstart",i="touchend";else var t="mousedown",i="mouseup";this.$el.on(t,function(t){e.buttonon=!0,e.changeStatus()}),this.$el.on(i,function(t){e.buttonon&&(e.buttonon=!1,e.changeStatus(),_g.device.isWeixin()?window.setTimeout(function(){interaction_view.voiceEditor(function(t){t?(interaction_view.voicelocalId=t,interaction_view.events.onWeixinEvent(e,71)):interaction_view.events.onWeixinEvent(e,72)})},500):interaction_view.errorAlert("请在微信中操作"))})},changeStatus:function(){this.switchStatus()},resetOtherStatus:function(){this.resetWeixinVoiceStatus()},resetWeixinVoiceStatus:function(){this.switchStatus("normal")}})}),define("text!interaction_view/template/infoList_content.tpl",[],function(){return'<%\n	var position = ["left", "center", "right", "justify"],\n		strokeType = ["", "solid", "dotted", "dashed"],\n		boderStr;\n	if(iDetail.stroke_type == 0)\n		boderStr = "none";\n	else\n		boderStr = (iDetail.stroke_width>=0?iDetail.stroke_width:1)+"px "+strokeType[iDetail.stroke_type>=1?iDetail.stroke_type:1];\n	_.each(infolist, function(v,i){ %>\n<table style="margin: 0;<%=(page&&i==0)?"":"border-top:"+boderStr+";"%> <%=(infolist.length==i+1)?"border-bottom:"+boderStr+";":""%>border-color:<%=iDetail.stroke_color%>">\n	<tr>\n		<td style="width: 50px; vertical-align: top;<%=iDetail.iPortrait?"":"display:none"%>">\n			<div style="background-image: url(<%=v.portrait||web_url+"diazo/img/avatar.png"%>);width: 30px;height: 30px;margin: 10px;background-size: cover;	background-position: 50% 50%;border-radius: 40px;"></div>\n		</td>\n		<td style="vertical-align: top;padding: 5px;">\n			<p style="margin: 0;font-size: 13px;font-weight: bold;<%=iDetail.iNickname?"":"display:none;"%> color:<%=iDetail.nickname_color%>; min-height:21px;"><%=_g.util.htmlspecialchars(v.nickname||"")%></p>\n			<p style="color:<%=iDetail.font_color%>;font-size:<%=iDetail.font_size%>px;text-align:<%=position[iDetail.iPosition]%>;"><%=_g.util.htmlspecialchars(v[iDetail.iField])%></p>\n		</td>\n	</tr>\n</table>\n<%})%>'}),define("interaction_view/model/infoList",["interaction_view/model/base","text!interaction_view/template/infoList_content.tpl","text!interaction_view/template/prompt.tpl"],function(){var e=require("text!interaction_view/template/infoList_content.tpl"),t=require("text!interaction_view/template/prompt.tpl");interaction_view.model.InfoList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.InfoList({model:this})},setsyncmodel:function(){}}),interaction_view.view.InfoList=interaction_view.view.Base.extend({render:function(){this.totalInfoPage=0,this.currentPage=1,this.pullUpInfo=["上拉加载更多","释放更新"],this.model._reset=!0},resetOtherStatus:function(){this.getInfo()},renderUrl:function(e){var t=this.getdetail(),i=t.iAppUrl+"infolist.json";return i+="?iField="+t.iField,i+=this.currentPage>1&&!e?"&size="+t.size*this.currentPage:"&size="+t.size,i+="&sort_by="+t.sort_by,i+="&sort_order="+(t.sord_order?1:-1),1==t.sort_by&&(i+="&unique="+t.unique),e&&(i+="&page="+e),t.iKind&&2==t.iKind&&("undefined"!=typeof epub360_sourceinfo&&void 0!=epub360_sourceinfo.openid?i+="&source_openid="+epub360_sourceinfo.openid:"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.openid&&(i+="&source_openid="+epub360_userinfo.openid)),i},getInfo:function(t){var i,n=this,a=this.getdetail(),r=!1;t?(this.currentPage<this.totalInfoPage?this.currentPage++:r=!0,i=n.renderUrl(this.currentPage)):i=n.renderUrl(),r||_g.ajax.get({dataType:"JSON",url:i,callback:function(i){if(200==i.code){n.totalInfoPage=Math.ceil(i.data.sum/a.size);var r=_.template(e,{infolist:i.data.results,iDetail:a,page:t}),o={x:0,y:0};t?(o=n.scrollview.iScroll.getComputedPosition(),n.$el.find(".info-content .lists").append(r)):n.$el.find(".info-content .lists").html(r),n.renderScroll(o),n.updatePullUpInfo()}else n.$el.find(".info-content .lists").html("空")}})},postInfo:function(){console.log("postinfo");var e=this,i=this.getdetail(),n="InfoListInput",a=_.template(t,{class_name:n}),r=$("."+n);r.length||(r=$(a).appendTo("body")),r.show().attr("infolist-id",e.model.id);var o=r.find(".modalArea");interaction_view.ismobile&&o.width($(document).width()),_g.ui.center({Item:o}),r.find("textarea").val("");var s=function(){r.find("textarea").focus().click(function(){$(this).focus()})};r.find("button.cancel").one("click",function(){r.remove()}),r.find("button.ok").one("click",function(){if(r.attr("infolist-id")==e.model.id){r.remove();var t={};t[i.iField]=r.find("textarea").val(),_g.ajax.post({dataType:"JSON",url:i.iAppUrl+"?format=json",data:t,callback:function(t){200==t.code&&e.getInfo()}})}}),s(),setTimeout(s,500)},updatePullUpInfo:function(){this.currentPage>=this.totalInfoPage?this.pullUpInfo=["没有更多了","没有更多了"]:this.pullUpInfo=["上拉加载更多","释放更新"],this.$el.find(".info-content .pullUp").html(this.pullUpInfo[0]).text(this.pullUpInfo[0])},getLayerContentSize:function(){var e,t={width:0,height:0};return t.width=this.$el.find(".info-content .lists").width(),t.height=this.$el.find(".info-content .lists").height(),e=this.$el.find(".Element").height(),t.height<=e&&(t.height=e),t.height+=10,t},renderScroll:function(e){this.scrollview&&this.scrollview.iScroll.destroy();var t=this,i=this.getMoveRange(),n=this.$el.find(".Element"),a=0;this.scrollview=new _g.scrollview({containment:n,contentel:this.$el.find(".info-content"),mask_width:n.width(),mask_height:n.height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:0,content_y:e.y,scrollY:i.y>0?!0:!1,onScrolling:function(e){if(i.y>0){if(e.deltaY>0&&t.$el.find(".info-content .pullUp").hide(),e.deltaY<-5-i.y&&t.$el.find(".info-content .pullUp").show(),-e.deltaY>i.y+30)a=1,t.$el.find(".info-content .pullUp").html(t.pullUpInfo[1]).text(t.pullUpInfo[1]);else{if(!(e.deltaY>30))return t.$el.find(".info-content .pullUp").html(t.pullUpInfo[0]).text(t.pullUpInfo[0]),void t.$el.find(".info-content .pullDown").html("下拉刷新").text("下拉刷新");a=2,t.$el.find(".info-content .pullDown").html("释放更新").text("释放更新")}n.addClass("is_exceededY")}},onScrollend:function(){a>0&&t.getInfo(1==a),n.removeClass("is_exceededY"),t.$el.find(".info-content").find(".pullUp").hide()}}),this.$el.addClass("hascontrols")}})}),define("text!interaction_view/template/chartList_content.tpl",[],function(){return'<div style="color:<%=iDetail.font_color%>;font-size:<%=iDetail.font_size%>px;">\n   <p style="font-weight:bold;margin:2px;"><%=iDetail.label%></p>\n   <p style="text-align:right;margin:2px;">参与人数：<span><%=infolist.sum%></span></p>\n   <%\n		var position = ["left", "center", "right", "justify"],\n			strokeType = ["", "solid", "dotted", "dashed"],\n			boderStr;\n		if(iDetail.stroke_type == 0)\n			boderStr = "none";\n		else\n			boderStr = (iDetail.stroke_width>=0?iDetail.stroke_width:1)+"px "+strokeType[iDetail.stroke_type>=1?iDetail.stroke_type:1];\n		_.each(infolist.items, function(v,i){ %>\n	<table style="width: 100%; margin: 0;border-top: <%=boderStr%>;<%=(infolist.length==i+1)?"border-bottom:"+boderStr+";":""%>border-color:<%=iDetail.stroke_color%>">\n		<tr>\n			<td style="width:20px;text-align:left;padding: 2px;"><%=i+1%>.</td>\n			<td style="text-align:<%=position[iDetail.iPosition]%>;font-size:<%=iDetail.font_size%>px;"><%=v.value%></td>\n		</tr>\n		<tr>\n			<td colspan="2">\n				<div style="width:100%;height:13px;background-color:#D9D9D9">\n					<div style="width: <%=(v.count/infolist.sum*100).toFixed(2)%>%;background-color:<%=Colors[i%10]%>;height:100%"></div>\n				</div>\n			</td>\n		</tr>\n		<tr><td colspan="2" style="text-align:right;padding: 2px;"><%=v.count%>人 <%=(v.count/infolist.sum*100).toFixed(2)%>%</td></tr>\n	</table>\n   <%})%>\n</div>'}),define("interaction_view/model/chartList",["interaction_view/model/base","text!interaction_view/template/chartList_content.tpl"],function(){var e=require("text!interaction_view/template/chartList_content.tpl");interaction_view.model.ChartList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.ChartList({model:this})},setsyncmodel:function(){}}),interaction_view.view.ChartList=interaction_view.view.Base.extend({render:function(){this.Colors=["#50d92b","#5dbc5e","#9fb5ef","#a5cbd6","#d743b3","#e2fea9","#fd7a99","#fce096","#e6f63b","#e7ab6d"],this.model._reset=!0},resetOtherStatus:function(){this.getInfo()},renderUrl:function(e){var t=this.getdetail(),i=t.iAppUrl+"chartlist.json";return i+="?iField="+t.iField},getInfo:function(e){var t=this,i=this.getdetail();_g.ajax.get({dataType:"JSON",url:t.renderUrl(),callback:function(e){if(200==e.code&&e.data.results.length>0){var n={sum:e.data.sum,items:e.data.results.length?e.data.results[0].items:[]};(i.sort_by=1)&&n.items.sort(function(e,t){return i.sord_order?parseInt(e.count)>parseInt(t.count):parseInt(e.count)<parseInt(t.count)}),t.renderChart(n),t.renderScroll()}else t.$el.find(".info-content .lists").html("空")}})},renderChart:function(t){var i,n=this,a=this.getdetail();if(0==a.iKind)i=_.template(e,{infolist:t,iDetail:a,Colors:n.Colors}),n.$el.find(".info-content .lists").html(i);else{var r=[];n.getcommon().iWidth,n.getcommon().iHeight;_.each(t.items,function(e,t){r.push([e.value,Number(e.count)])}),n.$el.find(".info-content .lists").highcharts({chart:{backgroundColor:null,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:a.label},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{itemStyle:{"font-size":a.font_size+"px",color:a.font_color}},series:[{type:"pie",name:"占比",data:r}]}),n.$el.find(".info-content .lists .highcharts-button").hide(),n.$el.find(".info-content .lists .highcharts-title").css("font-size",a.font_size)}},getLayerContentSize:function(){var e,t={width:0,height:0};return t.width=this.$el.find(".info-content .lists").width(),t.height=this.$el.find(".info-content .lists").height(),e=this.$el.find(".Element").height(),t.height<=e&&(t.height=e),t.height*=1.03,t},renderScroll:function(){this.scrollview&&this.scrollview.iScroll.destroy();var e=this,t=this.getMoveRange(),i=this.$el.find(".Element"),n=0;this.scrollview=new _g.scrollview({containment:i,contentel:this.$el.find(".info-content"),mask_width:i.width(),mask_height:i.height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:0,content_y:0,scrollY:t.y>0?!0:!1,onScrolling:function(a){if(t.y>0){if(!(a.deltaY>30))return void e.$el.find(".info-content .pullDown").html("下拉刷新").text("下拉刷新");n=1,e.$el.find(".info-content .pullDown").html("释放更新").text("释放更新"),i.addClass("is_exceededY")}},onScrollend:function(){n>0&&e.getInfo(),i.removeClass("is_exceededY")}}),this.$el.addClass("hascontrols")}})}),define("interaction_view/model/textbutton",["interaction_view/model/paragraph"],function(){interaction_view.model.TextButton=interaction_view.model.Paragraph.extend({defaults:{iType:"TextButton",iSync:!1},setview:function(){this.iview=new interaction_view.view.TextButton({model:this})}}),interaction_view.view.TextButton=interaction_view.view.Paragraph.extend({renderlink:function(){if(interaction_view.forpreview)return!1;var e=this.model.get("iDetail");this.$el.children(".Element").on("click",function(){void 0!=e.linktype&&interaction_view.renderLink(e.linktype,e)})},setOtherDisplay:function(){var e=this.getdetail();void 0!=e.isConfigConfirm&&(this.$el.addClass("hasaction"),this.$el.find(".iText").off("click").on("click",function(){configpage.saveConfig()})),void 0!=e.isConfigCancel&&(this.$el.addClass("hasaction"),this.$el.find(".iText").off("click").on("click",function(){window.close(),parent.window.postMessage("close","*")}))}})}),define("interaction_view/model/collision",["interaction_view/model/base"],function(){interaction_view.model.Collision=interaction_view.model.Base.extend({defaults:{},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Collision({model:this})},setsyncmodel:function(){}}),interaction_view.view.Collision=interaction_view.view.Base.extend({resetOtherStatus:function(){this.cachePos={}},render:function(e){this.peers=this.getPeers(),this.bindHitDetect(),this.hitState={},this.cachePos={}},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t],this.model.layer_id=t}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},getPeers:function(){var e=this.getdetail(),t=[];return _.each(e.target_ids,function(i,n){_.each(e.source_ids,function(e,n){e!=i&&t.push([e,i])})}),t},bindHitDetect:function(){var e=this;_.each(e.peers,function(t,i){_.each(t,function(i,n){var a=e.model.page,r=a.iAnimationlist.where({overlay_id:i});_.each(r,function(n,a){var r=e.model.layer_id,o={type:"animation",page_id:e.model.page.id,overlay_id:i,animation_id:n.id,layer_id:r,_label:"collision"};r&&(o.iPage_id=e.model.iPage_id),o.func=function(){e.hitDetect(t[0],t[1],i)},interaction_view.events.animationUpdateEvents.push(o),o={type:"animation",page_id:e.model.page.id,overlay_id:i,animation_id:n.id,layer_id:r,_label:"collision"},o.func=function(){setTimeout(e.hitDetect(t[0],t[1],i),1)},interaction_view.events.animationEndEvents.push(o)});var o=e.model.layer_id,s=a.get&&a.get("overlays")||o&&interaction_view.ilayerlist.get(o).get("overlays"),l=s.filter(function(e){return e.id==i});if(l.length){var c={page_id:e.model.page.id,overlay_id:i,layer_id:o,_label:"collision"};o&&(c.iPage_id=e.model.iPage_id),c.func=function(){e.hitDetect(t[0],t[1],i)},interaction_view.events.draggingEvents.push(c),interaction_view.events.stateGroupUpdateEvents.push(c)}})})},setHitState:function(e,t,i){this.hitState[e+t]=i,this.hitState[t+e]=i},getHitState:function(e,t){return this.hitState[e+t]},hitDetect:function(e,t,i){if(this.cachePos[i]=[!1,{}],this.isHit(e,t)){var n=this.getdetail(),a=!0;"once"==n.trigger&&this.getHitState(e,t)&&(a=!1),a&&(n.hide_source&&this.getModel(e).iview.$el.addClass("hide"),interaction_view.events.onCollision(this)),this.setHitState(e,t,!0)}else this.setHitState(e,t,!1)},isHit:function(e,t){var i=this,n=this.getdetail(),a=i.getModel(e),r=i.getModel(t);return a&&r?(a=a.iview.$el,r=r.iview.$el,0==a.css("opacity")||0==r.css("opacity")||"none"==a.css("display")||"none"==r.css("display")?!1:"center"==n.source_offset_type?"center"==n.target_offset_type?i.isHitCC(a,r):i.isHitCR(a,r):"center"==n.target_offset_type?i.isHitRC(a,r):i.isHitRR(a,r)):!1},getModel:function(e){return interaction_view.getParentpage(interaction_view.currentPage).iOverlaylist.where({id:e})[0]||interaction_view.getParentpage(this.model.page).iOverlaylist.where({id:e})[0]},isHitCC:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"circle",n.source_offset),r=i.getCoord(t,"circle",n.target_offset);return i.isCircleHitCircle(a,r)},isHitCR:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"circle",n.source_offset),r=i.getCoord(t,"rect",n.target_offset);return i.isCircleHitRect(a,r)},isHitRC:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"rect",n.source_offset),r=i.getCoord(t,"circle",n.target_offset);return i.isCircleHitRect(r,a)},isHitRR:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"rect",n.source_offset),r=i.getCoord(t,"rect",n.target_offset);return i.isRectHitRect(a,r)},getCoord:function(e,t,i){var n=this;this.getdetail();if(n.cachePos[e[0].id]&&n.cachePos[e[0].id][0])return n.cachePos[e[0].id][1];var a=n.getOffsetXY(e);e.hasClass("static")&&(a={x:a.x+e.children().width()/2,y:a.y+e.children().height()/2});var r;switch(t){case"circle":r={o:a,r:i};break;case"rect":var o=e.children().width(),s=e.children().height(),l=n.getDomRotation(e),c={x:a.x-o/2,y:a.y-s/2},d={x:c.x+o,y:c.y},h={x:c.x+o,y:c.y+s},u={x:c.x,y:c.y+s};c=n.getRotatedCoord(a,{x:c.x-i,y:c.y-i},l),d=n.getRotatedCoord(a,{x:d.x+i,y:d.y-i},l),h=n.getRotatedCoord(a,{x:h.x+i,y:h.y+i},l),u=n.getRotatedCoord(a,{x:u.x-i,y:u.y+i},l);var p=[c,d,h,u];r={o:a,vertex:p,w:o,h:s}}return n.cachePos[e[0].id]=[!0,r],r},getOffsetXY:function(e){var t=e.offset();return{x:t.left,y:t.top}},getDomRotation:function(e){function t(e,t){e=parseFloat(e),t=parseFloat(t);var i=(180*Math.asin(e)/Math.PI+360)%360;return e>=0&&t>=0?i:e>=0&&0>=t?180-i:0>=e&&t>=0?i:0>=e&&0>=t?540-i:void 0}function i(){var i,n=e.children().css("transform")||e.children().css("-webkit-transform");return n.split("(")[1]?(i=n.split("(")[1].split(","),t(i[1],i[0])):0}var n,a=e.children().css("transform")||e.children().css("-webkit-transform");if(a.split("(")[1]){var r=a.split("(")[1].split(",");n=t(r[1],r[0]),n||(n=i())}else n=i();return n},getRotatedCoord:function(e,t,i){var n=t;i=i/180*Math.PI;var a=(n.x-e.x)*Math.cos(i)-(n.y-e.y)*Math.sin(i)+e.x,r=(n.x-e.x)*Math.sin(i)+(n.y-e.y)*Math.cos(i)+e.y;return{x:a,y:r}},distPP:function(e,t){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},distPL:function(e,t,i){var n=i.y-t.y,a=t.x-i.x,r=i.x*t.y-t.x*i.y;return Math.abs(n*e.x+a*e.y+r)/Math.sqrt(n*n+a*a)},isCircleHitCircle:function(e,t){var i=this.distPP(e.o,t.o);return i<=e.r+t.r},isCircleHitRect:function(e,t){var i=t.w/2,n=t.h/2,a={x:(t.vertex[0].x+t.vertex[1].x)/2,y:(t.vertex[0].y+t.vertex[1].y)/2},r={x:(t.vertex[2].x+t.vertex[1].x)/2,y:(t.vertex[2].y+t.vertex[1].y)/2},o=this.distPL(e.o,t.o,a),s=this.distPL(e.o,t.o,r);return o>i+e.r?!1:s>n+e.r?!1:i>=o?!0:n>=s?!0:(o-i)*(o-i)+(s-n)*(s-n)<=e.r*e.r},isRectHitRect:function(e,t){var i=!0,n=[{x:e.vertex[0].x-e.vertex[3].x,y:e.vertex[0].y-e.vertex[3].y},{x:e.vertex[0].x-e.vertex[1].x,y:e.vertex[0].y-e.vertex[1].y},{x:t.vertex[0].x-t.vertex[3].x,y:t.vertex[0].y-t.vertex[3].y},{x:t.vertex[0].x-t.vertex[1].x,y:t.vertex[0].y-t.vertex[1].y}];return $.each(n,function(n,a){var r,o,s,l,c=[];return _.each(e.vertex,function(e,t){var i=e.x*a.x+e.y*a.y;c.push(i)}),r=_.min(c),o=_.max(c),c=[],_.each(t.vertex,function(e,t){var i=e.x*a.x+e.y*a.y;c.push(i)}),s=_.min(c),l=_.max(c),o>=s&&l>=r?void 0:(i=!1,!1)}),i}})}),define("interaction_view/model/usersvg",["interaction_view/model/base"],function(){interaction_view.model.UserSVG=interaction_view.model.Base.extend({defaults:{},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.attributes.iDetail.iSvg=interaction_view.isEvilCode(this.attributes.iDetail.iSvg),this.iview=new interaction_view.view.UserSVG({model:this})},setsyncmodel:function(){}}),interaction_view.view.UserSVG=interaction_view.view.Base.extend({resetOtherStatus:function(){},render:function(){var e=this.model.page.iAnimationlist.where({overlay_id:this.model.id,iType:702});if(e.length>0){if("undefined"==typeof TweenMax)return;TweenMax.set(this.$el.find("svg").find("path"),{display:"none"}),this.$el.find("svg").append("<g id='cloneArea' style='display:none;'></g>"),this.$el.find("svg #cloneArea").append(this.$el.find("svg").find("path").clone()),this.$el.find("svg #cloneArea path").each(function(e,t){t.id="clone_"+t.id,$(t).attr("data-attr","morphCloneElement")});var t=e[0].attributes.iDetail.pathIndex;if(!_.isEmpty(t)){if(t.find)var i=t.find(function(e){return null!=e.selected});else var i=_.find(t,function(e){return null!=e.selected});if(i){i.id;TweenMax.set(this.$el.find("svg").find("path#"+i.id),{display:"block"})}}}}})}),define("interaction_view/model/avatarList",["_g/ajax","interaction_view/model/infoList"],function(){interaction_view.model.AvatarList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.get("iDetail");this.iview=new interaction_view.view.AvatarList({model:this})},setsyncmodel:function(){}}),interaction_view.view.AvatarList=interaction_view.view.Base.extend({render:function(){var e=[30,40,50],t=["Hiragino Sans GB,Microsoft YaHei,SimHei,STHeiti","SimSun,宋体,STSong","andale mono,times","arial,helvetica,sans-serif","arial black,avant garde","book antiqua,palatino","comic sans ms,sans-serif","courier new,courier","georgia,palatino","helvetica","impact,chicago","tahoma,arial,helvetica,sans-serif","terminal,monaco","times new roman,times","trebuchet ms,geneva","verdana,geneva"];this.$el.find(".avatar").css({width:e[this.model.attributes.iDetail.thumb_size]}),this.$el.find(".avatar .thumb").css({"border-radius":this.model.attributes.iDetail.cr+"px"}),this.$el.find(".avatar .title").css({color:this.model.attributes.iDetail.font_color,"font-size":this.model.attributes.iDetail.font_size+"px","font-family":t[this.model.attributes.iDetail.font_face]}),this.model.attributes.iDetail.show_title?this.$el.find(".avatar .title").show():this.$el.find(".avatar .title").hide(),this.$avatar=this.$el.find(".info-template .avatar").clone(),this.url="",this.totalInfoPage=0,this.currentPage=1,this.pullUpInfo=["上拉加载更多","释放更新"],this.model._reset=!0},resetOtherStatus:function(){this.delayShowel(),this.model.attributes.iDetail.RelationID||this.renderScroll()},delayShowel:function(){function e(){t.$el.find(".Element").css("visibility","visible")}var t=this;setTimeout(e,0)},renderScroll:function(){this.scrollview&&this.scrollview.iScroll.destroy();var e=this.getMoveRange(),t=this.$el.find(".Element");this.scrollview=new _g.scrollview({containment:t,contentel:this.$el.find(".info-content"),mask_width:t.width(),mask_height:t.height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:0,content_y:0,scrollY:e.y>0?!0:!1}),this.$el.addClass("hascontrols")},getLayerContentSize:function(){var e,t,i,n,a={width:0,height:0};i=this.$el.find(".Element").width(),n=this.$el.find(".Element").height();var r=2*parseInt(this.$el.find(".avatar:first").css("padding"));return e=this.$el.find(".avatar:first").width()+r,t=this.$el.find(".avatar:first").height(),0==t&&(this.$el.removeClass("hide"),t=this.$el.find(".avatar:first").height(),t>0?this.$el.addClass("hide"):t=60),t+=r,a.width=i,a.height=Math.ceil(this.$el.find(".avatar").size()/Math.floor(i/e))*t,this.$el.find(".info-content").css({width:a.width,height:a.height}),a.height<=t&&(a.height=t),a.height+=10,this.$el.find(".info-content .lists").height(a.height),a},updatePullUpInfo:interaction_view.view.InfoList.prototype.updatePullUpInfo,renderPagingScroll:interaction_view.view.InfoList.prototype.renderScroll,getInfo:function(e){var t=this,i=(this.getdetail(),this.url),n=!1;e&&(this.currentPage<this.totalInfoPage?this.currentPage++:n=!0,i+="&page="+this.currentPage),n||_g.ajax.get({dataType:"JSON",url:i,callback:function(i){if(200==i.code){t.totalInfoPage=i.data.numpages;var n={x:0,y:0},a=t.$el.find(".info-content .lists"),r=t.$el.find(".info-template .avatar .title").height();e?n=t.scrollview.iScroll.getComputedPosition():a.empty(),$.each(i.data.results,function(e,i){var n=t.$avatar.clone();n.find(".thumb").css("background-image","url("+i.portrait+")"),n.find(".title").html(i.nickname).attr("title",i.nickname),a.append(n)}),a.find(".avatar .title").height(r),t.renderPagingScroll(n),t.updatePullUpInfo()}else t.$el.find(".info-content .lists").html("空")}})}})}),define("interaction_view/model/avatar",["_g/ajax","interaction_view/model/vote","interaction_view/model/avatarList"],function(){interaction_view.model.Avatar=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.get("iDetail");this.setSubOverlays(),this.iview=new interaction_view.view.Avatar({model:this})},setsyncmodel:function(){}}),interaction_view.view.Avatar=interaction_view.view.Base.extend({render:function(e){this.model._reset=!0},resetOtherStatus:function(){if(this.delayShowel(),!this.model.attributes.iDetail.RelationID){var e,t;void 0!=this.model.attributes.iDetail.iKind&&1==this.model.attributes.iDetail.iKind?"undefined"!=typeof epub360_sourceinfo&&epub360_sourceinfo.portrait&&(e=epub360_sourceinfo.portrait,t=epub360_sourceinfo.nickname):"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.portrait&&(e=epub360_userinfo.portrait,t=epub360_userinfo.nickname),e&&this.$el.find(".thumb").css({"background-image":"url("+e+")","background-size":"cover"}),t&&this.$el.find(".iTextLabel p").html(t)}this.model.attributes.iDetail.iNickname?this.$el.find(".iTextLabel").show():this.$el.find(".iTextLabel").hide()},delayShowel:interaction_view.view.AvatarList.prototype.delayShowel,preload:interaction_view.view.Vote.prototype.preload,checkImgload:interaction_view.view.Vote.prototype.checkImgload,afterpreload:interaction_view.view.Vote.prototype.afterpreload,setTitle:function(){if(this.model.attributes.iDetail.iNickname){var e=(this.getdetail(),this.model.get("suboverlays")),t=e[0].iDetail.iValue,i=interaction_view.formatLabel({
text:"Jason"==t?"Name":t,font_size:e[0].iDetail.font_size,text_color:e[0].iDetail.text_color,iPosition:e[0].iDetail.iPosition});this.$el.find(".iTextLabel.Element").html(i)}},afterSubOverlayPreload:interaction_view.view.Vote.prototype.afterSubOverlayPreload})}),define("interaction_view/model/initButton",["interaction_view/model/button"],function(){interaction_view.model.InitButton=interaction_view.model.Button.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.InitButton({model:this})},setsyncmodel:function(){}}),interaction_view.view.InitButton=interaction_view.view.Button.extend({render:function(){var e=this,t=interaction_view.environment.Shareapp.slug,i="tap";e.$el.find("img.iconNormal").hammer().on(i,function(i){_g.ajax.post({dataType:"JSON",url:"/share/"+t+"/create",callback:function(t){if(200==t.code){var i=t.data.results[0].shareinfo.id;message_link=_g.replaceUrlParameterByName("shareid","shareid="+i,message_link),interaction_view.environment.Shareapp.shareinfo=t.data.results[0].shareinfo,interaction_view.environment.Shareapp.id=i,2!=interaction_view.environment.Shareapp.status&&(interaction_view.environment.Shareapp.status=2,interaction_view.environment.Shareapp.appinfo={target_num:0,help_rule:0}),epub360_userinfo.hasOwnProperty("openid")&&(interaction_view.environment.Shareapp.helperinfo=epub360_userinfo,interaction_view.environment.Shareapp.helperinfo.help_num=0,interaction_view.environment.Shareapp.helperinfo.help_num_today=0);var n=_.filter(interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.models,function(e){return"UserList"==e.attributes.iType});if(n.length>0){var a=t.data.results[0].shareinfo.nickname,r=t.data.results[0].shareinfo.portrait,o=n[0];0==o.iview.status?o.iview.resetOtherStatus():o.iview.setShareAppInfo(i,a,r)}interaction_view.weixin.share(),interaction_view.events.onUserList(e,78)}else interaction_view.events.onUserList(e,79)},onError:function(){interaction_view.events.onUserList(e,79)}})}),this.model._reset=!0}})}),define("interaction_view/model/userList",["interaction_view/model/base"],function(){interaction_view.model.UserList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.UserList({model:this})},setsyncmodel:function(){}}),interaction_view.view.UserList=interaction_view.view.Base.extend({render:function(){this.model._reset=!0,this.binded=!1,this.status=0,interaction_view.environment.Shareapp.add(this)},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},resetOtherStatus:function(){var e=this;interaction_view.environment.Shareapp.status<2||(this.avatar=this.getRelationOverlay(0),this.avatarList=this.getRelationOverlay(1),this.button=this.getRelationOverlay(2),this.avatar&&this.avatarList&&this.button&&(2==interaction_view.environment.Shareapp.status?(e.getAvatar(),e.getAvatarList(),!e.binded&&e.bindSupportTrigger()):this.avatarList.renderScroll(),this.model._reset=!1,this.status=2,this.binded=!0))},getAvatar:function(){var e=this;2==interaction_view.environment.Shareapp.status&&(e.setAvatar(interaction_view.environment.Shareapp.shareinfo.nickname,interaction_view.environment.Shareapp.shareinfo.portrait),interaction_view.environment.Shareapp.shareinfo.total>=interaction_view.environment.Shareapp.appinfo.target_num&&("undefined"!=typeof epub360_userinfo&&epub360_userinfo.openid==interaction_view.environment.Shareapp.shareinfo.openid&&interaction_view.events.onUserList(e,74),interaction_view.environment.Shareapp.helperinfo&&interaction_view.environment.Shareapp.helperinfo.help_num>0&&interaction_view.events.onUserList(e,75)))},setShareAppInfo:function(e,t,i){var n=this;n.share_id=e,n.setAvatar(t,i),n.getAvatarList()},setAvatar:function(e,t){var i=this;i.avatar.$el.find(".thumb").css({"background-image":"url("+t+")","background-size":"cover"}),i.avatar.$el.find(".iTextLabel p").html(e)},getAvatarList:function(){var e=this;e.avatarList.url="/share/"+interaction_view.environment.Shareapp.slug+"/list?id="+interaction_view.environment.Shareapp.id,e.resetAvatarList(),e.avatarList.getInfo()},resetAvatarList:function(){var e=this,t=e.avatarList.$el.find(".info-content .lists");t.empty()},bindSupportTrigger:function(){var e=this,t=1,i="tap";e.button.$el.find("img.iconNormal").hammer().on(i,function(i){if(interaction_view.environment.Shareapp.helperinfo&&interaction_view.environment.Shareapp.helperinfo.help_num>0)if(0==interaction_view.environment.Shareapp.appinfo.help_rule){if(interaction_view.environment.Shareapp.helperinfo&&interaction_view.environment.Shareapp.helperinfo.help_num>0)return void interaction_view.errorAlert("您已经支持过，谢谢!")}else if(interaction_view.environment.Shareapp.appinfo.help_rule<=interaction_view.environment.Shareapp.helperinfo.help_num_today)return void interaction_view.errorAlert("您今天的次数已经用完!");_g.ajax.post({dataType:"JSON",url:"/share/"+interaction_view.environment.Shareapp.slug+"/help",data:{share_id:interaction_view.environment.Shareapp.id,amount:t},callback:function(t){if(200==t.code){if("undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.portrait){var i=e.avatarList.$el.find(".info-content .lists"),n=e.avatarList.$avatar.clone();n.find(".thumb").css("background-image","url("+epub360_userinfo.portrait+")"),n.find(".title").html(epub360_userinfo.nickname).attr("title",epub360_userinfo.nickname),n.find(".title").css("height","18px"),i.prepend(n),interaction_view.environment.Shareapp.helperinfo=epub360_userinfo,interaction_view.environment.Shareapp.helperinfo.help_num=1,_g.ajax.get({dataType:"JSON",url:"/share/"+interaction_view.environment.Shareapp.slug+"/info?id="+interaction_view.environment.Shareapp.id,callback:function(t){200==t.code&&(interaction_view.environment.Shareapp.helperinfo=t.data.results[0].helperinfo,interaction_view.environment.Shareapp.shareinfo.total=interaction_view.environment.Shareapp.shareinfo.total+1,interaction_view.environment.Shareapp.shareinfo.total>=interaction_view.environment.Shareapp.appinfo.target_num&&interaction_view.events.onUserList(e,75))}})}interaction_view.events.onUserList(e.button,76)}else interaction_view.events.onUserList(e.button,77)},onError:function(){interaction_view.events.onUserList(e.button,77)}})})},getRelationOverlay:function(e){var t=this.model.get("iDetail").RelationID;t=t.replace(t.split("_")[0],"t"+e);var i=_.filter(this.model.page.iOverlaylist.models,function(e){return e.id&&e.get("iDetail").RelationID&&e.get("iDetail").RelationID==t});return i.length>0?i[0].iview:null}})}),define("interaction_view/model/infoForm",["interaction_view/model/userList"],function(){interaction_view.model.InfoForm=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.InfoForm({model:this})},setsyncmodel:function(){}}),interaction_view.view.InfoForm=interaction_view.view.Base.extend({render:function(){this.model._reset=!0,this.binded=!1},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},getRelationOverlay:interaction_view.view.UserList.prototype.getRelationOverlay,resetOtherStatus:function(){if(!this.binded){var e=this,t=_g.getUrlParameterByName("shareid"),i=interaction_view.shareapp.id;this.input_fullname=this.getRelationOverlay(0),this.input_mobile=this.getRelationOverlay(1),this.input_address=this.getRelationOverlay(2),this.input_email=this.getRelationOverlay(3),this.input_memo=this.getRelationOverlay(4),this.button=this.getRelationOverlay(5),e.bindSubmitTrigger(t,i),this.model._reset=!1,this.binded=!0}},isValid:function(e,t,i,n){var a=this;if(!$.trim(e))return alert("请输入姓名！"),!1;if(!$.trim(t))return alert("请输入手机号码！"),!1;var r=interaction_view.MOBILEREG;return r.test(t)?(t&&(epub360_userinfo=epub360_userinfo||{},epub360_userinfo.mobile=t),a.model.get("iDetail").show_address&&!$.trim(i)?(alert("请输入地址信息！"),!1):a.model.get("iDetail").show_email&&!$.trim(n)?(alert("请输入电子邮箱信息！"),!1):!0):(alert("请输入正确手机号码！"),!1)},bindSubmitTrigger:function(e,t){var i=this,n="tap";i.button.$el.find("img.iconNormal").hammer().on(n,function(n){if(!t)return void alert("仅配合助力活动使用，绑定助力应用后生效！");var a=i.input_fullname&&i.input_fullname.$el.find("input").val(),r=i.input_mobile&&i.input_mobile.$el.find("input").val(),o=i.input_address&&i.input_address.$el.find("input").val(),s=i.input_email&&i.input_email.$el.find("input").val(),l=i.input_memo&&i.input_memo.$el.find("textarea").val();i.isValid(a,r,o,s)&&_g.ajax.post({dataType:"JSON",url:"/share/"+t+"/signup",data:{share_id:e,fullname:a,mobile:r,address:o,email:s,memo:l},callback:function(e){200==e.code?(interaction_view.events.onUserList(i.button,80),"function"==typeof epub360FromSubmited&&epub360FromSubmited()):interaction_view.events.onUserList(i.button,81)},onError:function(){interaction_view.events.onUserList(i.button,81)}})})}})}),define("interaction_view/model/contactForm",["interaction_view/model/infoForm"],function(){interaction_view.model.ContactForm=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.ContactForm({model:this})},setsyncmodel:function(){}}),interaction_view.view.ContactForm=interaction_view.view.InfoForm.extend({isValid:function(e,t,i,n){var a=this,r=a.getdetail(),o=a.input_fullname&&a.input_fullname.getdetail()||{},s=a.input_mobile&&a.input_mobile.getdetail()||{},l=a.input_address&&a.input_address.getdetail()||{},c=a.input_email&&a.input_email.getdetail()||{};if(!$.trim(e)&&r.show_name){var d=o.placeholder||"请输入姓名！";return interaction_view.errorAlert(d),!1}if(r.show_tel){if(!$.trim(t)){var h=s.placeholder||"请输入手机号码！";return interaction_view.errorAlert(h),!1}var u=interaction_view.MOBILEREG;if(!u.test(t))return(void 0==s.iKind||"tel"!=s.iKind)&&interaction_view.errorAlert("请输入正确手机号码！"),!1;t&&(epub360_userinfo=epub360_userinfo||{},epub360_userinfo.mobile=t)}if(r.show_address&&!$.trim(i)){var p=l.placeholder||"请输入地址信息！";return interaction_view.errorAlert(p),!1}if(r.show_email){if(!$.trim(n)){var f=c.placeholder||"请输入电子邮箱信息！";return interaction_view.errorAlert(f),!1}if(void 0==c.iKind||"email"!=c.iKind){var v=/^(\w)+(.\w+)*@(\w)+(.\w+)*((\.\w+)+)$/;if(!v.test(n))return interaction_view.errorAlert("请输入正确的电子邮箱！"),!1}}return!0},bindSubmitTrigger:function(e,t){var i=this,n="tap";i.button.$el.find("img.iconNormal").hammer().on(n,function(t){var n=i.input_fullname&&i.input_fullname.$el.find("input").val(),a=i.input_mobile&&i.input_mobile.$el.find("input").val(),r=i.input_address&&i.input_address.$el.find("input").val(),o=i.input_email&&i.input_email.$el.find("input").val(),s=i.input_memo&&i.input_memo.$el.find("textarea").val();i.isValid(n,a,r,o)&&_g.ajax.post({dataType:"JSON",url:"/manage/book/"+interaction_view.doc.id+"/form/",data:{id:i.model.get("id"),title:i.model.get("iDetail").title,share_id:e,fullname:n,mobile:a,address:r,email:o,memo:s},callback:function(e){if(200==e.code){var t=i.getdetail().submit_info||"提交成功!";interaction_view.events.onContactFormSubmit(i.button,82,t,function(){i.input_fullname&&i.input_fullname.$el.find("input").val(""),i.input_mobile&&i.input_mobile.$el.find("input").val(""),i.input_address&&i.input_address.$el.find("input").val(""),i.input_email&&i.input_email.$el.find("input").val(""),i.input_memo&&i.input_memo.$el.find("textarea").val("")}),"function"==typeof epub360FromSubmited&&epub360FromSubmited()}else interaction_view.events.onContactFormSubmit(i.button,83)},onError:function(){interaction_view.events.onContactFormSubmit(i.button,83)}})})}})}),define("interaction_view/model/plugin",["interaction_view/model/base","text!interaction_view/template/offline_info.tpl"],function(){require("text!interaction_view/template/offline_info.tpl");interaction_view.model.Plugin=interaction_view.model.Base.extend({defaults:{iType:"Plugin",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Plugin({model:this})},setsyncmodel:function(){}}),interaction_view.view.Plugin=interaction_view.view.Base.extend({events:{},render:function(){var e=this.getdetail();this.$el.children(".Element").html(e.iSource),this.model.renderWebContent=!0},renderWebContent:function(e){this.getdetail()},clearWebContent:function(){}})}),define("interaction_view/model/select",["interaction_view/model/base"],function(){interaction_view.model.Select=interaction_view.model.Base.extend({defaults:{iType:"Select",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.Select({model:this})},setsyncmodel:function(){}}),interaction_view.view.Select=interaction_view.view.Base.extend({events:{},render:function(e){var t=this,i=this.getdetail();this.prependOpt();var n=t.$el.find("select").parent();n.addClass("select-patch-unify"),n.find(".select-patch-arrow").length||n.append("<div class='select-patch-arrow'></div>"),this.arrowFix(n),this.$el.find("select").on("change",function(){console.log($(this).val()),interaction_view.events.onFormEvent(t.model,$(this).val())});var a=interaction_view.events.onFormButtonRender(this.model);if(a.field){for(var r=a.field.i.field_options.options,o=0;o<r.length;o++){var s=$("<option>"+r[o].label+"</option>");s.attr("value",r[o].label),this.$el.find("select").append(s)}a.value&&this.$el.find("select").val(a.value)}if(1==i.sourceType){if(i.items&&i.items.length)for(var o=0;o<i.items.length;o++){var s=$("<option>"+i.items[o]+"</option>");s.attr("value",i.items[o]),this.$el.find("select").append(s)}}else{if(2==i.sourceType)return;if(3==i.sourceType){var l=new dboperate,c=null;l.getqueryValue(i.db_id,i.query_id,0,c,function(e){for(var n=0;c>n&&n<e.data.results.length;n++)if(e.data.results[n]){var a=t.getFieldVal(i.field_id,e.data.results[n]),r=$("<option>"+a+"</option>");r.attr("value",a),this.$el.find("select").append(r)}},{query:{},type:0})}}i.initial&&this.$el.find("select").val(i.initial)},prependOpt:function(){var e=this.getdetail();this.$el.find("select").empty(),e.placeholder&&this.$el.find("select").append("<option>"+e.placeholder+"</option>")},getFieldVal:function(e,t){var i=interaction_view.expression.getFieldValue(e,t);return interaction_view.expression.id2values(i,null,{force_compute:!0})},resetOtherStatus:function(){var e=this.getdetail();if(0==e.sourceType){var t=interaction_view.events.onFormButtonRender(this.model);t.value&&this.$el.find("select").val(t.value)}},onPlay:function(){var e=this.getdetail();if(2==e.sourceType){var t=interaction_view.events.onFormButtonRender(this.model);t.value&&(this.$el.find("select").val(t.value),this.$el.find("select").trigger("change"))}},setVariable:function(e,t,i,n){var a=this;1!=e&&2!=e&&3!=e&&interaction_view.expression.id2values(t,function(e){a.$el.find("select").val(e),n&&n(e)},{_promise:i})},arrowFix:function(e){var t=t||this,i=e.find(".select-patch-arrow");i.length&&i.css({right:t.widthAdder(e.find("select"),["border-right-width"]),top:Math.max(e.outerHeight(),e.find("select").outerHeight())/2+"px"})},widthAdder:function(e,t){return _(_(t).map(function(t){return e.css(t)})).reduce(function(e,t){return e+Number(t.slice(0,-2))},0)+"px"},getPlaceholder:function(){return this.getdetail().placeholder},isCascadeSelect:function(){return 2==this.getdetail().sourceType}})}),define("interaction_view/model/systemvariable",["interaction_view/model/base"],function(){interaction_view.model.SystemVariable=interaction_view.model.Base.extend({defaults:{iType:"SystemVariable",iVisibility:!0,iCommon:null,iDetail:{},iParentModel:null,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1"},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.SystemVariable({model:this})},setsyncmodel:function(){}}),interaction_view.view.SystemVariable=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){this.detail=this.model.attributes.iDetail},render:function(e){this.model._reset=!0},preload:function(){},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},triggerVarChange:function(){var e=this.getdetail();1==e.immediate&&interaction_view.events.onSystemVariableChanged(this)}})}),define("interaction_view/model/qqvideo",["interaction_view/model/video"],function(){interaction_view.model.QQVideo=interaction_view.model.Video.extend({defaults:{iType:"QQVideo",iLock:!0,iVisibility:!0,iCommon:{},iDetail:{},iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,callback:null},setview:function(e){this.iview=new interaction_view.view.QQVideo({model:this})}}),interaction_view.view.QQVideo=interaction_view.view.Video.extend({events:{},preload:function(){var e=this.getdetail();e.vid&&(this.preloadmodel=this.sendToPreload({vid:e.vid}))},resetOtherStatus:function(){if(!this.model.hided&&this.model.media){if(this.model.iview.$el.hasClass("video_auto_play"))return;interaction_view.media.video.reset(this.model),this.model.get("iDetail").iControl&&this.$el.find(".jwdisplayIcon").css({opacity:1})}}})}),define("interaction_view/model/MobileValid",["interaction_view/model/userList"],function(){interaction_view.model.MobileValid=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){this.iview=new interaction_view.view.MobileValid({model:this})},setsyncmodel:function(){}}),interaction_view.view.MobileValid=interaction_view.view.Base.extend({render:function(){this.model._reset=!0,this.binded=!1},getRelationOverlay:interaction_view.view.UserList.prototype.getRelationOverlay,resetOtherStatus:function(){this.binded||(this.input_mobile=this.getRelationOverlay(0),this.input_valid=this.getRelationOverlay(1),this.button=this.getRelationOverlay(2),this.input_valid.$el.find("input")[0].type="number",this.bindSubmitTrigger(),this.binded=!0)},isValid:function(e){if(!$.trim(e))return interaction_view.application.errorAlert("请输入手机号码！"),!1;var t=interaction_view.MOBILEREG;return t.test(e)?!0:(interaction_view.application.errorAlert("请输入正确手机号码！"),!1)},bindSubmitTrigger:function(){var e=this,t=this.input_mobile.model.attributes.iDetail.app_id;if(t){var i="tap",n=[e.button.$el.find(".iText>div").text(),"秒后重新发送"];e.button.$el.hammer().on(i,function(i){if(e.button.$el.find(".iText>div").text()==n[0]){var a=e.input_mobile&&e.input_mobile.$el.find("input").val();e.isValid(a)&&(e.input_valid.$el.find("input").val(""),_g.ajax.post({dataType:"JSON",url:"/form/"+t+"/verifymobile/",data:{mobile:a},callback:function(t){function i(e){0==a?e.text(n[0]):(e.text(a+"秒后重新获取验证码"),a--,setTimeout(function(){i(e)},1e3))}if(400==t.code)interaction_view.application.errorAlert("手机号有误！");else if(409==t.code)interaction_view.application.errorAlert("此手机号已经参与过，请使用其他号码！");else if(200==t.code){var a=60;i(e.button.$el.find(".iText>div"))}else interaction_view.application.errorAlert(t.msg)},onError:function(){interaction_view.application.errorAlert("系统错误，请重试！")}}))}}),interaction_view.environment.otherFormValue.veriyCode="",e.input_valid.$el.find("input").change(function(e){interaction_view.environment.otherFormValue.veriyCode={value:$(this).val(),errMsg:"请输入验证码！"}})}}})}),epub360.PlayerPlugins.push({config:{type:"StaticList",template:"Paragraph"},render:function(){this.updateTemplate()},updateTemplate:function(){function e(){var e=$("<div class='contentGridRow'></div>");if(e.html(a.detail),0==i.iTemplate&&i.iCols>1){var n=t.getcommon().iWidth/i.iCols;e.css({display:"inline-block",width:n})}else 2==i.iTemplate&&e.css({display:"inline-block"});return e}var t=this,i=this.getdetail(),n=this.$el.find(".iParagraph>.paragraph>div"),a=_.find(i.templates,function(e){return e.id==i.styleIndex}),r=e();n.html("<div class='contentList'></div>"),n=n.find(".contentList"),a&&a.detail&&(i.data&&0!=i.data.length?_.each(i.data,function(e,t){var a=r.clone();a.find("[es-title]").each(function(t,n){var r=$(n).attr("es-title"),o=_.find(i.structure,function(e){return e.title==r}),s=_.indexOf(i.structure,o);if(s>=0&&(("text"==o.type||"文本"==o.type)&&$(n).text(e[s].value),"paragraph"==o.type||"段落"==o.type?$(n).html(e[s].value):("img"==o.type||"图片"==o.type||"背景图片"==o.type)&&("img"==n.tagName.toLowerCase()?$(n).attr("src",e[s].value):$(n).css("background-image","url("+e[s].value+")")),o.show&&e[s].show||a.find("[es-order="+o.order+"]").hide(),e[s].show&&_.include(["0","1","2"],e[s].linktype+""))){var l={page_id:e[s].linkvalue,url:e[s].linkvalue};$(n).removeAttr("href").addClass("hasaction"),$(n).hammer().on("tap",function(t){return window.setTimeout(function(){interaction_view.renderLink(e[s].linktype,l)},300),t.gesture.preventDefault(),!1})}}),n.append(a)}):(n.append(r),_.each(i.structure,function(e,t){e.show||n.find("[es-order="+e.order+"]").hide()})))},renderScroll:function(e){this.scrollview&&this.scrollview.iScroll.destroy();var t=this,i=this.$el.find(".contentList"),n=i.parent(),a=i.outerHeight(),r=_g.ui.isOverflowed(n).y,o=a-n.height();r&&(this.scrollview=new _g.scrollview({containment:n,contentel:i,mask_width:n.width(),mask_height:n.height(),content_width:n.width,content_height:a,content_x:0,content_y:0,scrollY:!0,HWCompositing:!0,onScrolling:function(e){r&&(Math.abs(e.deltaY)>o+30||e.deltaY>30)&&(n.addClass("is_exceededY"),t.$el.children(".Element").removeClass("disableDragY iMouseWheel disableMouseWheelY"))},onScrollend:function(){r&&n.removeClass("is_exceededY")}}),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY"))},immediateRender:function(){this.renderScroll(),console.log("元素开始在页面播放")},setotherdisplay:function(){},otherOnShow:function(){console.log("element shown"),this.renderScroll()},otherOnHide:function(){console.log("element hided")}}),define("interaction_view/components/staticlist",function(){}),epub360.PlayerPlugins.push({config:{type:"Puzzle",Model:"ImageBlock",template:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iPuzzle Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;<%=iDetail.iStyle%>">',"</div>","</div>","</div>"].join("")},render:function(){var e=this.getdetail();if("Puzzle"==this.model.get("iType")){var t=this.model.id;$(this.container).find("#"+t).find(".el_wrap").html(e.itemplateOn);var i=$(this.container).find("#"+t).find("[es-type=img]");_.each(i,function(t,i){var n=e.iImg;n&&n[i]&&$(t).css({"background-image":"url("+n[i].picture+")","background-position":n[i].iStyle}),e.templateStyle&&$(t).css("border-radius",e.templateStyle.borderRadius).parent().css("padding",e.templateStyle.blockpadding)}),console.log("元素已经完成在页面的展现")}},immediateRender:function(){console.log("元素开始在页面播放")},setOtherDisplay:function(){var e=this,t=this.getdetail();t.iFullview&&this.$el.on("click",function(){e.fullview()})},otherOnShow:function(){console.log("element shown")},otherOnHide:function(){console.log("element hided")},fullview:function(){var e=this.getdetail(),t=[];(null==e.iImg||0==e.iImg.length)&&e_api.console.log("iImg 为空");for(var i=0;i<e.iImg.length;i++)t.push(e.iImg[i].picture);window.epubsdk.previewImage(t[0],t)},isFullSwitch:function(){return!1}}),define("interaction_view/components/puzzle/puzzle",function(){}),epub360.PlayerPlugins.push({config:{type:"Gyroscope",template:"Container"},render:function(){var e=this.getdetail();switch(e.init_display?this.$el.show():this.$el.hide(),this.$el.find(".el_wrap").html("0"),this.iKind=e.iKind,this.start=e.start||0,this.end=e.end||0,this.iKind){case 0:this.gy_range=360,this.gy_start=-180,this.start<-180&&(this.start=-180),this.start>180&&(this.start=180),this.end>180&&(this.end=180),this.end<-180&&(this.end=-180);break;case 1:this.gy_range=180,this.gy_start=-90,this.start<-90&&(this.start=-90),this.start>90&&(this.start=90),this.end>90&&(this.end=90),this.end<-90&&(this.end=-90);break;case 2:this.gy_range=360,this.gy_start=0,this.start<0&&(this.start=0),this.start>360&&(this.start=360),this.end>360&&(this.end=360),this.end<0&&(this.end=0)}this.range=Math.abs(this.end-this.start),this.oper=this.end-this.start>0?1:-1,this.model.eventsHandle=[]},immediateRender:function(e){this.getdetail();this.model.disabled=!1,this.model.value=0,this.range&&_e.orientation.event.on("orientation",this.listenOrientation)},listenOrientation:function(e){if(!this.model.disabled&&(console.log(e),e)){var t,i=e.beta,n=e.gamma,a=e.alpha;if(t=0==this.iKind?i:1==this.iKind?n:a,1===this.oper){if(!(t>=this.start&&t<=this.end))return}else if(!(t>=this.end&&t<=this.start))return;if(t=_g.number.decimal(t,2),this.model.value==t)return;this.model.value=t*this.oper,this.$el.find(".el_wrap").html(this.model.value);for(var r=0;r<this.model.eventsHandle.length;r++)this.model.eventsHandle[r].func()}},updateText:function(e,t){},onStop:function(){_e.orientation.event.off("orientation",this.listenOrientation)}}),define("interaction_view/components/gyroscope/gyroscope",function(){}),epub360.PlayerPlugins.push({config:{type:"contentGrid",template:"Container"},render:function(){this.totalInfoPage=0,this.currentPage=1,this.queryOpts={key:"",value:""},this.db_id=this.model.attributes.iDetail.db_id,this.query_id=this.model.attributes.iDetail.query_id,this.model.attributes.iDetail.autoload&&this.updateTemplate()},refresh:function(e){this.queryOpts={key:"",value:""},this.db_id=this.model.attributes.iDetail.db_id,this.query_id=this.model.attributes.iDetail.query_id,this.updateTemplate(function(){e.done()})},updateTemplate:function(e,t){function i(){var e=$("<div class='contentGridRow'></div>");if(e.html(l.detail),0==r.iTemplate&&r.iCols>1){var t=a.getcommon().iWidth/r.iCols;e.css({display:"inline-block",width:t})}else 2==r.iTemplate&&e.css({display:"inline-block"});return e}function n(){for(var n=i(),o=0;o<r.iCount;o++){var l=n.clone();l.find("[es-bind=1]").length?l.find("[es-bind=1]").each(a.bindData_static):l.find("[es-title]").each(a.bindData_static),s.append(l),a.onContentGridRender(l,r)}n.remove();var c={x:0,y:0};t&&(c=a.scrollview.iScroll.getComputedPosition()),a.renderScroll(c),e&&e()}var a=this,r=this.getdetail(),o=r.db_dbtype,s=this.$el.find(".Element .el_wrap"),l=_.find(r.templates,function(e){return e.id==r.styleIndex});if(l&&l.detail)if(a.db_id&&a.query_id){var c=new dboperate,d=!1,h=r.iCount,u=1;t?(this.currentPage<this.totalInfoPage?this.currentPage++:d=!0,u=this.currentPage):h=this.currentPage*r.iCount,!d&&c.getqueryValue(a.db_id,a.query_id,u,h,function(n){a.totalInfoPage=n.data.numpages;var o={x:0,y:0};t&&(o=a.scrollview.iScroll.getComputedPosition()),!t&&s.html("<div class='contentList'></div>"),s=s.find(".contentList");for(var l=i(),c=0;h>c;c++)if(n.data.results[c]){var d=l.clone();a.isBind()&&(d.find("[es-bind=1]").length?d.find("[es-bind=1]").each(function(e,t){a.bindData_db($(t),n.data.results[c])}):d.find("[es-title]").each(function(e,t){a.bindData_db($(t),n.data.results[c])})),d.data("value",n.data.results[c]),s.append(d),a.onContentGridRender(d,r)}l.remove(),a.renderScroll(o),e&&e()},{query:this.queryOpts,type:o||0})}else!t&&s.html("<div class='contentList'></div>"),s=s.find(".contentList"),a.isBind()?setTimeout(n,0):(s.html(l.detail),_.each(r.structure,function(e,t){e.show||s.find("[es-order="+e.order+"]").hide()}))},isBind:function(){var e=!1,t=this.getdetail();return t.structure.length&&(t.structure[0].id?_.each(t.structure,function(t,i){return t.bind?(e=!0,!1):void 0}):e=t.fields&&t.fields.length),e},getStructure:function(e){var t=this.getdetail(),i=e.attr("es-id"),n=e.attr("es-title"),a=null;if(t.structure.length)if(t.structure[0].id)a=_.find(t.structure,function(e){return e.id==i});else{a=_.find(t.structure,function(e){return e.title==n});var r=_.indexOf(t.structure,a);a.bind=t.fields[r]}return a},bindData_static:function(e,t,i){var n=this.getStructure($(t),i);if(n){if(_.include(["text","paragraph","img"],n.type)){var a=interaction_view.expression.id2values(n.bind,null,{force_compute:!0});"text"==n.type||"paragraph"==n.type?$(t).html(interaction_view.Txt2Html(a)):"img"==n.type&&$(t).css("background-image","url("+a+")")}else if("背景图片"==n.type&&interaction_view.expression.id2values(n.bind,function(e){$(t).css("background-image","url("+e+")")},{force_compute:!0}),"图片"==n.type)interaction_view.expression.id2values(n.bind,function(e){$(t).attr("src",e)},{force_compute:!0});else if("文本"==n.type)interaction_view.expression.id2values(n.bind,function(e){$(t).html(interaction_view.Txt2Html(e))},{force_compute:!0});else if("链接"==n.type)var a=interaction_view.expression.id2values(n.bind.linkvalue,function(e){0==n.bind.linktype?$(t).hammer().on("tap",function(t){return window.location=e,t.gesture.preventDefault(),!1}):$(t).hammer().on("tap",function(t){return window.location="tel:"+e,t.gesture.preventDefault(),!1})},{force_compute:!0});else"链接块"==n.type&&(n.bind.is_bind_bkimg&&interaction_view.expression.id2values(n.bind.bkimg,function(e){$(t).css("background-image","url("+e+")")},{force_compute:!0}),n.bind.is_bind_link&&interaction_view.expression.id2values(n.bind.linkvalue,function(e){0==n.bind.linktype?$(t).hammer().on("tap",function(t){return window.location=e,t.gesture.preventDefault(),!1}):$(t).hammer().on("tap",function(t){return window.location="tel:"+e,t.gesture.preventDefault(),!1})},{force_compute:!0}));this.showEl(n,$(t))}},bindData_db:function(e,t,i){var n=this.getStructure(e,i);if(n){if(_.include(["text","paragraph","img"],n.type)){var a=this.getFieldVal(n.bind,t);if("text"==n.type||"paragraph"==n.type?e.html(interaction_view.Txt2Html(a)):"img"==n.type&&e.css("background-image","url("+a+")"),""==a)return void e.hide()}else if("背景图片"==n.type){var a=this.getFieldVal(n.bind,t);e.css("background-image","url("+a+")")}else if("文本"==n.type){var a=this.getFieldVal(n.bind,t);e.html(interaction_view.Txt2Html(a))}else if("链接"==n.type){var a=this.getFieldVal(n.bind.linkvalue,t);0==n.bind.linktype?e.hammer().on("tap",function(e){
return window.location=a,e.gesture.preventDefault(),!1}):e.hammer().on("tap",function(e){return window.location="tel:"+a,e.gesture.preventDefault(),!1})}else if("链接块"==n.type){if(n.bind.is_bind_bkimg){var a=this.getFieldVal(n.bind.bkimg,t);e.css("background-image","url("+a+")")}if(n.bind.is_bind_link){var a=this.getFieldVal(n.bind.linkvalue,t);0==n.bind.linktype?e.hammer().on("tap",function(e){return window.location=a,e.gesture.preventDefault(),!1}):e.hammer().on("tap",function(e){return window.location="tel:"+a,e.gesture.preventDefault(),!1})}}this.showEl(n,e.parents(".contentGridRow:first"))}},showEl:function(e,t){var i;i=e.order?t.find("[es-order="+e.order+"]"):t.find("[es-id="+e.id+"]"),e.show?i.show():i.hide()},getFieldVal:function(e,t){var i=/\$[^\$]+\$/g,n=String(e).match(i),a=e;return _.each(n,function(e,i){var n=interaction_view.expression.getFieldValue(e,t);a=a.replace(e,n)}),interaction_view.expression.id2values(a,null,{force_compute:!0})},onContentGridRender:function(e,t){var i=this;e.data("variables",$.extend(!0,[],t.variables)),_.each(e.data("variables"),function(t,n){t.initial=i.getFieldVal(t.initial,e.data("value"))}),interaction_view.events.onContentGridRender(this,{$dom:e})},idToObject:function(e){e=e.replace("$d_","").replace("$","");var t=e.split(".");return t[t.length-1]},renderScroll:function(e){this.scrollview&&this.scrollview.iScroll.destroy();var t=this,i=this.getdetail(),n=!0,a=!1,r=this.$el.find(".Element .el_wrap"),o=!1;if(this.$el.hasClass("hide")&&(this.$el.removeClass("hide"),o=!0),r.css({width:"100%",height:"100%"}),r.find(".contentList").length){r.find(".contentList").css("height","");var s=r.find(".contentList").height();if(i.pulldown)a=1==i.pulldownType;else{n=!1;var l=this.model.attributes.iCommon.landscape.iHeight;if(l>=s)return}interaction_view.renderScroll({containment:r,contentel:r.find(".contentList").first(),view:t,content_y:e&&e.y||0,pullDown:n,pullUp:!0,autoload_more:a,onPullDown:function(){t.$el.find(".info_content").css("height",""),t.updateTemplate()},onPullUp:function(){t.$el.find(".info_content").css("height",""),t.updateTemplate(null,!0)}}),o&&this.$el.addClass("hide")}},immediateRender:function(){console.log("元素开始在页面播放")},setotherdisplay:function(){},otherOnShow:function(){this.renderScroll(),console.log("element shown")},onPlay:function(){this.model.attributes.iDetail.autoload&&this.renderScroll()},otherOnHide:function(){console.log("element hided")},renderQuery:function(e,t,i,n){this.queryOpts={key:i.key,value:i.value},this.db_id=e,this.query_id=t,this.updateTemplate(n)}}),define("interaction_view/components/contentGrid/contentGrid",function(){}),epub360.PlayerPlugins.push({config:{type:"htmlPage",template:"Container"},render:function(){this.bindData_static=interaction_view.view.contentGrid.prototype.bindData_static,this.bindData_db=interaction_view.view.contentGrid.prototype.bindData_db,this.showEl=interaction_view.view.contentGrid.prototype.showEl,this.getFieldVal=interaction_view.view.contentGrid.prototype.getFieldVal,this.onContentGridRender=interaction_view.view.contentGrid.prototype.onContentGridRender,this.renderScroll=interaction_view.view.StaticList.prototype.renderScroll},immediateRender:function(){this.updateTemplate()},updateTemplate:function(e,t){function i(){o--,0>=o&&n.renderScroll()}var n=this,a=this.getdetail();if(a.html){var r=this.$el.find(".Element .el_wrap");r.html("<div class='contentList'></div>"),r=r.find(".contentList"),r.html(a.html);var o=a.structure.length;o.length||n.renderScroll(),_.each(a.structure,function(e,t){var a=r.find("[es-id="+e.id+"]");if("背景图片"==e.type&&interaction_view.expression.id2values(e.bind,function(e){a.css("background-image","url("+e+")"),i()},{force_compute:!0}),"图片"==e.type)interaction_view.expression.id2values(e.bind,function(e){a.attr("src",e),i()},{force_compute:!0});else if("文本"==e.type)interaction_view.expression.id2values(e.bind,function(e){a.html(interaction_view.Txt2Html(e)),i()},{force_compute:!0});else if("网格列表"==e.type)return e.structure&&e.structure.length&&n.renderContentGrid(e,i),!0;e.show?a.show():a.hide()})}},updateDom:function(e,t){var i=this.getdetail(),n=i.structure.find(function(t){return t.id==e}),a=this.$el.find(".Element .contentList").find("[es-id="+e+"]");"背景图片"==n.type&&a.css("background-image","url("+t+")"),"图片"==n.type?a.attr("src",t):"文本"==n.type&&a.html(interaction_view.Txt2Html(t))},renderContentGrid:function(e,t){function i(){a.html("");for(var i=0;i<e.iCount;i++){var o=r.clone();_.each(e.structure,function(t,i){n.bindData_static(i,o.find("[es-id="+t.id+"]")[0],e)}),a.append(o),n.onContentGridRender(o,e)}r.remove(),t&&t()}var n=this,a=this.$el.find("[es-id="+e.id+"]"),r=this.$el.find("[es-id="+e.id+"]").find(".grid-item:first").clone();if(r.length)if(e.db_id&&e.query_id){var o=new dboperate;o.getqueryValue(e.db_id,e.query_id,0,e.iCount,function(i){a.html("");for(var o=0;o<e.iCount;o++)if(i.data.results[o]){var s=r.clone();n.isBind(e)&&_.each(e.structure,function(t,a){n.bindData_db(s.find("[es-id="+t.id+"]"),i.data.results[o],e)}),s.data("value",i.data.results[o]),a.append(s),n.onContentGridRender(s,e)}r.remove(),t&&t()},{query:{key:"",value:""},type:0})}else n.isBind(e)&&setTimeout(i,0);e.show?a.show():a.hide()},isBind:function(e){var t=!1;return _.each(e.structure,function(e,i){return e.bind?(t=!0,!1):void 0}),t},getStructure:function(e,t){var i=e.attr("es-id");return _.find(t.structure,function(e){return e.id==i})}}),define("interaction_view/components/htmlPage/htmlPage",function(){}),epub360.PlayerPlugins.push({config:{type:"Debug",category:"global"},initialize:function(){var e=this;"undefined"!=typeof DB&&(DB.Debug=!0),interaction_view.DEBUG=!0,console.log("Debug已经初始化完成"),interaction_view.containment.append('<div id="epub360-debug-btn"></div>'),$("#epub360-debug-btn").on("click",function(){var t=!1;interaction_view.containment.find("#epub360-debug").remove(),interaction_view.containment.append('<div id="epub360-debug"></div>'),interaction_view.containment.append('<div class="debug_menu"><div class="debug_btn debug_request">res</div><div class="debug_btn debug_close">&Chi;</div></div>'),$(".debug_close").on("click",function(){interaction_view.containment.find("#epub360-debug").remove(),interaction_view.containment.find(".debug_menu").remove()}),e.renderDebug(),e.renderLog();try{e.renderQueue()}catch(i){}return $(".debug_request").on("click",function(){return t?(e.renderDebug(),t=!1):(e.renderRequest(),t=!0),!1}),!1})},renderDebug:function(){interaction_view.containment.find("#epub360-debug").empty();var e=$("<li><span>全局变量</span><ul></ul></li>");interaction_view.containment.find("#epub360-debug").append(e),interaction_view.globallist.each(function(t){if(_.include(["GlobalVariable","ShareVariable"],t.attributes.iType)){var i=t.attributes.iDetail.title||t.attributes.iType,n=t.attributes.iDetail.initial,a=typeof n,r=$('<li style="margin:10px;">'+i+":"+n+"("+a+")</li>");e.append(r)}});var e=$("<li><span>当前页变量</span><ul></ul></li>");if(interaction_view.containment.find("#epub360-debug").append(e),interaction_view.currentPage){var t=interaction_view.ipagelist.getPage(interaction_view.currentPage);this.renderVariable(e,t)}var e=$("<li><span>当前页条件判断</span><ul></ul></li>");interaction_view.currentPage&&this.renderCondition(e,interaction_view.currentPage);var e=$("<li><span>Masterpage页变量</span><ul></ul></li>");if(interaction_view.currentPage){var t=interaction_view.imasterlist.at(0);this.renderVariable(e,t)}var e=$("<li><span>Masterpage页条件判断</span><ul></ul></li>");interaction_view.currentPage&&this.renderCondition(e,interaction_view.imasterlist.at(0).id);var e=$("<li><span>Background页变量</span><ul></ul></li>");if(interaction_view.currentPage){var t=interaction_view.ibackgroundlist.at(0);this.renderVariable(e,t)}var e=$("<li><span>Background页条件判断</span><ul></ul></li>");interaction_view.currentPage&&this.renderCondition(e,interaction_view.ibackgroundlist.at(0).id)},renderRequest:function(){interaction_view.containment.find("#epub360-debug").empty();var e=$("<li><span>数据表后台请求数据</span><ul></ul></li>");interaction_view.containment.find("#epub360-debug").append(e);for(var t in DB.Logs)if(DB.Logs[t]){var i=(DB.Logs[t].req||"send:<br>")+(DB.Logs[t].res||"请求无返回数据:"),n=$('<li style="margin:10px;">'+i+"</li>");e.children().eq(0).after(n)}},renderVariable:function(e,t){interaction_view.containment.find("#epub360-debug").append(e),t.iOverlaylist.each(function(t){if("Variable"==t.attributes.iType){var i=t.attributes.iDetail.title||t.attributes.iType,n=t.attributes.iDetail.initial,a=typeof n,r=$('<li style="margin:10px;">'+i+":"+n+"("+a+")</li>");e.append(r)}})},renderCondition:function(e,t){interaction_view.containment.find("#epub360-debug").append(e);for(var i={},n=0;n<interaction_view.events.conditionEvents.length;n++){var a=interaction_view.events.conditionEvents[n];if(a.page_id==t){var r=a.title;if(!i[r]){i[r]=1;var o=null!=a.result&&void 0!=a.result?a.result:"未执行",s=$('<li style="margin:10px 10px ;">'+r+":("+o+")</li>");e.append(s)}}}},renderQueue:function(){var e=$("<li><span>触发器当前残留队列</span><ul></ul></li>");if(interaction_view.containment.find("#epub360-debug").append(e),interaction_view.queue.current){var t=interaction_view.queue.current.debug,i="类别:"+t.category,n=$('<li style="margin:10px 10px ;">'+i+"</li>");e.append(n);var i="触发事件:"+t.iType,n=$('<li style="margin:10px 10px ;">'+i+"</li>");e.append(n);var i="触发执行:"+t.actionType,n=$('<li style="margin:10px 10px ;">'+i+"</li>");e.append(n);var i="页面:第"+(_.pluck(interaction_view.ipagelist.getPages(),"id").indexOf(t.page_id)+1)+"页("+t.page_id+")",n=$('<li style="margin:10px 10px ;">'+i+"</li>");e.append(n);var i="组件:"+t.overlay_id;interaction_view.ipagelist.getPage(t.page_id).iOverlaylist.get(t.overlay_id)&&(i="组件:"+interaction_view.ipagelist.getPage(t.page_id).iOverlaylist.get(t.overlay_id).attributes.iDetail.title||interaction_view.ipagelist.getPage(t.page_id).iOverlaylist.get(t.overlay_id).attributes.iType);var n=$('<li style="margin:10px 10px ;">'+i+"</li>");e.append(n)}},renderLog:function(e){var t=$("<li><span>日志Log输出</span><ul></ul></li>");if(interaction_view.containment.find("#epub360-debug").append(t),window.e_Debug)for(var i=0;i<e_Debug.length;i++){var n=$('<li style="margin:10px 10px ;">'+e_Debug[i]+"</li>");t.append(n)}},renderCustom:function(e){}}),define("interaction_view/components/debug/debug",function(){}),epub360.PlayerPlugins.push({config:{type:"Anchor",template:""},render:function(){console.log("元素已经完成在页面的展现"),interaction_view.DEBUG?this.$el.find(".el_wrap").first().append('<div class="div_qGhbyA">&diams;</div>'):this.$el.hide()},resetOtherStatus:function(){console.log("元素状态重置了")},immediateRender:function(){console.log("元素所在页面已经是当前页,元素开始在页面中马上就要开始播放")},setotherdisplay:function(){},onInitialize:function(){console.log("元素初始化")},onEpubReady:function(){console.log("Epub已经初始化完成")},onStop:function(e){console.log("元素在当前页停止播放"),e=e||interaction_view.currentPage;var t=interaction_view.events.scrollEvents.filter(function(t){return t.page_id==e});t.forEach(function(e){e.onceExecuted=!1})},onPlay:function(){},otherOnShow:function(){},otherOnHide:function(){},onAnchorTrigger:function(){function e(e,i,n,a){var r=n.baselineDirection;return"center"!=r?passed=t(e,i,r,n,a):passed=t(e,i,"x",n,a)||t(e,i,"y",n,a),passed}function t(e,t,n,a,r){var o=i(a,n,r),s=e[n]<o&&o<=t[n]||e[n]>o&&o>=t[n];return s}function i(e,t,i){var n="x"==t,a={left:0,top:0,right:i.width,bottom:i.height,center:"center"}[e.baseline];return a=void 0===a?"center":a,"center"==a&&(a=n?i.width/2:i.height/2),a+=e.baselineOffset,n?e.anchorPos.x-a:e.anchorPos.y-a}function n(t,i,n,a){var r=t.config;if(!r.noRepeat||!t.onceExecuted){var o={left:i.x<n.x,up:i.y<n.y,right:n.x<i.x,down:n.y<i.y};a=a||{},a={width:a.width||interaction_view.doc.get("width"),height:a.height||interaction_view.doc.get("height")},"any"!=r.triggerDirection&&1!=o[r.triggerDirection]||!e(i,n,r,a)||(t.onceExecuted=!0,t.func())}}return n}()}),define("interaction_view/components/anchor/anchor",function(){}),epub360.PlayerPlugins.push({config:{type:"ShareVariable",category:"global"},initialize:function(){var e=_g.getUrlParameterByName(this.model.id,message_link);e||0==e||(e=_g.getHashParameterByName(this.model.id)),e&&(0==this.model.attributes.iDetail.iKind&&(e=Number(e)),this.model.attributes.iDetail.initial=e)}}),define("interaction_view/components/ShareVariable/ShareVariable",function(){}),epub360.PlayerPlugins.push({config:{type:"DataBinder",Model:"Image",template:"Image"},immediateRender:function(){console.log("双向绑定渲染完成");var e=this,t=(e.$el,this.getdetail()),i=t.dataBinder,n=t.autoLoad;if(n){var a=interaction_view.expression;interaction_view.globallist.models;_.each(i,function(t){var i=t.expression_id,n=_g.uuid(2);DB.Cache.addSwitch(n),a.id2values(i,function(i){if(console.log("数据库的值为"+i),void 0!=i&&null!=i){if(t.id.indexOf("@g_")>0||0==t.id.indexOf("@g_")){var r=t.id.replace("@g_","").replace("@","");interaction_view.expression.setGlobal(r,i)}var o=a.getPagePath(t.id);if(null!=o)switch(o.type){case"p":case"c":if("c"==o.type)var s=configpage.page;else var s=interaction_view.ipagelist.getPage(o.page_id);if(!s)break;var l=s.iOverlaylist.get(o.element_id);if(null!=l)switch(l.attributes.iType){case"Input":l.iview.$el.find("input[type=text]").val(i);break;case"Textarea":l.iview.$el.find("textarea").val(i);break;case"Variable":l.iview.setVariable("0",i,null,null);break;case"Paragraph":l.iview.updateText(i);break;case"Image":case"ImageBlock":l.iview.replaceImg(i);break;case"Select":var c="<option value='-1'>不限</option><option value='0'>每人一次</option><option value='1'>每天一次</option><option value='2'>每天二次</option><option value='3'>每天三次</option>";l.iview.$el.find("select").empty(),l.iview.$el.find("select").append($(c)),l.iview.$el.find("select option[value="+i+"]").prop("selected",!0)}break;case"m":var l=interaction_view.imasterlist.models[0].iOverlaylist.get(o.element_id);if(null!=l)switch(l.attributes.iType){case"Input":l.iview.$el.find("input[type=text]").val(i);break;case"Textarea":l.iview.$el.find("textarea").val(i);break;case"Variable":l.iview.setVariable("0",i,null,null);break;case"Paragraph":l.iview.updateText(i);break;case"Image":case"ImageBlock":l.iview.replaceImg(i)}break;case"b":var l=interaction_view.ibackgroundlist.models[0].iOverlaylist.get(o.element_id);if(null!=l)switch(l.attributes.iType){case"Input":l.iview.$el.find("input[type=text]").val(i);break;case"Textarea":l.iview.$el.find("textarea").val(i);break;case"Variable":l.iview.setVariable("0",i,null,null);break;case"Paragraph":l.iview.updateText(i);break;case"Image":case"ImageBlock":l.iview.replaceImg(i)}break;case"h":e.updateHtmlPage(o,i)}}DB.Cache.closeSwitch(n)},{force_compute:!0})})}},resetOtherStatus:function(){console.log("元素状态重置了")},setotherdisplay:function(){},onInitialize:function(){console.log("元素初始化")},onEpubReady:function(){console.log("Epub已经初始化完成")},onStop:function(){console.log("元素在当前页停止播放")},onPlay:function(){},otherOnShow:function(){},otherOnHide:function(){},refresh:function(e){var t=this,i=t.getdetail().dataBinder,n=interaction_view.expression;_.each(i,function(i){var a=i.expression_id,r=_g.uuid(2);DB.Cache.addSwitch(r),n.id2values(a,function(a){if(a){if(i.id.indexOf("@g_")>0||0==i.id.indexOf("@g_")){var o=i.id.replace("@g_","").replace("@","");interaction_view.expression.setGlobal(o,a)}var s=n.getPagePath(i.id);if(null!=s){var l=null;switch(s.type){case"p":var c=interaction_view.ipagelist.getPage(s.page_id);l=c.iOverlaylist.get(s.element_id);break;case"m":l=interaction_view.imasterlist.models[0].iOverlaylist.get(s.element_id);break;case"b":l=interaction_view.ibackgroundlist.models[0].iOverlaylist.get(s.element_id);break;case"h":t.updateHtmlPage(s,a)}if(null!=l)switch(l.attributes.iType){case"Input":l.iview.$el.find("input[type=text]").val(a);break;case"Textarea":l.iview.$el.find("textarea").val(a);break;case"Variable":l.iview.setVariable("0",a,null,null);break;case"Paragraph":l.iview.updateText(a);break;case"Image":l.iview.replaceImg(a);break;case"Select":var d="<option value='-1'>不限</option><option value='0'>每人一次</option><option value='1'>每天一次</option><option value='2'>每天二次</option><option value='3'>每天三次</option>";l.iview.$el.find("select").empty(),l.iview.$el.find("select").append($(d)),l.iview.$el.find("select option[value="+a+"]").prop("selected",!0)}}}e.done(),DB.Cache.closeSwitch(r)},{force_compute:!0})})},updateHtmlPage:function(e,t){var i,n=interaction_view.ipagelist.getPage(e.page_id);i=n?n.iOverlaylist.get(e.element_id):interaction_view.imasterlist.models[0].iOverlaylist.get(e.element_id),i||(i=interaction_view.ibackgroundlist.models[0].iOverlaylist.get(e.element_id)),i&&i.iview.updateDom(e.dom_id,t)}}),define("interaction_view/components/DataBinder/DataBinder",function(){}),epub360.PlayerPlugins.push({config:{type:"StateGroup",template:"others"},render:function(){console.log(this.model.toJSON())},immediateRender:function(){console.log("元素开始在页面播放")},setOtherDisplay:function(){},onPlay:function(){this.model.toJSON().iDetail.currentState&&delete this.model.toJSON().iDetail.currentState,this.state=new window.stategroup(this.model),this.model.state=this.state,this.state.render()},otherOnShow:function(){console.log("element shown")},otherOnHide:function(){console.log("element hided")},onStop:function(){if(this.state&&(this.state.killOverlayTweenmax(this.getdetail().chooseElement),this.state&&this.state.ioverlaylist&&this.state.ioverlaylist.length))for(var e=0;e<this.state.ioverlaylist.length;e++){var t=this.state.ioverlaylist[e];!t.isMasterOverlay&&t.iview&&t.iview.$el&&interaction_view.setPos(t.iview.$el,{x:t.iview.x,y:t.iview.y})}}}),define("interaction_view/components/stategroup/stategroup",function(){}),epub360.PlayerPlugins.push({config:{type:"Map",template:"Map"},render:function(){}}),define("interaction_view/components/map/map",function(){}),epub360.PlayerPlugins.push({config:{type:"FormView",template:"FormView"},resetOtherStatus:function(){},onSizeAdaptChange:function(){this.$el.children(".Element").children("iframe").css({width:this.originWidth,height:this.originHeight})}}),define("interaction_view/components/formview/formview",function(){}),epub360.PlayerPlugins.push({config:{type:"Palette",template:"Container"},render:function(){this.model.paintStartEvents=[]},resetOtherStatus:function(){console.log("元素状态重置了")},immediateRender:function(){var e=this,t=this.getdetail(),i=this.getcommon();this.$el.children(".Element").css("cursor","pointer"),this.$el.children(".Element").addClass("disableDragX disableDragY"),this.$el.find(".el_wrap").html('<div class="palette_tmp"></div>'),this.$el.find(".el_wrap").children().css({width:i.iWidth,height:i.iHeight}),this.$el.find(".el_wrap").is(":hidden")||this.$el.find(".el_wrap").children().eraser({size:t.size,imageWidth:i.iWidth,imageHeight:i.iHeight,completeRatio:1,draw:!0,color:t.color,brush:t.brush,completeRatioFunction:function(){},completeFunction:function(){},onPaintStart:function(){for(var t=0;t<e.model.paintStartEvents.length;t++)e.model.paintStartEvents[t].func()}})},setotherdisplay:function(){},onStop:function(){console.log("元素在当前页停止播放")},otherOnShow:function(){this.immediateRender()},otherOnHide:function(){}}),define("interaction_view/components/palette/palette",function(){}),epub360.PlayerPlugins.push({config:{type:"LayerSlide",template:"LayerRef",Model:"LayerRef",model_object:{setiview:function(){this.iview=new interaction_view.view.LayerSlide({model:this})}},defaults:{iSlideNumber:!0}},render:function(e){var t=this,i=this.getdetail();this.currentSlideIndex=null,this.model.on("slideTo",function(e){if(console.log(e),null!=t.currentSlideIndex&&t.currentSlideIndex==e)return!1;if(null!=t.currentSlideIndex&&t.currentSlideIndex!=e){var n=i.layer_ids[t.currentSlideIndex];interaction_view.stopPlay(t.model.layer[n])}if(t.preloaded){var a=i.layer_ids[e];if(!t.model.layer[a])return;t.model.layer[a].isLayer=!0,interaction_view.play(t.model.layer[a]),t.currentSlideIndex=e,t.model.layer[a].playFinished=!0}}),this.model._reset=!0},playAnimation:function(){var e=this,t=this.getdetail();t.iSlidetype;this.delay=Number(t.iInterval)||2,this.autoplay=t.iAutoplay;var i=t.iRepeat?-1:0;return this.iFade=t.iFade||0,this.iRewind=t.iRewind,this.timeline=new TimelineMax({paused:!0,repeat:i,onComplete:this.setRewind}),this.slideel=e.$el.children(".Element").find(".layer-content").first(),this.slidelength=t.layer_ids.length,this.slidelength<2?!1:(this.repeat=i,this.slipable=t.iSlipable,this.setTimeline(),this.autoplay?!this.timeline||this.$el.children(".Element").is(":hidden")&&!interaction_view.ismobile||this.timeline.play(0):this.setSlideDisplay(0),void(this.slipable?(this.control(),this.$el.addClass("hascontrols")):this.slideel&&this.slideel.on("click",function(){e.$el.children(".Element").trigger("click")})))},playLayer:function(){this.autoplay&&this.timeline&&!this.$el.children(".Element").is(":hidden")&&this.timeline.play(0),this.slidelength>0&&this.model.trigger("slideTo",0)},setTimeline:function(){if("Fade"==this.iFade)this.setFade();else if("Slip"==this.iFade)this.setSlip();else{if("None"!=this.iFade)return;this.setNone()}this.slideel.children().first().css({opacity:1,left:0,top:0}).nextAll().css("opacity",0)},getSlipeInterval:function(e){},getLayerContentSize:function(){var e=this.getdetail(),t={};if(!e.layer_ids||e.layer_ids.length>0){var i=_.map(e.layer_ids,function(e){return interaction_view.ilayerlist.get(e).toJSON()});return t.width=_.max(_.pluck(i,"layer_width")),t.height=_.max(_.pluck(i,"layer_height")),t}return null},getStartPoint:function(e){return this.delay+(this.delay+.500002)*this.delay},getEndPoint:function(e){return(this.delay+.500002)*e+1e-5},getCurrentIndex:function(e){var t=this.timeline.duration(),i=t/this.slidelength;return parseInt(e/i,10)},testControl:function(e){var t=$(e).closest(".iView");if(t.hasClass("hasaction"))return!1;if(t){var i=t.attr("data-type");return"Slide"!=i&&"CycleImage"!=i||!t.attr("data-iSlipable")?!0:!1}return!0},resetOtherStatus:function(){this.resetlayer();var e=this,t=this.getdetail();t.layer_ids&&0!=t.layer_ids.length&&(this.slideel.children().first().css({opacity:1,left:0,top:0}),this.autoplay=t.iAutoplay,e.currentIndex=0,e.currentSlideIndex=null,this.hasSlideNumber&&(this.setSlideNumberPosition(),this.changeSlideNumber()),this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY"),this.timeline&&(this.timeline.pause(1e-5),!this.autoplay||this.$el.children(".Element").is(":hidden")&&!interaction_view.ismobile?this.setSlideDisplay(0):this.timeline.play(0)))},getSlideLength:function(){var e=this.getdetail();return e.layer_ids?e.layer_ids.length:0}}),define("interaction_view/components/layerslide/layerslide",function(){}),epub360.PlayerPlugins.push({config:{type:"ComponentRefRef",template:"LayerRef",Model:"LayerRef",model_object:{setiview:function(){var e=this.get("iCommon");this.offset=this.getOffset(e),e.landscape.iStartx=0,e.landscape.iStarty=0,e.landscape.iWidth=interaction_view.size.x,e.landscape.iHeight=interaction_view.size.y,this.iview=new interaction_view.view.ComponentRef({model:this})},setsyncmodel:function(){},filterlayers:function(){var e=this,t=this.get("iDetail"),i=t.layer_ids;this.components={},t.layer_ids&&t.layer_ids.length>0&&(i=_.filter(i,function(t){var i=interaction_view.iComponentlist.get(t);return i&&(e.components[t]=i),i})),t.layer_ids=i,this.set("iDetail",t)},getOffset:function(e){var t={x:0,y:0},i=this.get("iDetail");if(i.layer_ids&&i.layer_ids.length){var n=i.layer_ids[0],a=this.getComponentSize(n);t={x:e.landscape.iStartx-a.left,y:e.landscape.iStarty-a.top}}return t},getComponentSize:function(e,t){t||(t={w:200,h:200,left:null,top:null,bottom:null,right:null});var i=this.components[e];if(i){var n=i.overlays;_.each(n,function(e){null==t.left?(t.left=e.iCommon[iPageDirection].iStartx,t.top=e.iCommon[iPageDirection].iStarty,t.right=e.iCommon[iPageDirection].iStartx+e.iCommon[iPageDirection].iWidth,t.bottom=e.iCommon[iPageDirection].iStarty+e.iCommon[iPageDirection].iHeight):(t.left=t.left<e.iCommon[iPageDirection].iStartx?t.left:e.iCommon[iPageDirection].iStartx,t.top=t.top<e.iCommon[iPageDirection].iStarty?t.top:e.iCommon[iPageDirection].iStarty,t.right=t.right>e.iCommon[iPageDirection].iStartx+e.iCommon[iPageDirection].iWidth?t.right:e.iCommon[iPageDirection].iStartx+e.iCommon[iPageDirection].iWidth,t.bottom=t.bottom>e.iCommon[iPageDirection].iStarty+e.iCommon[iPageDirection].iHeight?t.bottom:e.iCommon[iPageDirection].iStarty+e.iCommon[iPageDirection].iHeight)})}return null!=t.left&&null!=t.top&&(t.w=t.right-t.left,t.h=t.bottom-t.top),t}}},events:{},render:function(e){this.$el.css({width:"100%",height:"100%"}),this.renderMask(),this.model._reset=!0},renderMask:function(){},preload:function(){var e=this.model.get("iDetail");e.layer_ids&&e.layer_ids.length>0&&this.sendToPreload({file:null})},loadLayer:function(e){var t=this.getdetail();this.layerCheckList=_.clone(t.layer_ids),this.firstlayer=t.layer_ids?t.layer_ids[0]:null,this.preloadmodel=e;var i=require("interaction_view/view/layer");i=_g.mvc.createView(i),this.layerview=new i({model:this.model}),this.layerview.afterload()},afterlayerload:function(e){if(console.log(e),this.preloadmodel){this.layerCheckList=_.reject(this.layerCheckList,function(t){return t==e}),this.model.layer[e].iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.layer[e].iActionlist.each(function(e){e.iview.render()});this.model.toJSON().iDetail.iHidden||!1;0==this.layerCheckList.length&&(this.$el.addClass("hide").css("opacity",""),this.slideel=this.$el.find(".layer-content").first(),this.slideel.children(".layer-item").first().show(),this.slidestyle=this.slideel.attr("style"),this.playAnimation(),this.firstlayer&&"ComponentRef"==this.model.get("iType")&&(this.model.layer[this.firstlayer].isLayer=!0),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))}},playLayer:function(){this.firstlayer&&interaction_view.play(this.model.layer[this.firstlayer])},playAnimation:function(){this.getdetail();this.$el.find(".layer-content").children().css("opacity",1)},onExecuteBindingForComponentRef:function(e){var t=this.getMoveRange();1!=e.type&&(e.cdirection||t.x>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(-e.deltarate*t.x,this.getCurrentPosition().top),e.cdirection&&t.y>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(this.getCurrentPosition().left,-e.deltarate*t.y))},getCurrentPosition:function(){if(this.$el.find(".layer-content").length>0){var e={left:0,top:0};return this.scrollview&&(e={left:this.scrollview.iScroll.x,top:this.scrollview.iScroll.y}),e}return{left:0,top:0}},getCurrentPositionRate:function(){var e=0,t=0,i=this.getMoveRange(),n=this.getCurrentPosition();return i.x&&(e=-n.left/i.x),i.y&&(t=-n.top/i.y),{left:e,top:t}},getLayerContentSize:function(){var e=this.getdetail(),t={};return!e.layer_ids||e.layer_ids.length>0?(t.width=interaction_view.size.x,t.height=interaction_view.size.y,t):null},resetlayer:function(){var e=this,t=this.getdetail();t.layer_ids&&t.layer_ids.length>0&&(_.each(t.layer_ids,function(t){e.model.layer[t].iAnimationlist.resetAnimationStatus(),e.model.layer[t].iOverlaylist.resetViewStatus()}),!this.model.bindingfixed&&this.slideel&&this.slideel.attr("style",this.slidestyle),e.currentIndex=0)},resetOtherStatus:function(){this.resetlayer()},onShow:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e?i.model.layer[n].iOverlaylist.each(function(e){e.iview.onShow()}):i.model.layer[n].iOverlaylist.each(function(e){e.iview.onShow()})})},onBeforeHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onBeforeHide(),_.include(["RichText","Region"],e.get("iType"))&&e.iview.resetOtherStatus()})})},onHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onHide()})})},onSizeAdaptChange:function(){}}),define("interaction_view/components/componentref/componentref",function(){}),epub360.PlayerPlugins.push({config:{type:"LayerRef",template:"LayerRef",model_object:{setiview:function(){this.iview=new interaction_view.view.LayerRef({model:this})},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(e){var t=this.get("iDetail"),i=this;i.layer={},this.filterlayers(),t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(e){i.layer[e]={},i.layer[e].iOverlaylist=new interaction_view.collection.list,i.layer[e].iAnimationlist=new interaction_view.collection.Animation,i.layer[e].iActionlist=new interaction_view.collection.Action,i.layer[e].ipreloadlist=new interaction_view.collection.Preload,i.layer[e].subcontainer=i.layer[e].ipreloadlist.subcontainer=i.layer[e].iOverlaylist.subcontainer=i.layer[e].iAnimationlist.subcontainer=i.layer[e].iActionlist.subcontainer=i.id,i.layer[e].ipreloadlist.path=i.layer[e].iOverlaylist.path=i.layer[e].iAnimationlist.path=i.layer[e].iActionlist.path=i.createPath(e),i.layer[e].ipreloadlist.pageid=i.layer[e].iOverlaylist.pageid=i.layer[e].iAnimationlist.pageid=i.layer[e].iActionlist.pageid=i.id,i.layer[e].ipreloadlist.pagetype=i.layer[e].iOverlaylist.pagetype=i.layer[e].iAnimationlist.pagetype=i.layer[e].iActionlist.pagetype="LayerRef",i.layer[e].ipreloadlist.parentpageid=i.layer[e].iOverlaylist.parentpageid=i.layer[e].iAnimationlist.parentpageid=i.layer[e].iActionlist.parentpageid=i.get("pageid"),i.layer[e].ipreloadlist.layerid=i.layer[e].iOverlaylist.layerid=i.layer[e].iAnimationlist.layerid=i.layer[e].iActionlist.layerid=e,i.layer[e].iAnimationlist.page=i.layer[e],i.layer[e].iAnimationlist.iPage_id=i.get("pageid")}),this.setiview()},createPath:function(e){var t=interaction_view.createPath({path:this.get("path"),isSubOverlay:this.get("isSubOverlay"),page_id:this.get("pageid"),model:this,layer_id:e});return t},setsyncmodel:function(){},filterlayers:function(){var e=this.get("iDetail"),t=e.layer_ids;e.layer_ids&&e.layer_ids.length>0&&(t=_.filter(t,function(e){return interaction_view.ilayerlist.get(e)})),e.layer_ids=t,this.set("iDetail",e)}}},events:{},render:function(e){this.renderMask(),this.model._reset=!0,this.last_y=0,this.last_x=0},renderMask:function(){var e=this.getdetail();e.layer_ids&&e.layer_ids.length>0&&(this.$el.children(".Element").children().children().css({translate:[e.x,e.y]}),this.scrollview&&(this.$el.children(".Element").children().removeClass("is_exceededX"),this.$el.children(".Element").children().removeClass("is_exceededY"),this.scrollview.iScroll.scrollTo(e.x,e.y),this.last_x=e.x,this.last_y=e.y))},preload:function(){var e=this.model.get("iDetail");e.layer_ids&&e.layer_ids.length>0&&this.sendToPreload({file:null})},loadLayer:function(e){var t=this.getdetail();this.layerCheckList=_.clone(t.layer_ids),this.firstlayer=t.layer_ids?t.layer_ids[0]:null,this.preloadmodel=e;var i=require("interaction_view/view/layer");i=_g.mvc.createView(i),this.layerview=new i({model:this.model}),this.layerview.afterload()},afterlayerload:function(e){if(console.log(e),this.preloadmodel){this.layerCheckList=_.reject(this.layerCheckList,function(t){return t==e}),this.model.layer[e].iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()});var t=this.model.page.id+this.model.id+e;this.clearRelatedActions(e),this.model.layer[e].iActionlist.each(function(e){e.attributes.iDetail.customType;e.iview&&(interaction_view.LayerActionLoaded[t]?e.iview.render({init:!0,replace:!0}):e.iview.render({init:!0}))}),interaction_view.LayerActionLoaded[t]=!0;this.model.toJSON().iDetail.iHidden||!1;0==this.layerCheckList.length&&(this.$el.addClass("hide").css("opacity",""),this.slideel=this.$el.find(".layer-content").first(),
this.slideel.children(".layer-item").first().show(),this.slidestyle=this.slideel.attr("style"),this.playAnimation(),this.firstlayer&&"LayerRef"==this.model.get("iType")&&(this.model.layer[this.firstlayer].isLayer=!0),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))}},playLayer:function(){this.firstlayer&&interaction_view.play(this.model.layer[this.firstlayer])},playAnimation:function(){var e=this;this.$el.find(".layer-content").children().css("opacity",1);var t=this.getcommon();t={width:t.iWidth,height:t.iHeight};var i=this.getLayerContentSize();if(i={width:i.width,height:i.height},t.width==i.width&&t.height==i.height)return!1;var n,a,r=this.getdetail(),o=r.layer_ids&&r.layer_ids[0]||"",s=interaction_view.events.scrollEvents.filter(function(e){return e.page_id==o}),l=this.$el.children(".Element").children(),c=l.children();this.setMaskSlipable({items:this.$el.find(".layer-content"),containment:l,contentel:c,content_x:r.x,content_y:r.y,mouseWheelSpeed:10,onScrollStart:function(t){n=e.getCurrentPosition(),n={x:-(n.left||0),y:-(n.top||0)}},onScrolling:function(e,i,r,o){e.data("has-anchor")&&(a={x:-(i.deltaX||0),y:-(i.deltaY||0)},s.forEach(function(e){e.overlaymodel.iview.onAnchorTrigger(e,n,a,t)}),n=a)},onScrollend:function(){}})},onExecuteBindingForLayerRef:function(e){var t=this.getMoveRange();1!=e.type&&(e.cdirection||t.x>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(-e.deltarate*t.x,this.getCurrentPosition().top),e.cdirection&&t.y>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(this.getCurrentPosition().left,-e.deltarate*t.y))},getCurrentPosition:function(){if(this.$el.find(".layer-content").length>0){var e={left:0,top:0};return this.scrollview&&(e={left:this.scrollview.iScroll.x,top:this.scrollview.iScroll.y}),e}return{left:0,top:0}},getCurrentPositionRate:function(){var e=0,t=0,i=this.getMoveRange(),n=this.getCurrentPosition();return i.x&&(e=-n.left/i.x),i.y&&(t=-n.top/i.y),{left:e,top:t}},getLayerContentSize:function(){var e=this.getdetail(),t={};if(!e.layer_ids||e.layer_ids.length>0){var i=_.map(e.layer_ids,function(e){return interaction_view.ilayerlist.get(e).toJSON()});return t.width=_.max(_.pluck(i,"layer_width")),t.height=_.max(_.pluck(i,"layer_height")),t}return null},stoplayer:function(){var e=this,t=this.getdetail();t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(t){var i=e.model.layer[t];i.iAnimationlist.timeline&&i.iAnimationlist.timeline.pause(0),i.iAnimationlist.css_timeline&&(i.iAnimationlist.css_timeline.stop(),e.cssStopPatch(i)),i.iOverlaylist.resetViewStatus(),i.iOverlaylist.models.forEach(function(e){e.iview.onStop&&e.iview.onStop(t)}),interaction_view.bezierPatch&&interaction_view.bezierPatch(i)})},cssStopPatch:function(e){$("#"+e.subcontainer).find(".child_Element").children().unwrap()},resetlayer:function(){var e=this,t=this.getdetail();t.layer_ids&&t.layer_ids.length>0&&(_.each(t.layer_ids,function(t){e.model.layer[t].iAnimationlist.resetAnimationStatus(),e.model.layer[t].iOverlaylist.resetViewStatus()}),!this.model.bindingfixed&&this.slideel&&this.slideel.attr("style",this.slidestyle),e.currentIndex=0)},resetOtherStatus:function(){this.resetlayer(),"LayerRef"==this.model.get("iType")&&this.renderMask()},onShow:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e?i.model.layer[n].iOverlaylist.each(function(e){e.iview.onShow()}):i.model.layer[n].iOverlaylist.each(function(e){e.iview.onShow()})})},onBeforeHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onBeforeHide(),_.include(["RichText","Region"],e.get("iType"))&&e.iview.resetOtherStatus()})})},onHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onHide()})})},onSizeAdaptChange:function(){this.$el.children(".Element").children(".layer-mask").css({width:this.originWidth,height:this.originHeight})},clearRelatedActions:function(e){var t=this;interaction_view.events.conditionEvents=_.reject(interaction_view.events.conditionEvents,function(i){return i.iPage_id==t.model.iPageId&&i.page_id==e&&i.layer_id==e})}}),define("interaction_view/components/layerref/layerref",function(){});var ProvinceJson={Province:[{c:"11",n:"北京市"},{c:"12",n:"天津市"},{c:"13",n:"河北省"},{c:"14",n:"山西省"},{c:"15",n:"内蒙古自治区"},{c:"21",n:"辽宁省"},{c:"22",n:"吉林省"},{c:"23",n:"黑龙江省"},{c:"31",n:"上海市"},{c:"32",n:"江苏省"},{c:"33",n:"浙江省"},{c:"34",n:"安徽省"},{c:"35",n:"福建省"},{c:"36",n:"江西省"},{c:"37",n:"山东省"},{c:"41",n:"河南省"},{c:"42",n:"湖北省"},{c:"43",n:"湖南省"},{c:"44",n:"广东省"},{c:"45",n:"广西壮族自治区"},{c:"46",n:"海南省"},{c:"50",n:"重庆市"},{c:"51",n:"四川省"},{c:"52",n:"贵州省"},{c:"53",n:"云南省"},{c:"54",n:"西藏自治区"},{c:"61",n:"陕西省"},{c:"62",n:"甘肃省"},{c:"63",n:"青海省"},{c:"64",n:"宁夏回族自治区"},{c:"65",n:"新疆维吾尔自治区"},{c:"71",n:"台湾省"},{c:"81",n:"香港特别行政区"},{c:"82",n:"澳门特别行政区"}],City:[{c:"1101",n:"北京市"},{c:"1201",n:"天津市"},{c:"3101",n:"上海市"},{c:"5001",n:"重庆市"},{c:"1301",n:"石家庄市"},{c:"1302",n:"唐山市"},{c:"1303",n:"秦皇岛市"},{c:"1304",n:"邯郸市"},{c:"1305",n:"邢台市"},{c:"1306",n:"保定市"},{c:"1307",n:"张家口市"},{c:"1308",n:"承德市"},{c:"1309",n:"沧州市"},{c:"1310",n:"廊坊市"},{c:"1311",n:"衡水市"},{c:"1401",n:"太原市"},{c:"1402",n:"大同市"},{c:"1403",n:"阳泉市"},{c:"1404",n:"长治市"},{c:"1405",n:"晋城市"},{c:"1406",n:"朔州市"},{c:"1407",n:"晋中市"},{c:"1408",n:"运城市"},{c:"1409",n:"忻州市"},{c:"1410",n:"临汾市"},{c:"1411",n:"吕梁市"},{c:"1501",n:"呼和浩特市"},{c:"1502",n:"包头市"},{c:"1503",n:"乌海市"},{c:"1504",n:"赤峰市"},{c:"1505",n:"通辽市"},{c:"1506",n:"鄂尔多斯市"},{c:"1507",n:"呼伦贝尔市"},{c:"1508",n:"巴彦淖尔市"},{c:"1509",n:"乌兰察布市"},{c:"1522",n:"兴安盟"},{c:"1525",n:"锡林郭勒盟"},{c:"1529",n:"阿拉善盟"},{c:"2101",n:"沈阳市"},{c:"2102",n:"大连市"},{c:"2103",n:"鞍山市"},{c:"2104",n:"抚顺市"},{c:"2105",n:"本溪市"},{c:"2106",n:"丹东市"},{c:"2107",n:"锦州市"},{c:"2108",n:"营口市"},{c:"2109",n:"阜新市"},{c:"2110",n:"辽阳市"},{c:"2111",n:"盘锦市"},{c:"2112",n:"铁岭市"},{c:"2113",n:"朝阳市"},{c:"2114",n:"葫芦岛市"},{c:"2201",n:"长春市"},{c:"2202",n:"吉林市"},{c:"2203",n:"四平市"},{c:"2204",n:"辽源市"},{c:"2205",n:"通化市"},{c:"2206",n:"白山市"},{c:"2207",n:"松原市"},{c:"2208",n:"白城市"},{c:"2224",n:"延边朝鲜族自治州"},{c:"2301",n:"哈尔滨市"},{c:"2302",n:"齐齐哈尔市"},{c:"2303",n:"鸡西市"},{c:"2304",n:"鹤岗市"},{c:"2305",n:"双鸭山市"},{c:"2306",n:"大庆市"},{c:"2307",n:"伊春市"},{c:"2308",n:"佳木斯市"},{c:"2309",n:"七台河市"},{c:"2310",n:"牡丹江市"},{c:"2311",n:"黑河市"},{c:"2312",n:"绥化市"},{c:"2327",n:"大兴安岭地区"},{c:"3201",n:"南京市"},{c:"3202",n:"无锡市"},{c:"3203",n:"徐州市"},{c:"3204",n:"常州市"},{c:"3205",n:"苏州市"},{c:"3206",n:"南通市"},{c:"3207",n:"连云港市"},{c:"3208",n:"淮安市"},{c:"3209",n:"盐城市"},{c:"3210",n:"扬州市"},{c:"3211",n:"镇江市"},{c:"3212",n:"泰州市"},{c:"3213",n:"宿迁市"},{c:"3301",n:"杭州市"},{c:"3302",n:"宁波市"},{c:"3303",n:"温州市"},{c:"3304",n:"嘉兴市"},{c:"3305",n:"湖州市"},{c:"3306",n:"绍兴市"},{c:"3307",n:"金华市"},{c:"3308",n:"衢州市"},{c:"3309",n:"舟山市"},{c:"3310",n:"台州市"},{c:"3311",n:"丽水市"},{c:"3401",n:"合肥市"},{c:"3402",n:"芜湖市"},{c:"3403",n:"蚌埠市"},{c:"3404",n:"淮南市"},{c:"3405",n:"马鞍山市"},{c:"3406",n:"淮北市"},{c:"3407",n:"铜陵市"},{c:"3408",n:"安庆市"},{c:"3410",n:"黄山市"},{c:"3411",n:"滁州市"},{c:"3412",n:"阜阳市"},{c:"3413",n:"宿州市"},{c:"3415",n:"六安市"},{c:"3416",n:"亳州市"},{c:"3417",n:"池州市"},{c:"3418",n:"宣城市"},{c:"3501",n:"福州市"},{c:"3502",n:"厦门市"},{c:"3503",n:"莆田市"},{c:"3504",n:"三明市"},{c:"3505",n:"泉州市"},{c:"3506",n:"漳州市"},{c:"3507",n:"南平市"},{c:"3508",n:"龙岩市"},{c:"3509",n:"宁德市"},{c:"3601",n:"南昌市"},{c:"3602",n:"景德镇市"},{c:"3603",n:"萍乡市"},{c:"3604",n:"九江市"},{c:"3605",n:"新余市"},{c:"3606",n:"鹰潭市"},{c:"3607",n:"赣州市"},{c:"3608",n:"吉安市"},{c:"3609",n:"宜春市"},{c:"3610",n:"抚州市"},{c:"3611",n:"上饶市"},{c:"3701",n:"济南市"},{c:"3702",n:"青岛市"},{c:"3703",n:"淄博市"},{c:"3704",n:"枣庄市"},{c:"3705",n:"东营市"},{c:"3706",n:"烟台市"},{c:"3707",n:"潍坊市"},{c:"3708",n:"济宁市"},{c:"3709",n:"泰安市"},{c:"3710",n:"威海市"},{c:"3711",n:"日照市"},{c:"3712",n:"莱芜市"},{c:"3713",n:"临沂市"},{c:"3714",n:"德州市"},{c:"3715",n:"聊城市"},{c:"3716",n:"滨州市"},{c:"3717",n:"菏泽市"},{c:"4101",n:"郑州市"},{c:"4102",n:"开封市"},{c:"4103",n:"洛阳市"},{c:"4104",n:"平顶山市"},{c:"4105",n:"安阳市"},{c:"4106",n:"鹤壁市"},{c:"4107",n:"新乡市"},{c:"4108",n:"焦作市"},{c:"4109",n:"濮阳市"},{c:"4110",n:"许昌市"},{c:"4111",n:"漯河市"},{c:"4112",n:"三门峡市"},{c:"4113",n:"南阳市"},{c:"4114",n:"商丘市"},{c:"4115",n:"信阳市"},{c:"4116",n:"周口市"},{c:"4117",n:"驻马店市"},{c:"4201",n:"武汉市"},{c:"4202",n:"黄石市"},{c:"4203",n:"十堰市"},{c:"4205",n:"宜昌市"},{c:"4206",n:"襄阳市"},{c:"4207",n:"鄂州市"},{c:"4208",n:"荆门市"},{c:"4209",n:"孝感市"},{c:"4210",n:"荆州市"},{c:"4211",n:"黄冈市"},{c:"4212",n:"咸宁市"},{c:"4213",n:"随州市"},{c:"4228",n:"恩施土家族苗族自治州"},{c:"4301",n:"长沙市"},{c:"4302",n:"株洲市"},{c:"4303",n:"湘潭市"},{c:"4304",n:"衡阳市"},{c:"4305",n:"邵阳市"},{c:"4306",n:"岳阳市"},{c:"4307",n:"常德市"},{c:"4308",n:"张家界市"},{c:"4309",n:"益阳市"},{c:"4310",n:"郴州市"},{c:"4311",n:"永州市"},{c:"4312",n:"怀化市"},{c:"4313",n:"娄底市"},{c:"4331",n:"湘西土家族苗族自治州"},{c:"4401",n:"广州市"},{c:"4402",n:"韶关市"},{c:"4403",n:"深圳市"},{c:"4404",n:"珠海市"},{c:"4405",n:"汕头市"},{c:"4406",n:"佛山市"},{c:"4407",n:"江门市"},{c:"4408",n:"湛江市"},{c:"4409",n:"茂名市"},{c:"4412",n:"肇庆市"},{c:"4413",n:"惠州市"},{c:"4414",n:"梅州市"},{c:"4415",n:"汕尾市"},{c:"4416",n:"河源市"},{c:"4417",n:"阳江市"},{c:"4418",n:"清远市"},{c:"4419",n:"东莞市"},{c:"4420",n:"中山市"},{c:"4451",n:"潮州市"},{c:"4452",n:"揭阳市"},{c:"4453",n:"云浮市"},{c:"4501",n:"南宁市"},{c:"4502",n:"柳州市"},{c:"4503",n:"桂林市"},{c:"4504",n:"梧州市"},{c:"4505",n:"北海市"},{c:"4506",n:"防城港市"},{c:"4507",n:"钦州市"},{c:"4508",n:"贵港市"},{c:"4509",n:"玉林市"},{c:"4510",n:"百色市"},{c:"4511",n:"贺州市"},{c:"4512",n:"河池市"},{c:"4513",n:"来宾市"},{c:"4514",n:"崇左市"},{c:"4601",n:"海口市"},{c:"4602",n:"三亚市"},{c:"4603",n:"三沙市"},{c:"4604",n:"儋州市"},{c:"5101",n:"成都市"},{c:"5103",n:"自贡市"},{c:"5104",n:"攀枝花市"},{c:"5105",n:"泸州市"},{c:"5106",n:"德阳市"},{c:"5107",n:"绵阳市"},{c:"5108",n:"广元市"},{c:"5109",n:"遂宁市"},{c:"5110",n:"内江市"},{c:"5111",n:"乐山市"},{c:"5113",n:"南充市"},{c:"5114",n:"眉山市"},{c:"5115",n:"宜宾市"},{c:"5116",n:"广安市"},{c:"5117",n:"达州市"},{c:"5118",n:"雅安市"},{c:"5119",n:"巴中市"},{c:"5120",n:"资阳市"},{c:"5132",n:"阿坝藏族羌族自治州"},{c:"5133",n:"甘孜藏族自治州"},{c:"5134",n:"凉山彝族自治州"},{c:"5201",n:"贵阳市"},{c:"5202",n:"六盘水市"},{c:"5203",n:"遵义市"},{c:"5204",n:"安顺市"},{c:"5205",n:"毕节市"},{c:"5206",n:"铜仁市"},{c:"5223",n:"黔西南布依族苗族自治州"},{c:"5226",n:"黔东南苗族侗族自治州"},{c:"5227",n:"黔南布依族苗族自治州"},{c:"5301",n:"昆明市"},{c:"5303",n:"曲靖市"},{c:"5304",n:"玉溪市"},{c:"5305",n:"保山市"},{c:"5306",n:"昭通市"},{c:"5307",n:"丽江市"},{c:"5308",n:"普洱市"},{c:"5309",n:"临沧市"},{c:"5323",n:"楚雄彝族自治州"},{c:"5325",n:"红河哈尼族彝族自治州"},{c:"5326",n:"文山壮族苗族自治州"},{c:"5328",n:"西双版纳傣族自治州"},{c:"5329",n:"大理白族自治州"},{c:"5331",n:"德宏傣族景颇族自治州"},{c:"5333",n:"怒江傈僳族自治州"},{c:"5334",n:"迪庆藏族自治州"},{c:"5401",n:"拉萨市"},{c:"5402",n:"日喀则市"},{c:"5403",n:"昌都市"},{c:"5404",n:"林芝市"},{c:"5405",n:"山南市"},{c:"5424",n:"那曲地区"},{c:"5425",n:"阿里地区"},{c:"6101",n:"西安市"},{c:"6102",n:"铜川市"},{c:"6103",n:"宝鸡市"},{c:"6104",n:"咸阳市"},{c:"6105",n:"渭南市"},{c:"6106",n:"延安市"},{c:"6107",n:"汉中市"},{c:"6108",n:"榆林市"},{c:"6109",n:"安康市"},{c:"6110",n:"商洛市"},{c:"6201",n:"兰州市"},{c:"6202",n:"嘉峪关市"},{c:"6203",n:"金昌市"},{c:"6204",n:"白银市"},{c:"6205",n:"天水市"},{c:"6206",n:"武威市"},{c:"6207",n:"张掖市"},{c:"6208",n:"平凉市"},{c:"6209",n:"酒泉市"},{c:"6210",n:"庆阳市"},{c:"6211",n:"定西市"},{c:"6212",n:"陇南市"},{c:"6229",n:"临夏回族自治州"},{c:"6230",n:"甘南藏族自治州"},{c:"6301",n:"西宁市"},{c:"6302",n:"海东市"},{c:"6322",n:"海北藏族自治州"},{c:"6323",n:"黄南藏族自治州"},{c:"6325",n:"海南藏族自治州"},{c:"6326",n:"果洛藏族自治州"},{c:"6327",n:"玉树藏族自治州"},{c:"6328",n:"海西蒙古族藏族自治州"},{c:"6401",n:"银川市"},{c:"6402",n:"石嘴山市"},{c:"6403",n:"吴忠市"},{c:"6404",n:"固原市"},{c:"6405",n:"中卫市"},{c:"6501",n:"乌鲁木齐市"},{c:"6502",n:"克拉玛依市"},{c:"6504",n:"吐鲁番市"},{c:"6505",n:"哈密市"},{c:"6523",n:"昌吉回族自治州"},{c:"6527",n:"博尔塔拉蒙古自治州"},{c:"6528",n:"巴音郭楞蒙古自治州"},{c:"6529",n:"阿克苏地区"},{c:"6530",n:"克孜勒苏柯尔克孜自治州"},{c:"6531",n:"喀什地区"},{c:"6532",n:"和田地区"},{c:"6540",n:"伊犁哈萨克自治州"},{c:"6542",n:"塔城地区"},{c:"6543",n:"阿勒泰地区"},{c:"7101",n:"台北市"},{c:"7102",n:"新北市"},{c:"7103",n:"桃园市"},{c:"7104",n:"台中市"},{c:"7105",n:"台南市"},{c:"7106",n:"高雄市"},{c:"7107",n:"基隆市"},{c:"7108",n:"新竹市"},{c:"7109",n:"嘉义市"}],Area:[{c:"110101",n:"东城区"},{c:"110102",n:"西城区"},{c:"110105",n:"朝阳区"},{c:"110106",n:"丰台区"},{c:"110107",n:"石景山区"},{c:"110108",n:"海淀区"},{c:"110109",n:"门头沟区"},{c:"110111",n:"房山区"},{c:"110112",n:"通州区"},{c:"110113",n:"顺义区"},{c:"110114",n:"昌平区"},{c:"110115",n:"大兴区"},{c:"110116",n:"怀柔区"},{c:"110117",n:"平谷区"},{c:"110118",n:"密云区"},{c:"110119",n:"延庆区"},{c:"120101",n:"和平区"},{c:"120102",n:"河东区"},{c:"120103",n:"河西区"},{c:"120104",n:"南开区"},{c:"120105",n:"河北区"},{c:"120106",n:"红桥区"},{c:"120110",n:"东丽区"},{c:"120111",n:"西青区"},{c:"120112",n:"津南区"},{c:"120113",n:"北辰区"},{c:"120114",n:"武清区"},{c:"120115",n:"宝坻区"},{c:"120116",n:"滨海新区"},{c:"120117",n:"宁河区"},{c:"120118",n:"静海区"},{c:"120119",n:"蓟州区"},{c:"130102",n:"长安区"},{c:"130104",n:"桥西区"},{c:"130105",n:"新华区"},{c:"130107",n:"井陉矿区"},{c:"130108",n:"裕华区"},{c:"130109",n:"藁城区"},{c:"130110",n:"鹿泉区"},{c:"130111",n:"栾城区"},{c:"130121",n:"井陉县"},{c:"130123",n:"正定县"},{c:"130125",n:"行唐县"},{c:"130126",n:"灵寿县"},{c:"130127",n:"高邑县"},{c:"130128",n:"深泽县"},{c:"130129",n:"赞皇县"},{c:"130130",n:"无极县"},{c:"130131",n:"平山县"},{c:"130132",n:"元氏县"},{c:"130133",n:"赵县"},{c:"130181",n:"辛集市"},{c:"130183",n:"晋州市"},{c:"130184",n:"新乐市"},{c:"130202",n:"路南区"},{c:"130203",n:"路北区"},{c:"130204",n:"古冶区"},{c:"130205",n:"开平区"},{c:"130207",n:"丰南区"},{c:"130208",n:"丰润区"},{c:"130209",n:"曹妃甸区"},{c:"130223",n:"滦县"},{c:"130224",n:"滦南县"},{c:"130225",n:"乐亭县"},{c:"130227",n:"迁西县"},{c:"130229",n:"玉田县"},{c:"130281",n:"遵化市"},{c:"130283",n:"迁安市"},{c:"130302",n:"海港区"},{c:"130303",n:"山海关区"},{c:"130304",n:"北戴河区"},{c:"130306",n:"抚宁区"},{c:"130321",n:"青龙满族自治县"},{c:"130322",n:"昌黎县"},{c:"130324",n:"卢龙县"},{c:"130402",n:"邯山区"},{c:"130403",n:"丛台区"},{c:"130404",n:"复兴区"},{c:"130406",n:"峰峰矿区"},{c:"130407",n:"肥乡区"},{c:"130408",n:"永年区"},{c:"130423",n:"临漳县"},{c:"130424",n:"成安县"},{c:"130425",n:"大名县"},{c:"130426",n:"涉县"},{c:"130427",n:"磁县"},{c:"130430",n:"邱县"},{c:"130431",n:"鸡泽县"},{c:"130432",n:"广平县"},{c:"130433",n:"馆陶县"},{c:"130434",n:"魏县"},{c:"130435",n:"曲周县"},{c:"130481",n:"武安市"},{c:"130502",n:"桥东区"},{c:"130503",n:"桥西区"},{c:"130521",n:"邢台县"},{c:"130522",n:"临城县"},{c:"130523",n:"内丘县"},{c:"130524",n:"柏乡县"},{c:"130525",n:"隆尧县"},{c:"130526",n:"任县"},{c:"130527",n:"南和县"},{c:"130528",n:"宁晋县"},{c:"130529",n:"巨鹿县"},{c:"130530",n:"新河县"},{c:"130531",n:"广宗县"},{c:"130532",n:"平乡县"},{c:"130533",n:"威县"},{c:"130534",n:"清河县"},{c:"130535",n:"临西县"},{c:"130581",n:"南宫市"},{c:"130582",n:"沙河市"},{c:"130602",n:"竞秀区"},{c:"130606",n:"莲池区"},{c:"130607",n:"满城区"},{c:"130608",n:"清苑区"},{c:"130609",n:"徐水区"},{c:"130623",n:"涞水县"},{c:"130624",n:"阜平县"},{c:"130626",n:"定兴县"},{c:"130627",n:"唐县"},{c:"130628",n:"高阳县"},{c:"130629",n:"容城县"},{c:"130630",n:"涞源县"},{c:"130631",n:"望都县"},{c:"130632",n:"安新县"},{c:"130633",n:"易县"},{c:"130634",n:"曲阳县"},{c:"130635",n:"蠡县"},{c:"130636",n:"顺平县"},{c:"130637",n:"博野县"},{c:"130638",n:"雄县"},{c:"130681",n:"涿州市"},{c:"130682",n:"定州市"},{c:"130683",n:"安国市"},{c:"130684",n:"高碑店市"},{c:"130702",n:"桥东区"},{c:"130703",n:"桥西区"},{c:"130705",n:"宣化区"},{c:"130706",n:"下花园区"},{c:"130708",n:"万全区"},{c:"130709",n:"崇礼区"},{c:"130722",n:"张北县"},{c:"130723",n:"康保县"},{c:"130724",n:"沽源县"},{c:"130725",n:"尚义县"},{c:"130726",n:"蔚县"},{c:"130727",n:"阳原县"},{c:"130728",n:"怀安县"},{c:"130730",n:"怀来县"},{c:"130731",n:"涿鹿县"},{c:"130732",n:"赤城县"},{c:"130802",n:"双桥区"},{c:"130803",n:"双滦区"},{c:"130804",n:"鹰手营子矿区"},{c:"130821",n:"承德县"},{c:"130822",n:"兴隆县"},{c:"130824",n:"滦平县"},{c:"130825",n:"隆化县"},{c:"130826",n:"丰宁满族自治县"},{c:"130827",n:"宽城满族自治县"},{c:"130828",n:"围场满族蒙古族自治县"},{c:"130881",n:"平泉市"},{c:"130902",n:"新华区"},{c:"130903",n:"运河区"},{c:"130921",n:"沧县"},{c:"130922",n:"青县"},{c:"130923",n:"东光县"},{c:"130924",n:"海兴县"},{c:"130925",n:"盐山县"},{c:"130926",n:"肃宁县"},{c:"130927",n:"南皮县"},{c:"130928",n:"吴桥县"},{c:"130929",n:"献县"},{c:"130930",n:"孟村回族自治县"},{c:"130981",n:"泊头市"},{c:"130982",n:"任丘市"},{c:"130983",n:"黄骅市"},{c:"130984",n:"河间市"},{c:"131002",n:"安次区"},{c:"131003",n:"广阳区"},{c:"131022",n:"固安县"},{c:"131023",n:"永清县"},{c:"131024",n:"香河县"},{c:"131025",n:"大城县"},{c:"131026",n:"文安县"},{c:"131028",n:"大厂回族自治县"},{c:"131081",n:"霸州市"},{c:"131082",n:"三河市"},{c:"131102",n:"桃城区"},{c:"131103",n:"冀州区"},{c:"131121",n:"枣强县"},{c:"131122",n:"武邑县"},{c:"131123",n:"武强县"},{c:"131124",n:"饶阳县"},{c:"131125",n:"安平县"},{c:"131126",n:"故城县"},{c:"131127",n:"景县"},{c:"131128",n:"阜城县"},{c:"131182",n:"深州市"},{c:"140105",n:"小店区"},{c:"140106",n:"迎泽区"},{c:"140107",n:"杏花岭区"},{c:"140108",n:"尖草坪区"},{c:"140109",n:"万柏林区"},{c:"140110",n:"晋源区"},{c:"140121",n:"清徐县"},{c:"140122",n:"阳曲县"},{c:"140123",n:"娄烦县"},{c:"140181",n:"古交市"},{c:"140202",n:"城区"},{c:"140203",n:"矿区"},{c:"140211",n:"南郊区"},{c:"140212",n:"新荣区"},{c:"140221",n:"阳高县"},{c:"140222",n:"天镇县"},{c:"140223",n:"广灵县"},{c:"140224",n:"灵丘县"},{c:"140225",n:"浑源县"},{c:"140226",n:"左云县"},{c:"140227",n:"大同县"},{c:"140302",n:"城区"},{c:"140303",n:"矿区"},{c:"140311",n:"郊区"},{c:"140321",n:"平定县"},{c:"140322",n:"盂县"},{c:"140402",n:"城区"},{c:"140411",n:"郊区"},{c:"140421",n:"长治县"},{c:"140423",n:"襄垣县"},{c:"140424",n:"屯留县"},{c:"140425",n:"平顺县"},{c:"140426",n:"黎城县"},{c:"140427",n:"壶关县"},{c:"140428",n:"长子县"},{c:"140429",n:"武乡县"},{c:"140430",n:"沁县"},{c:"140431",n:"沁源县"},{c:"140481",n:"潞城市"},{c:"140502",n:"城区"},{c:"140521",n:"沁水县"},{c:"140522",n:"阳城县"},{c:"140524",n:"陵川县"},{c:"140525",n:"泽州县"},{c:"140581",n:"高平市"},{c:"140602",n:"朔城区"},{c:"140603",n:"平鲁区"},{c:"140621",n:"山阴县"},{c:"140622",n:"应县"},{c:"140623",n:"右玉县"},{c:"140624",n:"怀仁县"},{c:"140702",n:"榆次区"},{c:"140721",n:"榆社县"},{c:"140722",n:"左权县"},{c:"140723",n:"和顺县"},{c:"140724",n:"昔阳县"},{c:"140725",n:"寿阳县"},{c:"140726",n:"太谷县"},{c:"140727",n:"祁县"},{c:"140728",n:"平遥县"},{c:"140729",n:"灵石县"},{c:"140781",n:"介休市"},{c:"140802",n:"盐湖区"},{c:"140821",n:"临猗县"},{c:"140822",n:"万荣县"},{c:"140823",n:"闻喜县"},{c:"140824",n:"稷山县"},{c:"140825",n:"新绛县"},{c:"140826",n:"绛县"},{c:"140827",n:"垣曲县"},{c:"140828",n:"夏县"},{c:"140829",n:"平陆县"},{c:"140830",n:"芮城县"},{c:"140881",n:"永济市"},{c:"140882",n:"河津市"},{c:"140902",n:"忻府区"},{c:"140921",n:"定襄县"},{c:"140922",n:"五台县"},{c:"140923",n:"代县"},{c:"140924",n:"繁峙县"},{c:"140925",n:"宁武县"},{c:"140926",n:"静乐县"},{c:"140927",n:"神池县"},{c:"140928",n:"五寨县"},{c:"140929",n:"岢岚县"},{c:"140930",n:"河曲县"},{c:"140931",n:"保德县"},{c:"140932",n:"偏关县"},{c:"140981",n:"原平市"},{c:"141002",n:"尧都区"},{c:"141021",n:"曲沃县"},{c:"141022",n:"翼城县"},{c:"141023",n:"襄汾县"},{c:"141024",n:"洪洞县"},{c:"141025",n:"古县"},{c:"141026",n:"安泽县"},{c:"141027",n:"浮山县"},{c:"141028",n:"吉县"},{c:"141029",n:"乡宁县"},{c:"141030",n:"大宁县"},{c:"141031",n:"隰县"},{c:"141032",n:"永和县"},{c:"141033",n:"蒲县"},{c:"141034",n:"汾西县"},{c:"141081",n:"侯马市"},{c:"141082",n:"霍州市"},{c:"141102",n:"离石区"},{c:"141121",n:"文水县"},{c:"141122",n:"交城县"},{c:"141123",n:"兴县"},{c:"141124",n:"临县"},{c:"141125",n:"柳林县"},{c:"141126",n:"石楼县"},{c:"141127",n:"岚县"},{c:"141128",n:"方山县"},{c:"141129",n:"中阳县"},{c:"141130",n:"交口县"},{c:"141181",n:"孝义市"},{c:"141182",n:"汾阳市"},{c:"150102",n:"新城区"},{c:"150103",n:"回民区"},{c:"150104",n:"玉泉区"},{c:"150105",n:"赛罕区"},{c:"150121",n:"土默特左旗"},{c:"150122",n:"托克托县"},{c:"150123",n:"和林格尔县"},{c:"150124",n:"清水河县"},{c:"150125",n:"武川县"},{c:"150202",n:"东河区"},{c:"150203",n:"昆都仑区"},{c:"150204",n:"青山区"},{c:"150205",n:"石拐区"},{c:"150206",n:"白云鄂博矿区"},{c:"150207",n:"九原区"},{c:"150221",n:"土默特右旗"},{c:"150222",n:"固阳县"},{c:"150223",n:"达尔罕茂明安联合旗"},{c:"150302",n:"海勃湾区"},{c:"150303",n:"海南区"},{c:"150304",n:"乌达区"},{c:"150402",n:"红山区"},{c:"150403",n:"元宝山区"},{c:"150404",n:"松山区"},{c:"150421",n:"阿鲁科尔沁旗"},{c:"150422",n:"巴林左旗"},{c:"150423",n:"巴林右旗"},{c:"150424",n:"林西县"},{c:"150425",n:"克什克腾旗"},{c:"150426",n:"翁牛特旗"},{c:"150428",n:"喀喇沁旗"},{c:"150429",n:"宁城县"},{c:"150430",n:"敖汉旗"},{c:"150502",n:"科尔沁区"},{c:"150521",n:"科尔沁左翼中旗"},{c:"150522",n:"科尔沁左翼后旗"},{c:"150523",n:"开鲁县"},{c:"150524",n:"库伦旗"},{c:"150525",n:"奈曼旗"},{c:"150526",n:"扎鲁特旗"},{c:"150581",n:"霍林郭勒市"},{c:"150602",n:"东胜区"},{c:"150603",n:"康巴什区"},{c:"150621",n:"达拉特旗"},{c:"150622",n:"准格尔旗"},{c:"150623",n:"鄂托克前旗"},{c:"150624",n:"鄂托克旗"},{c:"150625",n:"杭锦旗"},{c:"150626",n:"乌审旗"},{c:"150627",n:"伊金霍洛旗"},{c:"150702",n:"海拉尔区"},{c:"150703",n:"扎赉诺尔区"},{c:"150721",n:"阿荣旗"},{c:"150722",n:"莫力达瓦达斡尔族自治旗"},{c:"150723",n:"鄂伦春自治旗"},{c:"150724",n:"鄂温克族自治旗"},{c:"150725",n:"陈巴尔虎旗"},{c:"150726",n:"新巴尔虎左旗"},{c:"150727",n:"新巴尔虎右旗"},{c:"150781",n:"满洲里市"},{c:"150782",n:"牙克石市"},{c:"150783",n:"扎兰屯市"},{c:"150784",n:"额尔古纳市"},{c:"150785",n:"根河市"},{c:"150802",n:"临河区"},{c:"150821",n:"五原县"},{c:"150822",n:"磴口县"},{c:"150823",n:"乌拉特前旗"},{c:"150824",n:"乌拉特中旗"},{c:"150825",n:"乌拉特后旗"},{c:"150826",n:"杭锦后旗"},{c:"150902",n:"集宁区"},{c:"150921",n:"卓资县"},{c:"150922",n:"化德县"},{c:"150923",n:"商都县"},{c:"150924",n:"兴和县"},{c:"150925",n:"凉城县"},{c:"150926",n:"察哈尔右翼前旗"},{c:"150927",n:"察哈尔右翼中旗"},{c:"150928",n:"察哈尔右翼后旗"},{c:"150929",n:"四子王旗"},{c:"150981",n:"丰镇市"},{c:"152201",n:"乌兰浩特市"},{c:"152202",n:"阿尔山市"},{c:"152221",n:"科尔沁右翼前旗"},{c:"152222",n:"科尔沁右翼中旗"},{c:"152223",n:"扎赉特旗"},{c:"152224",n:"突泉县"},{c:"152501",n:"二连浩特市"},{c:"152502",n:"锡林浩特市"},{c:"152522",n:"阿巴嘎旗"},{c:"152523",n:"苏尼特左旗"},{c:"152524",n:"苏尼特右旗"},{c:"152525",n:"东乌珠穆沁旗"},{c:"152526",n:"西乌珠穆沁旗"},{c:"152527",n:"太仆寺旗"},{c:"152528",n:"镶黄旗"},{c:"152529",n:"正镶白旗"},{c:"152530",n:"正蓝旗"},{c:"152531",n:"多伦县"},{c:"152921",n:"阿拉善左旗"},{c:"152922",n:"阿拉善右旗"},{c:"152923",n:"额济纳旗"},{c:"210102",n:"和平区"},{c:"210103",n:"沈河区"},{c:"210104",n:"大东区"},{c:"210105",n:"皇姑区"},{c:"210106",n:"铁西区"},{c:"210111",n:"苏家屯区"},{c:"210112",n:"浑南区"},{c:"210113",n:"沈北新区"},{c:"210114",n:"于洪区"},{c:"210115",n:"辽中区"},{c:"210123",n:"康平县"},{c:"210124",n:"法库县"},{c:"210181",n:"新民市"},{c:"210202",n:"中山区"},{c:"210203",n:"西岗区"},{c:"210204",n:"沙河口区"},{c:"210211",n:"甘井子区"},{c:"210212",n:"旅顺口区"},{c:"210213",n:"金州区"},{c:"210214",n:"普兰店区"},{c:"210224",n:"长海县"},{c:"210281",n:"瓦房店市"},{c:"210283",n:"庄河市"},{c:"210302",n:"铁东区"},{c:"210303",n:"铁西区"},{c:"210304",n:"立山区"},{c:"210311",n:"千山区"},{c:"210321",n:"台安县"},{c:"210323",n:"岫岩满族自治县"},{c:"210381",n:"海城市"},{c:"210402",n:"新抚区"},{c:"210403",n:"东洲区"},{c:"210404",n:"望花区"},{c:"210411",n:"顺城区"},{c:"210421",n:"抚顺县"},{c:"210422",n:"新宾满族自治县"},{c:"210423",n:"清原满族自治县"},{c:"210502",n:"平山区"},{c:"210503",n:"溪湖区"},{c:"210504",n:"明山区"},{c:"210505",n:"南芬区"},{c:"210521",n:"本溪满族自治县"},{c:"210522",n:"桓仁满族自治县"},{c:"210602",n:"元宝区"},{c:"210603",n:"振兴区"},{c:"210604",n:"振安区"},{c:"210624",n:"宽甸满族自治县"},{c:"210681",n:"东港市"},{c:"210682",n:"凤城市"},{c:"210702",n:"古塔区"},{c:"210703",n:"凌河区"},{c:"210711",n:"太和区"},{c:"210726",n:"黑山县"},{c:"210727",n:"义县"},{c:"210781",n:"凌海市"},{c:"210782",n:"北镇市"},{c:"210802",n:"站前区"},{c:"210803",n:"西市区"},{c:"210804",n:"鲅鱼圈区"},{c:"210811",n:"老边区"},{c:"210881",n:"盖州市"},{c:"210882",n:"大石桥市"},{c:"210902",n:"海州区"},{c:"210903",n:"新邱区"},{c:"210904",n:"太平区"},{c:"210905",n:"清河门区"},{c:"210911",n:"细河区"},{c:"210921",n:"阜新蒙古族自治县"},{c:"210922",n:"彰武县"},{c:"211002",n:"白塔区"},{c:"211003",n:"文圣区"},{c:"211004",n:"宏伟区"},{c:"211005",n:"弓长岭区"},{c:"211011",n:"太子河区"},{c:"211021",n:"辽阳县"},{c:"211081",n:"灯塔市"},{c:"211102",n:"双台子区"},{c:"211103",n:"兴隆台区"},{c:"211104",n:"大洼区"},{c:"211122",n:"盘山县"},{c:"211202",n:"银州区"},{c:"211204",n:"清河区"},{c:"211221",n:"铁岭县"},{c:"211223",n:"西丰县"},{c:"211224",n:"昌图县"},{c:"211281",n:"调兵山市"},{c:"211282",n:"开原市"},{c:"211302",n:"双塔区"},{c:"211303",n:"龙城区"},{c:"211321",n:"朝阳县"},{c:"211322",n:"建平县"},{c:"211324",n:"喀喇沁左翼蒙古族自治县"},{c:"211381",n:"北票市"},{c:"211382",n:"凌源市"},{c:"211402",n:"连山区"},{c:"211403",n:"龙港区"},{c:"211404",n:"南票区"},{c:"211421",n:"绥中县"},{c:"211422",n:"建昌县"},{c:"211481",n:"兴城市"},{c:"220102",n:"南关区"},{c:"220103",n:"宽城区"},{c:"220104",n:"朝阳区"},{c:"220105",n:"二道区"},{c:"220106",n:"绿园区"},{c:"220112",n:"双阳区"},{c:"220113",n:"九台区"},{c:"220122",n:"农安县"},{c:"220182",n:"榆树市"},{c:"220183",n:"德惠市"},{c:"220202",n:"昌邑区"},{c:"220203",n:"龙潭区"},{c:"220204",n:"船营区"},{c:"220211",n:"丰满区"},{c:"220221",n:"永吉县"},{c:"220281",n:"蛟河市"},{c:"220282",n:"桦甸市"},{c:"220283",n:"舒兰市"},{c:"220284",n:"磐石市"},{c:"220302",n:"铁西区"},{c:"220303",n:"铁东区"},{c:"220322",n:"梨树县"},{c:"220323",n:"伊通满族自治县"},{c:"220381",n:"公主岭市"},{c:"220382",n:"双辽市"},{c:"220402",n:"龙山区"},{c:"220403",n:"西安区"},{c:"220421",n:"东丰县"},{c:"220422",n:"东辽县"},{c:"220502",n:"东昌区"},{c:"220503",n:"二道江区"},{c:"220521",n:"通化县"},{c:"220523",n:"辉南县"},{c:"220524",n:"柳河县"},{c:"220581",n:"梅河口市"},{c:"220582",n:"集安市"},{c:"220602",n:"浑江区"},{c:"220605",n:"江源区"},{c:"220621",n:"抚松县"},{c:"220622",n:"靖宇县"},{c:"220623",n:"长白朝鲜族自治县"},{c:"220681",n:"临江市"},{c:"220702",n:"宁江区"},{c:"220721",n:"前郭尔罗斯蒙古族自治县"},{c:"220722",n:"长岭县"},{c:"220723",n:"乾安县"},{c:"220781",n:"扶余市"},{c:"220802",n:"洮北区"},{c:"220821",n:"镇赉县"},{c:"220822",n:"通榆县"},{c:"220881",n:"洮南市"},{c:"220882",n:"大安市"},{c:"222401",n:"延吉市"},{c:"222402",n:"图们市"},{c:"222403",n:"敦化市"},{c:"222404",n:"珲春市"},{c:"222405",n:"龙井市"},{c:"222406",n:"和龙市"},{c:"222424",n:"汪清县"},{c:"222426",n:"安图县"},{c:"230102",n:"道里区"},{c:"230103",n:"南岗区"},{c:"230104",n:"道外区"},{c:"230108",n:"平房区"},{c:"230109",n:"松北区"},{c:"230110",n:"香坊区"},{c:"230111",n:"呼兰区"},{c:"230112",n:"阿城区"},{c:"230113",n:"双城区"},{c:"230123",n:"依兰县"},{c:"230124",n:"方正县"},{c:"230125",n:"宾县"},{c:"230126",n:"巴彦县"},{c:"230127",n:"木兰县"},{c:"230128",n:"通河县"},{c:"230129",n:"延寿县"},{c:"230183",n:"尚志市"},{c:"230184",n:"五常市"},{c:"230202",n:"龙沙区"},{c:"230203",n:"建华区"},{c:"230204",n:"铁锋区"},{c:"230205",n:"昂昂溪区"},{c:"230206",n:"富拉尔基区"},{c:"230207",n:"碾子山区"},{c:"230208",n:"梅里斯达斡尔族区"},{c:"230221",n:"龙江县"},{c:"230223",n:"依安县"},{c:"230224",n:"泰来县"},{c:"230225",n:"甘南县"},{c:"230227",n:"富裕县"},{c:"230229",n:"克山县"},{c:"230230",n:"克东县"},{c:"230231",n:"拜泉县"},{c:"230281",n:"讷河市"},{c:"230302",n:"鸡冠区"},{c:"230303",n:"恒山区"},{c:"230304",n:"滴道区"},{c:"230305",n:"梨树区"},{c:"230306",n:"城子河区"},{c:"230307",n:"麻山区"},{c:"230321",n:"鸡东县"},{c:"230381",n:"虎林市"},{c:"230382",n:"密山市"},{c:"230402",n:"向阳区"},{c:"230403",n:"工农区"},{c:"230404",n:"南山区"},{c:"230405",n:"兴安区"},{c:"230406",n:"东山区"},{c:"230407",n:"兴山区"},{c:"230421",n:"萝北县"},{c:"230422",n:"绥滨县"},{c:"230502",n:"尖山区"},{c:"230503",n:"岭东区"},{c:"230505",n:"四方台区"},{c:"230506",n:"宝山区"},{c:"230521",n:"集贤县"},{c:"230522",n:"友谊县"},{c:"230523",n:"宝清县"},{c:"230524",n:"饶河县"},{c:"230602",n:"萨尔图区"},{c:"230603",n:"龙凤区"},{c:"230604",n:"让胡路区"},{c:"230605",n:"红岗区"},{c:"230606",n:"大同区"},{c:"230621",n:"肇州县"},{c:"230622",n:"肇源县"},{c:"230623",n:"林甸县"},{c:"230624",n:"杜尔伯特蒙古族自治县"},{c:"230702",n:"伊春区"},{c:"230703",n:"南岔区"},{c:"230704",n:"友好区"},{c:"230705",n:"西林区"},{c:"230706",n:"翠峦区"},{c:"230707",n:"新青区"},{c:"230708",n:"美溪区"},{c:"230709",n:"金山屯区"},{c:"230710",n:"五营区"},{c:"230711",n:"乌马河区"},{c:"230712",n:"汤旺河区"},{c:"230713",n:"带岭区"},{c:"230714",n:"乌伊岭区"},{c:"230715",n:"红星区"},{c:"230716",n:"上甘岭区"},{c:"230722",n:"嘉荫县"},{c:"230781",n:"铁力市"},{c:"230803",n:"向阳区"},{c:"230804",n:"前进区"},{c:"230805",n:"东风区"},{c:"230811",n:"郊区"},{c:"230822",n:"桦南县"},{c:"230826",n:"桦川县"},{c:"230828",n:"汤原县"},{c:"230881",n:"同江市"},{c:"230882",n:"富锦市"},{c:"230883",n:"抚远市"},{c:"230902",n:"新兴区"},{c:"230903",n:"桃山区"},{c:"230904",n:"茄子河区"},{c:"230921",n:"勃利县"},{c:"231002",n:"东安区"},{c:"231003",n:"阳明区"},{c:"231004",n:"爱民区"},{c:"231005",n:"西安区"},{c:"231025",n:"林口县"},{c:"231081",n:"绥芬河市"},{c:"231083",n:"海林市"},{c:"231084",n:"宁安市"},{c:"231085",n:"穆棱市"},{c:"231086",n:"东宁市"},{c:"231102",n:"爱辉区"},{c:"231121",n:"嫩江县"},{c:"231123",n:"逊克县"},{c:"231124",n:"孙吴县"},{c:"231181",n:"北安市"},{c:"231182",n:"五大连池市"},{c:"231202",n:"北林区"},{c:"231221",n:"望奎县"},{c:"231222",n:"兰西县"},{c:"231223",n:"青冈县"},{c:"231224",n:"庆安县"},{c:"231225",n:"明水县"},{c:"231226",n:"绥棱县"},{c:"231281",n:"安达市"},{c:"231282",n:"肇东市"},{c:"231283",n:"海伦市"},{c:"232721",n:"呼玛县"},{c:"232722",n:"塔河县"},{c:"232723",n:"漠河县"},{c:"310101",n:"黄浦区"},{c:"310104",n:"徐汇区"},{c:"310105",n:"长宁区"},{c:"310106",n:"静安区"},{c:"310107",n:"普陀区"},{c:"310109",n:"虹口区"},{c:"310110",n:"杨浦区"},{c:"310112",n:"闵行区"},{c:"310113",n:"宝山区"},{c:"310114",n:"嘉定区"},{c:"310115",n:"浦东新区"},{c:"310116",n:"金山区"},{c:"310117",n:"松江区"},{c:"310118",n:"青浦区"},{c:"310120",n:"奉贤区"},{c:"310151",n:"崇明区"},{c:"320102",n:"玄武区"},{c:"320104",n:"秦淮区"},{c:"320105",n:"建邺区"},{c:"320106",n:"鼓楼区"},{c:"320111",n:"浦口区"},{c:"320113",n:"栖霞区"},{c:"320114",n:"雨花台区"},{c:"320115",n:"江宁区"},{c:"320116",n:"六合区"},{c:"320117",n:"溧水区"},{c:"320118",n:"高淳区"},{c:"320205",n:"锡山区"},{c:"320206",n:"惠山区"},{c:"320211",n:"滨湖区"},{c:"320213",n:"梁溪区"},{c:"320214",n:"新吴区"},{c:"320281",n:"江阴市"},{c:"320282",n:"宜兴市"},{c:"320302",n:"鼓楼区"},{c:"320303",n:"云龙区"},{c:"320305",n:"贾汪区"},{c:"320311",n:"泉山区"},{c:"320312",n:"铜山区"},{c:"320321",n:"丰县"},{c:"320322",n:"沛县"},{c:"320324",n:"睢宁县"},{c:"320381",n:"新沂市"},{c:"320382",n:"邳州市"},{c:"320402",n:"天宁区"},{c:"320404",n:"钟楼区"},{c:"320411",n:"新北区"},{c:"320412",n:"武进区"},{c:"320413",n:"金坛区"},{c:"320481",n:"溧阳市"},{c:"320505",n:"虎丘区"},{c:"320506",n:"吴中区"},{c:"320507",n:"相城区"},{c:"320508",n:"姑苏区"},{c:"320509",n:"吴江区"},{c:"320581",n:"常熟市"},{c:"320582",n:"张家港市"},{c:"320583",n:"昆山市"},{c:"320585",n:"太仓市"},{c:"320602",n:"崇川区"},{c:"320611",n:"港闸区"},{c:"320612",n:"通州区"},{c:"320621",n:"海安县"},{c:"320623",n:"如东县"},{c:"320681",n:"启东市"},{c:"320682",n:"如皋市"},{c:"320684",n:"海门市"},{c:"320703",n:"连云区"},{c:"320706",n:"海州区"},{c:"320707",n:"赣榆区"},{c:"320722",n:"东海县"},{c:"320723",n:"灌云县"},{c:"320724",n:"灌南县"},{c:"320803",n:"淮安区"},{c:"320804",n:"淮阴区"},{c:"320812",n:"清江浦区"},{c:"320813",n:"洪泽区"},{c:"320826",n:"涟水县"},{c:"320830",n:"盱眙县"},{c:"320831",n:"金湖县"},{c:"320902",n:"亭湖区"},{c:"320903",n:"盐都区"},{c:"320904",n:"大丰区"},{c:"320921",n:"响水县"},{c:"320922",n:"滨海县"},{c:"320923",n:"阜宁县"},{c:"320924",n:"射阳县"},{c:"320925",n:"建湖县"},{c:"320981",n:"东台市"},{c:"321002",n:"广陵区"},{c:"321003",n:"邗江区"},{c:"321012",n:"江都区"},{c:"321023",n:"宝应县"},{c:"321081",n:"仪征市"},{c:"321084",n:"高邮市"},{c:"321102",n:"京口区"},{c:"321111",n:"润州区"},{c:"321112",n:"丹徒区"},{c:"321181",n:"丹阳市"},{c:"321182",n:"扬中市"},{c:"321183",n:"句容市"},{c:"321202",n:"海陵区"},{c:"321203",n:"高港区"},{c:"321204",n:"姜堰区"},{c:"321281",n:"兴化市"},{c:"321282",n:"靖江市"},{c:"321283",n:"泰兴市"},{c:"321302",n:"宿城区"},{c:"321311",n:"宿豫区"},{c:"321322",n:"沭阳县"},{c:"321323",n:"泗阳县"},{c:"321324",n:"泗洪县"},{c:"330102",n:"上城区"},{c:"330103",n:"下城区"},{c:"330104",n:"江干区"},{c:"330105",n:"拱墅区"},{c:"330106",n:"西湖区"},{c:"330108",n:"滨江区"},{c:"330109",n:"萧山区"},{c:"330110",n:"余杭区"},{c:"330111",n:"富阳区"},{c:"330112",n:"临安区"},{c:"330122",n:"桐庐县"},{c:"330127",n:"淳安县"},{c:"330182",n:"建德市"},{c:"330203",n:"海曙区"},{c:"330205",n:"江北区"},{c:"330206",n:"北仑区"},{c:"330211",n:"镇海区"},{c:"330212",n:"鄞州区"},{c:"330213",n:"奉化区"},{c:"330225",n:"象山县"},{c:"330226",n:"宁海县"},{c:"330281",n:"余姚市"},{c:"330282",n:"慈溪市"},{c:"330302",n:"鹿城区"},{c:"330303",n:"龙湾区"},{c:"330304",n:"瓯海区"},{c:"330305",n:"洞头区"},{c:"330324",n:"永嘉县"},{c:"330326",n:"平阳县"},{c:"330327",n:"苍南县"},{c:"330328",n:"文成县"},{c:"330329",n:"泰顺县"},{c:"330381",n:"瑞安市"},{c:"330382",n:"乐清市"},{c:"330402",n:"南湖区"},{c:"330411",n:"秀洲区"},{c:"330421",n:"嘉善县"},{c:"330424",n:"海盐县"},{c:"330481",n:"海宁市"},{c:"330482",n:"平湖市"},{c:"330483",n:"桐乡市"},{c:"330502",n:"吴兴区"},{c:"330503",n:"南浔区"},{c:"330521",n:"德清县"},{c:"330522",n:"长兴县"},{c:"330523",n:"安吉县"},{c:"330602",n:"越城区"},{c:"330603",n:"柯桥区"},{c:"330604",n:"上虞区"},{c:"330624",n:"新昌县"},{c:"330681",n:"诸暨市"},{c:"330683",n:"嵊州市"},{c:"330702",n:"婺城区"},{c:"330703",n:"金东区"},{c:"330723",n:"武义县"},{c:"330726",n:"浦江县"},{c:"330727",n:"磐安县"},{c:"330781",n:"兰溪市"},{c:"330782",n:"义乌市"},{c:"330783",n:"东阳市"},{c:"330784",n:"永康市"},{c:"330802",n:"柯城区"},{c:"330803",n:"衢江区"},{c:"330822",n:"常山县"},{c:"330824",n:"开化县"},{c:"330825",n:"龙游县"},{c:"330881",n:"江山市"},{c:"330902",n:"定海区"},{c:"330903",n:"普陀区"},{c:"330921",n:"岱山县"},{c:"330922",n:"嵊泗县"},{c:"331002",n:"椒江区"},{c:"331003",n:"黄岩区"},{c:"331004",n:"路桥区"},{c:"331021",n:"玉环市"},{c:"331022",n:"三门县"},{c:"331023",n:"天台县"},{c:"331024",n:"仙居县"},{c:"331081",n:"温岭市"},{c:"331082",n:"临海市"},{c:"331102",n:"莲都区"},{c:"331121",n:"青田县"},{c:"331122",n:"缙云县"},{c:"331123",n:"遂昌县"},{c:"331124",n:"松阳县"},{c:"331125",n:"云和县"},{c:"331126",n:"庆元县"},{c:"331127",n:"景宁畲族自治县"},{c:"331181",n:"龙泉市"},{c:"340102",n:"瑶海区"},{c:"340103",n:"庐阳区"},{c:"340104",n:"蜀山区"},{c:"340111",n:"包河区"},{c:"340121",n:"长丰县"},{c:"340122",n:"肥东县"},{c:"340123",n:"肥西县"},{c:"340124",n:"庐江县"},{c:"340181",n:"巢湖市"},{c:"340202",n:"镜湖区"},{c:"340203",n:"弋江区"},{c:"340207",n:"鸠江区"},{c:"340208",n:"三山区"},{c:"340221",n:"芜湖县"},{c:"340222",n:"繁昌县"},{c:"340223",n:"南陵县"},{c:"340225",n:"无为县"},{c:"340302",n:"龙子湖区"},{c:"340303",n:"蚌山区"},{c:"340304",n:"禹会区"},{c:"340311",n:"淮上区"},{c:"340321",n:"怀远县"},{c:"340322",n:"五河县"},{c:"340323",n:"固镇县"},{c:"340402",n:"大通区"},{c:"340403",n:"田家庵区"},{c:"340404",n:"谢家集区"},{c:"340405",n:"八公山区"},{c:"340406",n:"潘集区"},{c:"340421",n:"凤台县"},{c:"340422",n:"寿县"},{c:"340503",n:"花山区"},{c:"340504",
n:"雨山区"},{c:"340506",n:"博望区"},{c:"340521",n:"当涂县"},{c:"340522",n:"含山县"},{c:"340523",n:"和县"},{c:"340602",n:"杜集区"},{c:"340603",n:"相山区"},{c:"340604",n:"烈山区"},{c:"340621",n:"濉溪县"},{c:"340705",n:"铜官区"},{c:"340706",n:"义安区"},{c:"340711",n:"郊区"},{c:"340722",n:"枞阳县"},{c:"340802",n:"迎江区"},{c:"340803",n:"大观区"},{c:"340811",n:"宜秀区"},{c:"340822",n:"怀宁县"},{c:"340824",n:"潜山县"},{c:"340825",n:"太湖县"},{c:"340826",n:"宿松县"},{c:"340827",n:"望江县"},{c:"340828",n:"岳西县"},{c:"340881",n:"桐城市"},{c:"341002",n:"屯溪区"},{c:"341003",n:"黄山区"},{c:"341004",n:"徽州区"},{c:"341021",n:"歙县"},{c:"341022",n:"休宁县"},{c:"341023",n:"黟县"},{c:"341024",n:"祁门县"},{c:"341102",n:"琅琊区"},{c:"341103",n:"南谯区"},{c:"341122",n:"来安县"},{c:"341124",n:"全椒县"},{c:"341125",n:"定远县"},{c:"341126",n:"凤阳县"},{c:"341181",n:"天长市"},{c:"341182",n:"明光市"},{c:"341202",n:"颍州区"},{c:"341203",n:"颍东区"},{c:"341204",n:"颍泉区"},{c:"341221",n:"临泉县"},{c:"341222",n:"太和县"},{c:"341225",n:"阜南县"},{c:"341226",n:"颍上县"},{c:"341282",n:"界首市"},{c:"341302",n:"埇桥区"},{c:"341321",n:"砀山县"},{c:"341322",n:"萧县"},{c:"341323",n:"灵璧县"},{c:"341324",n:"泗县"},{c:"341502",n:"金安区"},{c:"341503",n:"裕安区"},{c:"341504",n:"叶集区"},{c:"341522",n:"霍邱县"},{c:"341523",n:"舒城县"},{c:"341524",n:"金寨县"},{c:"341525",n:"霍山县"},{c:"341602",n:"谯城区"},{c:"341621",n:"涡阳县"},{c:"341622",n:"蒙城县"},{c:"341623",n:"利辛县"},{c:"341702",n:"贵池区"},{c:"341721",n:"东至县"},{c:"341722",n:"石台县"},{c:"341723",n:"青阳县"},{c:"341802",n:"宣州区"},{c:"341821",n:"郎溪县"},{c:"341822",n:"广德县"},{c:"341823",n:"泾县"},{c:"341824",n:"绩溪县"},{c:"341825",n:"旌德县"},{c:"341881",n:"宁国市"},{c:"350102",n:"鼓楼区"},{c:"350103",n:"台江区"},{c:"350104",n:"仓山区"},{c:"350105",n:"马尾区"},{c:"350111",n:"晋安区"},{c:"350121",n:"闽侯县"},{c:"350122",n:"连江县"},{c:"350123",n:"罗源县"},{c:"350124",n:"闽清县"},{c:"350125",n:"永泰县"},{c:"350128",n:"平潭县"},{c:"350181",n:"福清市"},{c:"350182",n:"长乐市"},{c:"350203",n:"思明区"},{c:"350205",n:"海沧区"},{c:"350206",n:"湖里区"},{c:"350211",n:"集美区"},{c:"350212",n:"同安区"},{c:"350213",n:"翔安区"},{c:"350302",n:"城厢区"},{c:"350303",n:"涵江区"},{c:"350304",n:"荔城区"},{c:"350305",n:"秀屿区"},{c:"350322",n:"仙游县"},{c:"350402",n:"梅列区"},{c:"350403",n:"三元区"},{c:"350421",n:"明溪县"},{c:"350423",n:"清流县"},{c:"350424",n:"宁化县"},{c:"350425",n:"大田县"},{c:"350426",n:"尤溪县"},{c:"350427",n:"沙县"},{c:"350428",n:"将乐县"},{c:"350429",n:"泰宁县"},{c:"350430",n:"建宁县"},{c:"350481",n:"永安市"},{c:"350502",n:"鲤城区"},{c:"350503",n:"丰泽区"},{c:"350504",n:"洛江区"},{c:"350505",n:"泉港区"},{c:"350521",n:"惠安县"},{c:"350524",n:"安溪县"},{c:"350525",n:"永春县"},{c:"350526",n:"德化县"},{c:"350527",n:"金门县"},{c:"350581",n:"石狮市"},{c:"350582",n:"晋江市"},{c:"350583",n:"南安市"},{c:"350602",n:"芗城区"},{c:"350603",n:"龙文区"},{c:"350622",n:"云霄县"},{c:"350623",n:"漳浦县"},{c:"350624",n:"诏安县"},{c:"350625",n:"长泰县"},{c:"350626",n:"东山县"},{c:"350627",n:"南靖县"},{c:"350628",n:"平和县"},{c:"350629",n:"华安县"},{c:"350681",n:"龙海市"},{c:"350702",n:"延平区"},{c:"350703",n:"建阳区"},{c:"350721",n:"顺昌县"},{c:"350722",n:"浦城县"},{c:"350723",n:"光泽县"},{c:"350724",n:"松溪县"},{c:"350725",n:"政和县"},{c:"350781",n:"邵武市"},{c:"350782",n:"武夷山市"},{c:"350783",n:"建瓯市"},{c:"350802",n:"新罗区"},{c:"350803",n:"永定区"},{c:"350821",n:"长汀县"},{c:"350823",n:"上杭县"},{c:"350824",n:"武平县"},{c:"350825",n:"连城县"},{c:"350881",n:"漳平市"},{c:"350902",n:"蕉城区"},{c:"350921",n:"霞浦县"},{c:"350922",n:"古田县"},{c:"350923",n:"屏南县"},{c:"350924",n:"寿宁县"},{c:"350925",n:"周宁县"},{c:"350926",n:"柘荣县"},{c:"350981",n:"福安市"},{c:"350982",n:"福鼎市"},{c:"360102",n:"东湖区"},{c:"360103",n:"西湖区"},{c:"360104",n:"青云谱区"},{c:"360105",n:"湾里区"},{c:"360111",n:"青山湖区"},{c:"360112",n:"新建区"},{c:"360121",n:"南昌县"},{c:"360123",n:"安义县"},{c:"360124",n:"进贤县"},{c:"360202",n:"昌江区"},{c:"360203",n:"珠山区"},{c:"360222",n:"浮梁县"},{c:"360281",n:"乐平市"},{c:"360302",n:"安源区"},{c:"360313",n:"湘东区"},{c:"360321",n:"莲花县"},{c:"360322",n:"上栗县"},{c:"360323",n:"芦溪县"},{c:"360402",n:"濂溪区"},{c:"360403",n:"浔阳区"},{c:"360421",n:"柴桑区"},{c:"360423",n:"武宁县"},{c:"360424",n:"修水县"},{c:"360425",n:"永修县"},{c:"360426",n:"德安县"},{c:"360428",n:"都昌县"},{c:"360429",n:"湖口县"},{c:"360430",n:"彭泽县"},{c:"360481",n:"瑞昌市"},{c:"360482",n:"共青城市"},{c:"360483",n:"庐山市"},{c:"360502",n:"渝水区"},{c:"360521",n:"分宜县"},{c:"360602",n:"月湖区"},{c:"360622",n:"余江县"},{c:"360681",n:"贵溪市"},{c:"360702",n:"章贡区"},{c:"360703",n:"南康区"},{c:"360704",n:"赣县区"},{c:"360722",n:"信丰县"},{c:"360723",n:"大余县"},{c:"360724",n:"上犹县"},{c:"360725",n:"崇义县"},{c:"360726",n:"安远县"},{c:"360727",n:"龙南县"},{c:"360728",n:"定南县"},{c:"360729",n:"全南县"},{c:"360730",n:"宁都县"},{c:"360731",n:"于都县"},{c:"360732",n:"兴国县"},{c:"360733",n:"会昌县"},{c:"360734",n:"寻乌县"},{c:"360735",n:"石城县"},{c:"360781",n:"瑞金市"},{c:"360802",n:"吉州区"},{c:"360803",n:"青原区"},{c:"360821",n:"吉安县"},{c:"360822",n:"吉水县"},{c:"360823",n:"峡江县"},{c:"360824",n:"新干县"},{c:"360825",n:"永丰县"},{c:"360826",n:"泰和县"},{c:"360827",n:"遂川县"},{c:"360828",n:"万安县"},{c:"360829",n:"安福县"},{c:"360830",n:"永新县"},{c:"360881",n:"井冈山市"},{c:"360902",n:"袁州区"},{c:"360921",n:"奉新县"},{c:"360922",n:"万载县"},{c:"360923",n:"上高县"},{c:"360924",n:"宜丰县"},{c:"360925",n:"靖安县"},{c:"360926",n:"铜鼓县"},{c:"360981",n:"丰城市"},{c:"360982",n:"樟树市"},{c:"360983",n:"高安市"},{c:"361002",n:"临川区"},{c:"361003",n:"东乡区"},{c:"361021",n:"南城县"},{c:"361022",n:"黎川县"},{c:"361023",n:"南丰县"},{c:"361024",n:"崇仁县"},{c:"361025",n:"乐安县"},{c:"361026",n:"宜黄县"},{c:"361027",n:"金溪县"},{c:"361028",n:"资溪县"},{c:"361030",n:"广昌县"},{c:"361102",n:"信州区"},{c:"361103",n:"广丰区"},{c:"361121",n:"上饶县"},{c:"361123",n:"玉山县"},{c:"361124",n:"铅山县"},{c:"361125",n:"横峰县"},{c:"361126",n:"弋阳县"},{c:"361127",n:"余干县"},{c:"361128",n:"鄱阳县"},{c:"361129",n:"万年县"},{c:"361130",n:"婺源县"},{c:"361181",n:"德兴市"},{c:"370102",n:"历下区"},{c:"370103",n:"市中区"},{c:"370104",n:"槐荫区"},{c:"370105",n:"天桥区"},{c:"370112",n:"历城区"},{c:"370113",n:"长清区"},{c:"370114",n:"章丘区"},{c:"370124",n:"平阴县"},{c:"370125",n:"济阳县"},{c:"370126",n:"商河县"},{c:"370202",n:"市南区"},{c:"370203",n:"市北区"},{c:"370211",n:"黄岛区"},{c:"370212",n:"崂山区"},{c:"370213",n:"李沧区"},{c:"370214",n:"城阳区"},{c:"370281",n:"胶州市"},{c:"370282",n:"即墨区"},{c:"370283",n:"平度市"},{c:"370285",n:"莱西市"},{c:"370302",n:"淄川区"},{c:"370303",n:"张店区"},{c:"370304",n:"博山区"},{c:"370305",n:"临淄区"},{c:"370306",n:"周村区"},{c:"370321",n:"桓台县"},{c:"370322",n:"高青县"},{c:"370323",n:"沂源县"},{c:"370402",n:"市中区"},{c:"370403",n:"薛城区"},{c:"370404",n:"峄城区"},{c:"370405",n:"台儿庄区"},{c:"370406",n:"山亭区"},{c:"370481",n:"滕州市"},{c:"370502",n:"东营区"},{c:"370503",n:"河口区"},{c:"370505",n:"垦利区"},{c:"370522",n:"利津县"},{c:"370523",n:"广饶县"},{c:"370602",n:"芝罘区"},{c:"370611",n:"福山区"},{c:"370612",n:"牟平区"},{c:"370613",n:"莱山区"},{c:"370634",n:"长岛县"},{c:"370681",n:"龙口市"},{c:"370682",n:"莱阳市"},{c:"370683",n:"莱州市"},{c:"370684",n:"蓬莱市"},{c:"370685",n:"招远市"},{c:"370686",n:"栖霞市"},{c:"370687",n:"海阳市"},{c:"370702",n:"潍城区"},{c:"370703",n:"寒亭区"},{c:"370704",n:"坊子区"},{c:"370705",n:"奎文区"},{c:"370724",n:"临朐县"},{c:"370725",n:"昌乐县"},{c:"370781",n:"青州市"},{c:"370782",n:"诸城市"},{c:"370783",n:"寿光市"},{c:"370784",n:"安丘市"},{c:"370785",n:"高密市"},{c:"370786",n:"昌邑市"},{c:"370811",n:"任城区"},{c:"370812",n:"兖州区"},{c:"370826",n:"微山县"},{c:"370827",n:"鱼台县"},{c:"370828",n:"金乡县"},{c:"370829",n:"嘉祥县"},{c:"370830",n:"汶上县"},{c:"370831",n:"泗水县"},{c:"370832",n:"梁山县"},{c:"370881",n:"曲阜市"},{c:"370883",n:"邹城市"},{c:"370902",n:"泰山区"},{c:"370911",n:"岱岳区"},{c:"370921",n:"宁阳县"},{c:"370923",n:"东平县"},{c:"370982",n:"新泰市"},{c:"370983",n:"肥城市"},{c:"371002",n:"环翠区"},{c:"371003",n:"文登区"},{c:"371082",n:"荣成市"},{c:"371083",n:"乳山市"},{c:"371102",n:"东港区"},{c:"371103",n:"岚山区"},{c:"371121",n:"五莲县"},{c:"371122",n:"莒县"},{c:"371202",n:"莱城区"},{c:"371203",n:"钢城区"},{c:"371302",n:"兰山区"},{c:"371311",n:"罗庄区"},{c:"371312",n:"河东区"},{c:"371321",n:"沂南县"},{c:"371322",n:"郯城县"},{c:"371323",n:"沂水县"},{c:"371324",n:"兰陵县"},{c:"371325",n:"费县"},{c:"371326",n:"平邑县"},{c:"371327",n:"莒南县"},{c:"371328",n:"蒙阴县"},{c:"371329",n:"临沭县"},{c:"371402",n:"德城区"},{c:"371403",n:"陵城区"},{c:"371422",n:"宁津县"},{c:"371423",n:"庆云县"},{c:"371424",n:"临邑县"},{c:"371425",n:"齐河县"},{c:"371426",n:"平原县"},{c:"371427",n:"夏津县"},{c:"371428",n:"武城县"},{c:"371481",n:"乐陵市"},{c:"371482",n:"禹城市"},{c:"371502",n:"东昌府区"},{c:"371521",n:"阳谷县"},{c:"371522",n:"莘县"},{c:"371523",n:"茌平县"},{c:"371524",n:"东阿县"},{c:"371525",n:"冠县"},{c:"371526",n:"高唐县"},{c:"371581",n:"临清市"},{c:"371602",n:"滨城区"},{c:"371603",n:"沾化区"},{c:"371621",n:"惠民县"},{c:"371622",n:"阳信县"},{c:"371623",n:"无棣县"},{c:"371625",n:"博兴县"},{c:"371626",n:"邹平县"},{c:"371702",n:"牡丹区"},{c:"371703",n:"定陶区"},{c:"371721",n:"曹县"},{c:"371722",n:"单县"},{c:"371723",n:"成武县"},{c:"371724",n:"巨野县"},{c:"371725",n:"郓城县"},{c:"371726",n:"鄄城县"},{c:"371728",n:"东明县"},{c:"410102",n:"中原区"},{c:"410103",n:"二七区"},{c:"410104",n:"管城回族区"},{c:"410105",n:"金水区"},{c:"410106",n:"上街区"},{c:"410108",n:"惠济区"},{c:"410122",n:"中牟县"},{c:"410181",n:"巩义市"},{c:"410182",n:"荥阳市"},{c:"410183",n:"新密市"},{c:"410184",n:"新郑市"},{c:"410185",n:"登封市"},{c:"410202",n:"龙亭区"},{c:"410203",n:"顺河回族区"},{c:"410204",n:"鼓楼区"},{c:"410205",n:"禹王台区"},{c:"410212",n:"祥符区"},{c:"410221",n:"杞县"},{c:"410222",n:"通许县"},{c:"410223",n:"尉氏县"},{c:"410225",n:"兰考县"},{c:"410302",n:"老城区"},{c:"410303",n:"西工区"},{c:"410304",n:"瀍河回族区"},{c:"410305",n:"涧西区"},{c:"410306",n:"吉利区"},{c:"410311",n:"洛龙区"},{c:"410322",n:"孟津县"},{c:"410323",n:"新安县"},{c:"410324",n:"栾川县"},{c:"410325",n:"嵩县"},{c:"410326",n:"汝阳县"},{c:"410327",n:"宜阳县"},{c:"410328",n:"洛宁县"},{c:"410329",n:"伊川县"},{c:"410381",n:"偃师市"},{c:"410402",n:"新华区"},{c:"410403",n:"卫东区"},{c:"410404",n:"石龙区"},{c:"410411",n:"湛河区"},{c:"410421",n:"宝丰县"},{c:"410422",n:"叶县"},{c:"410423",n:"鲁山县"},{c:"410425",n:"郏县"},{c:"410481",n:"舞钢市"},{c:"410482",n:"汝州市"},{c:"410502",n:"文峰区"},{c:"410503",n:"北关区"},{c:"410505",n:"殷都区"},{c:"410506",n:"龙安区"},{c:"410522",n:"安阳县"},{c:"410523",n:"汤阴县"},{c:"410526",n:"滑县"},{c:"410527",n:"内黄县"},{c:"410581",n:"林州市"},{c:"410602",n:"鹤山区"},{c:"410603",n:"山城区"},{c:"410611",n:"淇滨区"},{c:"410621",n:"浚县"},{c:"410622",n:"淇县"},{c:"410702",n:"红旗区"},{c:"410703",n:"卫滨区"},{c:"410704",n:"凤泉区"},{c:"410711",n:"牧野区"},{c:"410721",n:"新乡县"},{c:"410724",n:"获嘉县"},{c:"410725",n:"原阳县"},{c:"410726",n:"延津县"},{c:"410727",n:"封丘县"},{c:"410728",n:"长垣县"},{c:"410781",n:"卫辉市"},{c:"410782",n:"辉县市"},{c:"410802",n:"解放区"},{c:"410803",n:"中站区"},{c:"410804",n:"马村区"},{c:"410811",n:"山阳区"},{c:"410821",n:"修武县"},{c:"410822",n:"博爱县"},{c:"410823",n:"武陟县"},{c:"410825",n:"温县"},{c:"410882",n:"沁阳市"},{c:"410883",n:"孟州市"},{c:"410902",n:"华龙区"},{c:"410922",n:"清丰县"},{c:"410923",n:"南乐县"},{c:"410926",n:"范县"},{c:"410927",n:"台前县"},{c:"410928",n:"濮阳县"},{c:"411002",n:"魏都区"},{c:"411003",n:"建安区"},{c:"411024",n:"鄢陵县"},{c:"411025",n:"襄城县"},{c:"411081",n:"禹州市"},{c:"411082",n:"长葛市"},{c:"411102",n:"源汇区"},{c:"411103",n:"郾城区"},{c:"411104",n:"召陵区"},{c:"411121",n:"舞阳县"},{c:"411122",n:"临颍县"},{c:"411202",n:"湖滨区"},{c:"411203",n:"陕州区"},{c:"411221",n:"渑池县"},{c:"411224",n:"卢氏县"},{c:"411281",n:"义马市"},{c:"411282",n:"灵宝市"},{c:"411302",n:"宛城区"},{c:"411303",n:"卧龙区"},{c:"411321",n:"南召县"},{c:"411322",n:"方城县"},{c:"411323",n:"西峡县"},{c:"411324",n:"镇平县"},{c:"411325",n:"内乡县"},{c:"411326",n:"淅川县"},{c:"411327",n:"社旗县"},{c:"411328",n:"唐河县"},{c:"411329",n:"新野县"},{c:"411330",n:"桐柏县"},{c:"411381",n:"邓州市"},{c:"411402",n:"梁园区"},{c:"411403",n:"睢阳区"},{c:"411421",n:"民权县"},{c:"411422",n:"睢县"},{c:"411423",n:"宁陵县"},{c:"411424",n:"柘城县"},{c:"411425",n:"虞城县"},{c:"411426",n:"夏邑县"},{c:"411481",n:"永城市"},{c:"411502",n:"浉河区"},{c:"411503",n:"平桥区"},{c:"411521",n:"罗山县"},{c:"411522",n:"光山县"},{c:"411523",n:"新县"},{c:"411524",n:"商城县"},{c:"411525",n:"固始县"},{c:"411526",n:"潢川县"},{c:"411527",n:"淮滨县"},{c:"411528",n:"息县"},{c:"411602",n:"川汇区"},{c:"411621",n:"扶沟县"},{c:"411622",n:"西华县"},{c:"411623",n:"商水县"},{c:"411624",n:"沈丘县"},{c:"411625",n:"郸城县"},{c:"411626",n:"淮阳县"},{c:"411627",n:"太康县"},{c:"411628",n:"鹿邑县"},{c:"411681",n:"项城市"},{c:"411702",n:"驿城区"},{c:"411721",n:"西平县"},{c:"411722",n:"上蔡县"},{c:"411723",n:"平舆县"},{c:"411724",n:"正阳县"},{c:"411725",n:"确山县"},{c:"411726",n:"泌阳县"},{c:"411727",n:"汝南县"},{c:"411728",n:"遂平县"},{c:"411729",n:"新蔡县"},{c:"419001",n:"济源市"},{c:"420102",n:"江岸区"},{c:"420103",n:"江汉区"},{c:"420104",n:"硚口区"},{c:"420105",n:"汉阳区"},{c:"420106",n:"武昌区"},{c:"420107",n:"青山区"},{c:"420111",n:"洪山区"},{c:"420112",n:"东西湖区"},{c:"420113",n:"汉南区"},{c:"420114",n:"蔡甸区"},{c:"420115",n:"江夏区"},{c:"420116",n:"黄陂区"},{c:"420117",n:"新洲区"},{c:"420202",n:"黄石港区"},{c:"420203",n:"西塞山区"},{c:"420204",n:"下陆区"},{c:"420205",n:"铁山区"},{c:"420222",n:"阳新县"},{c:"420281",n:"大冶市"},{c:"420302",n:"茅箭区"},{c:"420303",n:"张湾区"},{c:"420304",n:"郧阳区"},{c:"420322",n:"郧西县"},{c:"420323",n:"竹山县"},{c:"420324",n:"竹溪县"},{c:"420325",n:"房县"},{c:"420381",n:"丹江口市"},{c:"420502",n:"西陵区"},{c:"420503",n:"伍家岗区"},{c:"420504",n:"点军区"},{c:"420505",n:"猇亭区"},{c:"420506",n:"夷陵区"},{c:"420525",n:"远安县"},{c:"420526",n:"兴山县"},{c:"420527",n:"秭归县"},{c:"420528",n:"长阳土家族自治县"},{c:"420529",n:"五峰土家族自治县"},{c:"420581",n:"宜都市"},{c:"420582",n:"当阳市"},{c:"420583",n:"枝江市"},{c:"420602",n:"襄城区"},{c:"420606",n:"樊城区"},{c:"420607",n:"襄州区"},{c:"420624",n:"南漳县"},{c:"420625",n:"谷城县"},{c:"420626",n:"保康县"},{c:"420682",n:"老河口市"},{c:"420683",n:"枣阳市"},{c:"420684",n:"宜城市"},{c:"420702",n:"梁子湖区"},{c:"420703",n:"华容区"},{c:"420704",n:"鄂城区"},{c:"420802",n:"东宝区"},{c:"420804",n:"掇刀区"},{c:"420821",n:"京山县"},{c:"420822",n:"沙洋县"},{c:"420881",n:"钟祥市"},{c:"420902",n:"孝南区"},{c:"420921",n:"孝昌县"},{c:"420922",n:"大悟县"},{c:"420923",n:"云梦县"},{c:"420981",n:"应城市"},{c:"420982",n:"安陆市"},{c:"420984",n:"汉川市"},{c:"421002",n:"沙市区"},{c:"421003",n:"荆州区"},{c:"421022",n:"公安县"},{c:"421023",n:"监利县"},{c:"421024",n:"江陵县"},{c:"421081",n:"石首市"},{c:"421083",n:"洪湖市"},{c:"421087",n:"松滋市"},{c:"421102",n:"黄州区"},{c:"421121",n:"团风县"},{c:"421122",n:"红安县"},{c:"421123",n:"罗田县"},{c:"421124",n:"英山县"},{c:"421125",n:"浠水县"},{c:"421126",n:"蕲春县"},{c:"421127",n:"黄梅县"},{c:"421181",n:"麻城市"},{c:"421182",n:"武穴市"},{c:"421202",n:"咸安区"},{c:"421221",n:"嘉鱼县"},{c:"421222",n:"通城县"},{c:"421223",n:"崇阳县"},{c:"421224",n:"通山县"},{c:"421281",n:"赤壁市"},{c:"421303",n:"曾都区"},{c:"421321",n:"随县"},{c:"421381",n:"广水市"},{c:"422801",n:"恩施市"},{c:"422802",n:"利川市"},{c:"422822",n:"建始县"},{c:"422823",n:"巴东县"},{c:"422825",n:"宣恩县"},{c:"422826",n:"咸丰县"},{c:"422827",n:"来凤县"},{c:"422828",n:"鹤峰县"},{c:"429004",n:"仙桃市"},{c:"429005",n:"潜江市"},{c:"429006",n:"天门市"},{c:"429021",n:"神农架林区"},{c:"430102",n:"芙蓉区"},{c:"430103",n:"天心区"},{c:"430104",n:"岳麓区"},{c:"430105",n:"开福区"},{c:"430111",n:"雨花区"},{c:"430112",n:"望城区"},{c:"430121",n:"长沙县"},{c:"430124",n:"宁乡市"},{c:"430181",n:"浏阳市"},{c:"430202",n:"荷塘区"},{c:"430203",n:"芦淞区"},{c:"430204",n:"石峰区"},{c:"430211",n:"天元区"},{c:"430221",n:"株洲县"},{c:"430223",n:"攸县"},{c:"430224",n:"茶陵县"},{c:"430225",n:"炎陵县"},{c:"430281",n:"醴陵市"},{c:"430302",n:"雨湖区"},{c:"430304",n:"岳塘区"},{c:"430321",n:"湘潭县"},{c:"430381",n:"湘乡市"},{c:"430382",n:"韶山市"},{c:"430405",n:"珠晖区"},{c:"430406",n:"雁峰区"},{c:"430407",n:"石鼓区"},{c:"430408",n:"蒸湘区"},{c:"430412",n:"南岳区"},{c:"430421",n:"衡阳县"},{c:"430422",n:"衡南县"},{c:"430423",n:"衡山县"},{c:"430424",n:"衡东县"},{c:"430426",n:"祁东县"},{c:"430481",n:"耒阳市"},{c:"430482",n:"常宁市"},{c:"430502",n:"双清区"},{c:"430503",n:"大祥区"},{c:"430511",n:"北塔区"},{c:"430521",n:"邵东县"},{c:"430522",n:"新邵县"},{c:"430523",n:"邵阳县"},{c:"430524",n:"隆回县"},{c:"430525",n:"洞口县"},{c:"430527",n:"绥宁县"},{c:"430528",n:"新宁县"},{c:"430529",n:"城步苗族自治县"},{c:"430581",n:"武冈市"},{c:"430602",n:"岳阳楼区"},{c:"430603",n:"云溪区"},{c:"430611",n:"君山区"},{c:"430621",n:"岳阳县"},{c:"430623",n:"华容县"},{c:"430624",n:"湘阴县"},{c:"430626",n:"平江县"},{c:"430681",n:"汨罗市"},{c:"430682",n:"临湘市"},{c:"430702",n:"武陵区"},{c:"430703",n:"鼎城区"},{c:"430721",n:"安乡县"},{c:"430722",n:"汉寿县"},{c:"430723",n:"澧县"},{c:"430724",n:"临澧县"},{c:"430725",n:"桃源县"},{c:"430726",n:"石门县"},{c:"430781",n:"津市市"},{c:"430802",n:"永定区"},{c:"430811",n:"武陵源区"},{c:"430821",n:"慈利县"},{c:"430822",n:"桑植县"},{c:"430902",n:"资阳区"},{c:"430903",n:"赫山区"},{c:"430921",n:"南县"},{c:"430922",n:"桃江县"},{c:"430923",n:"安化县"},{c:"430981",n:"沅江市"},{c:"431002",n:"北湖区"},{c:"431003",n:"苏仙区"},{c:"431021",n:"桂阳县"},{c:"431022",n:"宜章县"},{c:"431023",n:"永兴县"},{c:"431024",n:"嘉禾县"},{c:"431025",n:"临武县"},{c:"431026",n:"汝城县"},{c:"431027",n:"桂东县"},{c:"431028",n:"安仁县"},{c:"431081",n:"资兴市"},{c:"431102",n:"零陵区"},{c:"431103",n:"冷水滩区"},{c:"431121",n:"祁阳县"},{c:"431122",n:"东安县"},{c:"431123",n:"双牌县"},{c:"431124",n:"道县"},{c:"431125",n:"江永县"},{c:"431126",n:"宁远县"},{c:"431127",n:"蓝山县"},{c:"431128",n:"新田县"},{c:"431129",n:"江华瑶族自治县"},{c:"431202",n:"鹤城区"},{c:"431221",n:"中方县"},{c:"431222",n:"沅陵县"},{c:"431223",n:"辰溪县"},{c:"431224",n:"溆浦县"},{c:"431225",n:"会同县"},{c:"431226",n:"麻阳苗族自治县"},{c:"431227",n:"新晃侗族自治县"},{c:"431228",n:"芷江侗族自治县"},{c:"431229",n:"靖州苗族侗族自治县"},{c:"431230",n:"通道侗族自治县"},{c:"431281",n:"洪江市"},{c:"431302",n:"娄星区"},{c:"431321",n:"双峰县"},{c:"431322",n:"新化县"},{c:"431381",n:"冷水江市"},{c:"431382",n:"涟源市"},{c:"433101",n:"吉首市"},{c:"433122",n:"泸溪县"},{c:"433123",n:"凤凰县"},{c:"433124",n:"花垣县"},{c:"433125",n:"保靖县"},{c:"433126",n:"古丈县"},{c:"433127",n:"永顺县"},{c:"433130",n:"龙山县"},{c:"440103",n:"荔湾区"},{c:"440104",n:"越秀区"},{c:"440105",n:"海珠区"},{c:"440106",n:"天河区"},{c:"440111",n:"白云区"},{c:"440112",n:"黄埔区"},{c:"440113",n:"番禺区"},{c:"440114",n:"花都区"},{c:"440115",n:"南沙区"},{c:"440117",n:"从化区"},{c:"440118",n:"增城区"},{c:"440203",n:"武江区"},{c:"440204",n:"浈江区"},{c:"440205",n:"曲江区"},{c:"440222",n:"始兴县"},{c:"440224",n:"仁化县"},{c:"440229",n:"翁源县"},{c:"440232",n:"乳源瑶族自治县"},{c:"440233",n:"新丰县"},{c:"440281",n:"乐昌市"},{c:"440282",n:"南雄市"},{c:"440303",n:"罗湖区"},{c:"440304",n:"福田区"},{c:"440305",n:"南山区"},{c:"440306",n:"宝安区"},{c:"440307",n:"龙岗区"},{c:"440308",n:"盐田区"},{c:"440309",n:"龙华区"},{c:"440310",n:"坪山区"},{c:"440402",n:"香洲区"},{c:"440403",n:"斗门区"},{c:"440404",n:"金湾区"},{c:"440507",n:"龙湖区"},{c:"440511",n:"金平区"},{c:"440512",n:"濠江区"},{c:"440513",n:"潮阳区"},{c:"440514",n:"潮南区"},{c:"440515",n:"澄海区"},{c:"440523",n:"南澳县"},{c:"440604",n:"禅城区"},{c:"440605",n:"南海区"},{c:"440606",n:"顺德区"},{c:"440607",n:"三水区"},{c:"440608",n:"高明区"},{c:"440703",n:"蓬江区"},{c:"440704",n:"江海区"},{c:"440705",n:"新会区"},{c:"440781",n:"台山市"},{c:"440783",n:"开平市"},{c:"440784",n:"鹤山市"},{c:"440785",n:"恩平市"},{c:"440802",n:"赤坎区"},{c:"440803",n:"霞山区"},{c:"440804",n:"坡头区"},{c:"440811",n:"麻章区"},{c:"440823",n:"遂溪县"},{c:"440825",n:"徐闻县"},{c:"440881",n:"廉江市"},{c:"440882",n:"雷州市"},{c:"440883",n:"吴川市"},{c:"440902",n:"茂南区"},{c:"440904",n:"电白区"},{c:"440981",n:"高州市"},{c:"440982",n:"化州市"},{c:"440983",n:"信宜市"},{c:"441202",n:"端州区"},{c:"441203",n:"鼎湖区"},{c:"441204",n:"高要区"},{c:"441223",n:"广宁县"},{c:"441224",n:"怀集县"},{c:"441225",n:"封开县"},{c:"441226",n:"德庆县"},{c:"441284",n:"四会市"},{c:"441302",n:"惠城区"},{c:"441303",n:"惠阳区"},{c:"441322",n:"博罗县"},{c:"441323",n:"惠东县"},{c:"441324",n:"龙门县"},{c:"441402",n:"梅江区"},{c:"441403",n:"梅县区"},{c:"441422",n:"大埔县"},{c:"441423",n:"丰顺县"},{c:"441424",n:"五华县"},{c:"441426",n:"平远县"},{c:"441427",n:"蕉岭县"},{c:"441481",n:"兴宁市"},{c:"441502",n:"城区"},{c:"441521",n:"海丰县"},{c:"441523",n:"陆河县"},{c:"441581",n:"陆丰市"},{c:"441602",n:"源城区"},{c:"441621",n:"紫金县"},{c:"441622",n:"龙川县"},{c:"441623",n:"连平县"},{c:"441624",n:"和平县"},{c:"441625",n:"东源县"},{c:"441702",n:"江城区"},{c:"441704",n:"阳东区"},{c:"441721",n:"阳西县"},{c:"441781",n:"阳春市"},{c:"441802",n:"清城区"},{c:"441803",n:"清新区"},{c:"441821",n:"佛冈县"},{c:"441823",n:"阳山县"},{c:"441825",n:"连山壮族瑶族自治县"},{c:"441826",n:"连南瑶族自治县"},{c:"441881",n:"英德市"},{c:"441882",n:"连州市"},{c:"445102",n:"湘桥区"},{c:"445103",n:"潮安区"},{c:"445122",n:"饶平县"},{c:"445202",n:"榕城区"},{c:"445203",n:"揭东区"},{c:"445222",n:"揭西县"},{c:"445224",n:"惠来县"},{c:"445281",n:"普宁市"},{c:"445302",n:"云城区"},{c:"445303",n:"云安区"},{c:"445321",n:"新兴县"},{c:"445322",n:"郁南县"},{c:"445381",n:"罗定市"},{c:"450102",n:"兴宁区"},{c:"450103",n:"青秀区"},{c:"450105",n:"江南区"},{c:"450107",n:"西乡塘区"},{c:"450108",n:"良庆区"},{c:"450109",n:"邕宁区"},{c:"450110",n:"武鸣区"},{c:"450123",n:"隆安县"},{c:"450124",n:"马山县"},{c:"450125",n:"上林县"},{c:"450126",n:"宾阳县"},{c:"450127",n:"横县"},{c:"450202",n:"城中区"},{c:"450203",n:"鱼峰区"},{c:"450204",n:"柳南区"},{c:"450205",n:"柳北区"},{c:"450206",n:"柳江区"},{c:"450222",n:"柳城县"},{c:"450223",n:"鹿寨县"},{c:"450224",n:"融安县"},{c:"450225",n:"融水苗族自治县"},{c:"450226",n:"三江侗族自治县"},{c:"450302",n:"秀峰区"},{c:"450303",n:"叠彩区"},{c:"450304",n:"象山区"},{c:"450305",n:"七星区"},{c:"450311",n:"雁山区"},{c:"450312",n:"临桂区"},{c:"450321",n:"阳朔县"},{c:"450323",n:"灵川县"},{c:"450324",n:"全州县"},{c:"450325",n:"兴安县"},{c:"450326",n:"永福县"},{c:"450327",n:"灌阳县"},{c:"450328",n:"龙胜各族自治县"},{c:"450329",n:"资源县"},{c:"450330",n:"平乐县"},{c:"450331",n:"荔浦县"},{c:"450332",n:"恭城瑶族自治县"},{c:"450403",n:"万秀区"},{c:"450405",n:"长洲区"},{c:"450406",n:"龙圩区"},{c:"450421",n:"苍梧县"},{c:"450422",n:"藤县"},{c:"450423",n:"蒙山县"},{c:"450481",n:"岑溪市"},{c:"450502",n:"海城区"},{c:"450503",n:"银海区"},{c:"450512",n:"铁山港区"},{c:"450521",n:"合浦县"},{c:"450602",n:"港口区"},{c:"450603",n:"防城区"},{c:"450621",n:"上思县"},{c:"450681",n:"东兴市"},{c:"450702",n:"钦南区"},{c:"450703",n:"钦北区"},{c:"450721",n:"灵山县"},{c:"450722",n:"浦北县"},{c:"450802",n:"港北区"},{c:"450803",n:"港南区"},{c:"450804",n:"覃塘区"},{c:"450821",n:"平南县"},{c:"450881",n:"桂平市"},{c:"450902",n:"玉州区"},{c:"450903",n:"福绵区"},{c:"450921",n:"容县"},{c:"450922",n:"陆川县"},{c:"450923",n:"博白县"},{c:"450924",n:"兴业县"},{c:"450981",n:"北流市"},{c:"451002",n:"右江区"},{c:"451021",n:"田阳县"},{c:"451022",n:"田东县"},{c:"451023",n:"平果县"},{c:"451024",n:"德保县"},{c:"451026",n:"那坡县"},{c:"451027",n:"凌云县"},{c:"451028",n:"乐业县"},{c:"451029",n:"田林县"},{c:"451030",n:"西林县"},{c:"451031",n:"隆林各族自治县"},{c:"451081",n:"靖西市"},{c:"451102",n:"八步区"},{c:"451103",n:"平桂区"},{c:"451121",n:"昭平县"},{c:"451122",n:"钟山县"},{c:"451123",n:"富川瑶族自治县"},{c:"451202",n:"金城江区"},{c:"451203",n:"宜州区"},{c:"451221",n:"南丹县"},{c:"451222",n:"天峨县"},{c:"451223",n:"凤山县"},{c:"451224",n:"东兰县"},{c:"451225",n:"罗城仫佬族自治县"},{c:"451226",n:"环江毛南族自治县"},{c:"451227",n:"巴马瑶族自治县"},{c:"451228",n:"都安瑶族自治县"},{c:"451229",n:"大化瑶族自治县"},{c:"451302",n:"兴宾区"},{c:"451321",n:"忻城县"},{c:"451322",n:"象州县"},{c:"451323",n:"武宣县"},{c:"451324",n:"金秀瑶族自治县"},{c:"451381",n:"合山市"},{c:"451402",n:"江州区"},{c:"451421",n:"扶绥县"},{c:"451422",n:"宁明县"},{c:"451423",n:"龙州县"},{c:"451424",n:"大新县"},{c:"451425",n:"天等县"},{c:"451481",n:"凭祥市"},{c:"460105",n:"秀英区"},{c:"460106",n:"龙华区"},{c:"460107",n:"琼山区"},{c:"460108",n:"美兰区"},{c:"460202",n:"海棠区"},{c:"460203",n:"吉阳区"},{c:"460204",n:"天涯区"},{c:"460205",n:"崖州区"},{c:"460321",n:"西沙群岛"},{c:"460322",n:"南沙群岛"},{c:"460323",n:"中沙群岛"},{c:"460324",n:"永乐群岛"},{c:"469001",n:"五指山市"},{c:"469002",n:"琼海市"},{c:"469005",n:"文昌市"},{c:"469006",n:"万宁市"},{c:"469007",n:"东方市"},{c:"469021",n:"定安县"},{c:"469022",n:"屯昌县"},{c:"469023",n:"澄迈县"},{c:"469024",n:"临高县"},{c:"469025",n:"白沙黎族自治县"},{c:"469026",n:"昌江黎族自治县"},{c:"469027",n:"乐东黎族自治县"},{c:"469028",n:"陵水黎族自治县"},{c:"469029",n:"保亭黎族苗族自治县"},{c:"469030",n:"琼中黎族苗族自治县"},{c:"500101",n:"万州区"},{c:"500102",n:"涪陵区"},{c:"500103",n:"渝中区"},{c:"500104",n:"大渡口区"},{c:"500105",n:"江北区"},{c:"500106",n:"沙坪坝区"},{c:"500107",n:"九龙坡区"},{c:"500108",n:"南岸区"},{c:"500109",n:"北碚区"},{c:"500110",n:"綦江区"},{c:"500111",n:"大足区"},{c:"500112",n:"渝北区"},{c:"500113",n:"巴南区"},{c:"500114",n:"黔江区"},{c:"500115",n:"长寿区"},{c:"500116",n:"江津区"},{c:"500117",n:"合川区"},{c:"500118",n:"永川区"},{c:"500119",n:"南川区"},{c:"500120",n:"璧山区"},{c:"500151",n:"铜梁区"},{c:"500152",n:"潼南区"},{c:"500153",n:"荣昌区"},{c:"500154",n:"开州区"},{c:"500155",n:"梁平区"},{c:"500156",n:"武隆区"},{c:"500229",n:"城口县"},{c:"500230",n:"丰都县"},{c:"500231",n:"垫江县"},{c:"500233",n:"忠县"},{c:"500235",n:"云阳县"},{c:"500236",n:"奉节县"},{c:"500237",n:"巫山县"},{c:"500238",n:"巫溪县"},{c:"500240",n:"石柱土家族自治县"},{c:"500241",n:"秀山土家族苗族自治县"},{c:"500242",n:"酉阳土家族苗族自治县"},{c:"500243",n:"彭水苗族土家族自治县"},{c:"510104",n:"锦江区"},{c:"510105",n:"青羊区"},{c:"510106",n:"金牛区"},{c:"510107",n:"武侯区"},{c:"510108",n:"成华区"},{c:"510112",n:"龙泉驿区"},{c:"510113",n:"青白江区"},{c:"510114",n:"新都区"},{c:"510115",n:"温江区"},{c:"510116",n:"双流区"},{c:"510117",n:"郫都区"},{c:"510121",n:"金堂县"},{c:"510129",n:"大邑县"},{c:"510131",n:"蒲江县"},{c:"510132",n:"新津县"},{c:"510181",n:"都江堰市"},{c:"510182",n:"彭州市"},{c:"510183",n:"邛崃市"},{c:"510184",n:"崇州市"},{c:"510185",n:"简阳市"},{c:"510302",n:"自流井区"},{c:"510303",n:"贡井区"},{c:"510304",n:"大安区"},{c:"510311",n:"沿滩区"},{c:"510321",n:"荣县"},{c:"510322",n:"富顺县"},{c:"510402",n:"东区"},{c:"510403",n:"西区"},{c:"510411",n:"仁和区"},{c:"510421",n:"米易县"},{c:"510422",n:"盐边县"},{c:"510502",n:"江阳区"},{c:"510503",n:"纳溪区"},{c:"510504",n:"龙马潭区"},{c:"510521",n:"泸县"},{c:"510522",n:"合江县"},{c:"510524",n:"叙永县"},{c:"510525",n:"古蔺县"},{c:"510603",n:"旌阳区"},{c:"510623",n:"中江县"},{c:"510626",n:"罗江县"},{c:"510681",n:"广汉市"},{c:"510682",n:"什邡市"},{c:"510683",n:"绵竹市"},{c:"510703",n:"涪城区"},{c:"510704",n:"游仙区"},{c:"510705",n:"安州区"},{c:"510722",n:"三台县"},{c:"510723",n:"盐亭县"},{c:"510725",n:"梓潼县"},{c:"510726",n:"北川羌族自治县"},{c:"510727",n:"平武县"},{c:"510781",n:"江油市"},{c:"510802",n:"利州区"},{c:"510811",n:"昭化区"},{c:"510812",n:"朝天区"},{c:"510821",n:"旺苍县"},{c:"510822",n:"青川县"},{c:"510823",n:"剑阁县"},{c:"510824",n:"苍溪县"},{c:"510903",n:"船山区"},{c:"510904",n:"安居区"},{c:"510921",n:"蓬溪县"},{c:"510922",n:"射洪县"},{c:"510923",n:"大英县"},{c:"511002",n:"市中区"},{c:"511011",n:"东兴区"},{c:"511024",n:"威远县"},{c:"511025",n:"资中县"},{c:"511083",n:"隆昌市"},{c:"511102",n:"市中区"},{c:"511111",n:"沙湾区"},{c:"511112",n:"五通桥区"},{c:"511113",n:"金口河区"},{c:"511123",n:"犍为县"},{c:"511124",n:"井研县"},{c:"511126",n:"夹江县"},{c:"511129",n:"沐川县"},{c:"511132",n:"峨边彝族自治县"},{c:"511133",n:"马边彝族自治县"},{c:"511181",n:"峨眉山市"},{c:"511302",n:"顺庆区"},{c:"511303",n:"高坪区"},{c:"511304",n:"嘉陵区"},{c:"511321",n:"南部县"},{c:"511322",n:"营山县"},{c:"511323",n:"蓬安县"},{c:"511324",n:"仪陇县"},{c:"511325",n:"西充县"},{c:"511381",n:"阆中市"},{c:"511402",n:"东坡区"},{c:"511403",n:"彭山区"},{c:"511421",n:"仁寿县"},{c:"511423",n:"洪雅县"},{c:"511424",n:"丹棱县"},{c:"511425",n:"青神县"},{c:"511502",n:"翠屏区"},{c:"511503",n:"南溪区"},{c:"511521",n:"宜宾县"},{c:"511523",n:"江安县"},{c:"511524",n:"长宁县"},{c:"511525",n:"高县"},{c:"511526",n:"珙县"},{c:"511527",n:"筠连县"},{c:"511528",n:"兴文县"},{c:"511529",n:"屏山县"},{c:"511602",n:"广安区"},{c:"511603",n:"前锋区"},{c:"511621",n:"岳池县"},{c:"511622",n:"武胜县"},{c:"511623",n:"邻水县"},{c:"511681",n:"华蓥市"},{c:"511702",n:"通川区"},{c:"511703",n:"达川区"},{c:"511722",n:"宣汉县"},{c:"511723",n:"开江县"},{c:"511724",n:"大竹县"},{c:"511725",n:"渠县"},{c:"511781",n:"万源市"},{c:"511802",n:"雨城区"},{c:"511803",n:"名山区"},{c:"511822",n:"荥经县"},{c:"511823",n:"汉源县"},{c:"511824",n:"石棉县"},{c:"511825",n:"天全县"},{c:"511826",n:"芦山县"},{c:"511827",n:"宝兴县"},{c:"511902",n:"巴州区"},{c:"511903",n:"恩阳区"},{c:"511921",n:"通江县"},{c:"511922",n:"南江县"},{c:"511923",n:"平昌县"},{c:"512002",n:"雁江区"},{c:"512021",n:"安岳县"},{c:"512022",n:"乐至县"},{c:"513201",n:"马尔康市"},{c:"513221",n:"汶川县"},{c:"513222",n:"理县"},{c:"513223",n:"茂县"},{c:"513224",n:"松潘县"},{c:"513225",n:"九寨沟县"},{c:"513226",n:"金川县"},{c:"513227",n:"小金县"},{c:"513228",n:"黑水县"},{c:"513230",n:"壤塘县"},{c:"513231",n:"阿坝县"},{c:"513232",n:"若尔盖县"},{c:"513233",n:"红原县"},{c:"513301",n:"康定市"},{c:"513322",n:"泸定县"},{c:"513323",n:"丹巴县"},{c:"513324",n:"九龙县"},{c:"513325",n:"雅江县"},{c:"513326",n:"道孚县"},{c:"513327",n:"炉霍县"},{c:"513328",n:"甘孜县"},{c:"513329",n:"新龙县"},{c:"513330",n:"德格县"},{c:"513331",n:"白玉县"},{c:"513332",n:"石渠县"},{c:"513333",n:"色达县"},{c:"513334",n:"理塘县"},{c:"513335",n:"巴塘县"},{c:"513336",n:"乡城县"},{c:"513337",n:"稻城县"},{c:"513338",n:"得荣县"},{c:"513401",n:"西昌市"},{c:"513422",n:"木里藏族自治县"},{c:"513423",n:"盐源县"},{c:"513424",n:"德昌县"},{c:"513425",n:"会理县"},{c:"513426",n:"会东县"},{c:"513427",n:"宁南县"},{c:"513428",n:"普格县"},{c:"513429",n:"布拖县"},{c:"513430",n:"金阳县"},{c:"513431",n:"昭觉县"},{c:"513432",n:"喜德县"},{c:"513433",n:"冕宁县"},{c:"513434",n:"越西县"},{c:"513435",n:"甘洛县"},{c:"513436",n:"美姑县"},{c:"513437",n:"雷波县"},{c:"520102",n:"南明区"},{c:"520103",n:"云岩区"},{c:"520111",n:"花溪区"},{c:"520112",n:"乌当区"},{c:"520113",n:"白云区"},{c:"520115",n:"观山湖区"},{c:"520121",n:"开阳县"},{c:"520122",n:"息烽县"},{c:"520123",n:"修文县"},{c:"520181",n:"清镇市"},{c:"520201",n:"钟山区"},{c:"520203",n:"六枝特区"},{c:"520221",n:"水城县"},{c:"520281",n:"盘州市"},{c:"520302",n:"红花岗区"},{c:"520303",n:"汇川区"},{c:"520304",n:"播州区"},{c:"520322",n:"桐梓县"},{c:"520323",n:"绥阳县"},{c:"520324",n:"正安县"},{c:"520325",n:"道真仡佬族苗族自治县"},{c:"520326",n:"务川仡佬族苗族自治县"},{c:"520327",n:"凤冈县"},{c:"520328",n:"湄潭县"},{c:"520329",n:"余庆县"},{c:"520330",n:"习水县"},{c:"520381",n:"赤水市"},{c:"520382",n:"仁怀市"},{c:"520402",n:"西秀区"},{c:"520403",n:"平坝区"},{c:"520422",n:"普定县"},{c:"520423",n:"镇宁布依族苗族自治县"},{c:"520424",n:"关岭布依族苗族自治县"},{c:"520425",n:"紫云苗族布依族自治县"},{c:"520502",n:"七星关区"},{c:"520521",n:"大方县"},{c:"520522",n:"黔西县"},{c:"520523",n:"金沙县"},{c:"520524",n:"织金县"},{c:"520525",n:"纳雍县"},{c:"520526",n:"威宁彝族回族苗族自治县"},{c:"520527",n:"赫章县"},{c:"520602",n:"碧江区"},{c:"520603",n:"万山区"},{c:"520621",n:"江口县"},{c:"520622",n:"玉屏侗族自治县"},{c:"520623",n:"石阡县"},{c:"520624",n:"思南县"},{c:"520625",n:"印江土家族苗族自治县"},{c:"520626",n:"德江县"},{c:"520627",n:"沿河土家族自治县"},{c:"520628",n:"松桃苗族自治县"},{c:"522301",n:"兴义市"},{c:"522322",n:"兴仁县"},{c:"522323",n:"普安县"},{c:"522324",n:"晴隆县"},{c:"522325",n:"贞丰县"},{c:"522326",n:"望谟县"},{c:"522327",n:"册亨县"},{c:"522328",n:"安龙县"},{c:"522601",n:"凯里市"},{c:"522622",n:"黄平县"},{c:"522623",n:"施秉县"},{c:"522624",n:"三穗县"},{c:"522625",n:"镇远县"},{c:"522626",n:"岑巩县"},{c:"522627",n:"天柱县"},{c:"522628",n:"锦屏县"},{c:"522629",n:"剑河县"},{c:"522630",n:"台江县"},{c:"522631",n:"黎平县"},{c:"522632",n:"榕江县"},{c:"522633",n:"从江县"},{c:"522634",n:"雷山县"},{c:"522635",n:"麻江县"},{c:"522636",n:"丹寨县"},{c:"522701",n:"都匀市"},{c:"522702",n:"福泉市"},{c:"522722",n:"荔波县"},{c:"522723",n:"贵定县"},{c:"522725",n:"瓮安县"},{c:"522726",n:"独山县"},{c:"522727",n:"平塘县"},{c:"522728",n:"罗甸县"},{c:"522729",n:"长顺县"},{c:"522730",n:"龙里县"},{c:"522731",n:"惠水县"},{c:"522732",n:"三都水族自治县"},{c:"530102",n:"五华区"},{c:"530103",n:"盘龙区"},{c:"530111",n:"官渡区"},{c:"530112",n:"西山区"},{c:"530113",n:"东川区"},{c:"530114",n:"呈贡区"},{c:"530115",n:"晋宁区"},{c:"530124",n:"富民县"},{c:"530125",n:"宜良县"},{c:"530126",n:"石林彝族自治县"},{c:"530127",n:"嵩明县"},{c:"530128",n:"禄劝彝族苗族自治县"},{c:"530129",n:"寻甸回族彝族自治县"},{c:"530181",n:"安宁市"},{c:"530302",n:"麒麟区"},{c:"530303",n:"沾益区"},{c:"530321",n:"马龙县"},{c:"530322",n:"陆良县"},{c:"530323",n:"师宗县"},{c:"530324",n:"罗平县"},{c:"530325",n:"富源县"},{c:"530326",n:"会泽县"},{c:"530381",n:"宣威市"},{c:"530402",n:"红塔区"},{c:"530403",n:"江川区"},{c:"530422",n:"澄江县"},{c:"530423",n:"通海县"},{c:"530424",n:"华宁县"},{c:"530425",n:"易门县"},{c:"530426",n:"峨山彝族自治县"},{c:"530427",n:"新平彝族傣族自治县"},{c:"530428",n:"元江哈尼族彝族傣族自治县"},{c:"530502",n:"隆阳区"},{c:"530521",n:"施甸县"},{c:"530523",n:"龙陵县"},{c:"530524",n:"昌宁县"},{c:"530581",n:"腾冲市"},{c:"530602",n:"昭阳区"},{c:"530621",n:"鲁甸县"},{c:"530622",n:"巧家县"},{c:"530623",n:"盐津县"},{c:"530624",n:"大关县"},{c:"530625",n:"永善县"},{c:"530626",n:"绥江县"},{c:"530627",n:"镇雄县"},{c:"530628",n:"彝良县"},{c:"530629",n:"威信县"},{c:"530630",n:"水富县"},{c:"530702",n:"古城区"},{c:"530721",n:"玉龙纳西族自治县"},{c:"530722",n:"永胜县"},{c:"530723",n:"华坪县"},{c:"530724",n:"宁蒗彝族自治县"},{c:"530802",n:"思茅区"},{c:"530821",n:"宁洱哈尼族彝族自治县"},{c:"530822",n:"墨江哈尼族自治县"},{c:"530823",n:"景东彝族自治县"},{c:"530824",n:"景谷傣族彝族自治县"},{c:"530825",n:"镇沅彝族哈尼族拉祜族自治县"},{c:"530826",n:"江城哈尼族彝族自治县"},{c:"530827",n:"孟连傣族拉祜族佤族自治县"},{c:"530828",n:"澜沧拉祜族自治县"},{c:"530829",n:"西盟佤族自治县"},{c:"530902",n:"临翔区"},{c:"530921",n:"凤庆县"},{c:"530922",n:"云县"},{c:"530923",n:"永德县"},{c:"530924",n:"镇康县"},{c:"530925",n:"双江拉祜族佤族布朗族傣族自治县"},{c:"530926",n:"耿马傣族佤族自治县"},{c:"530927",n:"沧源佤族自治县"},{c:"532301",n:"楚雄市"},{c:"532322",n:"双柏县"},{c:"532323",n:"牟定县"},{c:"532324",n:"南华县"},{c:"532325",n:"姚安县"},{c:"532326",n:"大姚县"},{c:"532327",n:"永仁县"},{c:"532328",n:"元谋县"},{c:"532329",n:"武定县"},{c:"532331",n:"禄丰县"},{c:"532501",n:"个旧市"},{c:"532502",n:"开远市"},{c:"532503",n:"蒙自市"},{c:"532504",n:"弥勒市"},{c:"532523",n:"屏边苗族自治县"},{c:"532524",n:"建水县"},{c:"532525",n:"石屏县"},{c:"532527",n:"泸西县"},{c:"532528",n:"元阳县"},{c:"532529",n:"红河县"},{c:"532530",n:"金平苗族瑶族傣族自治县"},{c:"532531",n:"绿春县"},{c:"532532",n:"河口瑶族自治县"},{c:"532601",n:"文山市"},{c:"532622",n:"砚山县"},{c:"532623",n:"西畴县"},{c:"532624",n:"麻栗坡县"},{c:"532625",n:"马关县"},{c:"532626",n:"丘北县"},{c:"532627",n:"广南县"},{c:"532628",n:"富宁县"},{c:"532801",n:"景洪市"},{c:"532822",n:"勐海县"},{c:"532823",n:"勐腊县"},{c:"532901",n:"大理市"},{c:"532922",n:"漾濞彝族自治县"},{c:"532923",n:"祥云县"},{c:"532924",n:"宾川县"},{c:"532925",n:"弥渡县"},{c:"532926",n:"南涧彝族自治县"},{c:"532927",n:"巍山彝族回族自治县"},{c:"532928",n:"永平县"},{c:"532929",n:"云龙县"},{c:"532930",n:"洱源县"},{c:"532931",n:"剑川县"},{c:"532932",n:"鹤庆县"},{c:"533102",n:"瑞丽市"},{c:"533103",n:"芒市"},{c:"533122",n:"梁河县"},{c:"533123",n:"盈江县"},{c:"533124",n:"陇川县"},{c:"533301",n:"泸水市"},{c:"533323",n:"福贡县"},{c:"533324",n:"贡山独龙族怒族自治县"},{c:"533325",n:"兰坪白族普米族自治县"},{c:"533401",n:"香格里拉市"},{c:"533422",n:"德钦县"},{c:"533423",n:"维西傈僳族自治县"},{c:"540102",n:"城关区"},{c:"540103",n:"堆龙德庆区"},{c:"540121",n:"林周县"},{c:"540122",n:"当雄县"},{c:"540123",n:"尼木县"},{c:"540124",n:"曲水县"},{c:"540126",n:"达孜县"},{c:"540127",n:"墨竹工卡县"},{c:"540202",n:"桑珠孜区"},{c:"540221",n:"南木林县"},{c:"540222",n:"江孜县"},{c:"540223",n:"定日县"},{c:"540224",n:"萨迦县"},{c:"540225",n:"拉孜县"},{c:"540226",n:"昂仁县"},{c:"540227",n:"谢通门县"},{c:"540228",n:"白朗县"},{c:"540229",n:"仁布县"},{c:"540230",n:"康马县"},{c:"540231",n:"定结县"},{c:"540232",n:"仲巴县"},{c:"540233",n:"亚东县"},{c:"540234",n:"吉隆县"},{c:"540235",n:"聂拉木县"},{c:"540236",n:"萨嘎县"},{c:"540237",n:"岗巴县"},{c:"540302",n:"卡若区"},{c:"540321",n:"江达县"},{c:"540322",n:"贡觉县"},{
c:"540323",n:"类乌齐县"},{c:"540324",n:"丁青县"},{c:"540325",n:"察雅县"},{c:"540326",n:"八宿县"},{c:"540327",n:"左贡县"},{c:"540328",n:"芒康县"},{c:"540329",n:"洛隆县"},{c:"540330",n:"边坝县"},{c:"540402",n:"巴宜区"},{c:"540421",n:"工布江达县"},{c:"540422",n:"米林县"},{c:"540423",n:"墨脱县"},{c:"540424",n:"波密县"},{c:"540425",n:"察隅县"},{c:"540426",n:"朗县"},{c:"540502",n:"乃东区"},{c:"540521",n:"扎囊县"},{c:"540522",n:"贡嘎县"},{c:"540523",n:"桑日县"},{c:"540524",n:"琼结县"},{c:"540525",n:"曲松县"},{c:"540526",n:"措美县"},{c:"540527",n:"洛扎县"},{c:"540528",n:"加查县"},{c:"540529",n:"隆子县"},{c:"540530",n:"错那县"},{c:"540531",n:"浪卡子县"},{c:"542421",n:"那曲县"},{c:"542422",n:"嘉黎县"},{c:"542423",n:"比如县"},{c:"542424",n:"聂荣县"},{c:"542425",n:"安多县"},{c:"542426",n:"申扎县"},{c:"542427",n:"索县"},{c:"542428",n:"班戈县"},{c:"542429",n:"巴青县"},{c:"542430",n:"尼玛县"},{c:"542431",n:"双湖县"},{c:"542521",n:"普兰县"},{c:"542522",n:"札达县"},{c:"542523",n:"噶尔县"},{c:"542524",n:"日土县"},{c:"542525",n:"革吉县"},{c:"542526",n:"改则县"},{c:"542527",n:"措勤县"},{c:"610102",n:"新城区"},{c:"610103",n:"碑林区"},{c:"610104",n:"莲湖区"},{c:"610111",n:"灞桥区"},{c:"610112",n:"未央区"},{c:"610113",n:"雁塔区"},{c:"610114",n:"阎良区"},{c:"610115",n:"临潼区"},{c:"610116",n:"长安区"},{c:"610117",n:"高陵区"},{c:"610118",n:"鄠邑区"},{c:"610122",n:"蓝田县"},{c:"610124",n:"周至县"},{c:"610202",n:"王益区"},{c:"610203",n:"印台区"},{c:"610204",n:"耀州区"},{c:"610222",n:"宜君县"},{c:"610302",n:"渭滨区"},{c:"610303",n:"金台区"},{c:"610304",n:"陈仓区"},{c:"610322",n:"凤翔县"},{c:"610323",n:"岐山县"},{c:"610324",n:"扶风县"},{c:"610326",n:"眉县"},{c:"610327",n:"陇县"},{c:"610328",n:"千阳县"},{c:"610329",n:"麟游县"},{c:"610330",n:"凤县"},{c:"610331",n:"太白县"},{c:"610402",n:"秦都区"},{c:"610403",n:"杨陵区"},{c:"610404",n:"渭城区"},{c:"610422",n:"三原县"},{c:"610423",n:"泾阳县"},{c:"610424",n:"乾县"},{c:"610425",n:"礼泉县"},{c:"610426",n:"永寿县"},{c:"610427",n:"彬县"},{c:"610428",n:"长武县"},{c:"610429",n:"旬邑县"},{c:"610430",n:"淳化县"},{c:"610431",n:"武功县"},{c:"610481",n:"兴平市"},{c:"610502",n:"临渭区"},{c:"610503",n:"华州区"},{c:"610522",n:"潼关县"},{c:"610523",n:"大荔县"},{c:"610524",n:"合阳县"},{c:"610525",n:"澄城县"},{c:"610526",n:"蒲城县"},{c:"610527",n:"白水县"},{c:"610528",n:"富平县"},{c:"610581",n:"韩城市"},{c:"610582",n:"华阴市"},{c:"610602",n:"宝塔区"},{c:"610603",n:"安塞区"},{c:"610621",n:"延长县"},{c:"610622",n:"延川县"},{c:"610623",n:"子长县"},{c:"610625",n:"志丹县"},{c:"610626",n:"吴起县"},{c:"610627",n:"甘泉县"},{c:"610628",n:"富县"},{c:"610629",n:"洛川县"},{c:"610630",n:"宜川县"},{c:"610631",n:"黄龙县"},{c:"610632",n:"黄陵县"},{c:"610702",n:"汉台区"},{c:"610721",n:"南郑区"},{c:"610722",n:"城固县"},{c:"610723",n:"洋县"},{c:"610724",n:"西乡县"},{c:"610725",n:"勉县"},{c:"610726",n:"宁强县"},{c:"610727",n:"略阳县"},{c:"610728",n:"镇巴县"},{c:"610729",n:"留坝县"},{c:"610730",n:"佛坪县"},{c:"610802",n:"榆阳区"},{c:"610803",n:"横山区"},{c:"610822",n:"府谷县"},{c:"610824",n:"靖边县"},{c:"610825",n:"定边县"},{c:"610826",n:"绥德县"},{c:"610827",n:"米脂县"},{c:"610828",n:"佳县"},{c:"610829",n:"吴堡县"},{c:"610830",n:"清涧县"},{c:"610831",n:"子洲县"},{c:"610881",n:"神木市"},{c:"610902",n:"汉滨区"},{c:"610921",n:"汉阴县"},{c:"610922",n:"石泉县"},{c:"610923",n:"宁陕县"},{c:"610924",n:"紫阳县"},{c:"610925",n:"岚皋县"},{c:"610926",n:"平利县"},{c:"610927",n:"镇坪县"},{c:"610928",n:"旬阳县"},{c:"610929",n:"白河县"},{c:"611002",n:"商州区"},{c:"611021",n:"洛南县"},{c:"611022",n:"丹凤县"},{c:"611023",n:"商南县"},{c:"611024",n:"山阳县"},{c:"611025",n:"镇安县"},{c:"611026",n:"柞水县"},{c:"620102",n:"城关区"},{c:"620103",n:"七里河区"},{c:"620104",n:"西固区"},{c:"620105",n:"安宁区"},{c:"620111",n:"红古区"},{c:"620121",n:"永登县"},{c:"620122",n:"皋兰县"},{c:"620123",n:"榆中县"},{c:"620302",n:"金川区"},{c:"620321",n:"永昌县"},{c:"620402",n:"白银区"},{c:"620403",n:"平川区"},{c:"620421",n:"靖远县"},{c:"620422",n:"会宁县"},{c:"620423",n:"景泰县"},{c:"620502",n:"秦州区"},{c:"620503",n:"麦积区"},{c:"620521",n:"清水县"},{c:"620522",n:"秦安县"},{c:"620523",n:"甘谷县"},{c:"620524",n:"武山县"},{c:"620525",n:"张家川回族自治县"},{c:"620602",n:"凉州区"},{c:"620621",n:"民勤县"},{c:"620622",n:"古浪县"},{c:"620623",n:"天祝藏族自治县"},{c:"620702",n:"甘州区"},{c:"620721",n:"肃南裕固族自治县"},{c:"620722",n:"民乐县"},{c:"620723",n:"临泽县"},{c:"620724",n:"高台县"},{c:"620725",n:"山丹县"},{c:"620802",n:"崆峒区"},{c:"620821",n:"泾川县"},{c:"620822",n:"灵台县"},{c:"620823",n:"崇信县"},{c:"620824",n:"华亭县"},{c:"620825",n:"庄浪县"},{c:"620826",n:"静宁县"},{c:"620902",n:"肃州区"},{c:"620921",n:"金塔县"},{c:"620922",n:"瓜州县"},{c:"620923",n:"肃北蒙古族自治县"},{c:"620924",n:"阿克塞哈萨克族自治县"},{c:"620981",n:"玉门市"},{c:"620982",n:"敦煌市"},{c:"621002",n:"西峰区"},{c:"621021",n:"庆城县"},{c:"621022",n:"环县"},{c:"621023",n:"华池县"},{c:"621024",n:"合水县"},{c:"621025",n:"正宁县"},{c:"621026",n:"宁县"},{c:"621027",n:"镇原县"},{c:"621102",n:"安定区"},{c:"621121",n:"通渭县"},{c:"621122",n:"陇西县"},{c:"621123",n:"渭源县"},{c:"621124",n:"临洮县"},{c:"621125",n:"漳县"},{c:"621126",n:"岷县"},{c:"621202",n:"武都区"},{c:"621221",n:"成县"},{c:"621222",n:"文县"},{c:"621223",n:"宕昌县"},{c:"621224",n:"康县"},{c:"621225",n:"西和县"},{c:"621226",n:"礼县"},{c:"621227",n:"徽县"},{c:"621228",n:"两当县"},{c:"622901",n:"临夏市"},{c:"622921",n:"临夏县"},{c:"622922",n:"康乐县"},{c:"622923",n:"永靖县"},{c:"622924",n:"广河县"},{c:"622925",n:"和政县"},{c:"622926",n:"东乡族自治县"},{c:"622927",n:"积石山保安族东乡族撒拉族自治县"},{c:"623001",n:"合作市"},{c:"623021",n:"临潭县"},{c:"623022",n:"卓尼县"},{c:"623023",n:"舟曲县"},{c:"623024",n:"迭部县"},{c:"623025",n:"玛曲县"},{c:"623026",n:"碌曲县"},{c:"623027",n:"夏河县"},{c:"630102",n:"城东区"},{c:"630103",n:"城中区"},{c:"630104",n:"城西区"},{c:"630105",n:"城北区"},{c:"630121",n:"大通回族土族自治县"},{c:"630122",n:"湟中县"},{c:"630123",n:"湟源县"},{c:"630202",n:"乐都区"},{c:"630203",n:"平安区"},{c:"630222",n:"民和回族土族自治县"},{c:"630223",n:"互助土族自治县"},{c:"630224",n:"化隆回族自治县"},{c:"630225",n:"循化撒拉族自治县"},{c:"632221",n:"门源回族自治县"},{c:"632222",n:"祁连县"},{c:"632223",n:"海晏县"},{c:"632224",n:"刚察县"},{c:"632321",n:"同仁县"},{c:"632322",n:"尖扎县"},{c:"632323",n:"泽库县"},{c:"632324",n:"河南蒙古族自治县"},{c:"632521",n:"共和县"},{c:"632522",n:"同德县"},{c:"632523",n:"贵德县"},{c:"632524",n:"兴海县"},{c:"632525",n:"贵南县"},{c:"632621",n:"玛沁县"},{c:"632622",n:"班玛县"},{c:"632623",n:"甘德县"},{c:"632624",n:"达日县"},{c:"632625",n:"久治县"},{c:"632626",n:"玛多县"},{c:"632701",n:"玉树市"},{c:"632722",n:"杂多县"},{c:"632723",n:"称多县"},{c:"632724",n:"治多县"},{c:"632725",n:"囊谦县"},{c:"632726",n:"曲麻莱县"},{c:"632801",n:"格尔木市"},{c:"632802",n:"德令哈市"},{c:"632821",n:"乌兰县"},{c:"632822",n:"都兰县"},{c:"632823",n:"天峻县"},{c:"640104",n:"兴庆区"},{c:"640105",n:"西夏区"},{c:"640106",n:"金凤区"},{c:"640121",n:"永宁县"},{c:"640122",n:"贺兰县"},{c:"640181",n:"灵武市"},{c:"640202",n:"大武口区"},{c:"640205",n:"惠农区"},{c:"640221",n:"平罗县"},{c:"640302",n:"利通区"},{c:"640303",n:"红寺堡区"},{c:"640323",n:"盐池县"},{c:"640324",n:"同心县"},{c:"640381",n:"青铜峡市"},{c:"640402",n:"原州区"},{c:"640422",n:"西吉县"},{c:"640423",n:"隆德县"},{c:"640424",n:"泾源县"},{c:"640425",n:"彭阳县"},{c:"640502",n:"沙坡头区"},{c:"640521",n:"中宁县"},{c:"640522",n:"海原县"},{c:"650102",n:"天山区"},{c:"650103",n:"沙依巴克区"},{c:"650104",n:"新市区"},{c:"650105",n:"水磨沟区"},{c:"650106",n:"头屯河区"},{c:"650107",n:"达坂城区"},{c:"650109",n:"米东区"},{c:"650121",n:"乌鲁木齐县"},{c:"650202",n:"独山子区"},{c:"650203",n:"克拉玛依区"},{c:"650204",n:"白碱滩区"},{c:"650205",n:"乌尔禾区"},{c:"650402",n:"高昌区"},{c:"650421",n:"鄯善县"},{c:"650422",n:"托克逊县"},{c:"650502",n:"伊州区"},{c:"650521",n:"巴里坤哈萨克自治县"},{c:"650522",n:"伊吾县"},{c:"652301",n:"昌吉市"},{c:"652302",n:"阜康市"},{c:"652323",n:"呼图壁县"},{c:"652324",n:"玛纳斯县"},{c:"652325",n:"奇台县"},{c:"652327",n:"吉木萨尔县"},{c:"652328",n:"木垒哈萨克自治县"},{c:"652701",n:"博乐市"},{c:"652702",n:"阿拉山口市"},{c:"652722",n:"精河县"},{c:"652723",n:"温泉县"},{c:"652801",n:"库尔勒市"},{c:"652822",n:"轮台县"},{c:"652823",n:"尉犁县"},{c:"652824",n:"若羌县"},{c:"652825",n:"且末县"},{c:"652826",n:"焉耆回族自治县"},{c:"652827",n:"和静县"},{c:"652828",n:"和硕县"},{c:"652829",n:"博湖县"},{c:"652901",n:"阿克苏市"},{c:"652922",n:"温宿县"},{c:"652923",n:"库车县"},{c:"652924",n:"沙雅县"},{c:"652925",n:"新和县"},{c:"652926",n:"拜城县"},{c:"652927",n:"乌什县"},{c:"652928",n:"阿瓦提县"},{c:"652929",n:"柯坪县"},{c:"653001",n:"阿图什市"},{c:"653022",n:"阿克陶县"},{c:"653023",n:"阿合奇县"},{c:"653024",n:"乌恰县"},{c:"653101",n:"喀什市"},{c:"653121",n:"疏附县"},{c:"653122",n:"疏勒县"},{c:"653123",n:"英吉沙县"},{c:"653124",n:"泽普县"},{c:"653125",n:"莎车县"},{c:"653126",n:"叶城县"},{c:"653127",n:"麦盖提县"},{c:"653128",n:"岳普湖县"},{c:"653129",n:"伽师县"},{c:"653130",n:"巴楚县"},{c:"653131",n:"塔什库尔干塔吉克自治县"},{c:"653201",n:"和田市"},{c:"653221",n:"和田县"},{c:"653222",n:"墨玉县"},{c:"653223",n:"皮山县"},{c:"653224",n:"洛浦县"},{c:"653225",n:"策勒县"},{c:"653226",n:"于田县"},{c:"653227",n:"民丰县"},{c:"654002",n:"伊宁市"},{c:"654003",n:"奎屯市"},{c:"654004",n:"霍尔果斯市"},{c:"654021",n:"伊宁县"},{c:"654022",n:"察布查尔锡伯自治县"},{c:"654023",n:"霍城县"},{c:"654024",n:"巩留县"},{c:"654025",n:"新源县"},{c:"654026",n:"昭苏县"},{c:"654027",n:"特克斯县"},{c:"654028",n:"尼勒克县"},{c:"654201",n:"塔城市"},{c:"654202",n:"乌苏市"},{c:"654221",n:"额敏县"},{c:"654223",n:"沙湾县"},{c:"654224",n:"托里县"},{c:"654225",n:"裕民县"},{c:"654226",n:"和布克赛尔蒙古自治县"},{c:"654301",n:"阿勒泰市"},{c:"654321",n:"布尔津县"},{c:"654322",n:"富蕴县"},{c:"654323",n:"福海县"},{c:"654324",n:"哈巴河县"},{c:"654325",n:"青河县"},{c:"654326",n:"吉木乃县"},{c:"659001",n:"石河子市"},{c:"659002",n:"阿拉尔市"},{c:"659003",n:"图木舒克市"},{c:"659004",n:"五家渠市"},{c:"659005",n:"北屯市"},{c:"659006",n:"铁门关市"},{c:"659007",n:"双河市"},{c:"659008",n:"可克达拉市"},{c:"659009",n:"昆玉市"},{c:"710101",n:"中正区"},{c:"710102",n:"大同区"},{c:"710103",n:"中山区"},{c:"710104",n:"万华区"},{c:"710105",n:"信义区"},{c:"710106",n:"松山区"},{c:"710107",n:"大安区"},{c:"710108",n:"南港区"},{c:"710109",n:"北投区"},{c:"710110",n:"内湖区"},{c:"710111",n:"士林区"},{c:"710112",n:"文山区"},{c:"710201",n:"板桥区"},{c:"710202",n:"土城区"},{c:"710203",n:"新庄区"},{c:"710204",n:"新店区"},{c:"710205",n:"深坑区"},{c:"710206",n:"石碇区"},{c:"710207",n:"坪林区"},{c:"710208",n:"乌来区"},{c:"710209",n:"五股区"},{c:"710210",n:"八里区"},{c:"710211",n:"林口区"},{c:"710212",n:"淡水区"},{c:"710213",n:"中和区"},{c:"710214",n:"永和区"},{c:"710215",n:"三重区"},{c:"710216",n:"芦洲区"},{c:"710217",n:"泰山区"},{c:"710218",n:"树林区"},{c:"710219",n:"莺歌区"},{c:"710220",n:"三峡区"},{c:"710221",n:"汐止区"},{c:"710222",n:"金山区"},{c:"710223",n:"万里区"},{c:"710224",n:"三芝区"},{c:"710225",n:"石门区"},{c:"710226",n:"瑞芳区"},{c:"710227",n:"贡寮区"},{c:"710228",n:"双溪区"},{c:"710229",n:"平溪区"},{c:"710301",n:"桃园区"},{c:"710302",n:"中坜区"},{c:"710303",n:"平镇区"},{c:"710304",n:"八德区"},{c:"710305",n:"杨梅区"},{c:"710306",n:"芦竹区"},{c:"710307",n:"大溪区"},{c:"710308",n:"龙潭区"},{c:"710309",n:"龟山区"},{c:"710310",n:"大园区"},{c:"710311",n:"观音区"},{c:"710312",n:"新屋区"},{c:"710313",n:"复兴区"},{c:"710401",n:"中区"},{c:"710402",n:"东区"},{c:"710403",n:"西区"},{c:"710404",n:"南区"},{c:"710405",n:"北区"},{c:"710406",n:"西屯区"},{c:"710407",n:"南屯区"},{c:"710408",n:"北屯区"},{c:"710409",n:"丰原区"},{c:"710410",n:"大里区"},{c:"710411",n:"太平区"},{c:"710412",n:"东势区"},{c:"710413",n:"大甲区"},{c:"710414",n:"清水区"},{c:"710415",n:"沙鹿区"},{c:"710416",n:"梧栖区"},{c:"710417",n:"后里区"},{c:"710418",n:"神冈区"},{c:"710419",n:"潭子区"},{c:"710420",n:"大雅区"},{c:"710421",n:"新小区"},{c:"710422",n:"石冈区"},{c:"710423",n:"外埔区"},{c:"710424",n:"大安区"},{c:"710425",n:"乌日区"},{c:"710426",n:"大肚区"},{c:"710427",n:"龙井区"},{c:"710428",n:"雾峰区"},{c:"710429",n:"和平区"},{c:"710501",n:"中西区"},{c:"710502",n:"东区"},{c:"710503",n:"南区"},{c:"710504",n:"北区"},{c:"710505",n:"安平区"},{c:"710506",n:"安南区"},{c:"710507",n:"永康区"},{c:"710508",n:"归仁区"},{c:"710509",n:"新化区"},{c:"710510",n:"左镇区"},{c:"710511",n:"玉井区"},{c:"710512",n:"楠西区"},{c:"710513",n:"南化区"},{c:"710514",n:"仁德区"},{c:"710515",n:"关庙区"},{c:"710516",n:"龙崎区"},{c:"710517",n:"官田区"},{c:"710518",n:"麻豆区"},{c:"710519",n:"佳里区"},{c:"710520",n:"西港区"},{c:"710521",n:"七股区"},{c:"710522",n:"将军区"},{c:"710523",n:"学甲区"},{c:"710524",n:"北门区"},{c:"710525",n:"新营区"},{c:"710526",n:"后壁区"},{c:"710527",n:"白河区"},{c:"710528",n:"东山区"},{c:"710529",n:"六甲区"},{c:"710530",n:"下营区"},{c:"710531",n:"柳营区"},{c:"710532",n:"盐水区"},{c:"710533",n:"善化区"},{c:"710534",n:"大内区"},{c:"710535",n:"山上区"},{c:"710536",n:"新市区"},{c:"710537",n:"安定区"},{c:"710601",n:"楠梓区"},{c:"710602",n:"左营区"},{c:"710603",n:"鼓山区"},{c:"710604",n:"三民区"},{c:"710605",n:"盐埕区"},{c:"710606",n:"前金区"},{c:"710607",n:"新兴区"},{c:"710608",n:"苓雅区"},{c:"710609",n:"前镇区"},{c:"710610",n:"旗津区"},{c:"710611",n:"小港区"},{c:"710612",n:"凤山区"},{c:"710613",n:"大寮区"},{c:"710614",n:"鸟松区"},{c:"710615",n:"林园区"},{c:"710616",n:"仁武区"},{c:"710617",n:"大树区"},{c:"710618",n:"大社区"},{c:"710619",n:"冈山区"},{c:"710620",n:"路竹区"},{c:"710621",n:"桥头区"},{c:"710622",n:"梓官区"},{c:"710623",n:"弥陀区"},{c:"710624",n:"永安区"},{c:"710625",n:"燕巢区"},{c:"710626",n:"阿莲区"},{c:"710627",n:"茄萣区"},{c:"710628",n:"湖内区"},{c:"710629",n:"旗山区"},{c:"710630",n:"美浓区"},{c:"710631",n:"内门区"},{c:"710632",n:"杉林区"},{c:"710633",n:"甲仙区"},{c:"710634",n:"六龟区"},{c:"710635",n:"茂林区"},{c:"710636",n:"桃源区"},{c:"710637",n:"那玛夏区"},{c:"710701",n:"中正区"},{c:"710702",n:"七堵区"},{c:"710703",n:"暖暖区"},{c:"710704",n:"仁爱区"},{c:"710705",n:"中山区"},{c:"710706",n:"安乐区"},{c:"710707",n:"信义区"},{c:"710801",n:"东区"},{c:"710802",n:"北区"},{c:"710803",n:"香山区"},{c:"710901",n:"东区"},{c:"710902",n:"西区"},{c:"719001",n:"宜兰县"},{c:"719002",n:"新竹县"},{c:"719003",n:"苗栗县"},{c:"719004",n:"彰化县"},{c:"719005",n:"南投县"},{c:"719006",n:"嘉义县"},{c:"719007",n:"云林县"},{c:"719008",n:"屏东县"},{c:"719009",n:"台东县"},{c:"719010",n:"花莲县"},{c:"719011",n:"澎湖县"},{c:"719012",n:"金门县"},{c:"719013",n:"连江县"},{c:"810101",n:"中西区"},{c:"810102",n:"湾仔区"},{c:"810103",n:"东区"},{c:"810104",n:"南区"},{c:"810105",n:"油尖旺区"},{c:"810106",n:"深水埗区"},{c:"810107",n:"九龙城区"},{c:"810108",n:"黄大仙区"},{c:"810109",n:"观塘区"},{c:"810110",n:"北区"},{c:"810111",n:"大埔区"},{c:"810112",n:"沙田区"},{c:"810113",n:"西贡区"},{c:"810114",n:"荃湾区"},{c:"810115",n:"屯门区"},{c:"810116",n:"元朗区"},{c:"810117",n:"葵青区"},{c:"810118",n:"离岛区"},{c:"820101",n:"花地玛堂区"},{c:"820102",n:"圣安多尼堂区"},{c:"820103",n:"大堂区"},{c:"820104",n:"望德堂区"},{c:"820105",n:"风顺堂区"},{c:"820106",n:"嘉模堂区"},{c:"820107",n:"圣方济各堂区"},{c:"820108",n:"路氹城"},{c:"820109",n:"澳门新城"}]};define("interaction_view/components/cascadeSelect/province",function(){}),epub360.PlayerPlugins.push({config:{type:"CascadeSelect",template:"others"},immediateRender:function(){var e=this,t=this.getdetail();if(0==t.sourceType)e.getItems(e.renderData);else if(1==t.sourceType)e.renderData();else if(2==t.sourceType){t.items=[];for(var i=0;i<ProvinceJson.Area.length;i++){var n,a=ProvinceJson.Area[i],r=a.c.substr(0,4);n=_.include(["1101","1102","1201","1202","3101","3102","5001","5002"],r)?_.find(ProvinceJson.City,function(e){return e.c.substr(0,3)==r.substr(0,3)}):_.find(ProvinceJson.City,function(e){return e.c==r.substr(0,4)});var o=_.find(ProvinceJson.Province,function(e){return e.c==r.substr(0,2)});n?t.items.push([o.n,n.n,a.n]):t.items.push([o.n,a.n])}e.renderData()}},renderData:function(){var e=this,t=this.getdetail();if(t.items&&t.items.length>0){for(var i=[],n=[],a=0,r=0;r<t.data.length;r++){var o=t.data[r].overlay;null!=o&&e.isCascadeSelect(o)&&(i.push(o),0==t.sourceType?n.push(a++):t.sourceType>=1&&n.push(t.data[r].field))}i.length>0&&e.renderFirstSelect(i[0],n[0])&&e.bindCascadeSelect(i,n)}},renderFirstSelect:function(e,t){var i=this,n=this.getdetail(),a=i.getSelect(e);if(n.items){if(a){for(var r=[],o=0;o<n.items.length;o++)r.push(n.items[o][t]);return i.setSelectVal(a,r),!0}return!1}},bindCascadeSelect:function(e,t){for(var i=this,n=(this.getdetail(),0);n<e.length;n++){var a=i.getPlaceholder(e[n]),r=i.getSelect(e[n]);r&&(r.data("Cascade_index",n),r.change(function(n){var r=$(this).val(),o=Number($(this).data("Cascade_index"));if(r==a)for(var s=o+1;s<e.length;s++){var l=i.getOverlayView(e[s]);l&&l.prependOpt()}else if(o+1<e.length){i.updateSelect(e,t,o+1);for(var s=o+2;s<e.length;s++){var l=i.getOverlayView(e[s]);l&&l.prependOpt()}}}))}},updateSelect:function(e,t,i){var n=this,a=this.getdetail(),r=n.getOverlayView(e[i]);if(r){if(r.prependOpt(),!a.items)return;for(var o=a.items.filter(function(a){for(var r=0;i>r;r++)if(a[t[r]]!=n.getSelectVal(e[r]))return!1;return!0}),s=n.getSelect(e[i]),l=[],c=0;c<o.length;c++)l.push(o[c][t[i]]);n.setSelectVal(s,l)}},setSelectVal:function(e,t){t=_.uniq(t);for(var i=0;i<t.length;i++)if(t[i]){var n=$("<option>"+t[i]+"</option>");n.attr("value",t[i]),e.append(n)}},getItems:function(e){var t=this,i=this.getdetail(),n=new dboperate,a=null;i.items=[],i.db_id&&i.query_id&&n.getqueryValue(i.db_id,i.query_id,0,a,function(n){for(var a=0;a<n.data.results.length;a++)if(n.data.results[a]){for(var r=[],o=0;o<i.data.length;o++)if(null!=i.data[o].overlay){var s=t.getFieldVal(i.data[o].field,n.data.results[a]);if(null==s){r=[];break}r.push(s)}r.length&&i.items.push(r)}e&&e()},{query:{},type:0})},getFieldVal:function(e,t){var i=interaction_view.expression.getFieldValue(e,t);return interaction_view.expression.id2values(i,null,{force_compute:!0})},getOverlayView:function(e){var t=interaction_view.getPage(interaction_view.currentPage).iOverlaylist.find(function(t){return t.id==e});return t&&t.iview?t.iview:null},getSelect:function(e){var t=this.getOverlayView(e);return t&&t.$el&&t.$el.find("select")},getSelectVal:function(e){var t=this.getSelect(e);return t&&t.val()},getPlaceholder:function(e){var t=this.getOverlayView(e);return t.getPlaceholder()},isCascadeSelect:function(e){var t=this.getOverlayView(e);return t&&t.isCascadeSelect()}}),define("interaction_view/components/cascadeSelect/cascadeSelect",function(){}),epub360.PlayerPlugins.push({config:{type:"Pip",template:"Image"},render:function(){},immediateRender:function(){this.isInit=!1,this.topLine=20,this.preloadImgTime=0,this.init()},onStop:function(){this.isInit=!1;var e=this.savedData.rAF;window.cancelAnimationFrame(e)},init:function(e){this.model.pipFinishAction=[],this.model.zoom=2;var t=this,i=this.getdetail(),n=this.getcommon();this.pipType=i.pipType;var a=i.iImg,r=_.pluck(a,"picture");this.imgArrCopy=r;var o=this.$el;this.posWH=n,this.model.loadedImg=[],this.drawImgIdx=0,this.savedData={rAF:null,currentAct:0,mainImgCurW:null,mainImgCurH:null,mainImgCurX:null,mainImgCurY:null,minorImgCurX:null,minorImgCurY:null,minorImgCurW:null,minorImgCurH:null,isStart:!1},this.preloadImg(function(){t.drawCanvas(o,a),t.isInit=!0,e&&!i.pipAutoPlay&&e()})},preloadImg:function(e){var t=this,i=0,n=[];n=this.imgArrCopy.length>this.topLine?this.imgArrCopy.slice(this.preloadImgTime*this.topLine,this.topLine*(this.preloadImgTime+1)):this.imgArrCopy;for(var a=0;a<n.length;a++)interaction_view.iImgs[n[a]]?(t.model.loadedImg.push(interaction_view.iImgs[n[a]]),++i==n.length&&e(t.model.loadedImg)):t.imgLoad(n[a],function(a,r){if(interaction_view.iImgs[a]=r,++i==n.length){for(var o=0;o<n.length;o++)t.model.loadedImg.push(interaction_view.iImgs[n[o]]);e(t.model.loadedImg)}});this.preloadImgTime++},imgLoad:function(e,t){var i=new Image;i.onload=function(){t(e,i)},i.src=e},drawCanvas:function(e,t){var i=this.model.zoom,n=this,a=this.model.loadedImg,r='<div class="pipWrap"></div>';e.html(r);var o=e.find(".pipWrap");o.css({overflow:"hidden",position:"absolute",width:n.posWH.iWidth,height:n.posWH.iHeight,top:-(n.posWH.iHeight/2),left:-(n.posWH.iWidth/2)});var s=document.createElement("canvas");s.width=n.posWH.iWidth*i,s.height=n.posWH.iHeight*i,s.style.width=n.posWH.iWidth+"px",s.style.height=n.posWH.iHeight+"px",s.className="pipCanvas",o.append(s);var l=e.find("canvas")[0].getContext("2d");if(0==n.pipType)l.drawImage(n.model.loadedImg[0],0*i,0*i,n.posWH.iWidth*i,n.posWH.iHeight*i);else{if(!t[0]||!t[0].pip_data)return;var c=t[0].pip_data,d=c.w,h=c.h,u=c.x,p=c.y;l.drawImage(n.model.loadedImg[0],0,0,n.posWH.iWidth*i,n.posWH.iHeight*i),l.globalCompositeOperation="source-over",l.drawImage(n.model.loadedImg[1],u*i,p*i,d*i,h*i)}var f,v=this.getdetail(),g=v.pipType,t=v.iImg,m=this.$el.find("canvas")[0],w=t.length;v.pipAutoPlay&&(f=0==this.pipType?3*Number(t[1].pip_data.curPicSpeed)/10:3*Number(t[0].pip_data.curPicSpeed)/10,this.calculateData(g,t,f,l,m,a,w),this.play(g,t,f,l,m,a,w))},calculateData:function(e,t,i,n,a,r,o){var s=Number(a.style.width.replace(/px/,"")),l=Number(a.style.height.replace(/px/,"")),c=this.savedData.currentAct;this.savedData.mainImgCurX=this.savedData.mainImgCurX||0,this.savedData.mainImgCurY=this.savedData.mainImgCurY||0,this.savedData.mainImgCurW=this.savedData.mainImgCurW||s,this.savedData.mainImgCurH=this.savedData.mainImgCurH||l,0==e?(this.savedData.minorImgCurW=this.savedData.minorImgCurW||s/t[c+1].pip_data.ratio,this.savedData.minorImgCurH=this.savedData.minorImgCurH||l/t[c+1].pip_data.ratio,this.savedData.minorImgCurX=this.savedData.minorImgCurX||-t[c+1].pip_data.x/t[c+1].pip_data.ratio,this.savedData.minorImgCurY=this.savedData.minorImgCurY||-t[c+1].pip_data.y/t[c+1].pip_data.ratio,this.mainImgNextX=t[c+1].pip_data.x,this.mainImgNextY=t[c+1].pip_data.y,this.mainImgNextW=t[c+1].pip_data.w,this.mainImgNextH=t[c+1].pip_data.h,this.mainImgWChangeOnce=i,this.mainImgHChangeOnce=i/s*l,this.mainImgXChangeOnce=this.mainImgWChangeOnce/(s-this.mainImgNextW)*this.mainImgNextX,this.mainImgYChangeOnce=this.mainImgHChangeOnce/(l-this.mainImgNextH)*this.mainImgNextY,this.minorImgWChangeOnce=this.mainImgWChangeOnce/t[c+1].pip_data.ratio,this.minorImgHChangeOnce=this.mainImgHChangeOnce/t[c+1].pip_data.ratio,this.minorImgXChangeOnce=this.mainImgXChangeOnce/t[c+1].pip_data.ratio,this.minorImgYChangeOnce=this.mainImgYChangeOnce/t[c+1].pip_data.ratio):(this.savedData.minorImgCurW=this.savedData.minorImgCurW||s*t[c].pip_data.ratio,this.savedData.minorImgCurH=this.savedData.minorImgCurH||l*t[c].pip_data.ratio,this.savedData.minorImgCurX=this.savedData.minorImgCurX||t[c].pip_data.x,this.savedData.minorImgCurY=this.savedData.minorImgCurY||t[c].pip_data.y,this.mainImgNextX=-t[c].pip_data.x/t[c].pip_data.ratio,this.mainImgNextY=-t[c].pip_data.y/t[c].pip_data.ratio,this.mainImgNextW=s/t[c].pip_data.ratio,this.mainImgNextH=l/t[c].pip_data.ratio,this.minorImgWChangeOnce=i,this.minorImgHChangeOnce=i/s*l,this.minorImgXChangeOnce=this.minorImgWChangeOnce/(s-s*t[c].pip_data.ratio)*t[c].pip_data.x,this.minorImgYChangeOnce=this.minorImgHChangeOnce/(l-l*t[c].pip_data.ratio)*t[c].pip_data.y,this.mainImgWChangeOnce=this.minorImgWChangeOnce/t[c].pip_data.ratio,this.mainImgHChangeOnce=this.minorImgHChangeOnce/t[c].pip_data.ratio,this.mainImgXChangeOnce=this.minorImgXChangeOnce/t[c].pip_data.ratio,this.mainImgYChangeOnce=this.minorImgYChangeOnce/t[c].pip_data.ratio),0==e?interaction_view.events.inCurPip(this,this.savedData.currentAct+1):interaction_view.events.inCurPip(this,this.savedData.currentAct)},play:function(e,t,i,n,a,r,o){this.savedData.isStart||(interaction_view.events.onPipStart(this),this.savedData.isStart=!0);var s=this.savedData.currentAct,l=this;if(0==e){if(this.savedData.mainImgCurX>=t[s+1].pip_data.x||this.savedData.minorImgCurX>=0){if(!(this.savedData.currentAct+1<o-1))return interaction_view.events.outCurPip(this,s+1),interaction_view.events.onPipFinish(this),void this.pause(e,t,i,n,a,r,o);interaction_view.events.outCurPip(this,s+1),this.savedData.currentAct++,this.savedData.mainImgCurX=null,this.savedData.mainImgCurY=null,this.savedData.mainImgCurW=null,this.savedData.mainImgCurH=null,this.savedData.minorImgCurW=null,this.savedData.minorImgCurH=null,this.savedData.minorImgCurX=null,this.savedData.minorImgCurY=null;var i=3*Number(t[this.savedData.currentAct+1].pip_data.curPicSpeed)/10;this.calculateData(e,t,i,n,a,r,o)}n.clearRect(0,0,a.width,a.height),this.drawMinorImg(e,t,i,n,a,r,o),n.globalCompositeOperation="source-over",this.drawMainImg(e,t,i,n,a,r,o)}else{if(this.savedData.minorImgCurX<=0||this.savedData.minorImgCurY<=0){if(!(this.savedData.currentAct+1<o-1))return interaction_view.events.outCurPip(this,s),interaction_view.events.onPipFinish(this),void this.pause(e,t,i,n,a,r,o);interaction_view.events.outCurPip(this,s),this.savedData.currentAct++,this.savedData.mainImgCurX=null,this.savedData.mainImgCurY=null,this.savedData.mainImgCurW=null,this.savedData.mainImgCurH=null,this.savedData.minorImgCurW=null,this.savedData.minorImgCurH=null,this.savedData.minorImgCurX=null,this.savedData.minorImgCurY=null;var i=3*Number(t[this.savedData.currentAct].pip_data.curPicSpeed)/10;this.calculateData(e,t,i,n,a,r,o)}n.clearRect(0,0,a.width,a.height),this.drawMainImg(e,t,i,n,a,r,o),n.globalCompositeOperation="source-over",this.drawMinorImg(e,t,i,n,a,r,o)}this.savedData.rAF=window.requestAnimationFrame(function(){l.savedData.currentAct==l.topLine*l.preloadImgTime-2?l.preloadImg(function(r){l.play(e,t,i,n,a,r,o)}):l.play(e,t,i,n,a,r,o)})},pause:function(e,t,i,n,a,r,o){var s=this.savedData.rAF;window.cancelAnimationFrame(s)},drawMainImg:function(e,t,i,n,a,r,o){var s=this.model.zoom,l=this.savedData.currentAct;0==e?(n.drawImage(r[l],this.savedData.mainImgCurX*s,this.savedData.mainImgCurY*s,this.savedData.mainImgCurW*s,this.savedData.mainImgCurH*s),this.savedData.mainImgCurX+=this.mainImgXChangeOnce,this.savedData.mainImgCurY+=this.mainImgYChangeOnce,this.savedData.mainImgCurW-=this.mainImgWChangeOnce,this.savedData.mainImgCurH-=this.mainImgHChangeOnce):(n.drawImage(r[l],this.savedData.mainImgCurX*s,this.savedData.mainImgCurY*s,this.savedData.mainImgCurW*s,this.savedData.mainImgCurH*s),this.savedData.mainImgCurX-=this.mainImgXChangeOnce,this.savedData.mainImgCurY-=this.mainImgYChangeOnce,this.savedData.mainImgCurW+=this.mainImgWChangeOnce,this.savedData.mainImgCurH+=this.mainImgHChangeOnce)},drawMinorImg:function(e,t,i,n,a,r,o){var s=this.model.zoom,l=this.savedData.currentAct;0==e?(n.drawImage(r[l+1],this.savedData.minorImgCurX*s,this.savedData.minorImgCurY*s,this.savedData.minorImgCurW*s,this.savedData.minorImgCurH*s),this.savedData.minorImgCurX+=this.minorImgXChangeOnce,this.savedData.minorImgCurY+=this.minorImgYChangeOnce,this.savedData.minorImgCurW-=this.minorImgWChangeOnce,this.savedData.minorImgCurH-=this.minorImgHChangeOnce):(n.drawImage(r[l+1],this.savedData.minorImgCurX*s,this.savedData.minorImgCurY*s,this.savedData.minorImgCurW*s,this.savedData.minorImgCurH*s),this.savedData.minorImgCurX-=this.minorImgXChangeOnce,this.savedData.minorImgCurY-=this.minorImgYChangeOnce,this.savedData.minorImgCurW+=this.minorImgWChangeOnce,this.savedData.minorImgCurH+=this.minorImgHChangeOnce)}}),define("interaction_view/components/pip/pip",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:526,exec:function(e,t,i,n){var a=a||this,r=e.getdetail().results[0].values||"",o="";r.length&&(o=interaction_view.expression.id2values(r).toString().replace(/<br>+/g,"\n").replace(/"+/g,"'").replace(/<\/div><div>/g,"\n").replace(/<div>/g,"").replace(/<\/div>/g,"").replace(/'/g,""));var s=e.getdetail().results[0],l=s.iTip,c=function(){interaction_view.errorAlert(s.iTipText)};a.doTextCopy(o,function(){l&&c()})},setExecuteActions:function(e,t,i){},doTextCopy:function(e,t,i){var n=require("thirdparty/clipboard/clipboard"),a="tapCopyTrigger",r=$("#"+a).length?$("#"+a):$("<div id='"+a+"' style='display:none;opacity:0;visibility:hidden;'></div>").appendTo("body");r.attr("copy-text",e);var o=interaction_view.tapCopyObj;o&&o.destroy(),interaction_view.tapCopyObj=new n(r[0],{text:function(e){return $(e).attr("copy-text")}}),o=interaction_view.tapCopyObj,o.on("success",function(e){_.isFunction(t)&&t()}),o.on("error",function(e){_.isFunction(i)&&i()}),r.click()}}}),define("interaction_view/actionexecutes/tapcopy/tapcopy",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:525,exec:function(e,t,i){var n=n||this,a=interaction_view.getPage(interaction_view.currentPage).runtimeCache;a.timelineControl=a.timelineControl||{from:{page:interaction_view.getPage(interaction_view.currentPage),master:interaction_view.imasterlist.at(0),background:interaction_view.ibackgroundlist.at(0)},hashMap:{}};var r=e.model.get("iDetail").results[0];_.isArray(r.values)&&r.values.length&&n.runAction(n.getAniInstance(r.values),r.action)},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}},getAniInstance:function(e){var t,i=i||this,n=interaction_view.getPage(interaction_view.currentPage).runtimeCache.timelineControl,a=i.hashFlag(e);return"timeline"==e[0].id?(a=n.hashMap[a].alias,t=n.hashMap[a].timeline):t=n.hashMap[a]?n.hashMap[a].timeline:i.createNewLine(e,a),t},runAction:function(e,t){if(e instanceof TimelineLite)switch(t){case"play":e.play();break;case"pause":e.pause();break;case"reverse":e.elements.forEach(function(e){$(e).filter(".hide").removeClass("hide"),$(e).find(".hide").removeClass("hide")}),e.reverse();break;case"stop":e.pause(0);break;case"restart":e.play(0)}},createNewLine:function(e,t){var i=interaction_view.getPage(interaction_view.currentPage),n=animateTimeline.generateTimeline({onStart:null,ids:e,iPage_id:interaction_view.currentPage,page:interaction_view.getPage(interaction_view.currentPage),paused:!0,foraction:!0});return i.runtimeCache.timelineControl.hashMap[t]={list:e,timeline:n},n},hashFlag:function(e){var t=e.reduce(function(e,t){var n=""+t.id.slice(-6)+t.page_id.slice(-6);for(i=0;i<n.length;i++)char=n.charCodeAt(i),e=(e<<5)+e+char;return e},5381);return t}}}),define("interaction_view/actionexecutes/timelinecontrol/timelinecontrol",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:200,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0].values,n=t.results[0].ani_iType;if(i&&i.length&&n){for(var a=t.results[0].ani_duration,r=t.results[0].ani_delay,o=t.results[0].ani_repeat,s=[],l=0;l<i.length;l++){var c=i[l],d=c.page_id,h=interaction_view.getAnimationPage(d,e.model.page),u=h.iOverlaylist.get(c.id);if(u&&u.iview&&u.iview.$el){var p={el:u.iview.$el.children(".Element"),type:n,delay:r,duration:a,repeat:o,onShow:u.iview.onShow};s.push(p)}}if(s.length){var f=new Animate({items:s,className:"child_Action_Element",autoClear:!0,onStart:function(){if(e.executeactions&&e.executeactions.length)for(var t=0;t<e.executeactions.length;t++){var i=e.executeactions[t];"cssanimatestart"==i.attributes.iDetail.customType&&i.iview.executeAction(i.iview)}},onEnd:function(){if(e.executeactions&&e.executeactions.length)for(var t=0;t<e.executeactions.length;t++){var i=e.executeactions[t];"cssanimateend"==i.attributes.iDetail.customType&&i.iview.executeAction(i.iview)}}});f.play();var h=interaction_view.ipagelist.getPage(interaction_view.currentPage);h.css_timelines&&h.css_timelines.length||(h.css_timelines=[]),h.css_timelines.push(f)}}},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/cssanimateaction/cssanimateaction",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:404,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0],n=i.overlay;if(n){var a=interaction_view.getParentpage(n.page_id);if(a){var r=a.iOverlaylist.get(n.id);if(r){var o,s,l=(r.iview.$el,interaction_view.expression.id2values(i.duration)),c=!1,d={};if((i.positionlimit||i.sizelimit||i.skewlimit||i.rotatelimit)&&(s=interaction_view.transform.getState(r),console.log(s),o={position:{},size:{},transform:{}}),i.position){if(s)var h=s.size.width/2,u=s.size.height/2;else var p=interaction_view.transform.getSize(r),h=p.width/2,u=p.height/2;var f,v;if(i.position_x){var g=interaction_view.expression.id2values(i.position_x);0==i.selectx?(f=g+h,o&&(o.position.x=f)):1==i.selectx?(f="+="+g,o&&(o.position.x=s.position.x+g)):(f="-="+g,o&&(o.position.x=s.position.x-g))}if(i.position_y){var m=interaction_view.expression.id2values(i.position_y);0==i.selecty?(v=m+u,o&&(o.position.y=v)):1==i.selecty?(v="+="+m,o&&(o.position.y=s.position.y+m)):(v="-="+m,o&&(o.position.y=s.position.y-m))}if(i.position_y||i.position_x){if(i.positionlimit){var w={x:h,y:u},_=["x","y"];for(var y in _)void 0!=i[_[y]+"max"]&&void 0!=o.position[_[y]]&&(o.position[_[y]]-w[_[y]]<=i[_[y]+"max"]||("x"==_[y]?f=void 0:v=void 0)),void 0!=i[_[y]+"min"]&&void 0!=o.position[_[y]]&&(o.position[_[y]]-w[_[y]]>=i[_[y]+"min"]||("x"==_[y]?f=void 0:v=void 0))}if(d.position||(d.position={}),(i.selectx>0||i.selecty>0)&&(d.position.oper=!0),void 0==f&&void 0==v)return;d.position.x=f,d.position.y=v,c=!0}}if(i.size){d.size={};var b;if(b=s?{width:s.size.width,height:s.size.height}:interaction_view.transform.getSize(r),i.itemwidth){var x=Number(interaction_view.expression.id2values(i.itemwidth));i.selectwidth&&0!=i.selectwidth?1==i.selectwidth?(x=b.width+x,o&&(o.size.width=x)):(x=b.width-x,o&&(o.size.width=x)):(i.selectwidth="0",o&&(o.size.width=x))}else x=void 0;if(i.itemheight){var S=Number(interaction_view.expression.id2values(i.itemheight));i.selectheight&&0!=i.selectheight?1==i.selectheight?(S=b.height+S,o&&(o.size.height=S)):(S=b.height-S,
o&&(o.size.height=S)):(i.selectheight="0",o&&(o.size.height=S))}else S=void 0;if(d.size.width=x,d.size.height=S,i.sizelimit){var _=["width","height"];for(var y in _)void 0!=i[_[y]+"max"]&&void 0!=o.size[_[y]]&&(o.size[_[y]]<=i[_[y]+"max"]||(d.size[_[y]]=void 0)),void 0!=i[_[y]+"min"]&&void 0!=o.size[_[y]]&&(o.size[_[y]]>=i[_[y]+"min"]||(d.size[_[y]]=void 0))}}if(i.rotate){if(i.changex){var C=Number(interaction_view.expression.id2values(i.changex));0==i.rotatex?(i.rotatex="0",o&&(o.transform.changex=C)):1==i.rotatex?(o&&(o.transform.changex=s.transform.rotationX+C),C="+="+C):(o&&(o.transform.changex=s.transform.rotationX-C),C="-="+C)}else C=void 0;if(i.changey){var T=Number(interaction_view.expression.id2values(i.changey));0==i.rotatey?(i.rotatey="0",o&&(o.transform.changey=T)):1==i.rotatey?(o&&(o.transform.changey=s.transform.rotationY+T),T="+="+T):(o&&(o.transform.changey=s.transform.rotationY-T),T="-="+T)}else T=void 0;if(i.changez){var k=Number(interaction_view.expression.id2values(i.changez));0==i.rotatez?(i.rotatez="0",o&&(o.transform.changez=k)):1==i.rotatez?(o&&(o.transform.changez=s.transform.rotation+k),k="+="+k):(o&&(o.transform.changez=s.transform.rotation-k),k="-="+k)}else k=void 0;if(i.rotatelimit){var _=["changex","changey","changez"];for(var y in _)void 0!=i[_[y]+"max"]&&void 0!=o.transform[_[y]]&&(o.transform[_[y]]<=i[_[y]+"max"]||("changex"==_[y]?C=void 0:"changey"==_[y]?T=void 0:k=void 0)),void 0!=i[_[y]+"min"]&&void 0!=o.transform[_[y]]&&(o.transform[_[y]]>=i[_[y]+"min"]||("changex"==_[y]?C=void 0:"changey"==_[y]?T=void 0:k=void 0))}(i.rotatex||i.rotatey||i.rotatez)&&(d.transform||(d.transform={}),d.transform.rotationX=C,d.transform.rotationY=T,d.transform.rotation=k)}if(i.skew){if(i.skewx){var P=Number(interaction_view.expression.id2values(i.skewx));i.skewxoper&&0!=i.skewxoper?1==i.skewxoper?(o&&(o.transform.skewx=s.transform.skewX+P),P="+="+P):(o&&(o.transform.skewx=s.transform.skewX-P),P="-="+P):i.skewxoper="0"}else P=void 0;if(i.skewy){var E=Number(interaction_view.expression.id2values(i.skewy));i.skewyoper&&0!=i.skewyoper?1==i.skewyoper?(o&&(o.transform.skewy=s.transform.skewY+E),E="+="+E):(o&&(o.transform.skewy=s.transform.skewY-E),E="-="+E):i.skewyoper="0"}else E=void 0;if(i.skewlimit){var _=["skewx","skewy"];for(var y in _)void 0!=i[_[y]+"max"]&&void 0!=o.transform[_[y]]&&(o.transform[_[y]]<=i[_[y]+"max"]||("skewx"==_[y]?P=void 0:E=void 0)),void 0!=i[_[y]+"min"]&&void 0!=o.transform[_[y]]&&(o.transform[_[y]]>=i[_[y]+"min"]||("skewx"==_[y]?P=void 0:E=void 0))}(i.skewx||i.skewy)&&(d.transform||(d.transform={}),d.transform.skewX=P,d.transform.skewY=E)}d.transform&&(d.transform.transformOrigin=i.xcenter+"% "+i.ycenter+"%");var D={duration:l,ease:i.animate};if(c){var I={page_id:r.page.id,overlay_id:r.id,layer_id:r.attributes.layer_id};r.page.id||(I.layer_id=r.page.iOverlaylist.layerid),D.onUpdate=interaction_view.events.onDragging,D.onUpdateParams=[I]}interaction_view.transform.setState(r,d,D)}}}},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/elementproperty/elementproperty",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:201,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0],n=new dboperate(i);n.init(function(t){if(e.executeactions.length)for(var i=0;i<e.executeactions.length;i++){var n=e.executeactions[i];"dboperatesuccess"==n.attributes.iDetail.customType&&n.iview.executeAction(n.iview)}})},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/datalist/datalist",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:301,exec:function(e,t,i){var n=e.model.get("iDetail"),a=n.results[0].values,r=_g.uuid(2);DB.Cache.addSwitch(r);var o=function(e){var t=this,i=_g.uuid(2),n=new Queue({continuous:!1,onComplete:function(){t.done()}}),a=_.filter(interaction_view.events.conditionEvents,function(t){return t.overlay_id!=e.id?!1:t.page_id==e.page_id});if(a.length>0){for(var r={},o=0;o<a.length;o++)r[a[o].condition]||(r[a[o].condition]=[]),r[a[o].condition].push(a[o]);var s=[],l=[];for(var c in r){l.push(r[c]);var d=interaction_view.expression.doCondition(c);s.push(d)}s.length?(DB.Cache.addSwitch(i),promise.join(s).then(function(e){for(var a=0;a<e.length;a++)for(var r=l[a],o=0;o<r.length;o++)r[o].result=e[a],e[a][0]&&r[o].func(n);n.length()?n._exec():t.done(),DB.Cache.closeSwitch(i)})):t.done()}else t.done()};if(a&&a.length)for(var s=0;s<a.length;s++)t.add(o,a[s],{debug:i});DB.Cache.closeSwitch(r)}}}),define("interaction_view/actionexecutes/condition/condition",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:204,exec:function(e,t,i,n){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0],n={};if(n.config=i.config,i.state&&i.state.id){if(interaction_view.imasterlist.models[0]&&interaction_view.imasterlist.models[0].iOverlaylist.get(i.state.id))n.page=interaction_view.imasterlist.models[0],n.group=n.page.iOverlaylist.get(i.state.id);else if(interaction_view.ibackgroundlist.models[0]&&interaction_view.ibackgroundlist.models[0].iOverlaylist.get(i.state.id))n.page=interaction_view.ibackgroundlist.models[0],n.group=n.page.iOverlaylist.get(i.state.id);else if(interaction_view.ibackgroundlist.models[0]&&interaction_view.ipagelist.getPage(i.state.page_id)&&interaction_view.ipagelist.getPage(i.state.page_id).iOverlaylist.get(i.state.id))n.page=interaction_view.ipagelist.getPage(i.state.page_id),n.group=n.page.iOverlaylist.get(i.state.id);else{if(!e.model.page.iOverlaylist.get(i.state.id))return;n.page=e.model.page,n.group=n.page.iOverlaylist.get(i.state.id)}var a=new window.stategroup(n);a.render(),n.group.state=a,n.group.iview.state=a}else;},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/state/state",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:202,exec:function(e,t){var i=e.model.get("iDetail"),n=i.results[0].values,a=function(){var t=this,i=new Queue({continuous:!1,onComplete:function(){if(e.executeactions.length)for(var i=0;i<e.executeactions.length;i++){var n=e.executeactions[i];"onRefreshSuccess"==n.attributes.iDetail.customType&&n.iview.executeAction(n.iview)}t.done()}});_.each(n,function(e){console.log(e);var t=null;switch(e.type){case"page":t=interaction_view.ipagelist.getPage(e.page_id);break;case"master":t=interaction_view.imasterlist.models[0];break;case"background":t=interaction_view.ibackgroundlist.models[0]}if(t){var n=t.iOverlaylist.get(e.id),a=function(){n.iview.refresh(this)};i.add(a)}}),i._exec()};t.add(a),console.log("执行刷新")},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/refresh/refresh",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:203,exec:function(e,t,i){var n=e.model.attributes.iDetail.results[0],a=n.image_url;n.uploadImgWay;if(a){var r=function(){n.uploadImgWay&&"1"==n.uploadImgWay||interaction_view.forceUpload?n.isOriginWork&&1==n.isOriginWork?o(e,!0):o(e,!1):interaction_view.isWeixin&&"undefined"!=typeof wx_permissions&&wx_permissions.chooseImage?interaction_view.weixin.chooseimage(function(t){if(t&&t[0]){interaction_view.localIds=t;var i=t[0];if(e.executeactions.length)for(var n=0;n<e.executeactions.length;n++){var r=e.executeactions[n];"onUploadStart"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview)}interaction_view.imageUploader(i,function(t){if(interaction_view.expression.setValue(a,t),e.executeactions.length)for(var i=0;i<e.executeactions.length;i++){var n=e.executeactions[i];"onUploadEnd"==n.attributes.iDetail.customType&&n.iview.executeAction(n.iview)}})}}):n.isOriginWork&&1==n.isOriginWork?o(e,!0):o(e,!1)},o=function(e,t){$("body").append("<input type='file' id='image' name='image' accept='image/*' style='display:none;'>"),$("#image").click();var i=context_url+"uploadimage";$("#image").off("change").on("change",function(){if(e.executeactions.length)for(var n=0;n<e.executeactions.length;n++){var r=e.executeactions[n];"onUploadStart"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview)}var o=document.createElement("canvas");$(this).append(o),o.id="clipboarda",$("#clipboarda").hide();var l,c=document.getElementById("clipboarda"),d=c.getContext("2d"),h=this.files[0],u=h.type;if(h){EXIF.getData(h,function(){EXIF.getAllTags(this),l=EXIF.getTag(this,"Orientation")});var p=new FileReader,f=new Image;p.readAsDataURL(h),p.onload=function(n){var r=n.target.result;if(t){var o={};if(1!=l&&l)f.src=r,f.onload=function(){var t=f.width,n=f.height;switch(l){case 6:c.setAttribute("width",n+"px"),c.setAttribute("height",t+"px"),d.rotate(90*Math.PI/180),d.drawImage(f,0,-n,t,n);break;case 8:c.setAttribute("width",n+"px"),c.setAttribute("height",t+"px"),d.rotate(-90*Math.PI/180),d.drawImage(f,-t,0,t,n);break;case 3:c.setAttribute("width",t+"px"),c.setAttribute("height",n+"px"),d.rotate(180*Math.PI/180),d.drawImage(f,-t,-n,t,n)}var r=c.toDataURL(u),s=_g.fileapi.base64urltoBase64(r),h=_g.fileapi.b64toBlob({b64Data:s});o.url=i,o.blob=h,o.filekey="image",o.callback=function(t){var i=t.data.results[0];if(console.log(i),interaction_view.expression.setValue(a,i),e.executeactions.length)for(var n=0;n<e.executeactions.length;n++){var r=e.executeactions[n];"onUploadEnd"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview)}},_g.fileapi.sendBinary(o)};else{var h=_g.fileapi.base64urltoBase64(r),p=_g.fileapi.b64toBlob({b64Data:h});o.url=i,o.blob=p,o.filekey="image",o.callback=function(t){var i=t.data.results[0];if(console.log(i),interaction_view.expression.setValue(a,i),e.executeactions.length)for(var n=0;n<e.executeactions.length;n++){var r=e.executeactions[n];"onUploadEnd"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview)}},_g.fileapi.sendBinary(o)}}else f.src=r,f.onload=function(){var t=f.width,n=f.height,r={},o=s(t,n);switch(l){case 6:c.setAttribute("width",o.newH+"px"),c.setAttribute("height",o.newW+"px"),d.rotate(90*Math.PI/180),d.drawImage(f,0,-o.newH,o.newW,o.newH);break;case 8:c.setAttribute("width",o.newH+"px"),c.setAttribute("height",o.newW+"px"),d.rotate(-90*Math.PI/180),d.drawImage(f,-o.newW,0,o.newW,o.newH);break;case 3:c.setAttribute("width",o.newW+"px"),c.setAttribute("height",o.newH+"px"),d.rotate(180*Math.PI/180),d.drawImage(f,-o.newW,-o.newH,o.newW,o.newH);break;default:c.setAttribute("width",o.newW+"px"),c.setAttribute("height",o.newH+"px"),d.drawImage(f,0,0,o.newW,o.newH)}var h=c.toDataURL(u),p=_g.fileapi.base64urltoBase64(h),v=_g.fileapi.b64toBlob({b64Data:p});r.url=i,r.blob=v,r.filekey="image",r.callback=function(t){var i=t.data.results[0];if(console.log(i),interaction_view.expression.setValue(a,i),e.executeactions.length)for(var n=0;n<e.executeactions.length;n++){var r=e.executeactions[n];"onUploadEnd"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview)}},_g.fileapi.sendBinary(r),$("#clipboarda").remove()}}}})},s=function(e,t){var i,n=750/1206,a=e/t;return 750>e&&1206>t?i={newW:e,newH:t}:e>=750&&1206>t?i={newW:750,newH:750/a}:750>e&&t>=1206?i={newH:1206,newW:1206*a}:e>=750&&t>=1206&&(i=a>n?{newW:750,newH:750/a}:{newH:1206,newW:1206*a}),i};t.immediate(r,null,{debug:i})}},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/uploadimage/uploadimage",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:302,exec:function(e,t,i,n){function a(e){var t=new promise.Promise,i=Number(e.oper),n=_.find(d,function(t){return t.id==e.id});switch(i){case 0:1==e.type?interaction_view.expression.id2values(e.value,function(i){var n=c.find("[es-id="+e.id+"]");n.length&&(_.include(["div"],n[0].tagName.toLowerCase())?n.css("background-image","url("+i+")"):_.include(["img"],n[0].tagName.toLowerCase())?n.attr("src",i):_.include(["h1","h2","h3","h4","h5","h6","p"],n[0].tagName.toLowerCase())&&n.text(i)),t.done()},{$contentGridRow:c}):interaction_view.expression.id2values(e.value,function(e){n.initial=e,t.done()},{$contentGridRow:c});break;case 1:interaction_view.expression.id2values(e.value,function(e){0==n.iKind&&(n.initial=Number(n.initial)),n.initial+=e,t.done()},{$contentGridRow:c});break;case 2:interaction_view.expression.id2values(e.value,function(e){0==n.iKind&&(n.initial=Number(n.initial)),n.initial-=e,t.done()},{$contentGridRow:c});break;case 3:var a=interaction_view.setRandom(n);n.initial=a,t.done()}return t}function r(e){var t=interaction_view.ipagelist.getPage(interaction_view.currentPage).iOverlaylist.get(e);return t||(t=interaction_view.imasterlist.models[0].iOverlaylist.get(e)),t||(t=interaction_view.ibackgroundlist.models[0].iOverlaylist.get(e)),t?t.iview:void 0}var o=e.model.get("iDetail"),s=o.results[0].values,l=r(s.id);if(n.$dom)var c=n.$dom;if(4==s.type)t.add(function(t){var i=this,a=new Queue({continuous:!1,onComplete:function(){i.done()}}),r=_.filter(interaction_view.events.conditionEvents,function(i){return i.overlay_id==e.model.attributes.overlay_id&&_.contains(t.conditions,i.cond_id)?i.page_id==e.model.attributes.page_id:!1});if(r.length>0){for(var o={},s=0;s<r.length;s++)o[r[s].condition]||(o[r[s].condition]=[]),o[r[s].condition].push(r[s]);var l=[],c=[];for(var d in o){c.push(o[d]);var h=interaction_view.expression.doCondition(d,{$dom:n.$dom});l.push(h)}l.length?promise.join(l).then(function(e){for(var t=0;t<e.length;t++)for(var r=c[t],o=0;o<r.length;o++)r[o].result=e[t],e[t][0]&&r[o].func(a,{$dom:n.$dom});a.length()?a._exec():i.done()}):i.done()}else i.done()},s,{debug:i});else if(3==s.type){var d=c.data("variables");t.add(function(e){var t=this,i=[];_.each(e.variables,function(e,t){i.push(a(e))}),i.length?promise.join(i).then(function(e){t&&t.done()}):t&&t.done()},s,{debug:i})}else t.immediate(function(){var i=c.data("value");s&&(0==s.type?_.each(s.fields,function(a,r){if(a&&(interaction_view.expression.setValue(a,i[r]),e.executeactions.length))for(var r=0;r<e.executeactions.length;r++){var o=e.executeactions[r];"onSuccess"==o.attributes.iDetail.customType&&o.iview.executeAction(o.iview,t,{$dom:n.$dom})}}):1==s.type?interaction_view.expression.getDataById(l.model.attributes.iDetail.db_id,l.model.attributes.iDetail.query_id,i.id,function(i){if(c.data("value",i.data.results[0]),c.find("[es-bind=1]").each(function(e,t){l.bindData($(t),i.data.results[0])}),e.executeactions.length)for(var a=0;a<e.executeactions.length;a++){var r=e.executeactions[a];"onSuccess"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview,t,{$dom:n.$dom})}}):2==s.type&&(0==s.show?_.each(s.show_ids,function(e,t){c.find("[es-id="+e+"]").show()}):_.each(s.show_ids,function(e,t){c.find("[es-id="+e+"]").hide()})))},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/contentGrid/contentGrid",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:303,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0],n=i.overlay;if(n){var a=interaction_view.getParentpage(n.page_id);if(a){var r=a.iOverlaylist.get(n.id);if(r){var o=e.model.attributes.iDetail.results[0].image_url;if(i.oper)switch(Number(i.oper)){case 1:console.log("转成图片");var s=r.iview.$el.find("canvas").first()[0],l=s.toDataURL(),c=_g.fileapi.base64urltoBase64(l),d=_g.fileapi.b64toBlob({b64Data:c}),h=context_url+"uploadimage";_g.fileapi.sendBinary({blob:d,url:h,filekey:"image",filename:"canvas图片"+_g.uuid(1),callback:function(t){try{var i=t.data.results[0];o&&interaction_view.expression.setValue(o,i)}catch(n){}if(e.executeactions.length)for(var a=0;a<e.executeactions.length;a++){var r=e.executeactions[a];"onPaletteSuccess"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview)}}});break;case 2:var u=i.palette_action_size;if(0===u||u){var u=interaction_view.expression.id2values(u);r.iview.$el.find(".el_wrap").children().eraser("size",u)}break;case 3:var p=i.palette_action_color;i.palette_eraser?r.iview.$el.find(".el_wrap").children().eraser("setmode",0):(r.iview.$el.find(".el_wrap").children().eraser("setmode",1),p&&r.iview.$el.find(".el_wrap").children().eraser("color",p));break;case 4:i.palette_action_active;i.palette_action_active?(r.iview.$el.find(".el_wrap").children().eraser("enable"),r.iview.$el.children(".Element").addClass("disableDragX disableDragY")):(r.iview.$el.find(".el_wrap").children().eraser("disable"),r.iview.$el.children(".Element").removeClass("disableDragX disableDragY"));break;case 5:r.iview.$el.find(".el_wrap").children().eraser("clear")}}}}},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/palette/palette",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:403,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0],n=i.overlay;if(n&&n.length)for(var a=0;a<n.length;a++){var r=n[a],o=interaction_view.getParentpage(r.page_id);if(!o)return;var s=o.iOverlaylist.get(r.id);if(!s)return;if(i.oper)switch(Number(i.oper)){case 1:i.gyroscope_action_active;i.gyroscope_action_active?s.disabled=!1:s.disabled=!0}}},null,{debug:i})}}}),define("interaction_view/actionexecutes/gyroscope/gyroscope",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:205,exec:function(e){function t(e,t){var i=_.filter(l,function(e){return"Anchor"==e.get("iType")});if(s.anchorIndex+=parseInt(e),s.anchorIndex<0)return void(s.anchorIndex=0);if(s.anchorIndex>i.length-1)return void(s.anchorIndex=i.length-1);t&&(s.anchorIndex=0);var n=i[s.anchorIndex],a=$("section#"+o).find("#"+n.id)[0]._gsTransform.y-$("section#"+o+" #"+n.id+" .Element").height()/2;return a}var i,n,a=e.model.get("iDetail"),r=a.results[0].scrollTo,o=interaction_view.currentPage,s=interaction_view.ipagelist.getPage(o),l=s.iOverlaylist.models,c=$("section#"+o+" .interaction-view").height(),d=interaction_view.doc.get("height");if(interaction_view.ipagelist.getPage(o).iview.scrollview){switch(_.isUndefined(s.anchorIndex)&&(s.anchorIndex=0,n=!0),r){case"0":i=c-d;break;case"1":i=0;break;case"2":var h=a.results[0].toEl;if(!h)return;var u=$("section#"+o);i=u.find("#"+h)[0]._gsTransform.y-u.find("#"+h+" .Element").height()/2;var p=_.filter(l,function(e){return e.id==h})[0];if("Anchor"==p.get("iType")){var f=_.filter(l,function(e){return"Anchor"==e.get("iType")});s.anchorIndex=f.indexOf(p),console.log(s.anchorIndex)}break;case"3":i=t("1",n);break;case"4":i=t("-1")}i===+i&&(d>=c-i&&(i=c-d),interaction_view.ipagelist.getPage(o).iview.scrollview._scrollTo(0,"-"+i))}},setExecuteActions:function(e,t,i){}}}),define("interaction_view/actionexecutes/pagescroll/pagescroll",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:512,exec:function(e,t,i){t.immediate(function(){function t(e){var t=function(e,t){return e.toJSON().zIndex-t.toJSON().zIndex};e.sort(t);for(var i=0;i<e.length;i++)C.push(e[i])}function i(e){var t=e.toJSON().iCommon.landscape;e.isMasterOverlay||e.isBackgroundOverlay?(t.iStartx=interaction_view.transform.getState(e).position.x-interaction_view.transform.getState(e).size.width/2-Reveal.marginLeft,t.iStarty=interaction_view.transform.getState(e).position.y-interaction_view.transform.getState(e).size.height/2-Reveal.marginTop):(t.iStartx=interaction_view.transform.getState(e).position.x-interaction_view.transform.getState(e).size.width/2,t.iStarty=interaction_view.transform.getState(e).position.y-interaction_view.transform.getState(e).size.height/2);var i=e.toJSON().iDetail.init_rotation,s=e.iview.zIndex,l=e.toJSON().iDetail.init_opacity,c=e.toJSON().iDetail;e._scale&&(t._x=parseFloat(e._x),t._y=parseFloat(e._y),t._scale=parseFloat(e._scale)),_.include(["Avatar"],e.toJSON().iType)?n(e,N,R,t,i,s,l,c):_.include(["ImageBlock","Image","CycleImage","Gallery","Slide","qrcode"],e.toJSON().iType)?c.effect&&2==c.effect?a(e,N,R,t,i,s,l,c):r(e,N,R,t,i,s,l,c):_.include(["Paragraph"],e.toJSON().iType)&&o(e,N,R,t,i,s,l,c)}function n(e,t,i,n,a,r,o,l){var c=e.toJSON().iDetail.iNickname,d=$(e.iview.el).find(".thumb"),h=$(e.iview.el).find(".iTextLabel"),u=Number(h.width())*g,p=Number(h.parent()[0]._gsTransform.x)+Number(h.css("left").replace("px","")),f=Number(h.parent()[0]._gsTransform.y)+Number(h.css("top").replace("px","")),v=Number(h.css("line-height").replace("px","")),m=Number(h.css("font-size").replace("px",""))*g+"px",w=h.css("font-weight"),_=h.css("font-family").split(",")[2],y={borderColor:d.css("border-color"),borderWidth:Number(d.css("border-width").replace("px",""))*g,borderStyle:d.css("border-style"),borderRadius:Number(d.css("border-radius").replace("px",""))*g,background:d.css("background"),"background-size":d.css("background-size")},b={left:Number(n.iStartx)*g,top:Number(n.iStarty)*g,width:Number(n.iWidth)*g,height:Number(n.iHeight)*g},S=new Image,C=d.css("background-image").replace(/url\((.*)\)/,"$1").replace(/"/g,"");interaction_view.setCrossOrigin(S,C),S.src=C;var T=p*g,k=f*g;i.save(),i.translate(b.left+b.width/2,b.top+b.height/2),i.rotate(a*Math.PI/180);var P;"center"===h.css("text-align")?P=T+u/2-b.width/2:"left"===h.css("text-align")||"justify"===h.css("text-align")?P=-(b.width/2-T):"right"===h.css("text-align")&&(P=T+u-b.width/2);var E=Number(k-b.height/2),D=h.text();if(i.globalAlpha=o,c&&(i.font=w+" "+m+" "+_,i.fillStyle=h.css("color"),"center"===h.css("text-align")?i.textAlign="center":"left"===h.css("text-align")||"justify"===h.css("text-align")?i.textAlign="left":"right"===h.css("text-align")&&(i.textAlign="right"),i.textBaseline="middle",i.fillText(D,P,E+v*g/2)),b.width==b.height&&y.borderRadius>b.width/2&&y.borderRadius>b.height/2)i.beginPath(),i.arc(0,0,b.width/2,0,2*Math.PI,!1),i.lineWidth=2*y.borderWidth,i.clip();else{var I,O=-b.width/2,A=-b.height/2,N=b.width,R=b.height;y.borderRadius>b.height/2?I=b.height/2:y.borderRadius<=b.height/2&&(I=y.borderRadius),i.beginPath(),i.moveTo(O+I,A),i.arcTo(O+N,A,O+N,A+R,I),i.arcTo(O+N,A+R,O,A+R,I),i.arcTo(O,A+R,O,A,I),i.arcTo(O,A,O+N,A,I),i.lineWidth=2*y.borderWidth,i.clip()}S.complete?(i.drawImage(S,-(b.width/2)+y.borderWidth,-(b.height/2)+y.borderWidth,b.width-2*y.borderWidth,b.height-2*y.borderWidth),i.strokeStyle=y.borderColor,i.stroke(),i.restore(),x++,s()):S.onload=function(){i.drawImage(S,-(b.width/2)+y.borderWidth,-(b.height/2)+y.borderWidth,b.width-2*y.borderWidth,b.height-2*y.borderWidth),i.strokeStyle=y.borderColor,i.stroke(),i.restore(),x++,s()}}function a(e,t,i,n,a,r,o,l){var t=e.iview.$el.find(".el_wrap").find("canvas")[0],c=Number(n.iStartx)*g,d=Number(n.iStarty)*g,h=Number(n.iWidth)*g,u=Number(n.iHeight)*g;i.save(),i.globalAlpha=o,i.translate(c+h/2,d+u/2),i.rotate(a*Math.PI/180),i.drawImage(t,-h/2,-u/2),i.restore(),x++,s()}function r(e,t,i,n,a,r,o,l){var c,d,h,u,p,f=!1;h="Slide"==e.toJSON().iType||"CycleImage"==e.toJSON().iType?e.iview.$el.find(".slidecontent"):e.iview.$el.find(".el_wrap");var v,m={borderWidth:Number(h.css("border-width").replace("px",""))*g,borderColor:h.css("border-color"),borderRadius:Number(h.css("border-radius").replace("px",""))*g,borderStyle:h.css("border-style")},w=new Image;if("none"!=h.css("background-image")&&void 0!=h.css("background-image"))v=h.css("background-image").match(/url\(\"?(.[^"]*)\"?\)/)[1];else if("CycleImage"==e.toJSON().iType){var _=e.iview.currentIndex;v=e.iImgs[_].src}else{if(0==$(e.iview.el).find("img").length)return x++,void s();if("Slide"==e.toJSON().iType){var y=e.iview.currentSlideIndex;v=$(e.iview.el).find("img").eq(y).attr("src")}else v=$(e.iview.el).find("img").attr("src")}interaction_view.setCrossOrigin(w,v),w.src=v,l.iImgMask&&l.iImgMaskUrl&&(u=l.iImgMaskUrl,p=l.iImgMask_data,d=new Image,d.src=u),-1!=w.src.indexOf("svg")&&(f=2==e.toJSON().iDetail.iDisplay?2:1),c=new Image,interaction_view.setCrossOrigin(c,w.src),c.src=w.src;var b,S=Number(n.iStartx)*g,C=Number(n.iStarty)*g,T=Number(n.iWidth)*g,k=Number(n.iHeight)*g,P=(T-2*m.borderWidth)/T,E=(k-2*m.borderWidth)/k;if(b=Math.min(T,k)/2<m.borderRadius?Math.min(T,k)/2:m.borderRadius,i.save(),i.globalAlpha=o,i.translate(S+T/2,C+k/2),i.rotate(a*Math.PI/180),i.beginPath(),i.moveTo(-(T/2-b),-k/2),i.arcTo(T/2,-k/2,T/2,k/2,b),i.arcTo(T/2,k/2,-T/2,k/2,b),i.arcTo(-T/2,k/2,-T/2,-k/2,b),i.arcTo(-T/2,-k/2,T/2,-k/2,b),i.strokeStyle="rgba(0,0,0,0)",i.clip(),e._scale||e._x||e._y||e._rotate)if(c.complete){var D=c.height/c.width,I=T*Number(e._scale),O=I*D,A=0,N=-(k/2-O/2/Number(e._scale));i.translate(A,N),i.rotate(Number(e._rotate)*Math.PI/180),i.translate(Number(e._x)*Number(e._scale)*g,Number(e._y)*Number(e._scale)*g),i.drawImage(c,-I*P/2,-O*P/2,I*P,O*P),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s()}else c.onload=function(){var t=c.height/c.width,n=T*Number(e._scale),a=n*t,r=0,o=-(k/2-a/2/Number(e._scale));i.translate(r,o),i.rotate(Number(e._rotate)*Math.PI/180),i.translate(Number(e._x)*Number(e._scale)*g,Number(e._y)*Number(e._scale)*g),i.drawImage(c,-n*P/2,-a*P/2,n*P,a*P),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s()};else if(1!=e.toJSON().iDetail.iDisplay&&1!=f)if(2!=e.toJSON().iDetail.iDisplay&&2!=f)if(c.complete)if(l.iMask){var R=l.iMask_data;i.drawImage(c,-T*P/2+R.x*g,-k*E/2+R.y*g,R.width*g*P,R.height*g*E),i.globalCompositeOperation="destination-in",i.fillStyle="red",i.fillRect(-T/2,-k/2,T,k),i.restore(),x++,s()}else if(l.iImgMask&&l.iImgMaskUrl){u=l.iImgMaskUrl,p=l.iImgMask_data,d=new Image,interaction_view.setCrossOrigin(d,u);var M=Number(p.width)/Number(p.height),L=M.toFixed(1);d.onload=function(){if(-1!=d.src.indexOf("svg")){var e,t,n=d.width/d.height,a=n.toFixed(1);L>=a?(e=p.height*g,t=e*n):(t=p.width*g,e=t/n)}else t=p.width*g,e=p.height*g;var r=document.createElement("canvas");$("body").append(r),r.id="canvasp",r.width=T*P,r.height=k*E,$("#canvasp").hide();var o=document.querySelector("#canvasp"),l=o.getContext("2d");l.drawImage(c,0,0,T*P,k*E),l.globalCompositeOperation="destination-in",l.drawImage(d,p.x*g+(p.width*g-t)/2,p.y*g+(p.height*g-e)/2,t,e),0!=m.borderWidth&&(l.lineWidth=2*m.borderWidth,l.strokeStyle=m.borderColor);var h=o.toDataURL("image/png"),u=new Image;interaction_view.setCrossOrigin(u,h),u.onload=function(){i.drawImage(u,-T*P/2,-k*E/2,T*P,k*E),i.restore(),$("#canvasp").remove(),x++,s()},u.src=h},d.src=u}else i.drawImage(c,-T*P/2,-k*E/2,T*P,k*E),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s();else c.onload=function(){if(l.iMask){var e=l.iMask_data;i.drawImage(c,-T*P/2+e.x*g,-k*E/2+e.y*g,e.width*g*P,e.height*g*E),i.globalCompositeOperation="destination-in",i.fillStyle="red",i.fillRect(-T/2,-k/2,T,k),i.restore(),x++,s()}else if(l.iImgMask&&l.iImgMaskUrl){u=l.iImgMaskUrl,p=l.iImgMask_data,d=new Image,interaction_view.setCrossOrigin(d,u);var t=Number(p.width)/Number(p.height),n=t.toFixed(1);d.onload=function(){if(-1!=d.src.indexOf("svg")){var e,t,a=d.width/d.height,r=a.toFixed(1);n>=r?(e=p.height*g,t=e*a):(t=p.width*g,e=t/a)}else t=p.width*g,e=p.height*g;var o=document.createElement("canvas");$("body").append(o),o.id="canvasp",o.width=T*P,o.height=k*E,$("#canvasp").hide();var l=document.querySelector("#canvasp"),h=l.getContext("2d");h.drawImage(c,0,0,T*P,k*E),h.globalCompositeOperation="destination-in",h.drawImage(d,p.x*g+(p.width*g-t)/2,p.y*g+(p.height*g-e)/2,t,e),0!=m.borderWidth&&(h.lineWidth=2*m.borderWidth,h.strokeStyle=m.borderColor);var u=l.toDataURL("image/png"),f=new Image;interaction_view.setCrossOrigin(f,u),f.onload=function(){i.drawImage(f,-T*P/2,-k*E/2,T*P,k*E),i.restore(),$("#canvasp").remove(),x++,s()},f.src=u},d.src=u}else i.drawImage(c,-T*P/2,-k*E/2,T*P,k*E),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s()};else{var F=Number(n.iHeight)/Number(n.iWidth),W=F.toFixed(1);if(c.complete){var B=c.height/c.width,j=B.toFixed(1);if(j>=W)var z=T-2*m.borderWidth,U=z*B;else var U=k-2*m.borderWidth,z=U/B;i.drawImage(c,-z/2,-U/2,z,U),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s()}else c.onload=function(){var e=c.height/c.width,t=e.toFixed(1);if(t>=W)var n=T-2*m.borderWidth,a=n*e;else var a=k-2*m.borderWidth,n=a/e;i.drawImage(c,-n/2,-a/2,n,a),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s()}}else{var F=Number(n.iWidth)/Number(n.iHeight),W=F.toFixed(1);if(c.complete){var B=c.width/c.height,j=B.toFixed(1);if(W>=j)var U=k-2*m.borderWidth,z=U*B;else var z=T-2*m.borderWidth,U=z/B;i.drawImage(c,-z/2,-U/2,z,U),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s()}else c.onload=function(){var e=c.width/c.height,t=e.toFixed(1);if(W>=t)var n=k-m.borderWidth*g,a=n*e;else var a=T-2*m.borderWidth,n=a/e;i.drawImage(c,-a/2,-n/2,a,n),0!=m.borderWidth&&(i.lineWidth=2*m.borderWidth,i.strokeStyle=m.borderColor),i.stroke(),i.restore(),x++,s()}}}function o(e,t,i,n,a,r,o,c){var h=e.toJSON().iDetail.iText,u=e.iview.$el.find(".iText").children().length;e.iview.$el.find(".iText .iContent").length>0&&(u=e.iview.$el.find(".iText .iContent").children().length);var p=e.iview.$el.find(".el_wrap"),f={"font-size":p.css("font-size"),"background-color":p.css("background-color"),"font-family":p.css("font-family"),color:p.css("color"),"border-width":p.css("border-width"),"border-color":p.css("border-color"),"text-align":p.css("text-align"),"line-height":p.css("line-height"),"padding-top":p.css("padding-top"),"padding-left":p.css("padding-left"),"font-weight":p.css("font-weight"),"border-radius":p.css("border-radius")},v=e.toJSON().iDetail.iStyle.split(";");if(1==u||0==u){var m=e.toJSON().iDetail.iText.replace("<div>","").replace("</div>","");l(m,t,Number(n.iStartx)*g,Number(n.iStarty)*g,Number(n.iWidth)*g,v,n,a,f)}else d(t,h,Number(n.iStartx)*g,Number(n.iStarty)*g,Number(n.iWidth)*g,v,n,a,f);x++,s()}function s(){if(0===C.length||x!=C.length)return void(x<C.length&&i(C[x]));var t,n=$("canvas#clipboard")[0];if(0==k){try{t=n.toDataURL("image/webp")}catch(a){interaction_view.errorAlert(a)}if(b&&interaction_view.expression.setValue(b,t),$("#clipboard").remove(),e.executeactions.length)for(var r=0;r<e.executeactions.length;r++){var o=e.executeactions[r];"onClipBoardSuccess"==o.attributes.iDetail.customType&&o.iview.executeAction(o.iview)}}else{try{t=n.toDataURL("image/png")}catch(a){interaction_view.errorAlert(a)}var s=_g.fileapi.base64urltoBase64(t),l=_g.fileapi.b64toBlob({b64Data:s}),c=context_url+"uploadimage";_g.fileapi.sendBinary({blob:l,url:c,filekey:"image",filename:"canvas图片"+_g.uuid(1),callback:function(t){var i=t.data.results[0];if(b&&interaction_view.expression.setValue(b,i),$("#clipboard").remove(),e.executeactions.length)for(var n=0;n<e.executeactions.length;n++){var a=e.executeactions[n];
"onClipBoardSuccess"==a.attributes.iDetail.customType&&a.iview.executeAction(a.iview)}}})}}function l(e,t,i,n,a,r,o,s,l){var c=/([\[\]\,.?"'\(\)+_*\/\\&\$#^@!%~`<>:;\{\}？，。·！……（）+｛｝【】、|《》])/gi,d=t.getContext("2d"),h=Number(l["font-size"].replace("px",""))*g+"px",u=l["font-family"].split(",")[2],p=l["font-weight"],f=0;d.font=p+" "+h+" "+u,d.fillStyle=l.color,d.textBaseline="top",d.textAlign="left",d.lineHeight=l["line-height"],l["text-align"]&&("center"==l["text-align"]?d.textAlign="center":"right"==l["text-align"]&&(d.textAlign="right"));var v=0,m=0,w=0,_=i,y=/(\d+\.?\d*)px/,b=Number(l["padding-left"].match(y)[1]),x=Number(l["padding-top"].match(y)[1]),S=Number(l["line-height"].match(y)[1]),h=Number(l["font-size"].match(y)[1]),C=n+x*g,T=Number(l["border-radius"].replace("px",""))*g;if(0!=s){if(d.save(),d.translate(Number(o.iStartx)*g+Number(o.iWidth)*g/2,Number(o.iStarty)*g+Number(o.iHeight)*g/2),d.rotate(s*Math.PI/180),"0px"!=l["border-width"]){var k,P=Number(o.iWidth)*g,E=Number(o.iHeight)*g,v=Number(l["border-width"].replace("px",""))*g;k=Math.min(P,E)/2<T?Math.min(P,E)/2:T,d.moveTo(-(P/2-k),-E/2),d.arcTo(P/2,-E/2,P/2,E/2,k),d.arcTo(P/2,E/2,-P/2,E/2,k),d.arcTo(-P/2,E/2,-P/2,-E/2,k),d.arcTo(-P/2,-E/2,P/2,-E/2,k),d.beginPath(),d.moveTo(-(P/2-k-v/2+v/2),-(E/2-v/2)),d.arcTo(P/2-v/2,-(E/2-v/2),P/2-v/2,E/2-v/2,k-v/2),d.arcTo(P/2-v/2,E/2-v/2,-(P/2-v/2),E/2-v/2,k-v/2),d.arcTo(-(P/2-v/2),E/2-v/2,-(P/2-v/2),-(E/2-v/2),k-v/2),d.arcTo(-(P/2-v/2),-(E/2-v/2),P/2-v/2,-(E/2-v/2),k-v/2),d.lineWidth=v,d.strokeStyle=l["border-color"],d.stroke()}var D=-(Number(o.iWidth)*g/2);D="center"==d.textAlign?D+a/2+v:"right"==d.textAlign?D+a-b*g+v:D+b*g+v;var I=-(Number(o.iHeight)*g/2+Number(o.iStarty*g))+Number(C)+v;if(d.measureText(e[0]).width>a)for(var $=1;$<=e.length;$++)f++,d.fillText(e.substring(w,$),D,I),I+=S*g,m=0,w=$;else for(var $=0;$<e.length;$++)m+=d.measureText(e[$]).width,m>=a-2*b*g-2*v&&(c.test(e[$])?(f++,d.fillText(e.substring(w,$-1),D,I),I+=S*g,m=0,w=$-1,$-=2):(f++,d.fillText(e.substring(w,$),D,I),I+=S*g,m=0,w=$,$-=1)),$==e.length-1&&(f++,d.fillText(e.substring(w,$+1),D,I));return d.restore(),[n,f]}if("0px"!=l["border-width"]){var k,O=Number(o.iStartx)*g,A=Number(o.iStarty)*g,P=Number(o.iWidth)*g,E=Number(o.iHeight)*g,v=Number(l["border-width"].replace("px",""))*g;k=Math.min(P,E)/2<T?Math.min(P,E)/2:T,d.beginPath(),d.moveTo(O+k-v/2+v/2,A+v/2),d.arcTo(O+P-v/2,A+v/2,O+P-v/2,A+E-v/2,k-v/2),d.arcTo(O+P-v/2,A+E-v/2,O+v/2,A+E-v/2,k-v/2),d.arcTo(O+v/2,A+E-v/2,O+v/2,A+v/2,k-v/2),d.arcTo(O+v/2,A+v/2,O+P-v/2,A+v/2,k-v/2),d.lineWidth=v,d.strokeStyle=l["border-color"],d.stroke(),C+=v,i+=v,a-=2*v}if(_="center"==d.textAlign?i+a/2:"right"==d.textAlign?i+a-b*g:i+b*g,d.measureText(e[0]).width>a)for(var $=1;$<=e.length;$++)f++,d.fillText(e.substring(w,$),_,C),C+=S*g,m=0,w=$;else for(var $=0;$<e.length;$++)m+=d.measureText(e[$]).width,m>=a-2*b*g&&(c.test(e[$])?(f++,d.fillText(e.substring(w,$-1),_,C),C+=S*g,m=0,w=$-1,$-=2):(f++,d.fillText(e.substring(w,$),_,C),C+=S*g,m=0,w=$,$-=1)),$==e.length-1&&(f++,d.fillText(e.substring(w,$+1),_,C));return[n,f]}function c(e){var t=new Array;return e=e.replace(/<div>/g,""),t=e.split("</div>")}function d(e,t,i,n,a,r,o,s,d){var h=e.getContext("2d"),u=Number(d["font-size"].replace("px",""))*g+"px",p=d["font-family"].split(",")[0],f=d["font-weight"];h.font=f+" "+u+" "+p,h.fillStyle=d.color;var v=c(t),m=Number(d["line-height"].replace("px",""))*g;-Number(o.iHeight);if(0!=s)for(var w=0;w<v.length;w++){var _=l(v[w],e,i,n,a,r,o,s,d);n=_[0];var y=_[1];n+=m*y}else for(var w=0;w<v.length;w++){var _=l(v[w],e,i,n,a,r,o,s,d);n=_[0];var y=_[1];n+=m*y}}var h=e.model.get("iDetail"),u=h.results[0],p=u.overlay;if(p){var f=interaction_view.getParentpage(p.page_id);if(f){var v=f.iOverlaylist.get(p.id);if(v){var g=2,m=$("div[id='"+p.id+"'][data-type='ClipBoard']").first(),w=document.createElement("canvas");m.append(w),w.id="clipboard",$("#clipboard").hide();var y=v.toJSON().iDetail.chooseElement,b=e.model.attributes.iDetail.results[0].image_url,x=0,S={};S.overlaylist=[],S.masterpage=[],S.background=[];var C=[],T={},k=v.toJSON().iDetail.need_file,P=v.toJSON().iDetail.clipboard_area,E=v.toJSON().iCommon.landscape;if(v.toJSON().iDetail.iStyle)for(var D=v.toJSON().iDetail.iStyle.replace(/\-/g,"_").split(";"),I=0;I<D.length;I++){var O=D[I].split(":");T[$.trim(O[0])]=$.trim(O[1])}P?($(w).css({"margin-top":Number(E.iStarty)*g,"margin-left":Number(E.iStartx)*g}),w.width=Number(E.iWidth)*g,w.height=Number(E.iHeight)*g):(w.width=Number(interaction_view.size.x)*g,interaction_view.ipagelist.getPage(interaction_view.currentPage).get("height")?w.height=Number(interaction_view.ipagelist.getPage(interaction_view.currentPage).get("height"))*g:w.height=Number(interaction_view.size.y)*g);for(var I=0;I<y.length;I++){var A=f.iOverlaylist.get(y[I].id);A&&!A.iview.$el.hasClass("hide")?S.overlaylist.push(A):interaction_view.imasterlist.at(0).iOverlaylist.get(y[I].id)?(A=interaction_view.imasterlist.at(0).iOverlaylist.get(y[I].id),A&&!A.iview.$el.hasClass("hide")&&S.masterpage.push(A)):interaction_view.ibackgroundlist.at(0).iOverlaylist.get(y[I].id)&&(A=interaction_view.ibackgroundlist.at(0).iOverlaylist.get(y[I].id),A&&!A.iview.$el.hasClass("hide")&&S.background.push(A))}S.background&&S.background.length&&t(S.background),S.overlaylist&&S.overlaylist.length&&t(S.overlaylist),S.masterpage&&S.masterpage.length&&t(S.masterpage);var N=document.getElementById("clipboard"),R=N.getContext("2d");if(P){if(T.border_top_style&&(T.border_top_width||T.border_top_left_radius)){var M=Number(T.border_top_left_radius.replace("px",""))*g,L=Number(E.iWidth)*g,F=Number(E.iHeight)*g;M>Math.min(Number(E.iWidth)*g/2,Number(E.iHeight)*g/2)&&(M=Math.min(Number(E.iWidth)*g/2,Number(E.iHeight)*g/2)),R.beginPath(),R.moveTo(M,0),R.arcTo(L,0,L,F,M),R.arcTo(L,F,0,F,M),R.arcTo(0,F,0,0,M),R.arcTo(0,0,L,0,M),T.background_color&&(R.fillStyle=T.background_color,R.fill()),R.strokeStyle=T.border_top_color||"black",R.lineWidth=Number(T.border_top_width.replace("px",""))*g*2||1,R.clip(),R.stroke()}R.translate(-Number(E.iStartx)*g,-Number(E.iStarty)*g)}C.length&&i(C[0])}}}},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/clipboard/clipboard",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:505,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0],n=i.overlay;if(n){var a=interaction_view.getParentpage(n.page_id);if(a){var r=a.iOverlaylist.get(n.id);if(r){var o=interaction_view.expression.id2values(i.url),s=function(e){r.iview.$el.find("img").length&&(r.iview.$el.find("img")[0].crossOrigin=null,r.iview.$el.find("img")[0].src=e.toDataURL("image/png"))},l=$("<div></div>");if(l.qrcode({render:"canvas",text:o,width:r.iview.$el.find(".el_wrap").width(),height:r.iview.$el.find(".el_wrap").height()}),s(l.find("canvas")[0]),e.executeactions.length)for(var c=0;c<e.executeactions.length;c++){var d=e.executeactions[c];"onQrcodeSuccess"==d.attributes.iDetail.customType&&d.iview.executeAction(d.iview)}}}}},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/qrcode/qrcode",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:520,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0];Epub.PlayerSDK.sendMessage("control",{action:i.iActionDetail.action,index:i.iActionDetail.index||0})},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/cc/cc",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:214,exec:function(e,t,i){t.immediate(function(){var t=e.getdetail().results[0].cms,i=interaction_view.currentPage;CMS.toPage(t,i)},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/coolsitecms/cms",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:"actionGroup",exec:function(e,t,i){t.immediate(function(){_.each(e.executeactions,function(e,i){e.iview.executeAction(e.iview,t)})})},setExecuteActions:function(e,t,i){e.executeactions=[];var n=e.model.get("iDetail").results[0].values;if(n&&n.length)for(var a=0;a<n.length;a++){var r=interaction_view.getPage(n[a].page_id),o=r.iActionlist.models.filter(function(e){return 99==e.attributes.iType&&"actionGroup"==e.attributes.iDetail.customType&&e.attributes.overlay_id==n[a].id});_.each(o,function(t,i){e.executeactions.push(t)})}}}}),define("interaction_view/actionexecutes/actionGroup/actionGroup",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:215,exec:function(e,t,i){t.immediate(function(){interaction_view.face.uploadImg(e,function(){if(e.executeactions.length)for(var t=0;t<e.executeactions.length;t++){var i=e.executeactions[t];"facesuccess"==i.attributes.iDetail.customType&&i.iview.executeAction(i.iview)}},function(){if(e.executeactions.length)for(var t=0;t<e.executeactions.length;t++){var i=e.executeactions[t];"facefail"==i.attributes.iDetail.customType&&i.iview.executeAction(i.iview)}})},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/face/face",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:530,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0].values;if(i){var n,a,r;if(n=interaction_view.getParentpage(i.page_id)){if(a=n.iOverlaylist.get(i.id),!a)return;r=a.toJSON().iDetail.iImg}else{if(!interaction_view.ilayerlist)return;n=interaction_view.ilayerlist.get(i.page_id);var o=_.find(n.overlays,function(e){return e.id==i.id});if(!o)return;r=o.iDetail.iImg}for(var s=[],l=0;l<r.length;l++)s.push(r[l].picture);window.epubsdk.previewImage(s[0],s)}},null,{debug:i})}}}),define("interaction_view/actionexecutes/previewImage/previewImage",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:535,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail").results[0];shareTitle=t.momentsShare?interaction_view.expression.id2values(t.momentsShare):shareTitle,msgTitle=t.forwardTitle?interaction_view.expression.id2values(t.forwardTitle):msgTitle,msgContent=t.forwardInfo?interaction_view.expression.id2values(t.forwardInfo):msgContent,imgUrl=t.forwardThumbnail?interaction_view.expression.id2values(t.forwardThumbnail):imgUrl,interaction_view.weixin.share()},null,{debug:i})}}}),define("interaction_view/actionexecutes/weixinshareinfo/weixinshareinfo",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:540,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail").results[0],i=t.transfertitle?interaction_view.expression.id2values(t.transfertitle):"";console.log(i),interaction_view.foredit||(document.title=i)},null,{debug:i})}}}),define("interaction_view/actionexecutes/settitle/settitle",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:531,exec:function(e,t,i){t.immediate(function(){console.log(e,t,i);var n=e.model.get("iDetail"),a=n.results[0],r=a.overlay;if(r){var o=interaction_view.getParentpage(r.page_id);if(o){var s=o.iOverlaylist.get(r.id);if(s){var l,c=s.toJSON().iDetail.iImg,d=_.pluck(c,"picture"),h=s.iview.$el,u=(s.toJSON().iCommon.landscape,s.toJSON().iDetail.pipType),p=[],f=n.results[0].iActionDetail.mode;if(!s.toJSON().iDetail.pipAutoPlay)if(s.iview.isInit){l=0==u?3*Number(c[1].pip_data.curPicSpeed)/10:3*Number(c[0].pip_data.curPicSpeed)/10;for(var v=0;v<d.length;v++)p.push(interaction_view.iImgs[d[v]]);var g=p.length,m=h.find("canvas")[0],w=m.getContext("2d");0==f?(s.iview.calculateData(u,c,l,w,m,p,g),s.iview.play(u,c,l,w,m,p,g)):s.iview.pause(u,c,l,w,m,p,g)}else s.iview.init(function(){l=0==u?3*Number(c[1].pip_data.curPicSpeed)/10:3*Number(c[0].pip_data.curPicSpeed)/10;for(var e=0;e<d.length;e++)p.push(interaction_view.iImgs[d[e]]);var t=p.length,i=h.find("canvas")[0],n=i.getContext("2d");0==f?(s.iview.calculateData(u,c,l,n,i,p,t),s.iview.play(u,c,l,n,i,p,t)):s.iview.pause(u,c,l,n,i,p,t)})}}}},null,{debug:i})}}}),define("interaction_view/actionexecutes/pip/pip",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"gyroscope_change",func:function(e,t){console.log(t),e.view.overlaymodel.eventsHandle.push(e)}}}),define("interaction_view/actions/gyroscope/gyroscope",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"customtypeaction",func:function(e,t){console.log(t),alert(t)}}}),define("interaction_view/actions/demo/demo",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:301,func:function(e,t){var i={iPage_id:e.view.model.iPage_id,page_id:e.view.page_id,overlay_id:e.view.overlay_id,layer_id:e.view.layer_id,func:e.func};t.init&&(i.type=301,i.condition=String(e.view.model.attributes.condition),i.title=e.view.model.attributes.iDetail.title||i.condition,e.view.model.attributes.iDetail.cond_id&&(i.cond_id=e.view.model.attributes.iDetail.cond_id),interaction_view.events.conditionEvents.push(i))}}}),define("interaction_view/actions/condition/condition",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"anchor",func:function(e,t){var i={page_id:e.view.page_id,overlay_id:e.view.overlay_id,layer_id:e.view.layer_id,func:e.func,overlaymodel:e.view.overlaymodel};if(i.layer_id&&i.overlaymodel.iview.$el.closest(".layer-mask").data("has-anchor",!0),console.log("进入触发状态"),t.init){i.type="anchor",i.condition=String(e.view.model.attributes.condition);var n={},a=i.condition.split("_");n.baseline={"视窗左边线":"left","视窗上边线":"top","视窗右边线":"right","视窗下边线":"bottom","视窗中心":"center"}[a[0]]||"center",n.baselineDirection="center","center"!=n.baseline&&(n.baselineDirection=["left","right"].includes(n.baseline)?"x":"y"),n.baselineOffset=Number(a[1])||0,n.triggerDirection={"向左滚动接触时":"left","向上滚动接触时":"up","向右滚动接触时":"right","向下滚动接触时":"down","接触时":"any"}[a[2]]||"any",n.noRepeat=Boolean(+a[3])||!1;var r=i.overlaymodel.iview.common;n.anchorPos={x:r.iStartx,y:r.iStarty},i.config=n,interaction_view.events.scrollEvents.push(i)}}}}),define("interaction_view/actions/anchor/anchor",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"onStartPlay",func:function(e,t){console.log(t);var i={page_id:e.view.page_id,overlay_id:e.view.overlay_id,layer_id:e.view.layer_id,func:e.func};t.init&&(i.type="onStartPlay",interaction_view.events.mediaEvents.push(i))}}}),define("interaction_view/actions/mediaaction/onstartplay",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"onEnded",func:function(e,t){console.log(t);var i={page_id:e.view.page_id,overlay_id:e.view.overlay_id,layer_id:e.view.layer_id,func:e.func};t.init&&(i.type="onEnded",interaction_view.events.mediaEvents.push(i))}}}),define("interaction_view/actions/mediaaction/onended",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"onRender",func:function(e,t){var i={page_id:e.view.page_id,overlay_id:e.view.overlay_id,layer_id:e.view.layer_id,func:e.func};t.init&&(i.type="onRender",i.title=e.view.model.attributes.iDetail.title,interaction_view.events.contentGridRenderEvents.push(i))}}}),define("interaction_view/actions/contentGrid/contentGrid",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"onPaintStart",func:function(e,t){console.log(t),e.view.overlaymodel.paintStartEvents.push(e)}}}),define("interaction_view/actions/palette/palette",function(){});var pipAction=[{type:"onPipStart",event:"pipStartAction"},{type:"onPipFinish",event:"pipFinishAction"},{type:"inCurPip",event:"inCurPipAction"},{type:"outCurPip",event:"outCurPipAction"}];if(pipAction.forEach(function(e){epub360.PlayerPlugins.push({type:"action",config:{type:e.type,func:function(t,i){var n={page_id:t.view.page_id,overlay_id:t.view.overlay_id,layer_id:t.view.layer_id,func:t.func,overlaymodel:t.view.overlaymodel,d:t,type:e.type};interaction_view.events[e.event].push(n)}}})}),define("interaction_view/actions/pip/pip",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:206,exec:function(e,t,i){t.immediate(function(){if(_g.device.isWeixin())if(interaction_view.weixin.voiceauth(),"undefined"!=typeof wx_permissions&&wx_permissions.startRecord&&wx){var t=!0;wx.startRecord({success:function(){if(t||wx.stopRecord({}),e.executeactions.length)for(var i=0;i<e.executeactions.length;i++){var n=e.executeactions[i];"onStartRecordSuccess"==n.attributes.iDetail.customType&&n.iview.executeAction(n.iview)}},cancel:function(){interaction_view.errorAlert("开启微信录音功能失败")}}),wx.onVoiceRecordEnd({complete:function(t){t.localId;if(e.executeactions.length)for(var i=0;i<e.executeactions.length;i++){var n=e.executeactions[i];"onVoiceRecordEnd"==n.attributes.iDetail.customType&&n.iview.executeAction(n.iview)}}})}else interaction_view.errorAlert("微信JS接口未生效，无法微信录音。");else interaction_view.errorAlert("请在微信环境中操作")},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/weixinvoice/startrecord",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:207,exec:function(e,t,i){t.immediate(function(){_g.device.isWeixin()?(interaction_view.weixin.voiceauth(),"undefined"!=typeof wx_permissions&&wx_permissions.startRecord&&wx?wx.stopRecord({success:function(t){if(interaction_view.voicelocalId=t.localId,e.executeactions.length)for(var i=0;i<e.executeactions.length;i++){var n=e.executeactions[i];"onStopRecordSuccess"==n.attributes.iDetail.customType&&n.iview.executeAction(n.iview)}},fail:function(e){interaction_view.errorAlert("停止微信录音操作失败")}}):interaction_view.errorAlert("微信JS接口未生效，无法进行微信录音操作。")):interaction_view.errorAlert("请在微信环境中操作")},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/weixinvoice/stoprecord",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:208,exec:function(e,t,i){t.immediate(function(){_g.device.isWeixin()?(interaction_view.weixin.voiceauth(),"undefined"!=typeof wx_permissions&&wx_permissions.startRecord&&wx?interaction_view.voicelocalId?(wx.playVoice({localId:interaction_view.voicelocalId}),wx.onVoicePlayEnd({success:function(t){if(e.executeactions.length)for(var i=0;i<e.executeactions.length;i++){var n=e.executeactions[i];"onVoicePlayEnd"==n.attributes.iDetail.customType&&n.iview.executeAction(n.iview)}}})):interaction_view.errorAlert("还没有录音，无法播放！"):interaction_view.errorAlert("微信JS接口未生效，无法进行播放录音操作。")):interaction_view.errorAlert("请在微信环境中操作")},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/weixinvoice/playvoice",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:210,exec:function(e,t,i){t.immediate(function(){_g.device.isWeixin()?(interaction_view.weixin.voiceauth(),"undefined"!=typeof wx_permissions&&wx_permissions.startRecord&&wx?interaction_view.voicelocalId?wx.stopVoice({localId:interaction_view.voicelocalId}):interaction_view.errorAlert("还没有录音，无法停止播放！"):interaction_view.errorAlert("微信JS接口未生效，无法停止播放录音操作。")):interaction_view.errorAlert("请在微信环境中操作")},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/weixinvoice/stopvoice",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:213,exec:function(e,t,i){t.immediate(function(){var t=e.model.get("iDetail"),i=t.results[0];if(_g.device.isWeixin()){interaction_view.weixin.voiceauth();var n=e.model.attributes.iDetail.results[0].voice_text;if(!n)return;"undefined"!=typeof wx_permissions&&wx_permissions.translateVoice&&wx?interaction_view.voicelocalId?wx.translateVoice({localId:interaction_view.voicelocalId,isShowProgressTips:1,success:function(t){var a=t.translateResult;if(1==i.isRemovePunctuation&&-1!=a.indexOf("。")&&(a=a.replace("。","")),interaction_view.expression.setValue(n,a),e.executeactions.length)for(var r=0;r<e.executeactions.length;r++){var o=e.executeactions[r];"onTranslateVoiceSuccess"==o.attributes.iDetail.customType&&o.iview.executeAction(o.iview)}}}):interaction_view.errorAlert("还没有录音，无法进行语音识别！"):interaction_view.errorAlert("微信JS接口未生效，无法进行语音识别操作。")}else interaction_view.errorAlert("请在微信环境中操作")},null,{debug:i})},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),r=new interaction_view.model.Action(a);r.iview.render(),e.executeactions.push(r)}}}}),define("interaction_view/actionexecutes/weixinvoice/translatevoice",function(){}),function(){function e(e){var t=null,i={valueOf:function(){return t}};if("function"==typeof e){var n=function(){e(),t=requestAnimationFrame(n)};n()}return i}function t(e){cancelAnimationFrame(e)}function i(e,t,i){return i=void 0!=i?Math.abs(i):1e-6,e==t||Math.abs(e-t)<i}function n(e,t){return k=e.findIndex(function(e){return 0!=e}),t[k]*Math.sign(e[k])}function a(e){e=e||6;for(var t,i="";e;)t=e>8?8:e,i+=Math.random().toString(36).slice(-t),e-=t;return i}function r(e){for(var t=e.list,i=e.list.length,n=e.start,a=e.end,r=end=null,o=0;i>o;o++)if(t[o]>n){r=o;break}for(var o=r;i>o;o++)if(t[o]>a){end=o;break}return end=null==end?i:end,[r,end]}function o(e,t){for(var i=e.length,n=t[0],a=t[1],r=0;i>r;r++)r>=n&&a>r?e[r].style.display="block":e[r].style.display="none"}function s(e,t){return Math.min(Math.max(e,t[0]),t[1])}function i(e,t,i){return i=void 0!=i?Math.abs(i):1e-6,e==t||Math.abs(e-t)<i}window.setRaf=e,window.clearRaf=t;var l={type:"LayerRound",title:"走马灯"};"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(null!=a)for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])}return i},writable:!0,configurable:!0});var c=-1,d=function(){var e=arguments[0];e.$el.children(".Element").find(".layer-content").children(".layer-item").length&&(this.initBasicData.apply(this,arguments),this.calcItemsData(),this.mappingStamps(),this.initStage(),this.modeling(),this.showRangedOnly(),this.timeSensor=new TimeSensor,this.touchSensor=new h,this.orientSensor=new u,this.panoRafFn=this.panoRafFn.bind(this),this.setting.draggable&&(this.PanoTouchEvent=this.createPanoTouchEvent()),this.autoPlay())};Object.assign(d.prototype,{autoPlay:function(){(this.setting.autoPlay||this.setting.orientable)&&(this.setting.autoPlay&&(this.status.currentProgress=0,this.status.rawSpeed=this.setting.playSpeed),this.setting.orientable&&this.orientSensor.turnOn(),this.updateStatus("slip"),this.timeSensor.delta,this.flag.panoRafId=requestAnimationFrame(this.panoRafFn),this.status.flagProgress=this.status.currentProgress)},initBasicData:function(e){this.type=l.type,this.name=l.title,this.uid=l.type+"-"+a();var t=e.getdetail();this.setting={draggable:t.iRoundDraggable,orientable:t.iRoundUseSensor,autoPlay:t.iRoundAutoPlay,playSpeed:t.iAutoPlaySpeed,useInitialSpacing:t.iUseInitialDegree,initialSpacing:t.iInitialDegree,chirality:t.iRoundChirality,axiaProfile:t.iRoundAxiaProfile},c={normal:1,invert:-1}[this.setting.chirality],this.config={directionY:-1,renderRange:3e3,renderCount:20,dragSpeedRatio:100,movedCheckRange:100,kProgress:.04},this.$el=e.$el,this.$dest=this.$el.children(".Element").find(".layer-content"),this.viewObject=e,this.info={layerIdList:t.layer_ids,deltaSpacingMap:t.degreeMap,progressStampList:[]},this.C3dObject={},this.status={currentProgress:0,currentScopeIndex:0,lastViewStampIndex:0,goneStampIndex:-1,destStampIndex:0,destProgress:0,triggered:{itemEvent:!1,endEvent:!1},status:"stop",lastStatus:"stop",played:!1},this.flag={panoRafId:null}},prefixTouch:function(){var e=this.$el.children(".Element");e.find(".layer-item").children().css({"pointer-events":"initial"}),e.find(".layer-item").css({"pointer-events":"none"}),e.find(".layer-bg").css({"pointer-events":"none"}),e.addClass("disableDragX disableDragY")},calcItemsData:function(){var e=this.$dest,t=this.info.deltaSpacingMap,i=Array.prototype.map.call(e.children(".layer-item"),function(e){var i=$(e).data("id"),n=$(e);n.css({opcaity:"0.3"});var a=interaction_view.ilayerlist.get(i).toJSON();return{$el:n,deltaSpacing:t[i],width:a.layer_width,height:a.layer_height,layerId:i}});this.setting.useInitialSpacing&&(i[0].deltaSpacing=this.setting.initialSpacing),this.info.panoModelInfoList=i,this.info.layerIdList=i.map(function(e){return e.layerId}),this.calcItemsData2()},calcItemsData2:function(){function e(e,t,i,n,a){var r=n/t,o=t/e/(n/i);o>1&&(r*=o),r=1/r,i*=r,n*=r;var s=e/2,l=t/2,c=e/2-i/2,d=t/2-n/2;return c=c*{left:-1,right:1}[a]||0,d=d*{top:-1,bottom:1}[a]||0,{renderW:i/r,renderH:n/r,scale:r,destW:e,destH:t,positionX:(s+c)/r,positionY:(l+d)/r,position:a}}this.C3dConfig={};var t=this.$dest.width(),i=this.$dest.height(),n=this.info.panoModelInfoList[0].width,a=this.info.panoModelInfoList[0].height,r=this.setting.axiaProfile,o=e(t,i,n,a,r);this.C3dConfig.scale=o.scale,this.C3dConfig.destW=o.destW,this.C3dConfig.destH=o.destH,this.C3dConfig.renderW=o.renderW,this.C3dConfig.renderH=o.renderH,-1!=["top","bottom"].indexOf(r)?this.C3dConfig.radius=o.renderH/2:this.C3dConfig.radius=o.renderW/2,Object.assign(this.C3dConfig,{right:{axiaX:o.destW/2,axiaRotateZ:0,vectorDrag:[-1,0],vectorOrient:[0,0,-1]},top:{axiaX:o.destH/2,axiaRotateZ:-90,vectorDrag:[0,1],vectorOrient:[0,-1,0]},left:{axiaX:o.destW/2,axiaRotateZ:-180,vectorDrag:[1,0],vectorOrient:[0,0,1]},bottom:{axiaX:o.destH/2,axiaRotateZ:-270,vectorDrag:[0,-1],vectorOrient:[0,1,0]}}[r]),this.C3dConfig.modelRotateZ=-this.C3dConfig.axiaRotateZ,this.C3dConfig.perspectiveOrigin=r,this.C3dConfig.position=r}}),Object.assign(d.prototype,{mappingStamps:function(e,t){var i=0;this.info.progressStampList=this.info.panoModelInfoList.map(function(e){return i+=e.deltaSpacing}),this.info.viewStampList=this.info.progressStampList,this.info.progressLength=i;for(var n=this.info.viewStampList,a=[],r=1;r<n.length;r++)a.push((n[r]+n[r-1])/2);a.push(i+1),this.info.progressRightScopeStampList=a,this.calcItemsData3()},calcItemsData3:function(){}}),Object.assign(d.prototype,{initStage:function(){var e=this.$dest,t=(new C3D.Stage).size(e.width(),e.height()).update();$(t.el).css({"z-index":1}),e.append(t.el),this.C3dObject.iStage=t},modeling:function(){function e(e,t){var i=1/180*Math.PI,n=t*i;return[Math.sin(n)*e,Math.cos(n)*e]}for(var t=this.info.progressStampList,i=(this.info.viewStampList,this.info.panoModelInfoList),n=(this.C3dConfig.scale,this.C3dConfig.radius),a=(this.C3dConfig.modelRotateZ,new C3D.Sprite),r=0;r<i.length;r++){var o=i[r].$el;o.children("*").filter(function(e,t){return!$(t).hasClass(".hide")}).each(function(e,t){t.style.transform=t.style.transform+"translateZ("+.1*c*e+"px)"});var s=e(n,t[r]),l=new C3D.Plane({el:o[0]}).size(o.width(),o.height()).position(-s[1],0,-s[0]).rotate(0,-t[r],this.C3dConfig.modelRotateZ).update();a.addChild(l)}window.addEventListener("keydown",function(e){var t=10;e.keyCode=="Q".charCodeAt()&&(a.z-=t,a.update()),e.keyCode=="E".charCodeAt()&&(a.z+=t,a.update()),e.keyCode=="W".charCodeAt()&&(a.y-=t,a.update()),e.keyCode=="S".charCodeAt()&&(a.y+=t,a.update()),e.keyCode=="A".charCodeAt()&&(a.x-=t,a.update()),e.keyCode=="D".charCodeAt()&&(a.x+=t,a.update())});var d=1/180*Math.PI,h=this.C3dObject.iStage,u=h.camera.fov=35;h.update(),h.el.style.perspectiveOrigin=this.C3dConfig.position;var p=1/Math.tan(u/2*d)/2;a.position(this.C3dConfig.axiaX,0,-this.C3dConfig.renderH*p).scale(1,1,1*c),a.update(),h.addChild(a),this.C3dObject.iSprite=a,h.camera.rotate(0,0,-this.C3dConfig.axiaRotateZ),h.update(),this.info.$layers=this.$dest.find(".layer-item")},showRangedOnly:function(){o.call(this,this.info.$layers,r({list:this.info.progressStampList,start:this.status.currentProgress-89,end:this.status.currentProgress+89,count:this.config.renderCount}))}}),Object.assign(d.prototype,{createPanoTouchEvent:function(){var e=this,t=new AlloyFinger(e.$el[0],{touchStart:function(e){cancelAnimationFrame(this.flag.panoRafId),this.flag.panoRafId=requestAnimationFrame(this.panoRafFn),this.status.flagProgress=this.status.currentProgress,this.updateStatus("drag"),this.status.rawSpeed=null,this.orientSensor.turnOff()}.bind(e),touchEnd:function(e){this.status.flagProgress=this.status.currentProgress,this.timeSensor.refresh(),this.orientSensor.turnOn(),this.updateStatus("slip")}.bind(e)});this.PanoTouchEvent=t},initOrientEvent:function(){this.sensorStart(),this.orientRafId=requestAnimationFrame(this.orientRafFn)},orientRafFn:function(){var e=e||this,t=e._pano;t.sensorSpeed=this.sensor.deltaPoint[1]/-1,"stop"==this._pano.status&&this.startMoving(),e.sensorRafId=requestAnimationFrame(e.sensorRafFn)},sensorStart:function(){this.orientSensor=new u,this.orientSensor.turn("on")},updateStatus:function(e){this.status.lastStatus=this.status.status,this.status.status=e},stopMoving:function(){cancelAnimationFrame(this.flag.panoRafId),this.updateStatus("stop"),this.updatePanoRender()},panoRafFn:function(){this.flag.panoRafId=requestAnimationFrame(this.panoRafFn),this.updatePanoData()},updatePanoData:function(){var e;this.status.lastProgress=this.status.currentProgress;var t=this.status.status,i=n(this.C3dConfig.vectorDrag,[this.touchSensor.deltaX,this.touchSensor.deltaY])*c,a=n(this.C3dConfig.vectorDrag,[this.touchSensor.speedX,this.touchSensor.speedY])*c,r=this.setting.orientable?n(this.C3dConfig.vectorOrient,this.orientSensor.deltaPoint):0,o=this.timeSensor.delta;"drag"==t?(e=this.status.flagProgress+i*this.config.directionY*this.config.kProgress,this.status.currentProgress=e):"slip"==t&&(e=this.status.currentProgress,e+=this.status.rawSpeed?this.status.rawSpeed/1e3*o:a*o*this.config.directionY*this.config.kProgress,e+=r*c*3/1e3*o||0),e=s(e,[0,this.info.progressLength]),this.status.currentProgress=e,this.status,this.dispatchCurrentEvent(this.status.lastProgress,this.status.currentProgress),this.dispatchSelfEvent(this.status.lastProgress,this.status.currentProgress),"drag"!=this.status.status&&this.status.lastProgress==e,this.updatePanoRender()},updatePanoRender:function(){this.C3dObject.iSprite.rotationY=this.status.currentProgress*c,this.C3dObject.iSprite.updateT(),this.showRangedOnly()}}),Object.assign(d.prototype,{dispatchCurrentEvent:function(e,t){var n,a,r=(this.status.viewIndex,this.status.goneIndex);n=this.info.progressRightScopeStampList.findIndex(function(e){return e>t}),a=this.info.progressStampList.findIndex(function(e){
return e+90+.5>t})-1,this.status.viewIndex=n,this.status.goneIndex=a,this.status.lastViewIndex==n&&i(this.status.currentProgress,this.info.progressStampList[n],10)||(this.status.itemEvented=!1,this.status.lastViewIndex=n),i(this.status.currentProgress,this.info.progressStampList[n],e-t)&&this.triggerIntoItem(),a>r&&this.triggerGoneItem()},dispatchSelfEvent:function(e,t){0==e&&t>0&&this.triggerStartPlay(),e<this.info.progressLength&&t==this.info.progressLength&&this.triggerEndPlay(),t<this.info.progressLength-10&&(this.status.endEvented=!1)},triggerStartPlay:function(){this.status.startEvented||(this.status.startEvented=!0,interaction_view.events.onLongTakeStart(this.viewObject,{}))},triggerEndPlay:function(){this.status.endEvented||(this.status.endEvented=!0,interaction_view.events.onLongTakeEnd(this.viewObject,{}))},triggerIntoItem:function(){if(!this.status.itemEvented){this.status.itemEvented=!0;var e=this.info.layerIdList[this.status.viewIndex];if(void 0!=e){var t={ref_id:this.viewObject.model.id,layer_id:e,page_id:this.viewObject.model.iPageId};interaction_view.events.onLTLayerInto(t)}}},triggerGoneItem:function(){this.triggerGoneItem=_.debounce(function(){var e=this.info.layerIdList[this.status.goneIndex];if(void 0!=e){var t={ref_id:this.viewObject.model.id,layer_id:e,page_id:this.viewObject.model.iPageId};interaction_view.events.onLTLayerGone(t)}},20,!0),this.triggerGoneItem()}});var h=function(){this.initialize()};Object.assign(h.prototype,{initialize:function(){this.uid="touchSensor-"+a(),this.status="stop",this.lastStatus="stop",this.x=0,this.y=0,this.deltaX=0,this.deltaY=0,this.speedX=0,this.speedY=0,this.touchEvent=this._bindTouchEvent()},reset:function(){this.x=0,this.y=0},distory:function(){this.touchEvent.distory()},_bindTouchEvent:function(){function e(e){t.lastStatus=t.status,t.status=e}var t=this,i=null,n=null,a=6,r=90,o=new AlloyFinger(window,{touchStart:function(n){i=n.timeStamp,t.deltaX=0,t.deltaY=0,e("drag")},touchEnd:function(a){var o=a.touches.length;0==o&&(e("slip"),n=a.timeStamp-i,i=a.timeStamp,n>r&&(t.speedX=0,t.speedY=0))},pressMove:function(e){e.preventDefault(),t.x+=e.deltaX,t.y+=e.deltaY,t.deltaX+=e.deltaX,t.deltaY+=e.deltaY,n=e.timeStamp-i,i=e.timeStamp,n>a&&(n>r&&(n=16),t.speedX=e.deltaX/n,t.speedY=e.deltaY/n)},_checkSpeed:function(){}});return o}});var u=function(){this.id=Math.random().toString(36).slice(-6),this.initData()};Object.assign(u.prototype,{initData:function(){return this.point=[0,0,0],this.deltaPoint=[0,0,0],this.startPoint=[0,0,0],this.status="off",this._raw={alpha:0,beta:0,gamma:0,alpha0:void 0,beta0:void 0,gamma0:void 0},this},recordPoint:function(e){var t=this._raw;return e&&e.originalEvent&&(e=e.originalEvent,t.alpha=e.alpha,t.beta=e.beta,t.gamma=e.gamma,this.point[0]=t.alpha,this.point[1]=t.beta,this.point[2]=t.gamma),this.setDelta(),this},setDelta:function(){var e=this._raw;void 0!==e.alpha0&&(this.deltaPoint[0]=e.alpha-e.alpha0,this.deltaPoint[1]=e.beta-e.beta0,this.deltaPoint[2]=e.gamma-e.gamma0)},markStart:function(e){var t=this._raw;return t.toMark&&(t.toMark=!1,e&&e.originalEvent?(e=e.originalEvent,t.alpha0=e.alpha,t.beta0=e.beta,t.gamma0=e.gamma):(t.alpha0=t.alpha,t.beta0=t.beta,t.gamma0=t.gamma),this.startPoint[0]=t.alpha0,this.startPoint[1]=t.beta0,this.startPoint[2]=t.gamma0,this.setDelta()),this},turn:function(e){return"on"==e&&this.turnOn(),"off"==e&&this.turnOff(),this},turnOn:function(){var e=this._raw;return"on"!=this.status&&(this.status="on",e.recordPoint=this.recordPoint.bind(this),e.markStart=this.markStart.bind(this),$(window).on("deviceorientation",e.recordPoint),e.toMark=!0,$(window).on("deviceorientation",e.markStart)),this},turnOff:function(){return $(window).off("deviceorientation",this._raw.recordPoint),this.status="off",this.initData(),this}});var p=Date.now;!function(){function e(e,t){if(Array.prototype.forEach)e.forEach(t);else for(var i=0,n=e.length;n>i;i++)t(e[i],i)}for(var t=[],i=-1,n=!1,a=null,r=Date.now,o=0,s=["ms","moz","webkit","o"],l=0;l<s.length&&!window.requestAnimationFrame;++l)window.requestAnimationFrame=window[s[l]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[s[l]+"CancelAnimationFrame"]||window[s[l]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var i=r(),n=Math.max(0,16-(i-o)),a=window.setTimeout(function(){e(i+n)},n);return o=i+n,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)});var c=function(o,s){if(i++,t.push({id:i,fn:o,interval:s,lastTime:r()}),!n){var l=function(){a=requestAnimationFrame(l),e(t,function(e){(e.interval<17||r()-e.lastTime>=e.interval)&&(e.fn(),e.lastTime=r())})};n=!0,l()}return i},d=function(e){for(var i=0,r=t.length;r>i;i++)if(e===t[i].id){t.splice(i,1);break}0===t.length&&(cancelAnimationFrame(a),n=!1)},h=function(e,t){var i=r()+t,n=c(function(){r()>=i&&(e(),d(n))},16);return n},u=function(e){d(e)};window.setRafInterval=c,window.clearRafInterval=d,window.setRafTimeout=h,window.clearRafTimeout=u,Date.now||(Date.now=function(){return(new Date).getTime()})}(),function(){var e=Date.now;BeatSensor=function(){this.start()},BeatSensor.prototype={start:function(){return this._lastT=e(),this},end:function(){return this._lastT=null,this},refresh:function(){var t=e();return this._deltaT=t-this._lastT,this._lastT=t,this},beat:function(){return this.refresh()._deltaT}}}(),TimeSensorMax=function(){this.start()},TimeSensorMax.prototype={start:function(){return this._startT||(this._startT=this._rawStartT=this._lastT=p(),this._deltaT=this._deltaP0=this._deltaP1=0,this._pausedT=null),this},stop:function(){return this._lastT=this._currentT=this._deltaT=this._pausedT=this._delta0=this._startT=this._rawStartT=null,this},refresh:function(){return this._pausedT?this._deltaT=p()-this._lastT-this._deltaP1-this._deltaP2():(this._deltaT=p()-this._lastT-this._deltaP1,this._deltaP0+=this._deltaP1,this._deltaP1=0,this._lastT=p()),this},get delta(){return this.refresh()._deltaT},get value(){return p()-this._startT-this._deltaP0-this._deltaP1-this._deltaP2()},_deltaP2:function(e){return this._pausedT?(e||p())-this._pausedT:0},pause:function(e){return this._pausedT||(this._pausedT=p()),this},resume:function(e){this._resume(e)},_resume:function(e,t){return this._pausedT&&(this._deltaP1+=this._deltaP2(),this._pausedT=null),this},forward:function(e){},backward:function(e){},seek:function(e){},valueOf:function(){return this.value},toString:function(){return this.value}},TimeSensor=TimeSensorMax;window.lclog=function(){},epub360.PlayerPlugins.push({config:{type:"LayerRound",template:"LayerRef",Model:"LayerRef",model_object:{setiview:function(){this.iview=new interaction_view.view.LayerRound({model:this})}}},render:function(e){},playAnimation:function(){},resetOtherStatus:function(){},getLayerContentSize:function(){var e=this.getdetail(),t={};if(!e.layer_ids||e.layer_ids.length>0){var i=_.map(e.layer_ids,function(e){return interaction_view.ilayerlist.get(e).toJSON()});return t.width=_.max(_.pluck(i,"layer_width")),t.height=_.max(_.pluck(i,"layer_height")),t}return null},onPlay:function(){this.startPano()},onStop:function(){var e=e||this;e._pano;e.resetlayer(),e.stoplayer(),this.stopPano()},startPano:function(){this.pano=this.pano||new d(this),this.pano.prefixTouch(),this.pano.autoPlay()},stopPano:function(){this.pano.stopMoving(),this.pano.status.currentProgress=0,this.pano.updatePanoRender()},panolog:function(){},playNestedAnimation:function(){_.each(this.model.layer,function(e){e.isLayer=!0,interaction_view.play(e)})}})}(),define("interaction_view/components/layerround/layerround",function(){}),function(){var e=[{type:"onLongTakeStart",eventList:"longTakeStartEvents"},{type:"onLongTakeEnd",eventList:"longTakeEndEvents"}];e.forEach(function(e){epub360.PlayerPlugins.push({type:"action",config:{type:e.type,func:function(t,i){if(i.init){var n={page_id:t.view.page_id,overlay_id:t.view.overlay_id,layer_id:t.view.layer_id,func:t.func,overlaymodel:t.view.overlaymodel,d:t,type:e.type};interaction_view.events[e.eventList].push(n)}}}})});var t=[{type:"onLTLayerInto",eventList:"longTakeLayerIntoEvents"},{type:"onLTLayerGone",eventList:"longTakeLayerGoneEvents"}];t.forEach(function(e){epub360.PlayerPlugins.push({type:"action",config:{type:e.type,func:function(t,i){if(i.init){var n={page_id:t.view.page_id,overlay_id:t.view.overlay_id,layer_id:t.view.layer_id,ref_id:t.view.ref_id,func:t.func,overlaymodel:t.view.overlaymodel,d:t,type:e.type};interaction_view.events[e.eventList].push(n)}}}})})}(),define("interaction_view/actions/layerround/layerroundaction",function(){}),define("interaction_view/model/main",["interaction_view/model/action","interaction_view/model/animation_view","interaction_view/model/audio","interaction_view/model/cycleimage","interaction_view/model/image","interaction_view/model/page","interaction_view/model/doc","interaction_view/model/preload","interaction_view/model/richtext","interaction_view/model/slide","interaction_view/model/video","interaction_view/model/button","interaction_view/model/pay","interaction_view/model/link","interaction_view/model/binding","interaction_view/model/Grid","interaction_view/model/Cell","interaction_view/model/TextLabel","interaction_view/model/TabBar","interaction_view/model/SearchInput","interaction_view/model/Tree","interaction_view/model/gallery","interaction_view/model/PageIndex","interaction_view/model/webcontent","interaction_view/model/shape","interaction_view/model/BookButton","interaction_view/model/dragdrop","interaction_view/model/dragdropgroup","interaction_view/model/variable","interaction_view/model/vote","interaction_view/model/paragraph","interaction_view/model/input","interaction_view/model/textarea","interaction_view/model/selectbutton","interaction_view/model/submitbutton","interaction_view/model/selectbox","interaction_view/model/imageblock","interaction_view/model/weixincamera","interaction_view/model/weixinvoice","interaction_view/model/infoList","interaction_view/model/chartList","interaction_view/model/component","interaction_view/model/textbutton","interaction_view/model/collision","interaction_view/model/usersvg","interaction_view/model/avatar","interaction_view/model/avatarList","interaction_view/model/initButton","interaction_view/model/userList","interaction_view/model/infoForm","interaction_view/model/contactForm","interaction_view/model/plugin","interaction_view/model/select","interaction_view/model/systemvariable","interaction_view/model/qqvideo","interaction_view/model/MobileValid","interaction_view/components/staticlist","interaction_view/components/puzzle/puzzle","interaction_view/components/gyroscope/gyroscope","interaction_view/components/contentGrid/contentGrid","interaction_view/components/htmlPage/htmlPage","interaction_view/components/debug/debug","interaction_view/components/anchor/anchor","interaction_view/components/ShareVariable/ShareVariable","interaction_view/components/DataBinder/DataBinder","interaction_view/components/stategroup/stategroup","interaction_view/components/map/map","interaction_view/components/formview/formview","interaction_view/components/palette/palette","interaction_view/components/layerslide/layerslide","interaction_view/components/componentref/componentref","interaction_view/components/layerref/layerref","interaction_view/components/cascadeSelect/province","interaction_view/components/cascadeSelect/cascadeSelect","interaction_view/components/pip/pip","interaction_view/actionexecutes/tapcopy/tapcopy","interaction_view/actionexecutes/timelinecontrol/timelinecontrol","interaction_view/actionexecutes/cssanimateaction/cssanimateaction","interaction_view/actionexecutes/elementproperty/elementproperty","interaction_view/actionexecutes/datalist/datalist","interaction_view/actionexecutes/condition/condition","interaction_view/actionexecutes/state/state","interaction_view/actionexecutes/refresh/refresh","interaction_view/actionexecutes/uploadimage/uploadimage","interaction_view/actionexecutes/contentGrid/contentGrid","interaction_view/actionexecutes/palette/palette","interaction_view/actionexecutes/gyroscope/gyroscope","interaction_view/actionexecutes/pagescroll/pagescroll","interaction_view/actionexecutes/clipboard/clipboard","interaction_view/actionexecutes/qrcode/qrcode","interaction_view/actionexecutes/cc/cc","interaction_view/actionexecutes/coolsitecms/cms","interaction_view/actionexecutes/actionGroup/actionGroup","interaction_view/actionexecutes/face/face","interaction_view/actionexecutes/previewImage/previewImage","interaction_view/actionexecutes/weixinshareinfo/weixinshareinfo","interaction_view/actionexecutes/settitle/settitle","interaction_view/actionexecutes/pip/pip","interaction_view/actions/gyroscope/gyroscope","interaction_view/actions/demo/demo","interaction_view/actions/condition/condition","interaction_view/actions/anchor/anchor","interaction_view/actions/mediaaction/onstartplay","interaction_view/actions/mediaaction/onended","interaction_view/actions/contentGrid/contentGrid","interaction_view/actions/palette/palette","interaction_view/actions/pip/pip","interaction_view/actionexecutes/weixinvoice/startrecord","interaction_view/actionexecutes/weixinvoice/stoprecord","interaction_view/actionexecutes/weixinvoice/playvoice","interaction_view/actionexecutes/weixinvoice/stopvoice","interaction_view/actionexecutes/weixinvoice/translatevoice","interaction_view/components/layerround/layerround","interaction_view/actions/layerround/layerroundaction"],function(){}),define("text!interaction_view/template/alertbox.tpl",[],function(){return'<div class="alert-box"><div class="alert-msg"><%=text%></div><div class="alert-title"><a class="alert-confirm" href="#">确定</a></div></div>'}),define("text!interaction_view/template/confirmbox.tpl",[],function(){return'<div class="alert-box confirm"><div class="alert-msg"><%=text%></div><div class="alert-title"><a class="alert-confirm button" href="#">确定</a><a class="alert-cancel button" href="#">取消</a></div></div>'}),define("interaction_view/ui/main",["jquery","backbone","text!interaction_view/template/message.tpl","text!interaction_view/template/alertbox.tpl","text!interaction_view/template/confirmbox.tpl"],function(){function e(e,t,i){function n(){o.remove(),l.remove(),window.emulateLandscape.event.del(r)}function r(){l.css({margin:"auto",transform:"translate(-50%, -50%) rotate("+window.emulateLandscape.degree+"deg)"})}var o=interaction_view.containment.children(".alert_mask");if(!o.length){o=$('<div class="alert_mask"></div>').appendTo(interaction_view.containment),e=e||a,"undefined"!=typeof t&&t.indexOf&&t.indexOf("6015")>0&&(t="当前参与人数过多，请您稍后再试");var s=_.template(e,{text:t});interaction_view.containment.append(s);var l=interaction_view.containment.children(".alert-box"),c=l.find(".alert-confirm"),d=l.find(".alert-cancel");r(),window.emulateLandscape.event.add(r),c.on("click",function(){return n(),i&&i(),!1}),d.on("click",function(){return n(),!1})}}var t=require("text!interaction_view/template/message.tpl"),n=require("text!interaction_view/template/alertbox.tpl"),a=require("text!interaction_view/template/confirmbox.tpl"),r=document.createElement("DIV");window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelnimationFrame;var o={MOBILEREG:/^1\d{10}$/,message:function(e,i,n){0==$("body").find(".msg").length&&$("body").append('<div class="msg"></div>'),n||(n=3e3),$(".msg").html(_.template(t,{type:e,msg:i})),$(".msg").fadeIn(),setTimeout(function(){$(".msg").fadeOut("slow"),$(".msg").remove()},n)},getRequest:function(e){var t=location.search,i={};if(-1!=t.indexOf("?")){var n=t.substr(1);strs=n.split("&");for(var a=0;a<strs.length;a++)i[strs[a].split("=")[0]]=unescape(strs[a].split("=")[1])}return e?i[e]:i},deviceType:function(){return"iPad"==navigator.userAgent.match(/iPad/i)?"iPad":"iPhone"==navigator.userAgent.match(/iPhone/i)?"iPhone":"Android"==navigator.userAgent.match(/Android/i)?"Android":"BlackBerry"==navigator.userAgent.match(/BlackBerry/i)?"BlackBerry":"null"},getModelById:function(e,t){var i=null;return e.icollection.each(function(e){e.id==t&&(i=e);var n=interaction_view.getModelById(e,t);n&&(i=n)}),i},model2collection:function(e,t){e.has(t)&&e.icollection.add(e.get(t))},model2tree:function(e,t,i){e.has(t)&&(e.icollection.add(e.get(t)),e.icollection.each(function(e){e.has(i)&&interaction_view.model2tree(e,i,i)}))},getPageIds:function(){var e=[];return $(".reveal").find("section").each(function(){e.push($(this).attr("id"))}),e},getCurrentPageModel:function(){return interaction_view.ipagelist.getPage(interaction_view.currentPage)},getCurrentAudioModel:function(){var e,t=interaction_view.getCurrentPageModel();return t.iOverlaylist.models.forEach(function(t){"Audio"===t.toJSON().iType&&(e=t)}),e},createPath:function(e){var t=[];return e.isSubOverlay?t=$.extend(!0,[],e.path):t.push({type:"page",id:e.page_id}),t.push({type:e.model.get("iType"),id:e.model.id}),e.layer_id&&t.push({type:"layer",id:e.layer_id}),t},hashPath:function(e){return _.pluck(e,"id").join("")},getContainerDivByPath:function(e){var t=$(".interaction-view");if(!e)return $(".interaction-view");for(i=0;i<e.length;i++)"page"==e[i].type?interaction_view.ipagelist.getPage(e[i].id)?t=$('.Presentation[id="'+e[i].id+'"]').find(".interaction-view").first():(interaction_view.imasterlist.get(e[i].id)||interaction_view.ibackgroundlist.get(e[i].id))&&(t=$('.Presentation[id="'+interaction_view.currentPage+'"]').find(".interaction-view").first()):t="layer"==e[i].type?t.find('div.layer-item[data-id="'+e[i].id+'"]').first():t.find('div.iView[id="'+e[i].id+'"]').first().children(".Element");return t},getContainerModelByPath:function(e){var t=null;for(i=0;i<e.length;i++)if(t="page"==e[i].type?interaction_view.getParentpage(e[i].id):"layer"==e[i].type?t.layer[e[i].id]:t.iOverlaylist.get(e[i].id),!t)return null;return t},formatLabel:function(e){var t,i="",n="",a="";return e.iPosition||(t="left"),1==e.iPosition&&(t="center"),2==e.iPosition&&(t="right"),void 0!=e.radius&&(i="border-top-left-radius:"+e.radius+"px; border-top-right-radius:"+e.radius+"px; border-bottom-right-radius:"+e.radius+"px; border-bottom-left-radius:"+e.radius+"px;"),void 0!=e.border_color&&e.border_size&&(n="border:"+e.border_size+"px solid "+e.border_color+";"),void 0!=e.bg_color&&(a="background-color:"+e.bg_color+";"),e.el?($(e.el).css({"font-size":e.font_size,color:e.text_color,"text-align":t}),void(i&&$(e.el).css("border-radius",e.radius+"px"))):'<p style="text-align:'+t+";font-size:"+e.font_size+"px;color:"+e.text_color+";"+i+n+a+'">'+e.text+"</p>"},getWebContentSrc:function(e){switch(e.contentType){case 0:if(e.iUrl){var t=-1!=e.iUrl.indexOf("http://")||-1!=e.iUrl.indexOf("https://")?e.iUrl:0==e.iUrl.indexOf("/")?e.iUrl:"http://"+e.iUrl;return window.location.protocol&&"https:"==window.location.protocol&&-1==t.indexOf("https")&&(t=t.replace("http","https")),t=t.replace("www.epub360.com",window.location.host),{src:t,content:null}}return null;case 1:if(e.iFile&&e.iFile[0]&&e.iFile[0].file){if("undefined"==typeof cbt_data||interaction_view.forpreview)var t=e.iFile[0].file.replace(".zip","/");else var t=e.iFile[0].file.replace(".zip","/index.html");return window.location.protocol&&"https:"==window.location.protocol&&-1==t.indexOf("https")&&(t=t.replace("http","https")),{src:t,content:null}}return null;case 2:return e.iSource?{src:null,content:e.iSource}:null}},getMapUrl:function(e){if(window.location.host&&e.match(/^http[s]?:\/\/([^\/]+)\/.*$/)){var t=e.match(/^http[s]?:\/\/([^\/]+)\/.*$/)[1];e=e.replace(t,window.location.host)}return window.location.protocol&&"https:"==window.location.protocol?-1==e.indexOf("https")&&(e=e.replace("http","https")):-1!=e.indexOf("https")&&(e=e.replace("https","http")),e},getAnimationPage:function(e,t){return interaction_view.getParentpage(e)?interaction_view.getParentpage(e):t},filterAnimations:function(e,t,i,n){var a=_.filter(e,function(e){var t=e.toJSON();return t.iTiming&&t.iTiming.waitaction&&!interaction_view.SinglePreview&&!n?!1:0==t.iKind&&t.iGroup_id&&!i?!1:t.isH5?!1:!0});return a},preloadImg:function(e){var t=new Image;t.onload=function(){},t.src=e},drawImg:function(e,t,i,n){console.log(i);try{n.clearRect(0,0,2*e.canvas_width,2*e.canvas_height),n.drawImage(e.model.iImgs[i],0,0,2*e.canvas_width,2*e.canvas_height),this.onload=null}catch(a){console.log(a)}},getOverlays:function(e,t){var i=[];if(i=0==interaction_view.imasterlist.length?iMasterlist.at(0).overlaylist.models:interaction_view.imasterlist.at(0).iOverlaylist.models,interaction_view.currentPage==t)i=_.union(i,interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.models);else if(interaction_view.ilayerlist.get(t)){var n=interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.models.filter(function(e){return"LayerRef"==e.attributes.iType&&e.layer[t]});n&&n.length&&(i=_.union(i,n[0].layer[t].iOverlaylist.models))}return _.filter(i,function(t){return t.attributes.iType==e})},getVarsOp:function(e,t,i){"undefined"!=typeof t&&t&&t.length||(t=[0,1,2]),_.each(t,function(e,i){t[i]=String(e)});var n=_.filter(interaction_view.getOverlays("Variable",e),function(e){return _.include(t,String(e.attributes.iDetail.iKind))});n=_.union(n,interaction_view.getOverlays("Paragraph",e)),i&&(n=_.union(n,i));var a="@",r=/@/g,o=/\@[^\@]+\@/g,s=function(e){if(!c(e))return e;if("@微信_用户昵称@"==e)return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?epub360_userinfo.nickname:"@微信_用户授权_未启用@";if("@助力_用户身份@"==e)return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?interaction_view.environment.Shareapp.usertype():"@助力_用户授权_未启用@";if("@助力_助力数@"==e)return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?interaction_view.environment.Shareapp.total():"@助力_用户授权_未启用@";if("@助力_是否发起@"==e)return 2==interaction_view.environment.Shareapp.status?1:0;var t;e=e.replace(r,"");var i=interaction_view.application.getFormFieldValue(e);if(null!=i)return i;if(ids=e.split("_"),ext=ids.length>1?ids[1]:"",ids.length>1&&["position","voted"].indexOf(ext)>-1?e=ids[0]:ext="",t=_.filter(n,function(t){return t.id==e}),t.length){var a=t[0],o=t[0].attributes.iDetail;if("Vote"==a.get("iType")){var s=parseInt(o.initial);return""==ext?s=a.get("value")||parseInt(o.initial):"position"==ext?s=a.get("position")||0:"voted"==ext&&(s=a.get("voted")||0),s}if("undefined"!=typeof o.initial)return String(o.initial);if("undefined"!=typeof o.iText){var l=String(t[0].iview.userContent||o.iText),d=l.replace(/<br>/g,"\n").replace(/<\/div><div>/g,"\n").replace("<div>","").replace("</div>","");return d}return String(t[0].get("suboverlays")[0].iDetail.iValue)}return"0"},l=function(e){var t=String(e),i=t.match(o);return _.each(i,function(e){t=t.replace(e,s(e))}),t},c=function(e){return e&&e[0]==a},d=function(e){var t=String(e),i=t.match(o);return i&&i.length?!0:!1};return{vars:n,var2val:function(e,t){var i=String(e),a=i.match(o);return n&&n.length||a?t?l(e):Number(s(e))||0:e},beginWithAT:c,hasAT:d}},getParentpage:function(e){return interaction_view.getPage(e)},getPageType:function(e){return interaction_view.imasterlist.length&&e.model.page.id==interaction_view.imasterlist.at(0).id?"master":interaction_view.ibackgroundlist.length&&e.model.page.id==interaction_view.ibackgroundlist.at(0).id?"background":"page"},getPageType2:function(e){return e.isMasterOverlay?"master":e.isBackgroundOverlay?"background":"page"},imageEditor:function(e,t,i,n,a,r){function o(){var e=$(".imageeditor").children("img").data();a&&a(e.x||0,e.y||0,e.scale||1,e.rotate||0),interaction_view.imageEditorClear(),$(".reveal").removeClass("noevents")}$(".reveal").addClass("noevents");var s,l;s=$.zoom?t*$.zoom:t,l=$.zoom?i*$.zoom:i;var c=e.iview.$el.children(".Element").offset(),d=$.zoom?c.left*$.zoom:c.left,h=$.zoom?c.top*$.zoom:c.top,u=_.isNaN(Number(e._rotate))?0:Number(e._rotate),p=_.isNaN(Number(e._scale))?1:Number(e._scale),f=_.isNaN(Number(e._x))?0:Number(e._x),v=_.isNaN(Number(e._y))?0:Number(e._y),g="rotate("+u+"deg) scale("+p+") skew(0deg) translate("+f+"px ,"+v+"px)";e.iview.$el.find("img").css({"-webkit-transform":g,width:"100%",height:"auto"}),interaction_view.imageEditorClear(),interaction_view.containment.append('<div class="editor_mask" style="opacity:0;"></div>'),interaction_view.containment.append('<div class="imageeditorcontainer"><div class="imageeditor" style="position:absolute;left:'+d+"px;top:"+h+"px;width:"+s+"px;height:"+l+'px;z-index:999999999;"><img src="'+n+'" style="width:100%;height:100%;opacity:0;"></div></div>'),"undefined"!=typeof epub360&&epub360.settings&&["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type)>=0&&interaction_view.containment.append('<div style=" padding-bottom: 3px;display: inline-block;z-index: 999999999;position: absolute; bottom: 10px;  text-align: center; width: 100%;"><a href="http://www.epub360.com/?utm_source=epub360&amp;utm_medium=player&amp;utm_content=%E5%85%8D%E8%B4%B9%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81&amp;utm_campaign=loading" target="_blank" style="color: #c9c9c9;font-size: 14px;padding: 8px 14px;background: #a1a1a1;border-radius: 15px; -moz-border-radius: 15px;" class="advertise">Epub360.com 技术支持</a></div>'),interaction_view.containment.append('<div class="imageeditorbuttons"><button class="weixinbutton chooseimage"></button><button class="weixinbutton imageconfirm"></button></div>'),interaction_view.bindImageEditor($(".imageeditor").children("img"),u,p,f,v,e),$(".imageconfirm").on("click",function(){return o(),!1});var m=document.querySelector(".imageeditorcontainer");new AlloyFinger(m,{tap:function(e){e.target==m&&o()}}),$(".chooseimage").on("click",function(){return interaction_view.weixin.chooseimage(function(e){e&&(interaction_view.localIds=e,r(interaction_view.forceUpload?e:e[0]))}),!1})},imageEditorClear:function(){$(".editor_mask").remove(),$(".imageeditorcontainer").remove(),$(".voiceeditor").remove(),$(".imageeditor-confirm").remove(),$(".weixinbutton").remove(),$(".advertise").remove(),$(".imageeditorbuttons").remove()},bindImageEditor:function(e,t,i,n,a,r){var o=!1,s=0,l=1;e.data({rotate:t,scale:i,x:n,y:a});var c=e.hammer();c.on("drag",function(e){if(!o){var s=n+e.gesture.deltaX,l=a+e.gesture.deltaY,c="rotate("+t+"deg) scale("+i+") skew(0deg) translate("+s+"px, "+l+"px)";r.iview.$el.find("img").css({transform:c,"-webkit-transform":c}),$(".imageeditorbuttons").hide(),e.gesture.preventDefault()}}),c.on("rotate",function(c){o=!0,l=c.gesture.scale;var d=i+(l-1);s=c.gesture.rotation;var h=t+s;e.data({scale:d,rotate:h,x:n,y:a});var u="rotate("+h+"deg) scale("+d+") skew(0deg) translate("+n+"px ,"+a+"px)";r.iview.$el.find("img").css({transform:u,"-webkit-transform":u}),$(".imageeditorbuttons").hide(),c.gesture.preventDefault()}),c.on("pinch",function(c){o=!0,l=c.gesture.scale;var d=i+(l-1);s=c.gesture.rotation;var h=t+s;e.data({scale:d,rotate:h,x:n,y:a}),$(".imageeditorbuttons").hide();var u="rotate("+h+"deg) scale("+d+") skew(0deg) translate("+n+"px ,"+a+"px)";r.iview.$el.find("img").css({transform:u,"-webkit-transform":u}),c.gesture.preventDefault()}),c.on("dragend",function(r){var c=r.gesture.deltaX,d=r.gesture.deltaY;o?(t+=s,i+=l-1,e.data({rotate:t,scale:i,x:n,y:a})):(n+=c,a+=d,e.data({rotate:t,scale:i,x:n,y:a})),s=0,l=1,o=!1,$(".imageeditorbuttons").show()})},imageUploader:function(e,t){if(interaction_view.forceUpload){var i={},n=context_url+"uploadimage",a="image/png";try{a=e.match(/.*(image\/\w+);/)[1]}catch(r){}var o=_g.fileapi.base64urltoBase64(e),s=_g.fileapi.b64toBlob({b64Data:o,type:a});i.url=n,i.blob=s,i.filekey="image",i.callback=function(e){var i=e.data.results[0];t(i)},_g.fileapi.sendBinary(i)}else wx.uploadImage({localId:e,success:function(e){var i=context_url+"uploadimage";_g.ajax.post({url:i,data:{serverid:e.serverId},callback:function(e){200==e.code?t&&t(e.data.results[0]):interaction_view.errorAlert(e.msg)}})},fail:function(e){interaction_view.errorAlert("图片上传错误")}})},voiceEditor:function(e){$(".reveal").addClass("noevents"),interaction_view.weixin.voiceauth(),interaction_view.imageEditorClear(),interaction_view.containment.append('<div class="editor_mask" style="opacity:0;"></div>'),"undefined"!=typeof epub360&&epub360.settings&&["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type)>=0&&interaction_view.containment.append('<div style=" padding-bottom: 3px;display: inline-block;z-index: 999999999;position: absolute; bottom: 10px;  text-align: center; width: 100%;"><a href="http://www.epub360.com/?utm_source=epub360&amp;utm_medium=player&amp;utm_content=%E5%85%8D%E8%B4%B9%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81&amp;utm_campaign=loading" target="_blank" style="color: #c9c9c9;font-size: 14px;padding: 8px 14px;background: #a1a1a1;border-radius: 15px; -moz-border-radius: 15px;" class="advertise">Epub360.com 技术支持</a></div>'),interaction_view.containment.append('<div class="voiceeditor absolutecenter weixin-record">    <div class="voiceeditor-control">         <button class="voicebutton" id="playVoice" style="opacity:0;"></button>         <button class="voicebutton" id="startRecord"></button>         <div class="voicetext">按住录音</div>         <button class="weixincancel"></button>         <button class="weixinconfirm"></button>    </div></div>'),interaction_view.bindVoiceEditor(),$(".weixinconfirm").on("click",function(){return interaction_view.imageEditorClear(),$(".reveal").removeClass("noevents"),e&&e(interaction_view.voicelocalId),!1}),$(".weixincancel").on("click",function(){return wx.stopRecord({success:function(e){},fail:function(e){}}),interaction_view.imageEditorClear(),$(".reveal").removeClass("noevents"),!1})},bindVoiceEditor:function(e){var t=!1,i=function(){return interaction_view.voicelocalId?(wx.playVoice({localId:interaction_view.voicelocalId}),void window.setTimeout(function(){$("#playVoice").attr("id","stopVoice")},500)):void interaction_view.errorAlert("你还没有录音呢！")};$(".weixin-record").on("touchstart","#startRecord",function(e){return t=!0,wx.startRecord({success:function(){t?$("div.voicetext").html("正在录音...."):wx.stopRecord({})},cancel:function(){interaction_view.errorAlert("开启微信功能失败")}}),window.setTimeout(function(){$("#startRecord").attr("id","stopRecord")},100),!1}),$(".weixin-record").on("touchend","#stopRecord",function(e){return wx.stopRecord({success:function(e){interaction_view.voicelocalId=e.localId,$("#playVoice").css("opacity",1),i()},fail:function(e){interaction_view.errorAlert("微信录音失败")}}),window.setTimeout(function(){$("#stopRecord").attr("id","startRecord")},100),t=!1,$("div.voicetext").html("按住录音"),!1}),$(".weixin-record").on("touchcancel","#stopRecord",function(e){return wx.stopRecord({success:function(e){interaction_view.voicelocalId=e.localId,$("#playVoice").css("opacity",1),i()},fail:function(e){interaction_view.errorAlert("微信录音失败")}}),window.setTimeout(function(){$("#stopRecord").attr("id","startRecord")},100),t=!1,!1}),$(".weixin-record").on("click","#playVoice",function(e){return i(),!1}),$(".weixin-record").on("click","#stopVoice",function(e){return interaction_view.voicelocalId?(wx.stopVoice({localId:interaction_view.voicelocalId}),window.setTimeout(function(){$("#stopVoice").attr("id","playVoice")},500),!1):void interaction_view.errorAlert("你还没有录音呢！")}),wx.onVoicePlayEnd({complete:function(e){$("#stopVoice").attr("id","playVoice")}}),wx.onVoiceRecordEnd({complete:function(e){interaction_view.voicelocalId=e.localId,$("#playVoice").css("opacity",1),i(),$("#stopRecord").attr("id","startRecord")}})},voiceUploader:function(e,t){wx.uploadVoice({localId:e,isShowProgressTips:1,success:function(e){var i=(e.serverId,context_url+"uploadvoice");_g.ajax.post({url:i,data:{serverid:e.serverId},callback:function(e){200==e.code?t&&t(e.data.results[0]):interaction_view.errorAlert(e.msg)}})}})},errorAlert:function(t){
e(n,t)},confirmBox:function(t,i){e(a,t,i)},playbgsound:function(){if(interaction_view.bgsound){var e=interaction_view.bgsound;if(!e.hasPlayed){var t=e.iview.getdetail();e.media=audio,e.iview.$el.find(".status-play").addClass("status-pause").removeClass("status-play"),e.media.paused||(e.hasPlayed=!0),$("audio#bgsound").on("loadstart",function(e){}).on("error",function(e){}).on("timeupdate",function(t){if(e.iview.slider){var i=e.media.currentTime,n=e.media.duration,a=100*_g.number.decimal(i/n,2);e.iview.onSliderChange(a)}}),$("audio#bgsound").on("ended",function(i){if(t.iRepeat)_g.device.android()&&e.media.play();else{if(e.iview.slider&&e.iview.sliderstop(),0==e.media.seekable.length)return;try{}catch(n){}e.onAnimationStart&&(interaction_view.events.onAnimationEnd(e.onAnimationStart),e.onAnimationStart=null)}})}}},createLoop:function(e){var t=1e3*e.delay,i=17,n=0,a={};a.paused=!0,a._int=null;var r=0;return a.duration=function(){return e.duration},a.play=function(){a.paused=!1;var o=function(){a&&(a._int=requestAnimationFrame(o),n*i>=t?(console.log("play"),e.callback&&e.callback(),n=1,r=r+e.delay<=e.duration?r+e.delay:0):n+=1)};o()},a.pause=function(){a._int&&window.cancelAnimationFrame(a._int)},a.kill=function(){a._int&&(window.cancelAnimationFrame(a._int),a.paused=!0),a=null},a.time=function(){return r},a},renderLink:function(e,t){function i(){if(interaction_view.ismobile){var e=window.location.href;void 0===window.__wxjs_is_wkwebview&&(e=_g.changeURLPar(e,"return","1"),window.history.pushState({},"",e)),window.location.href=n}else window.open(n,"_blank")}if(interaction_view.foredit)return void global.message("warning","请使用预览全部模式预览该功能");if(0==e&&t.page_id)interaction_view.ipagelist.getPage(t.page_id)&&presentation.gotopage(t.page_id,0);else{if(1==e&&t.url){if(!t.url)return;var n=t.url;if(0==n.indexOf("@"))return void window.open(n,"_blank");-1==n.indexOf("://")&&(n="http://"+n),window.location.href.indexOf("query_string")>0&&(n+=n.indexOf("?")>=0&&"&"+window.location.search.replace("?","")||window.location.search);var a=n.match(/\w+:\/\//);if(a&&-1==["https://","http://"].indexOf(n.match(/\w+:\/\//)[0]))return void(window.location.href=n);var r=interaction_view.checkicp(n);return 200!=r?414==r?void interaction_view.errorAlert('<div>该网址被腾讯电脑管家检测为危险，停止访问!</div><div class="url">'+n+"</div>"):void(wx_config.LOGO?interaction_view.confirmBox('<div>新打开网址无法确定是否安全，是否继续访问?</div><div class="url">'+n+"</div>",i):i()):void i()}if(2==e&&t.url){if(!interaction_view.ismobile)return;window.location="tel:"+t.url}}},setPos:function(e,t){var i=t.x,n=t.y,a=t.scale;if(interaction_view.ismobile&&"undefined"==typeof TweenMax){var r="transform";"transform"in document.documentElement.style||(r="webkitTransform");var o=e[0].style[r].match(/[,\(][^\,]+/g);void 0!=i&&void 0==n?n==parseFloat(o[5].substring(2)):void 0==i&&void 0!=n&&i==parseFloat(o[4].substring(2)),void 0!=i&&void 0!=n&&(o.pop(),o.pop(),e[0].style[r]="matrix"+temp2.join("")+", "+i+", "+n+")"),void 0!=a&&"undefined"!=typeof TweenMax&&TweenMax.set(e,{scale:a})}else(void 0!=i||void 0!=n)&&TweenMax.set(e,t),void 0!=a&&TweenMax.set(e,{scale:a})},renderScroll:function(e){e.pullUpInfo||(e.pullUpInfo="上拉加载更多"),e.pullDownInfo||(e.pullDownInfo="释放更新");var t=e.view,i=(e.containment,0);e.mask_width=$(e.containment).outerWidth(),e.container_height=$(e.containment).outerHeight(),e.content_width=$(e.contentel).outerWidth(),e.content_height=$(e.contentel).outerHeight(),e.container_height%2?$(e.contentel).height(e.content_height-1):$(e.contentel).height(e.content_height),e.maskel||($(e.contentel).parent(".info_content").length&&($(e.contentel).siblings(".pullDown").remove(),$(e.contentel).siblings(".pullUp").remove(),$(e.contentel).unwrap(".info_content")),e.maskel=$('<div class="info_content" style="padding:0;"></div>'),$(e.contentel).wrap(e.maskel),e.pullDown&&$(e.contentel).before('<div class="pullDown" style="position:relative;margin-top: -38px;height: 38px;color:#999;text-align: center;font-size: 12px;">下拉刷新</div>'),e.pullUp&&$(e.contentel).after('<div class="pullUp" style="text-align: center;font-size: 12px; color:#999;height:18px;clear:both; display:none;">上拉加载更多</div>'),e.maskel.height(e.content_height),e.mask_height=e.content_height),e.mask_height<=e.container_height&&(e.mask_height=e.container_height+1),t&&t.scrollview&&t&&t.scrollview&&t.scrollview.iScroll.destroy(),$(e.containment).addClass("iMouseWheel disableMouseWheelY disableDragY");var n=e.content_height-e.container_height,a=new _g.scrollview({containment:e.containment,contentel:e.maskel,mask_width:e.mask_width,mask_height:e.container_height,content_width:e.content_width,content_height:e.mask_height,content_x:0,content_y:e.content_y||0,scrollY:!0,onScrolling:function(t){if(t.deltaY>0&&$(e.containment).find(".pullUp").first().hide(),t.deltaY<-5-n&&e.pullUp&&$(e.containment).find(".pullUp").first().show(),e.autoload_more&&-t.deltaY>=n||-t.deltaY>n+30)e.pullUp?(i=1,$(e.containment).find(".pullUp").first().text(e.pullUpInfo)):(i=0,$(e.containment).addClass("is_exceededY"),$(e.containment).removeClass("disableDragY iMouseWheel disableMouseWheelY"));else{if(!(t.deltaY>30))return e.pullUp&&$(e.containment).find(".pullUp").text(e.pullUpInfo),void(e.pullDown&&$(e.containment).find(".pullDown").text(e.pullDownInfo));e.pullDown?(i=2,$(e.containment).find(".pullDown").first().text(e.pullDownInfo)):i=0}},onScrollend:function(){1==i?e.onPullUp&&e.onPullUp():2==i&&e.onPullDown&&e.onPullDown(),i=0,$(e.containment).removeClass("is_exceededY"),$(e.containment).find(".pullUp").hide()}});t&&(t.scrollview=a),$(e.containment).addClass("hascontrols")},setRandom:function(e){if(e.iRepeatable){e.usedRandom||(e.usedRandom=[]),this.isUseup(e);var t;do t=this.getRandom(e);while(_.contains(e.usedRandom,t));return e.usedRandom.push(t),t}return this.getRandom(e)},isUseup:function(e){(!e.randlist&&e.usedRandom.length>=e.range[1]-e.range[0]+1||e.randlist&&e.usedRandom.length>=e.randlist.length)&&(e.usedRandom=[])},getRandom:function(e){return e.randlist?e.randlist[_.random(0,e.randlist.length-1)]:_.random(e.range[0],e.range[1])},getImgSrc:function(e){var t=e.find(".image_wrap img");if(t.length)return t.attr("src");var i=e.find(".image_wrap").css("background-image"),n=i.replace(/url\((.*)\)/,"$1").replace(/"/g,"");return n},parseVar:function(e){if(_.isNaN(Number(e))){var t=$("<textarea></textarea>");t.val(e),e="'"+t.val()+"'",t.remove()}else{var i=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;if("string"==typeof e&&i.test(e))e="'"+e+"'";else{var n=Number(e);if(n>0&&e[0]&&"0"===e[0]||!(""+e).match(/\./)&&!Number.isSafeInteger(n)){var t=$("<textarea></textarea>");t.val(e),e="'"+t.val()+"'",t.remove()}else e=n}}return e},isPersonId:function(e){var t=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return"string"==typeof e&&t.test(e)?!0:!1},Html2Txt:function(e){return e?(e=String(e),e.replace(/<\/div><br><div>/g,"\n\n").replace(/<\/div><br><br><div>/g,"\n\n\n").replace(/<\/div><br>/g,"\n\n").replace(/<br><div>/g,"\n").replace(/<br>/g,"\n").replace(/<\/div><div>/g,"\n").replace(/<div>/g,"").replace(/<\/div>/g,"").replace(/<div[^>]*/g,"").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<span[^>]*/g,"").replace(/>/g,"")):""},Txt2Html:function(e){return e?(e=String(e),"<div>"+e.replace(/\n/g,"</div><div>").replace(/<div><\/div>/g,"<br>")+"</div>"):""},checkicp:function(e){var t=200,i=window.location.host;return-1==i.indexOf("epub360")&&-1==i.indexOf("creatby")?200:_g.isEpub360Domain(e)?200:e?($.ajax({type:"POST",url:portal_url+"checkurl/",data:{url:e},async:!1,contentType:"application/json",dataType:"json",crossDomain:!0,success:function(e,i,n){200!=e.code&&(t=e.code)},error:function(e,i,n){t=200}}),t):200},evil_check:function(e){var t=200;return e?($.ajax({type:"POST",url:portal_url+"checkguanjia/",data:{url:e},async:!1,contentType:"application/json",dataType:"json",crossDomain:!0,success:function(e,i,n){200!=e.code&&201!=e.code&&(t=e.code)},error:function(e,i,n){t=200}}),t):200},getPageElement:function(e,t){if("string"!=typeof e)return e.iOverlaylist.get(t);var i=interaction_view.getPage(e);return i?i.iOverlaylist.get(t):null},getPage:function(e){if("string"!=typeof e)return e;var t;return t=interaction_view.ipagelist.getPage(e)?interaction_view.ipagelist.getPage(e):interaction_view.imasterlist.get(e)||interaction_view.ibackgroundlist.get(e),!t&&"undefined"!=typeof configpage&&configpage.page&&configpage.page.id==e?configpage.page:t},_setXY:function(e,t){},_setRotate:function(){},getTransform:function(e){},setTransform:function(e,t){},_checkPropPrefix:function(e,t){t=t||r;var i,n,a=t.style;if(void 0!==a[e])return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),i=["O","Moz","ms","Ms","Webkit"],n=5;--n>-1&&void 0===a[i[n]+e];);return n>=0?(_prefix=3===n?"ms":i[n],_prefixCSS="-"+_prefix.toLowerCase()+"-",_prefix+e):null},_getXY:function(e){e=e[0]?e[0]:e;var t=interaction_view.TransformPrefix,i=new WebKitCSSMatrix(e.style[t]);return{x:i.e,y:i.f}},_getmatrix:function(e,t,i,n,a,r){var o=Math.round(180*Math.asin(e)/Math.PI),s=Math.round(180*Math.acos(t)/Math.PI),l=Math.round(180*Math.asin(i)/Math.PI),c=Math.round(180*Math.acos(n)/Math.PI),d=0;return o==s||-o==s?d=c:-o+s==180?d=180+l:o+s==180&&(d=360-l||360-c),d>=360?0:d},_getRotation:function(e){e=e[0]?e[0]:e;var t=interaction_view.TransformPrefix,i=new WebKitCSSMatrix(e.style[t]);console.log(i);var n=Math.PI;return{x:Math.acos(i.a)*(180/n),y:Math.asin(i.b)*(180/n)}},_setSize:function(){},_setXY:function(){},_setRotation:function(){},isEvilCode:function(e){return"string"==typeof e&&e.toLowerCase().match(/\s?on\w+\s?=\s?['"]?\w+|\$\.|<iframe|<embed|<frame|<object|<script/)?(console.log("evilCode:"+e),""):e},setCrossOrigin:function(e,t){return 0===t.indexOf("data:")?e.crossOrigin=null:e.setAttribute("crossOrigin","anonymous"),e.crossOrigin}};return o}),define("text!interaction_view/template/pagenumber.tpl",[],function(){return'<%if(presentation.getPageNumber().horizontal_count>1){ %>\n<nav class="iView master nav-horizen pagenumber" style="position:absolute;left:<%=pageno_horizontal.x%>px;top:<%=pageno_horizontal.y%>px;<%=pageno_horizontal.show?"":"display:none;"%>">\n    <%for(i=0;i<presentation.getPageNumber().horizontal_count;i++){%><li class="<%=Reveal.getIndices().h==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>\n<%if(presentation.getPageNumber().vertical_count>1){ %>\n<nav class="iView master nav-vertical pagenumber" style="position:absolute;left:<%=pageno_vertical.x%>px;top:<%=pageno_vertical.y%>px;<%=pageno_vertical.show?"":"display:none;"%>">\n    <%for(i=0;i<presentation.getPageNumber().vertical_count;i++){%><li class="<%=Reveal.getIndices().v==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>'}),define("interaction_view/ui/presentation",["_g/ui","text!interaction_view/template/pagenumber.tpl"],function(){var e=require("text!interaction_view/template/pagenumber.tpl"),t={masterPageReset:function(){interaction_view.imasterlist.length&&interaction_view.imasterlist.at(0).iOverlaylist.each(function(e){_.include(["Grid","PageIndex","Gallery"],e.get("iType"))&&e.iview.resetOtherStatus()})},preloadpageAudio:function(e){interaction_view.ismobile&&interaction_view.imasterlist.at(0).iOverlaylist.each(function(e){"Audio"==e.get("iType")&&e.media&&(e.hasPlayed||e.get("iDetail").iAutoplay&&(e.media&&e.media.paused&&interaction_view.media.play(e),e.hasPlayed=!0))})},play:function(e){if(/^page/.test(e)&&window.scormPlayer&&window.scormPlayer.initStopPlay)return void(window.scormPlayer.initStopPlay=!1);var i=function(e){return"Video"==e.get("iType")||"QQVideo"==e.get("iType")?e.iosautoplay&&interaction_view.isIos?!0:!interaction_view.ismobile:!0},n=null;if(n="string"==typeof e?interaction_view.getParentpage(e):e,!n.isLayer&&"page"==n.get("type")){if(1==interaction_view.environment.Shareapp.status)return void(interaction_view.environment.Shareapp.waitpage=n.id);interaction_view.environment.Shareapp.waitpage==n.id&&(interaction_view.environment.Shareapp.waitpage="")}"Page"==interaction_view.mode&&!n.isLayer&&interaction_view.ipagelist.getPage(n.id)&&(t.setBackgroundDisplay(n),"undefined"!=typeof ScrollPage&&ScrollPage.bindScrollPage(interaction_view.currentPage)),1==n.playFinished&&(n.iOverlaylist.resetViewStatus(),n.iOverlaylist.resetBindings(),n.iAnimationlist.resetAnimationStatus(),n.playFinished=!1),n.iOverlaylist.each(function(e){n.playFinished||e._reset&&e.iview.resetStatus(),e.media&&((e.autoplay||e.iosautoplay&&e.firstplayed)&&i(e)?(interaction_view.media.play(e,{autoplay:!0}),e.media.paused||(e.hasPlayed=!0)):("Video"==e.get("iType")||"QQVideo"==e.get("iType"))&&(e.get("iDetail").iHidden||(e.notallowed=!0,e.iview.$el.removeClass("hide"),e.iview.$el.css("opacity",1),e.control&&e.iview.$el.find("video").css("display","block"),e.hided=!1))),e.renderWebContent&&e.iview.renderWebContent(),e.iview.immediateRender&&e.iview.immediateRender()}),n.played=!1,n.isRedirect=!1,interaction_view.events.clearWaitClick(),interaction_view.events.clearAnimationWaitSwipe(),n.iAnimationlist.setParams(),n.iAnimationlist.css_timeline&&n.iAnimationlist.css_timeline.play(),n.iAnimationlist.setPlay(),n.playFinished=!0,"Page"!=interaction_view.mode||n.isLayer||(interaction_view.ipagelist.getPage(n.id)&&t.setMasterDisplay(n),interaction_view.masterplayed||(interaction_view.masterplayed=!0,interaction_view.imasterlist.length&&interaction_view.play(interaction_view.imasterlist.at(0)))),"Page"!=interaction_view.mode||interaction_view.backgroundplayed||n.isLayer||(interaction_view.backgroundplayed=!0,interaction_view.ibackgroundlist.length&&interaction_view.play(interaction_view.ibackgroundlist.at(0))),n.isLayer?interaction_view.events.onPageStart(n.iOverlaylist.pageid,n.iOverlaylist.layerid):interaction_view.events.onPageStart(n.id),interaction_view.events.onControllerEvent(n.id),n.iAnimationlist.timeline&&n.iAnimationlist.timeline.play(0,!1),n.iOverlaylist.each(function(e){switch(e.get("iType")){case"LayerRef":case"LayerSlide":case"ComponentRef":e.iview.playLayer();break;case"Timer":e.iview.resetTimer();break;case"Vote":e.iview.triggerVoted();break;case"Variable":case"SystemVariable":e.iview.triggerVarChange()}e._autoplay&&e.iview._autoplay(),e.iview.onPlay&&e.iview.onPlay()}),n.runtimeCache=n.runtimeCache||{}},pause:function(e){var t;t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,t.playFinished&&t.iAnimationlist.timeline&&t.iAnimationlist.timeline.pause()},continuePlay:function(e){var t;t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,t.playFinished&&t.iAnimationlist.timeline&&t.iAnimationlist.timeline.resume()},stop:function(e){var t;if(t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,interaction_view.preloadended=!1,t.playFinished){if(t.anchorIndex=void 0,t.iAnimationlist.timeline&&(t.iAnimationlist.timeline.pause(0),t.iOverlaylist.resetViewStatus(),"string"==typeof e&&$(".interaction-view").css("cursor","auto"),interaction_view.bezierPatch(e)),t.iAnimationlist.css_timeline&&t.iAnimationlist.css_timeline.stop(),t.css_timelines&&t.css_timelines.length){for(var i=0;i<t.css_timelines.length;i++)t.css_timelines[i].stop();t.css_timelines=[]}t.iActionlist.each(function(e){if(e.iview.timeline){for(var t=e.iview.timeline.getChildren(),i=0;i<t.length;i++)t[i].actionNoClear&&e.iview.timeline.remove(t[i]);e.iview.timeline.pause(1e-5)}}),t.iOverlaylist.each(function(e){if(e.media&&(e.iview.resetOtherStatus(),"Video"==e.iview.iType||"QQVideo"==e.iview.iType)){try{interaction_view.media.pause(e)}catch(t){}e.iview.$el.addClass("hide")}("LayerRef"==e.iview.iType||"LayerSlide"==e.iview.iType||"ComponentRef"==e.iview.iType)&&e.iview.stoplayer(),("LayerRef"==e.iview.iType||"Image"==e.iview.iType||"ImageBlock"==e.iview.iType)&&e.iview.renderMask(),("Slide"==e.iview.iType||"LayerSlide"==e.iview.iType||"CycleImage"==e.iview.iType)&&e.iview.timeline&&e.iview.timeline.pause(1e-5),"Timer"==e.iview.iType&&e.iview.stopTimerSimple(),e.renderWebContent&&e.iview.clearWebContent(),e.iview.onStop&&e.iview.onStop()}),ScrollPage.reset(t)}"string"==typeof e&&(t.iview.$el.hasClass("dragConnector")&&connector.clearDragController(t.iview.$el),interaction_view.events.onPageStopClear(e))},getPageNumber:function(){var e=Reveal.getVerticalLength(),t=Reveal.getHorizontalLength();return{vertical_count:e,horizontal_count:t}},setMasterDisplay:function(e){t.setPageNumber(e),interaction_view.show_master=e.get("show_master")?!0:!1;var i=$('.Presentation[id="'+e.id+'"]').find(".interaction-view");interaction_view.touchview&&(i=$(".reveal")),interaction_view.show_master||"Master"==interaction_view.mode?i.children(".iView.master").removeClass("masterhide"):i.children(".iView.master").addClass("masterhide"),t.masterPageReset(e)},setBackgroundDisplay:function(e){interaction_view.show_background=e.get("show_background")?!0:!1;var t=$('.Presentation[id="'+e.id+'"]').find(".interaction-view");interaction_view.touchview&&(t=$(".reveal")),interaction_view.show_background||"Background"==interaction_view.mode?t.children(".iView.background").removeClass("backgroundhide"):t.children(".iView.background").addClass("backgroundhide")},setPageNumber:function(i){var n=$('.Presentation[id="'+i.id+'"]').find(".interaction-view");interaction_view.touchview&&(n=$(".reveal")),"Master"!=interaction_view.mode&&"Page"!=interaction_view.mode||!interaction_view.imasterlist.length||(n.children(".iView.master.pagenumber").remove(),n.append(_.template(e,interaction_view.imasterlist.at(0).toJSON())),t.setPageNumberPosition())},setPageNumberPosition:function(){$("nav.pagenumber").each(function(){$(this).css({left:$(this).position().left-$(this).outerWidth(!1)/2,top:$(this).position().top-$(this).outerHeight(!1)/2})})},bezierPatch:function(e){var t;t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,t.iAnimationlist.each(function(e){_.include([301,302],e.get("iType"))&&e.toJSON().iDetail.autoRotate&&e._animation&&TweenMax.set(e._animation.obj,{rotation:"0_cw"})})},startLoad:function(){t.pagesForLoad=[],interaction_view.imasterlist&&interaction_view.imasterlist.length&&t.pagesForLoad.push(interaction_view.imasterlist.at(0).id),interaction_view.ibackgroundlist&&interaction_view.ibackgroundlist.length&&t.pagesForLoad.push(interaction_view.ibackgroundlist.at(0).id),_.each(interaction_view.ipagelist.getPages(),function(e){t.pagesForLoad.push(e.id)}),interaction_view.iconfiglist&&interaction_view.iconfiglist.length&&t.pagesForLoad.push(interaction_view.iconfiglist.at(0).id),t.pagelength=t.pagesForLoad.length;var e;if(!interaction_view.forpreview||"Layer"!=interaction.doc.mode&&"Background"!=interaction.doc.mode){if(interaction_view.imasterlist&&interaction_view.imasterlist.length||interaction_view.ibackgroundlist&&interaction_view.ibackgroundlist.length){if(interaction_view.imasterlist&&interaction_view.imasterlist.length&&(e=interaction_view.imasterlist.at(0)),interaction_view.ibackgroundlist&&interaction_view.ibackgroundlist.length){var i=interaction_view.ibackgroundlist.at(0);i.iview.prepareLoad(),i.iview.startLoad(),i.isStartLoad=!0}}else e=interaction_view.ipagelist.at(0);if(interaction_view.iconfiglist&&interaction_view.iconfiglist.length){var n=interaction_view.iconfiglist.at(0);n.iview.prepareLoad(),n.iview.startLoad(),n.isStartLoad=!0}}else e=interaction_view.imasterlist&&interaction_view.imasterlist.length?interaction_view.imasterlist.at(0):interaction_view.ipagelist.at(0);e.iview.prepareLoad(),e.iview.startLoad(),e.isStartLoad=!0},pagesForLoad:[],pageLoadEvent:function(e){},pageLoad:function(e){var i=interaction_view.ipagelist.getPage(e);i.isStartLoad||i.get("loaded")?interaction_view.ismobile&&t.pagePreloadCenter(e):(i.iview.prepareLoad(),i.iview.startLoad(),i.isStartLoad=!0)},bookStatus:0,foredit:function(){},forpreview:function(){interaction_view.mode="Page",interaction_view.events.clearAll(),$("body").children("preloader").remove(),$("body").append('<div id="preloader"></div>'),interaction_view.forpreview||$("body").prepend('<div class="loading progress progress-striped active"><div class="bar" style="width: 0%;"></div></div>'),interaction_view.finishPagePreload=function(e,i){if(t.pagesForLoad=_.reject(t.pagesForLoad,function(t){return t==e}),i||(i=interaction_view.ipagelist.getPage(e)||interaction_view.imasterlist.get(e)||interaction_view.ibackgroundlist.get(e)),"Layer"==i.get("iType")&&(interaction_view.preloadended=!0),interaction_view.donext(i),i.set("loaded",!0,{silent:!0}),(0==t.pagesForLoad.length||t.pagelength-t.pagesForLoad.length>=1)&&(0==interaction_view.imasterlist.length||interaction_view.imasterlist.at(0).get("loaded"))&&(0==interaction_view.ibackgroundlist.length||interaction_view.ibackgroundlist.at(0).get("loaded"))){var n="undefined"!=typeof configpage&&configpage.page&&configpage.page.get("loaded"),a="undefined"!=typeof configpage&&configpage.page;(!a||n)&&(interaction_view.preloadended||(interaction_view.preloadended=!0,n&&"undefined"!=typeof config_player&&config_player&&t.play(configpage.page)))}if("wait"==interaction_view.playstatus&&interaction_view.preloadended){var r=interaction_view.ipagelist.getPage(interaction_view.currentPage);r.get("loaded")&&(interaction_view.playstatus="play",interaction_view.containment.children(".prejsloading").length?(clear_loading_progress_waiting=clear_loading_progress_waiting||200,clear_loading_progress_waiting<=200&&(clear_loading_progress_waiting=100),loading_progress_percent<60?(clear_loading_progress_waiting<=200&&(loading_progress_percent=66),window.loading_progress_timer1=setInterval(function(){compute_loadding_progress(),set_loading_progress()},clear_loading_progress_waiting)):(loading_progress_percent=100,set_loading_progress(),clearInterval(loading_progress_timer),workEnd("-------- 3. presentation : start clear loading 1 --------"),interaction_view.containment.children(".prejsloading").fadeOut(800,function(){interaction_view.containment.children(".prejsloading").remove(),interaction_view.play(interaction_view.currentPage),workEnd("-------- 3. presentation : start clear loading 1 --------"),window.loadAnalytics&&loadAnalytics()}))):($(".reveal_origin").length&&($(".reveal").removeClass("invisible noevents"),$(".reveal_origin").remove()),interaction_view.containment.children("#jswait-loading").remove(),interaction_view.play(interaction_view.currentPage)),interaction_view.isWeixin&&"undefined"!=typeof weixin_initial&&0==weixin_initial&&weixin_config_ready>0&&"function"==typeof load_wx?load_wx():"undefined"!=typeof load_analytics&&"function"==typeof load_analytics&&load_analytics())}else if(interaction_view.preloadended&&interaction_view.transitionPagePreLoad&&e==interaction_view.transitionPagePreLoad.page_id){var o=interaction_view.transitionPagePreLoad.transition,s=interaction_view.transitionPagePreLoad.redirect;interaction_view.transitionPagePreLoad=null,t.gotopage(e,o,s)}if(0==t.pagesForLoad.length?$(".loading").remove():interaction_view.ismobile||interaction_view.ipagelist.getPage(t.pagesForLoad[0])&&t.pageLoad(t.pagesForLoad[0]),interaction_view.ismobile)if(t.isFirstPageLoading){if(e==t.isFirstPageLoading&&(t.firstpageloaded=!0),t.firstpageloaded&&interaction_view.imasterlist.at(0).get("loaded")&&interaction_view.ibackgroundlist.at(0).get("loaded")){var l=t.isFirstPageLoading;t.isFirstPageLoading=null,t.preloadFourDirections(),t.pagePreloadCenter(l)}}else t.pagePreloadCenter(e)},interaction_view.setPreloadStatus=function(){var e=0,t=0;_.each(interaction_view.ipagelist.getPages(),function(i){t+=i.ipreloadlist.length,i.ipreloadlist.length>0&&(e+=i.ipreloadlist.where({loaded:!0}).length)}),interaction_view.imasterlist.length&&(t+=interaction_view.imasterlist.at(0).ipreloadlist.length,interaction_view.imasterlist.at(0).ipreloadlist.length>0&&(e+=interaction_view.imasterlist.at(0).ipreloadlist.where({loaded:!0}).length)),interaction_view.ibackgroundlist.length&&(t+=interaction_view.ibackgroundlist.at(0).ipreloadlist.length,interaction_view.ibackgroundlist.at(0).ipreloadlist.length>0&&(e+=interaction_view.ibackgroundlist.at(0).ipreloadlist.where({loaded:!0}).length)),$(".loading").children("div").css("width",String(e/t*100)+"%")},interaction_view.donext=function(e){e.iview.afterpreload()},interaction_view.play=t.play,interaction_view.stopPlay=t.stop,interaction_view.pausePlay=t.pause,interaction_view.continuePlay=t.continuePlay,interaction_view.bezierPatch=t.bezierPatch,interaction_view.slideChange=function(e){if(Reveal&&("number"==typeof e&&Reveal.slide(e),"string"==typeof e)){var t=interaction_view.getModelById(interaction_view.iChapter,e);Reveal.slide(t.get("index"))}},interaction_view.firstPlay=!0},screencontrol:function(){window.isFullscreen=!1,window.screenLock=!1,window.screenAutoAdapt=function(){if(!window.screenLock)if(screenfull.isFullscreen){isFullscreen=!0;var e=window.screen.width/window.screen.height>=interaction_view.size.x/interaction_view.size.y?window.screen.height/interaction_view.size.y:window.screen.width/interaction_view.size.x;_g.ui.scale(".reveal",e)}else isFullscreen=!1,_g.ui.scale(".reveal",1)},!interaction_view.ismobile&&(screenfull.onchange=screenAutoAdapt)},gotopagebyargs:function(e,i,n){var a=null;if(_.isNumber(e)&&!_.isNaN(e))a=interaction_view.ipagelist.getPages()[e]?interaction_view.ipagelist.getPages()[e].id:null;else if(_.include(["first","last","prev","next"],e))switch(e){case"first":a=Reveal.getFirst();break;case"last":a=Reveal.getLast();break;case"prev":a=Reveal.getPrev();break;case"next":a=Reveal.getNext()}else a=e;return a&&t.gotopage(a,i||0,n),a},gotopage:function(e,i,n){interaction_view.transitionPagePreLoad=null;var a,r,o,s,l=null;if(e!=interaction_view.currentPage){switch(i){case 0:o=0,r="y",a="up",s=1;break;case 1:o=0,r="x",a="right",s=-1;break;case 2:o=0,r="y",a="down",s=-1;break;case 3:o=0,r="x",a="left",s=1;break;case 4:o=1,r="y",a="up",s=1;break;case 5:o=1,r="x",a="right",s=-1;break;case 6:o=1,r="y",a="down",s=-1;break;case 7:o=1,r="x",a="left",s=1;break;case 8:o=2,r="x",a="left",s=1;break;case 10:o=3,r="y",a="up",s=1;break;case 11:o=3,r="x",a="right",s=-1;break;case 12:o=3,r="y",a="down",s=-1;break;case 13:o=3,r="x",a="left",s=1;break;case 14:o=4,r="y",a="up",s=1;break;case 15:o=4,r="x",a="right",s=-1;break;case 16:o=4,r="y",a="down",s=-1;break;case 17:o=4,r="x",a="left",s=1;break;case 18:o=5,r="y",a="up",s=1;break;case 19:o=5,r="x",a="right",s=-1;break;case 20:o=5,r="y",a="down",s=-1;break;case 21:o=5,r="x",a="left",s=1}if(interaction_view.ipagelist.getPage(e)){var c=interaction_view.ipagelist.getPage(e);if(0==interaction_view.doc.toJSON().play_mode?indexh=interaction_view.ipagelist.indexOf(c):(c.icollection.length&&(c=c.icollection.at(0)),indexh=c.collection.parent.collection.indexOf(c.collection.parent),l=c.collection.indexOf(c)),!c.get("loaded"))return interaction_view.transitionPagePreLoad={page_id:e,transition:i,redirect:n},void t.pageLoad(e);if(n&&interaction_view.currentPage&&(interaction_view.ipagelist.getPage(interaction_view.currentPage).isRedirect=!0),Reveal.lockAction=!0,9==i)return void Reveal.slide(indexh,l);Reveal.setSingleSlideItem(indexh,l,a),Reveal.originh=Reveal.indexh,Reveal.originv=Reveal.indexv,Reveal.indexh=indexh,null!=l&&(Reveal.indexv=l),Reveal.transition.autostart(o,r,s)}}},preloadFourDirections:function(){t.touchPreloadPageList=[];var e=Reveal.getSlideDirections();e.left?t.touchPreloadPageList.push(Reveal.getLeft()):interaction_view.control.getGroupLeft(Reveal.getCurrentSlideId())&&t.touchPreloadPageList.push(interaction_view.control.getGroupLeftId(Reveal.getCurrentSlideId())),e.right?t.touchPreloadPageList.push(Reveal.getRight()):interaction_view.control.getGroupRight(Reveal.getCurrentSlideId())&&t.touchPreloadPageList.push(interaction_view.control.getGroupRightId(Reveal.getCurrentSlideId())),3==Reveal.slideType&&(e.up&&t.touchPreloadPageList.push(Reveal.getUp()),e.down&&t.touchPreloadPageList.push(Reveal.getDown())),t.touchPreloadPageList.length&&t.pagePreloadCenter()},clearPreloadPages:function(){t.touchClearPageList=[];for(var e=Reveal.getAllSlideIds(),i=0;i<e.length;i++){var n=e[i];n!=Reveal.getLeft()&&n!=Reveal.getRight()&&n!=Reveal.getUp()&&n!=Reveal.getDown()&&n!=Reveal.getCurrentSlideId()&&n!=interaction_view.control.getGroupRightId(Reveal.getCurrentSlideId())&&n!=interaction_view.control.getGroupLeftId(Reveal.getCurrentSlideId())&&t.touchClearPageList.push(n)}t.touchClearPageList.length&&t.pageClearCenter()},pagePreloadCenter:function(e){if(e&&(t.touchPreloadPageList=_.reject(t.touchPreloadPageList,function(t){return t==e})),t.touchPreloadPageList.length){var i=t.touchPreloadPageList[0];t.pageLoad(i)}},pageClearCenter:function(e){if(e&&(t.touchClearPageList=_.reject(t.touchClearPageList,function(t){return t==e})),t.touchClearPageList.length){var i=interaction_view.ipagelist.getPage(t.touchClearPageList[0]);i.iview.clearPageLoad()}},touchPreloadPageList:[],touchClearPageList:[]};window.presentation=t}),define("interaction_view/ui/control",[],function(){var e={bindArrowControls:function(){Reveal.setNavigateFuncs({navigateLeft:e.slideLeft,navigateRight:e.slideRight})},slideUp:function(){Reveal.up()},slideDown:function(){Reveal.down()},slideLeft:function(){var t=Reveal.getCurrentSlide().id,i=e.getLeft(t);i&&e.slideTo(i.id)},slideRight:function(){var t=Reveal.getCurrentSlide().id,i=e.getRight(t);i&&e.slideTo(i.id)},getGroupLeft:function(e){if(3!=Reveal.slideType)return null;var t=interaction_view.ipagelist.getPage(e);if(!t)return null;var i=(t.get("group"),t.collection.parent),n=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(i)-1);if(n){var a=n.icollection.at(0);return a}return null},getGroupRight:function(e){if(3!=Reveal.slideType)return null;var t=interaction_view.ipagelist.getPage(e);if(!t)return null;var i=(t.get("group"),t.collection.parent),n=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(i)+1);if(n){var a=n.icollection.at(0);return a}return null},getGroupLeftId:function(e){var t=interaction_view.control.getGroupLeft(e);return t?t.id:null},getGroupRightId:function(e){var t=interaction_view.control.getGroupRight(e);return t?t.id:null},getRight:function(e){var t=interaction_view.ipagelist.getPage(e),i=t.get("group"),n=t.collection.parent,a=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(n)+1);if(a){var r=a.icollection.at(0),o=r.get("group");return i!=o?!1:r}return!1},getLeft:function(e){var t=interaction_view.ipagelist.getPage(e),i=t.get("group"),n=t.collection.parent,a=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(n)-1);if(a){var r=a.icollection.at(0),o=r.get("group");return i!=o?!1:r}return!1},getCurrent:function(){},slideTo:function(e){var t=interaction_view.ipagelist.getPage(e);indexh=t.collection.parent.collection.indexOf(t.collection.parent),indexv=t.collection.indexOf(t),Reveal.slide(indexh,indexv)}};return e}),function(){var e={addEvent:function(e,t,i,n){e.addEventListener?e.addEventListener(t,i,!!n):$(e).on(t,i)},removeEvent:function(e,t,i,n){e.removeEventListener?e.removeEventListener(t,i,!!n):$(e).off(t,i)},document:{disable_contextmenu:function(e){e||(e=document),e.oncontextmenu=function(e){return e&&e.preventDefault(),!1}},enable_contextmenu:function(e){e||(e=document),e.oncontextmenu=function(e){}},onCopy:function(e,t){$(document).on("copy",function(e){console.log(e)})},disable_paste:function(){document.disable_paste=!0},enable_paste:function(){document.disable_paste=!1}}};"undefined"==typeof require?(window._g||(window._g={}),window._g.event=e):define("_g/event",["_g/base"],function(){return window._g.event=e,window._g.event})}(window),define("interaction_view/ui/event",["_g/ui","_g/event"],function(){var events={pageStartEvents:[],pageClickEvents:[],pageDblClickEvents:[],pageWXShareSuccessEvents:[],pageSwipeEvents:[],elementChangeToEvents:[],slideClickEvents:[],slideDblClickEvents:[],animationStartEvents:[],animationEndEvents:[],animationUpdateEvents:[],bindingEvents:[],mediaEvents:[],controllerEvents:[],dragStartEvents:[],dragEndEvents:[],draggingEvents:[],
dragDropEvents:[],dragDropGroupEvents:[],timerEvents:[],variableEvents:[],voteEvents:[],paragraphEvents:[],pageShakeEvents:[],formEvents:[],eraserEvents:[],formSubmitEvents:[],WeixinCameraEvents:[],collisionEvents:[],userListEvents:[],contactFormEvents:[],systemVariableEvents:[],videoAutoPlayControlPatch:[],userdataSaveEvents:[],sharedataSaveEvents:[],preloadPageEvents:[],epub360StartEvents:[],conditionEvents:[],scrollEvents:[],contentGridRenderEvents:[],buttonGroupSelectEndEvents:[],quizGroupSelectCorrectEvents:[],quizGroupSelectWrongEvents:[],longTakeStartEvents:[],longTakeEndEvents:[],longTakeLayerIntoEvents:[],longTakeLayerGoneEvents:[],orientationChangeEvents:[],pipFinishAction:[],pipStartAction:[],inCurPipAction:[],outCurPipAction:[],stateGroupUpdateEvents:[],init:function(){target=$(".slides"),target.on("click",function(e){return"undefined"!=typeof Reveal&&Reveal.lockAction?(e.preventDefault(),!1):void(events.testControl(e)&&events.onClickEvent())}),interaction_view.ismobile?target.hammer&&target.hammer().on("doubletap",function(e){events.testDblControl(e)&&(events.onDblClickEvent(),e.preventDefault()),_g.ui.clearSelection()}):target.on("dblclick",function(e){return"undefined"!=typeof Reveal&&Reveal.lockAction?(e.preventDefault(),!1):(events.testDblControl(e)&&(events.onDblClickEvent(),e.preventDefault()),void _g.ui.clearSelection())}),interaction_view.ismobile||events.initWheelEvent(),_e.orientation.inited||_e.orientation&&(_e.orientation.init(),_e.orientation.inited=!0),"1"!=_g.getUrlParameterByName("-build")&&_g.event.document.disable_contextmenu(),window.addEventListener("orientationchange",function(e){e.isTrusted&&events.onOrientationChange()},!1),events.initShakeEvent(),epub360.Player={},_.extend(epub360.Player,Backbone.Events)},wheelEvents:[],initWheelEvent:function(){_g.mousewheel.init()},initShakeEvent:function(){if(_g.device.mobile()&&"undefined"!=typeof Shake){var e=new Shake({threshold:_g_device.iphone()?11:25});e.start(),window.addEventListener("shake",function(){interaction_view.events.onPageShakeEvent()},!1)}},testControl:function(e){var t=$(e.target).closest(".iView");if($(e.target).closest(".iView").hasClass("hasaction"))return!1;if(t){var i=t.attr("data-type");if(("Slide"==i||"CycleImage"==i)&&t.attr("data-iSlipable"))return!1}return $(e.target).closest(".iLayerRef").length>0&&$(e.target).closest(".iLayerRef").parent(".iView").hasClass("hascontrols")?!1:!0},testDblControl:function(e){$(e.target).closest(".iView");return $(e.target).closest(".iView").hasClass("hasDblClick")?!1:!0},onPageStart:function(e,t){interaction_view.ipagelist.getPage(e)&&epub360.settings.pems.has_analytics_src&&interaction_view.analytics.set(e);var i=_.filter(interaction_view.events.pageStartEvents,function(i){return i.page_id==e&&(t?i.layer_id==t:!0)});i.length>0&&_.each(i,function(e){e.func()})},onPageSwipeEvent:function(e,t,i){if(Reveal.transition.isTransiting)return!1;var n=_.filter(interaction_view.events.pageSwipeEvents,function(n){return n.page_id==t&&(i?n.layer_id==i:!0)&&e==n.swipeType});return n.length>0?(_.each(n,function(e){e.func()}),events.clearAnimationWaitSwipe(),!0):!1},onPageShakeEvent:function(){var e=_.filter(interaction_view.events.pageShakeEvents,function(e){return e.page_id==interaction_view.currentPage||e.page_id==interaction_view.imasterlist.at(0).id});return e.length>0?(_.each(e,function(e){e.func()}),events.clearAnimationWaitShake(),!0):!1},onChangeTo:function(e,t,i){var n=_.filter(interaction_view.events.elementChangeToEvents,function(n){return n.page_id==e&&n.overlay_id==t&&n.index==i});n.length>0&&_.each(n,function(e){e.func()})},onClickEvent:function(){if(interaction_view.events.pageClickEvents.length>0){var e=_.filter(interaction_view.events.pageClickEvents,function(e){return"waitaction"==e.type});if(e.length>0)_.each(e,function(e){e.func()});else{var t=_.filter(interaction_view.events.pageClickEvents,function(e){return e.page_id==interaction_view.currentPage&&"page"==e.type});if(t.length>0)_.each(t,function(e){e.func()});else{var i=_.filter(interaction_view.events.pageClickEvents,function(e){return"master"==e.type});if(i.length>0)interaction_view.show_master&&_.each(i,function(e){e.func()});else{var n=_.filter(interaction_view.events.pageClickEvents,function(e){return"background"==e.type});interaction_view.show_background&&_.each(n,function(e){e.func()})}}}events.clearWaitClick()}},onDblClickEvent:function(){if(interaction_view.events.pageDblClickEvents.length>0){var e=_.filter(interaction_view.events.pageDblClickEvents,function(e){return e.page_id==interaction_view.currentPage&&"page"==e.type});if(e.length>0)_.each(e,function(e){e.func()});else{var t=_.filter(interaction_view.events.pageDblClickEvents,function(e){return"master"==e.type});if(t.length>0)interaction_view.show_master&&_.each(t,function(e){e.func()});else{var i=_.filter(interaction_view.events.pageDblClickEvents,function(e){return"background"==e.type});interaction_view.show_background&&_.each(i,function(e){e.func()})}}}},onSlideClickEvent:function(e,t,i,n,a){},onSlideDblClickEvent:function(e,t,i,n,a){},onControllerEvent:function(e){},onBingChangeTo:function(e){var t=_.filter(interaction_view.events.bindingEvents,function(t){return t.id==e.id&&t.page_id==e.page_id});_.each(t,function(t){e.direction=t.direction,t.func(e)})},onAnimationStart:function(e){var t=_.filter(interaction_view.events.animationStartEvents,function(t){return e.layer_id?e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.layer_id==e.layer_id:t.animation_id==e.animation_id&&t.layer_id==e.layer_id:e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.page_id==e.page_id:t.animation_id==e.animation_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onAnimationEnd:function(e){var t=_.filter(interaction_view.events.animationEndEvents,function(t){return e.layer_id?e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.layer_id==e.layer_id:t.animation_id==e.animation_id&&t.layer_id==e.layer_id:e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.page_id==e.page_id:t.animation_id==e.animation_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onAnimationUpdate:function(e){var t=_.filter(interaction_view.events.animationUpdateEvents,function(t){return e.layer_id?e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.layer_id==e.layer_id:t.animation_id==e.animation_id&&t.layer_id==e.layer_id:e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.page_id==e.page_id:t.animation_id==e.animation_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onStateGroupUpdate:function(e){var t=_.filter(interaction_view.events.stateGroupUpdateEvents,function(t){if(e.layer_id){if(e.overlay_id)return t.overlay_id==e.overlay_id&&t.layer_id==e.layer_id}else if(e.overlay_id)return t.overlay_id==e.overlay_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragStart:function(e){var t=_.filter(interaction_view.events.dragStartEvents,function(t){return e.layer_id?t.overlay_id==e.overlay_id&&t.layer_id==e.layer_id:t.overlay_id==e.overlay_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragEnd:function(e){var t=_.filter(interaction_view.events.dragEndEvents,function(t){return e.layer_id?t.overlay_id==e.overlay_id&&t.layer_id==e.layer_id:t.overlay_id==e.overlay_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragging:function(e){var t=_.filter(interaction_view.events.draggingEvents,function(t){return e.layer_id?t.overlay_id==e.overlay_id&&t.layer_id==e.layer_id:t.overlay_id==e.overlay_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragDrop:function(e,t,i){function n(t,i){return t.overlay_id!=e.id||t.drop_type!=i?!1:e.page.isLayer?t.layer_id==e.page.iOverlaylist.layerid:t.page_id==e.page.id}var a;return 0==i?(a=_.filter(interaction_view.events.dragDropEvents,function(e){return n(e,8)}),void _.each(a,function(e){e.func()})):(e.iview.Status=2,_.include(e.iview.getdetail().element_ids,t.id)?(e.iview.Status=1,a=_.filter(interaction_view.events.dragDropEvents,function(e){return n(e,9)})):a=_.filter(interaction_view.events.dragDropEvents,function(e){return n(e,10)}),void _.each(a,function(e){e.func()}))},onDragDropGroup:function(e){function t(e,t,i){return e.overlay_id!=i.id||e.drop_type!=t?!1:i.page.isLayer?e.layer_id==i.page.iOverlaylist.layerid:e.page_id==i.page.id}$.each(e.iview.DragDropGroups,function(e,i){var n=i.iview.getdetail().element_ids,a=0,r=!0;if($.each(n,function(e,t){var n=i.page.iOverlaylist.where({id:t})[0];if(n&&n.iview){if(n=n.iview,0==n.Status)return r=!1,!1;1==n.Status&&a++}}),r){var o;o=a==n.length?_.filter(interaction_view.events.dragDropGroupEvents,function(e){return t(e,11,i)}):_.filter(interaction_view.events.dragDropGroupEvents,function(e){return t(e,12,i)}),_.each(o,function(e){e.func()})}})},onTimerStart:function(e){_.each(e.Actions_19,function(e){e.func()})},onTimerStop:function(e){_.each(e.Actions_17,function(e){e.func()})},onTimerInterval:function(e,t){_.each(e.Actions_18,function(e){(0==(Math.abs(t%e.condition)-e.condition).toFixed(2)||0==Math.abs(t%e.condition).toFixed(2))&&e.func()})},onTimerCountTo:function(e){_.each(e.Actions_16,function(t){var i=e.currentTime-t.condition,n=2*Math.abs(i);(0>=i&&n<=e.frame||i>0&&n<e.frame)&&t.func()})},onVariableChanged:function(view){var detail=view.getdetail(),initial="0"==detail.iKind&&Number(detail.initial)||detail.initial,actions=_.filter(interaction_view.events.variableEvents,function(e){return interaction_view.events.filterType(view,e,22)}),VarOPobj=interaction_view.getVarsOp(interaction_view.currentPage,null,interaction_view.environment.Votes.get());_.each(actions,function(v){var cond;cond=v.condition.replace(/%@/g,"initial"),cond=VarOPobj.var2val(cond,!0),eval(cond)&&v.func()})},onSystemVariableChanged:function(e){var t=_.filter(interaction_view.events.systemVariableEvents,function(t){return interaction_view.events.filterTypeByView(e,t)});t.length&&(console.log(t),_.each(t,function(e){if(100==e.type&&interaction_view.isWeixin&&e.func(),101!=e.type||interaction_view.isWeixin||e.func(),102==e.type&&interaction_view.isAndroid&&e.func(),103==e.type&&interaction_view.isIos&&e.func(),104==e.type&&interaction_view.isWin&&e.func(),105==e.type&&interaction_view.isMac&&e.func(),160==e.type&&_g.device.portrait()&&e.func(),161==e.type&&_g.device.landscape()&&e.func(),"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.is_subscribe){if(interaction_view.foredit)return void global.message("warning","请使用预览全部模式预览该功能");110==e.type&&epub360_userinfo.is_subscribe&&e.func(),111!=e.type||epub360_userinfo.is_subscribe||e.func()}"epub360"==epub360_domain&&(130==e.type&&0==interaction_view.environment.Sharedata.mode&&e.func(),131==e.type&&1==interaction_view.environment.Sharedata.mode&&e.func()),"epub360"==epub360_domain&&"undefined"!=typeof epub360_userinfo&&(140==e.type&&1==epub360_userinfo.visit_count&&e.func(),141==e.type&&epub360_userinfo.visit_count>1&&e.func())}))},onVoted:function(e){var t=_.filter(interaction_view.events.voteEvents,function(t){return interaction_view.events.filterType(e,t,23)});_.each(t,function(e){e.func()})},onParagraphChanged:function(e){var t=_.filter(interaction_view.events.paragraphEvents,function(t){return interaction_view.events.filterType(e,t,54)});_.each(t,function(e){e.func()})},onFormEvent:function(e,t){var i=e.createPath(),n=_.filter(interaction_view.events.formEvents,function(e){return e.overlay&&interaction_view.hashPath(i)==interaction_view.hashPath(e.overlay.path)+e.overlay.id});"Select"==e.get("iType")?_.each(n,function(i){if(e.attributes.iDetail.sourceType)i.func(t);else{var n=!1;i.key?i.key==t?(i.func(t),n=!0):i.clearValue():(i.func(t),n=!1)}}):_.each(n,function(e){e.func(t)})},onFormSubmitEvent:function(e,t){var i=_.filter(interaction_view.events.formSubmitEvents,function(e){return e.id==t});_.each(i,function(e){e.func(status)})},onFormButtonRender:function(e){var t=e.createPath(),i=null,n=null,a=_.filter(interaction_view.events.formEvents,function(e){return e.overlay&&interaction_view.hashPath(t)==interaction_view.hashPath(e.overlay.path)+e.overlay.id});return _.each(a,function(t){n=t,i=interaction_view.application.getValue(t.id,t.cid,t.key),t.bindSwitch&&interaction_view.application.sendOverlayToButtonGroup(e)}),{field:n,value:i}},onEraserEvent:function(e){var t=_.filter(interaction_view.events.eraserEvents,function(t){return interaction_view.events.filterType(e,t,41)});_.each(t,function(e){e.func()})},onWeixinEvent:function(e,t){var i=_.filter(interaction_view.events.WeixinCameraEvents,function(i){return interaction_view.events.filterType(e,i,t)});_.each(i,function(e){e.func()})},onCollision:function(e){var t=_.filter(interaction_view.events.collisionEvents,function(t){return interaction_view.events.filterType(e,t,73)});_.each(t,function(e){e.func()})},onUserList:function(e,t){var i=_.filter(interaction_view.events.userListEvents,function(i){return interaction_view.events.filterType(e,i,t)});_.each(i,function(e){e.func()})},onContactFormSubmit:function(e,t,i,n){var a=_.filter(interaction_view.events.contactFormEvents,function(i){return interaction_view.events.filterType(e,i,t)});a.length?_.each(a,function(e){e.func()}):82==t?interaction_view.errorAlert(i):interaction_view.errorAlert("提交失败!"),n&&n()},onUserdataSave:function(e){var t=_.filter(interaction_view.events.userdataSaveEvents,function(t){var i=e.model.toJSON();return t.userdatasave_hash==i.page_id+"_"+i.id});_.each(t,function(e){e.func()})},onSharedataSave:function(e){var t=_.filter(interaction_view.events.sharedataSaveEvents,function(t){return t.sharedatasave_hash==e.model.toJSON().id});_.each(t,function(e){e.func()})},onContentGridRender:function(e,t){var i=_.filter(interaction_view.events.contentGridRenderEvents,function(t){return interaction_view.events.filterType(e,t,"onRender")});_.each(i,function(e){e.func(null,t)})},clearWaitClick:function(){interaction_view.events.pageClickEvents=_.reject(interaction_view.events.pageClickEvents,function(e){return"waitaction"==e.type})},clearAnimationWaitSwipe:function(){interaction_view.events.pageSwipeEvents=_.reject(interaction_view.events.pageSwipeEvents,function(e){return"waitaction"==e.type})},clearAnimationWaitShake:function(){interaction_view.events.pageShakeEvents=_.reject(interaction_view.events.pageShakeEvents,function(e){return"waitaction"==e.type})},clearRelatedEvents:function(e){interaction_view.events.animationStartEvents=_.reject(interaction_view.events.animationStartEvents,function(t){return t.page_id==e||t.iPage_id==e}),interaction_view.events.animationEndEvents=_.reject(interaction_view.events.animationEndEvents,function(t){return t.page_id==e||t.iPage_id==e}),interaction_view.events.animationUpdateEvents=_.reject(interaction_view.events.animationUpdateEvents,function(t){return"collision"==t._label&&(t.page_id==e||t.iPage_id==e)}),interaction_view.events.stateGroupUpdateEvents=_.reject(interaction_view.events.stateGroupUpdateEvents,function(t){return t.page_id==e||t.iPage_id==e}),interaction_view.events.draggingEvents=_.reject(interaction_view.events.draggingEvents,function(t){return"collision"==t._label&&(t.page_id==e||t.iPage_id==e)}),interaction_view.events.variableEvents=_.reject(interaction_view.events.variableEvents,function(t){return t.iPage_id==e})},onPageStopClear:function(e){interaction_view.events.conditionEvents=_.map(interaction_view.events.conditionEvents,function(t){return t.page_id==e&&(t.result=null),t}),interaction_view.events.scrollEvents=_.map(interaction_view.events.scrollEvents,function(t){return t.page_id==e&&(t.executed=!1),t})},onButtonGroupSelectEnd:function(e){var t=_.filter(interaction_view.events.buttonGroupSelectEndEvents,function(t){return interaction_view.events.filterType(e,t,"onSelectEnd")});_.each(t,function(e){e.func()})},onQuizGroupSelectCorrect:function(e){var t=_.filter(interaction_view.events.quizGroupSelectCorrectEvents,function(t){return interaction_view.events.filterType(e,t,"onSelectCorrect")});_.each(t,function(e){e.func()})},onQuizGroupSelectWrong:function(e){var t=_.filter(interaction_view.events.quizGroupSelectWrongEvents,function(t){return interaction_view.events.filterType(e,t,"onSelectWrong")});_.each(t,function(e){e.func()})},onLongTakeStart:function(e){var t=_.filter(interaction_view.events.longTakeStartEvents,function(t){return interaction_view.events.filterType(e,t,"onLongTakeStart")});_.each(t,function(e){e.func()})},onLongTakeEnd:function(e){var t=_.filter(interaction_view.events.longTakeEndEvents,function(t){return interaction_view.events.filterType(e,t,"onLongTakeEnd")});_.each(t,function(e){e.func()})},onLTLayerInto:function(e){var t=_.filter(interaction_view.events.longTakeLayerIntoEvents,function(t){return _.findWhere([t],e)});_.each(t,function(e){e.func()})},onLTLayerGone:function(e){var t=_.filter(interaction_view.events.longTakeLayerGoneEvents,function(t){return _.findWhere([t],e)});_.each(t,function(e){e.func()})},onOrientationChange:function(){var e=interaction_view.currentPage,t=_.filter(interaction_view.events.orientationChangeEvents,function(t){return t.page_id==e});_.each(t,function(e){e.func()})},onPipStart:function(e){var t=_.filter(interaction_view.events.pipStartAction,function(t){return interaction_view.events.filterType(e,t,"onPipStart")});_.each(t,function(e){e.func()})},onPipFinish:function(e){var t=_.filter(interaction_view.events.pipFinishAction,function(t){return interaction_view.events.filterType(e,t,"onPipFinish")});_.each(t,function(e){e.func()})},inCurPip:function(e,t){var i=_.filter(interaction_view.events.inCurPipAction,function(i){return interaction_view.events.filterPipType(e,i,"inCurPip",t)});_.each(i,function(e){e.func()})},outCurPip:function(e,t){var i=_.filter(interaction_view.events.outCurPipAction,function(i){return interaction_view.events.filterPipType(e,i,"outCurPip",t)});_.each(i,function(e){e.func()})},clearAll:function(){interaction_view.events.pageClickEvents=[],interaction_view.events.pageDblClickEvents=[],interaction_view.events.pageStartEvents=[],interaction_view.events.pageWXShareSuccessEvents=[],interaction_view.events.bindingEvents=[],interaction_view.events.elementChangeToEvents=[],interaction_view.events.animationStartEvents=[],interaction_view.events.animationEndEvents=[],interaction_view.events.animationUpdateEvents=[],interaction_view.events.slideClickEvents=[],interaction_view.events.slideDblClickEvents=[],interaction_view.events.controllerEvents=[],interaction_view.events.dragDropEvents=[],interaction_view.events.dragDropGroupEvents=[],interaction_view.events.timerEvents=[],interaction_view.events.variableEvents=[],interaction_view.events.voteEvents=[],interaction_view.events.paragraphEvents=[],interaction_view.events.pageSwipeEvents=[],interaction_view.events.pageShakeEvents=[],interaction_view.events.formEvents=[],interaction_view.events.formSubmitEvents=[],interaction_view.events.eraserEvents=[],interaction_view.events.WeixinCameraEvents=[],interaction_view.events.collisionEvents=[],interaction_view.events.dragStartEvents=[],interaction_view.events.draggingEvents=[],interaction_view.events.dragEndEvents=[],interaction_view.events.userListEvents=[],interaction_view.events.contactFormEvents=[],interaction_view.events.systemVariableEvents=[],interaction_view.events.userdataSaveEvents=[],interaction_view.events.sharedataSaveEvents=[],interaction_view.events.preloadPageEvents=[],interaction_view.events.conditionEvents=[],interaction_view.events.scrollEvents=[],interaction_view.events.contentGridRenderEvents=[],interaction_view.events.mediaEvents=[],interaction_view.events.buttonGroupSelectEndEvents=[],interaction_view.events.quizGroupSelectCorrectEvents=[],interaction_view.events.quizGroupSelectWrongEvents=[],interaction_view.events.longTakeStartEvents=[],interaction_view.events.longTakeEndEvents=[],interaction_view.events.longTakeLayerIntoEvents=[],interaction_view.events.longTakeLayerGoneEvents=[],interaction_view.events.orientationChangeEvents=[],interaction_view.events.pipFinishAction=[],interaction_view.events.pipStartAction=[],interaction_view.events.inCurPipAction=[],interaction_view.events.outCurPipAction=[],interaction_view.events.stateGroupUpdateEvents=[],"undefined"!=typeof Reveal&&(Reveal.wheelLock=!1,Reveal.dragLock=!1,Reveal.wheelEventLock=!1),_e.orientation&&_e.orientation.event&&_e.orientation.event.off("orientation")},filterType:function(e,t,i){return t.overlay_id!=e.model.id||t.type!=i?!1:e.model.page.isLayer?t.layer_id==e.model.page.iOverlaylist.layerid:t.page_id==e.model.page.id},filterPipType:function(e,t,i,n){return t.overlay_id==e.model.id&&t.type==i&&t.d.view.index==n?!0:void 0},filterTypeByView:function(e,t){return t.overlay_id!=e.model.id?!1:e.model.page.isLayer?t.layer_id==e.model.page.iOverlaylist.layerid:t.page_id==e.model.page.id}};return events}),define("interaction_view/ui/environment",["underscore"],function(){var env={variables:{completeRatio:"undefined"!=typeof eraser_complete_ratio?eraser_complete_ratio:.6},Wxsysteminfo:{collection:{shareTitle:"",msgTitle:"",msgContent:"",message_link:"",imgUrl:""},get:function(key){return this.collection[key]||""==this.collection[key]?eval(key):""},set:function(e,t){if(this.collection[e]||""==this.collection[e])switch(e){case"shareTitle":shareTitle=t;break;case"msgTitle":msgTitle=t;break;case"msgContent":msgContent=t;break;case"message_link":message_link=t;break;case"imgUrl":imgUrl=t;break;default:return!1}}},Userdata:{id:"",source_id:"",data:{},collection:{},mode:0,status:0,init:function(){if("undefined"==typeof epub360_domain||"epub360"!=epub360_domain||1==interaction_view.forpreview)return env.Userdata.status=2,!0;var e=_g.getUrlParameterByName("userdata",message_link);return _g.getUrlParameterByName("source_openid",message_link)&&(e=_g.getUrlParameterByName("source_openid",message_link)),null==e||e==epub360_userinfo.openid?(env.Userdata.status=2,epub360_userinfo.openid&&(env.Userdata.id=epub360_userinfo.openid,env.Userdata.source_id=env.Userdata.id,void 0!=epub360_userinfo.data&&epub360_userinfo.data&&env.Userdata.initData(epub360_userinfo.data)),!0):(env.Userdata.id=epub360_userinfo.openid,env.Userdata.source_id=e,env.Userdata.mode=1,env.Userdata.get(),!0)},state:function(){return env.Userdata.status},initData:function(data){for(var i=0;i<data.length;i++){var item=data[i],page_id=item.iPageid,overlay_id=item.overlay_id,userdata_page=env.Userdata.data[page_id];if(void 0==userdata_page&&(env.Userdata.data[page_id]={}),"Paragraph"==item.iType){var text=item.iDetail.iText;item.iDetail={iText:eval("'"+text+"'")}}if(env.Userdata.data[page_id][overlay_id]=item,env.Userdata.collection[page_id+"_"+overlay_id]){var view=env.Userdata.collection[page_id+"_"+overlay_id];if("Paragraph"==item.iType&&view.updateText(item.iDetail.iText,addtourl=0),"ImageBlock"==item.iType&&(view.getArgs(),view.setOtherDisplay()),"Audio"==item.iType){var detail=view.getdetail(),url=item.iDetail.value;interaction_view.media.changeSrc(view.model,url),detail.iAutoplay&&interaction_view.media.play(view.model),detail.iFile[0].file=url}"Slide"==item.iType&&(view.rmbLast=parseInt(item.iDetail.value),view.setElementTo(view.rmbLast)),"Variable"==item.iType&&view.render(),delete env.Userdata.collection[page_id+"_"+overlay_id]}}},get:function(e){env.Userdata.status=1,_g.ajax.get({dataType:"JSON",url:"userdata/"+env.Userdata.source_id+"/",callback:function(t){if(200==t.code){env.Userdata.status=2;var i=t.data.results.data;env.Userdata.initData(i),e&&e()}},onError:function(){}})},set:function(e,t){if(""!=env.Userdata.id){0==env.Userdata.initial&&(env.Userdata.initial=1);var i="userdata/"+env.Userdata.id+"/";_g.ajax.post({dataType:"JSON",data:JSON.stringify(e),url:i,callback:function(e){200==e.code&&t()},onError:function(){}})}},update:function(e,t,i,n){var a="sharedata/"+env.Userdata.id+"/"+e+"/"+t+"/";_g.ajax.post({dataType:"JSON",type:"PUT",data:JSON.stringify(i),url:a,callback:function(e){200==e.code&&(env.Userdata.share(e.data.results[0].id,t),n&&n())},onError:function(){}})},share:function(){var e=0;-1==message_link.indexOf(env.Userdata.id)&&(message_link=_g.replaceUrlParameterByName("source_openid","source_openid="+env.Userdata.id,message_link),e=1),e&&interaction_view.weixin.share()},getitem:function(e,t){if(env.Userdata.data[e]){var i=env.Userdata.data[e][t];if(i)return i.iDetail}return null},setitem:function(e,t,i){if(""!=env.Userdata.id){env.Userdata.id!=env.Userdata.source_id&&env.Userdata.reset();var n=e.model.get("pageid");void 0==env.Userdata.data[n]&&(env.Userdata.data[n]={});var a={overlay_id:e.model.id,iPageid:n,title:e.model.get("iDetail").title,iType:e.model.get("iType"),iDetail:t};if(env.Userdata.data[n][e.model.id])env.Userdata.update(n,e.model.id,a,function(){env.Userdata.data[n][e.model.id]=a});else{if(1==env.Userdata.initial)return void env.Userdata.setitems.push(a);env.Userdata.set([a])}}},setitems:function(e,t){if(""!=env.Userdata.id){env.Userdata.id!=env.Userdata.source_id&&env.Userdata.reset();for(var i=[],n=0;n<e.length;n++){var a=e[n],r=a.model.get("pageid");void 0==env.Userdata.data[r]&&(env.Userdata.data[r]={});var o={overlay_id:a.model.id,iPageid:r,title:a.model.get("iDetail").title,iType:a.model.get("iType")},s=a.getdetail();"Variable"==o.iType&&(o.iDetail={value:s.initial}),i.push(o),env.Userdata.data[r][a.model.id]=o}i&&env.Userdata.set(i,t)}},reset:function(){env.Userdata.source_id=env.Userdata.id,env.Userdata.mode=0,env.Userdata.status=2,env.Userdata.data=void 0!=epub360_userinfo.data&&epub360_userinfo.data||{},env.Userdata.initial=0,env.Userdata.share()},disableMode:function(){env.Userdata.mode=0},addView:function(e){var t=e.model,i=t.get("pageid");env.Userdata.collection[i+"_"+t.id]||env.Userdata.updateView(e)},updateView:function(e){var t=e.model,i=t.get("pageid");env.Userdata.collection[i+"_"+t.id]=e},getList:function(){return _.toArray(env.Userdata.collection)}},Sharedata:{id:"",source_id:"",data:{},collection:{},enabled:!0,mode:0,status:0,init:function(){if("undefined"==typeof epub360_domain||"epub360"!=epub360_domain||1==interaction_view.forpreview)return env.Sharedata.status=2,!0;message_link&&message_link.indexOf("source_openid")>-1&&(env.Sharedata.mode=1),(location.href.indexOf("disableHistoryStart")>-1||location.href.indexOf("pageid")>-1)&&(env.Sharedata.mode=1);var e=_g.getUrlParameterByName("sharedata",message_link);return null==e?(env.Sharedata.status=2,!0):(env.Sharedata.id=e,env.Sharedata.source_id=e,env.Sharedata.mode=1,env.Sharedata.get(),!0)},state:function(){return env.Sharedata.status},get:function(callback){env.Sharedata.status=1,_g.ajax.get({dataType:"JSON",url:"sharedata/"+env.Sharedata.id+"/",callback:function(result){if(200==result.code){env.Sharedata.status=2;for(var data=result.data.results.data,i=0;i<data.length;i++){var item=data[i],page_id=item.iPageid,overlay_id=item.overlay_id,sharedata_page=env.Sharedata.data[page_id];if(void 0==sharedata_page&&(env.Sharedata.data[page_id]={}),"Paragraph"==item.iType){var text=item.iDetail.iText;item.iDetail={iText:eval("'"+text+"'")}}if(env.Sharedata.data[page_id][overlay_id]=item,env.Sharedata.collection[page_id+"_"+overlay_id]){var view=env.Sharedata.collection[page_id+"_"+overlay_id];if("Paragraph"==item.iType&&view.updateText(item.iDetail.iText,addtourl=0),"ImageBlock"==item.iType&&(view.getArgs(),view.setOtherDisplay()),"Audio"==item.iType){var detail=view.getdetail(),url=item.iDetail.value;interaction_view.media.changeSrc(view.model,url),detail.iAutoplay&&interaction_view.media.play(view.model),detail.iFile[0].file=url}"Slide"==item.iType&&(view.rmbLast=parseInt(item.iDetail.value),view.setElementTo(view.rmbLast)),delete env.Sharedata.collection[page_id+"_"+overlay_id]}}callback&&callback()}},onError:function(){}})},set:function(e,t){if(""!=env.Sharedata.id&&1!=env.Sharedata.initial){(void 0==env.Sharedata.initial||0==env.Sharedata.initial)&&(env.Sharedata.initial=1);var i="sharedata/"+env.Sharedata.id+"/";_g.ajax.post({dataType:"JSON",data:JSON.stringify(e),url:i,callback:function(i){if(200==i.code){for(var n,a,r=0,o=0;o<e.length;o++)n=e[o].iPageid,a=e[o].overlay_id,env.Sharedata.data[n][a].changed=!1,r+=env.Sharedata.share(env.Sharedata.id,a);1==env.Sharedata.initial&&(env.Sharedata.initial=0),r&&interaction_view.weixin.share(),t&&t()}},onError:function(){}})}},update:function(e,t,i,n){var a="sharedata/"+env.Sharedata.id+"/"+e+"/"+t+"/";_g.ajax.post({dataType:"JSON",type:"PUT",data:JSON.stringify(i),url:a,callback:function(e){200==e.code&&(env.Sharedata.share(e.data.results[0].id,t),n&&n())},onError:function(){}})},share:function(e,t){var i=0;-1==message_link.indexOf(env.Sharedata.id)&&(message_link=_g.replaceUrlParameterByName("sharedata","sharedata="+env.Sharedata.id,message_link),i=1);var n=new RegExp("&?"+t+"=([^&])+"),a=n.exec(message_link);return a&&(message_link=message_link.replace(a[0],""),i=1),i},getitem:function(e,t){if(env.Sharedata.data[e]){var i=env.Sharedata.data[e][t];if(i)return i.iDetail}return null},setitem:function(e,t,i){if(env.Sharedata.id==env.Sharedata.source_id&&env.Sharedata.reset(),""!=env.Sharedata.id){var n=e.model.get("pageid");void 0==env.Sharedata.data[n]&&(env.Sharedata.data[n]={});var a={overlay_id:e.model.id,iPageid:n,title:e.model.get("iDetail").title,iType:e.model.get("iType"),iDetail:t,changed:!0};env.Sharedata.data[n][e.model.id]=a}},setitems:function(e){var t=[];for(var i in env.Sharedata.data)for(var n in env.Sharedata.data[i])1==env.Sharedata.data[i][n].changed&&t.push(env.Sharedata.data[i][n]);env.Sharedata.set(t,e)},reset:function(){env.Sharedata.id="","object"==typeof wx_config&&wx_config.nonceStr&&(env.Sharedata.id=wx_config.nonceStr),env.Sharedata.mode=0,env.Sharedata.status=2,env.Sharedata.data={},env.Sharedata.initial=0},disableMode:function(){env.Sharedata.mode=0},addView:function(e){var t=e.model,i=t.get("pageid");env.Sharedata.collection[i+"_"+t.id]||env.Sharedata.updateView(e)},updateView:function(e){var t=e.model,i=t.get("pageid");env.Sharedata.collection[i+"_"+t.id]=e},getList:function(){return _.toArray(env.Sharedata.collection)}},Shareapp:{id:"",slug:"",shareinfo:{},helperinfo:{},appinfo:{},status:0,collection:{},init:function(){if(""==interaction_view.shareapp.id)return!1;env.Shareapp.slug=interaction_view.shareapp.id;var e=_g.getUrlParameterByName("shareid",message_link);return null==e?!1:""==interaction_view.shareapp.id?!1:(env.Shareapp.id=e,env.Shareapp.get(),!0)},get:function(e){env.Shareapp.status=1,_g.ajax.get({dataType:"JSON",url:"/share/"+env.Shareapp.slug+"/info?id="+env.Shareapp.id,callback:function(t){200==t.code?(env.Shareapp.shareinfo=t.data.results[0].shareinfo,env.Shareapp.helperinfo=t.data.results[0].helperinfo,env.Shareapp.appinfo=t.data.results[0].appinfo,1==env.Shareapp.status&&(env.Shareapp.status=2,env.Shareapp.waitpage&&env.Shareapp.waitpage==interaction_view.currentPage?interaction_view.play(interaction_view.currentPage):(console.info("env.Shareapp.get"),$.each(env.Shareapp.collection,function(e,t){var i=t;i.model.get("pageid")==interaction_view.currentPage&&2!=i.status&&i.resetOtherStatus()}))),e&&e()):env.Shareapp.status=0},onError:function(){interaction_view.environment.Shareapp.status=0}})},usertype:function(){return""==env.Shareapp.slug?"@助力_未启用@":""==env.Shareapp.id?0:env.Shareapp.status<2?0:env.Shareapp.shareinfo.openid==epub360_userinfo.openid?1:interaction_view.environment.Shareapp.helperinfo.help_num>0?2:0},total:function(){return""==env.Shareapp.slug?"@助力_未启用@":""==env.Shareapp.id?0:env.Shareapp.status<2?0:interaction_view.environment.Shareapp.shareinfo.total},help:function(e){e&&e()},create:function(){},add:function(e){var t=e.model;env.Shareapp.collection[t.id]||env.Shareapp.update(e)},update:function(e){var t=e.model;env.Shareapp.collection[t.id]=e},getList:function(){return _.toArray(env.Shareapp.collection)}},Votes:{collection:{},add:function(e){env.Votes.collection[e.id]||env.Votes.update(e);
},update:function(e){env.Votes.collection[e.id]=e},get:function(){return _.toArray(env.Votes.collection)}},Paragraph:{editable:!1,stateChanged:function(e){_.each(interaction_view.getOverlays("Slide",interaction_view.currentPage),function(t){t.iview.setControl(e)})},enable:function(){env.Paragraph.editable=!0,$("body").addClass("ParagraghEditable"),env.Paragraph.stateChanged(!0)},disable:function(){env.Paragraph.editable=!1,$("body").removeClass("ParagraghEditable"),env.Paragraph.stateChanged(!1)},state:function(){return env.Paragraph.editable}},otherFormValue:{}};return env}),define("interaction_view/ui/mobilemedia",[],function(){var e={statusclear:function(e){e.loaded=!1,e.played=!1,e.reseted=!1,e.completed=!1},play:function(t,i){i||(i={}),("Video"==t.get("iType")||"QQVideo"==t.get("iType"))&&e.video.play(t,i),"Audio"==t.get("iType")&&e.audio.play(t)},pause:function(e){if(!e.media||e.media.paused)return!1;try{e.media.pause()}catch(t){}e.iview.slider&&e.iview.sliderstop()},stop:function(e){interaction_view.media.pause(e);try{e.media.currentTime=0}catch(t){}},seek:function(t,i,n){n&&(i=e.getTimeByPercent(t,n));try{t.media.currentTime=i}catch(a){}},changeSrc:function(e,t){try{e.media.src=t}catch(i){}},video:{render:function(e,t,i){},init:function(e,t,i){function n(i){t.loaded=i,e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,i,t)}var a=i;if(!(i.indexOf("<script")>-1)){var r=t.iview.getdetail(),o=(t.iview.getcommon(),"");if(r.iAndroidFullscreen&&interaction_view.isAndroid){o="";var s=' x5-video-player-type="h5" x5-video-orientation="landscape|portrait"  x5-video-player-fullscreen="true"'}else if(r.iIosFullscreen&&interaction_view.isIos)var s=' x5-video-player-type="h5" x5-video-orientation="landscape|portrait"  x5-video-player-fullscreen="true"';else var s=r.iFullscreen&&!interaction_view.ismobile?"":'webkit-playsinline="true" playsinline="true" x5-playsinline';var l=$('<span class="video-control status-play absolutecenter" style="cursor: pointer;margin: auto;"></span>'),c=t.iview.$el,d=c.children(".Element");if(d.find("video").length)h=d.find("video"),p=t.iview.$el.find(".img");else{var h=$("<video "+s+' x-webkit-airplay="allow" preload="auto" autobufer="true" style="position:absolute; display:none;width:100%;height:100%;top:0;left:0;'+o+'" src="'+a+'" poster="'+r.iFile[0].picture+'"></video>'),u=$('<div style="position:relative;width:100%;height:100%;overflow:hidden"></div>').append(h),p=$('<div class="videoPoster" style="position:absolute;left:0;top:0;width:100%;height:100%;background-repeat:no-repeat;background-image:url('+r.iFile[0].picture+');" class="img" ></div>');c.removeClass("hide"),d.append(u).append(p),c.removeClass("hide"),d.append(l),l.hide()}var f,v,g=r.iDisplay,m=[];g?1==g?(m.push("object-contain"),f="contain"):2==g&&(m.push("object-cover"),f="cover"):(m.push("object-fill"),f="100% 100%");var w=r.object_position;if(w?1==w?(m.push("object-top"),v="top"):2==w&&(m.push("object-bottom"),v="bottom"):(m.push("object-center"),v="center"),t.iview.$el.addClass(m.join(" ")),p.css({"background-size":f,"background-position":v}),r.iControl&&!t.attributes.iDetail.init_rotation&&h.attr("controls","controls"),interaction_view.media.video.showPlayIcon(t),t.iosautoplay&&t.iview.$el.addClass("video_auto_play"),r.iRepeat&&h.attr("loop","loop"),t.media=h[0],t.poster=p,t.control_btn=l,t.autoplay=r.iAutoplay||!1,t.fullscreen=r.iFullscreen||!1,t.androidfullscreen=r.iAndroidFullscreen||!1,t.iosfullscreen=r.iIosFullscreen||!1,t.control=r.iControl||!1,t.androidfullscreen&&interaction_view.weixin&&interaction_view.isAndroid){var _=t.media,y=t.iview.$el,b=y.add(y.parent()).add(y.parent().parent());t.media.addEventListener("x5videoenterfullscreen",function(){window.onceForceAdjustScreen=!0;try{b.css({overflow:"visible"}),_.currentTime=0}catch(e){}}),t.media.addEventListener("x5videoexitfullscreen",function(){window.onceForceAdjustScreen=!0,_.currentTime=0})}h.on("play",function(e){t.fullscreen&&!interaction_view.ismobile&&interaction_view.media.video.playFullscreen(t),r.iControl&&t.attributes.iDetail.init_rotation&&h.attr("controls","controls")}).on("error",function(e){}).on("canplay",function(e){t.autoplay&&!interaction_view.ismobile&&p.hide(),h.show()}),n(!0),h.on("ended",function(e){r.iAutohide?(t.iview.$el.fadeOut(50),t.hided=!0):t.androidfullscreen&&interaction_view.isWeixin&&interaction_view.isAndroid&&t.iview.$el&&t.iview.$el.find("video").length&&(t.iview.$el.find("video").hide(),window.setTimeout(function(){t.iview.$el.find("video").show()},2e3),p.show(),interaction_view.media.video.showPlayIcon(t)),t.onAnimationStart&&(interaction_view.events.onAnimationEnd(t.onAnimationStart),t.onAnimationStart=null),r.iControl&&t.attributes.iDetail.init_rotation&&h.removeAttr("controls")}),h.on("pause",function(e){r.iControl&&t.attributes.iDetail.init_rotation&&(h.removeAttr("controls"),interaction_view.media.video.showPlayIcon(t))}),interaction_view.isIos?interaction_view.media.video.bindEvents(t):t.androidfullscreen&&interaction_view.isWeixin&&interaction_view.isAndroid&&(t.media.addEventListener("x5videoenterfullscreen",function(){window.setTimeout(function(){adjust_screen()},100)}),t.media.addEventListener("x5videoexitfullscreen",function(){window.setTimeout(function(){adjust_screen()},100)}))}},play:function(t,i){if(t.hls)return void(e.video.playH&&e.video.playH(t));if(!t.loaded||!t.media||!t.media.paused)return t.iview.slider&&t.media&&t.iview.sliderplay(),!1;if(t.reseted=!1,interaction_view.media.video.bindEvents(t),"Audio"==t.get("iType")){var n=t.media;try{var a=n.currentTime>0&&!n.paused&&!n.ended&&n.readyState>2;a||(n.play(),"undefined"==typeof audioPreloadFinished||audioPreloadFinished||(n.autoplay=!0))}catch(r){}}else{var o=t.media;try{var a=o.currentTime>0&&!o.paused&&!o.ended&&o.readyState>2;a||o.play()}catch(r){}}("Video"==t.get("iType")||"QQVideo"==t.get("iType"))&&(t.control_btn&&t.control_btn.fadeOut(50),t.fullscreen&&!interaction_view.ismobile&&interaction_view.media.video.playFullscreen(t),t.iview.$el.removeClass("hide"),t.hided=!1),t.iview.slider&&t.iview.sliderplay()},bindEvents:function(e){if($(e.media).on("timeupdate",function(){e.media.currentTime&&e.poster&&e.poster.fadeOut(50)}),!e.bindStart){var t=function(i){if(!i.currentTarget.paused){console.log("start play");var n=_.filter(interaction_view.events.mediaEvents,function(t){return e.page.isLayer?t.layer_id==e.page.iOverlaylist.layerid&&t.overlay_id==e.id&&"onStartPlay"==t.type:t.overlay_id==e.id&&"onStartPlay"==t.type&&t.page_id==e.page.id});if(n.length)for(var a=0;a<n.length;a++)n[a].func();$(e.media).off("timeupdate",t),e.bindStart=!1}};$(e.media).on("timeupdate",t),e.bindStart=!0}if(!e.bindEnded){var i=function(){console.log("ended play");var t=_.filter(interaction_view.events.mediaEvents,function(t){return e.page.isLayer?t.layer_id==e.page.iOverlaylist.layerid&&t.overlay_id==e.id&&"onEnded"==t.type:t.overlay_id==e.id&&"onEnded"==t.type&&t.page_id==e.page.id});if(t.length)for(var n=0;n<t.length;n++)t[n].func();$(e.media).off("ended",i),e.bindEnded=!1};$(e.media).on("ended",i),e.bindEnded=!0}},showPlayIcon:function(e){var t=e.iview.getdetail().iShowIcon,i=e.control_btn;if((t||void 0===t)&&i){if(i.show(),e.init_rotation){var n=e.iview.zIndex+"px";i.css({transform:"translateZ("+n+")","-webkit-transform":"translateZ("+n+")"})}i.one("click",function(){i.hide(),interaction_view.media.play(e)})}},reset:function(t){if(interaction_view.media.video.showPlayIcon(t),t.hls&&e.video.resetH&&e.video.resetH(t),!t.media||t.reseted)return!1;try{t.media.currentTime=0,t.media.paused||t.media.pause()}catch(i){}t.reseted=!0},getDuration:function(e){return e.duration},testFullscreen:function(e){return e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullScreen},launchFullscreen:function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullScreen()},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},playFullscreen:function(e){var t=t||this,i=e.media;return t.testFullscreen(i)?void(document.webkitIsFullScreen||(t.launchFullscreen(i),i.addEventListener("ended",function(){t.exitFullscreen()},!1))):void console.log("不支持全屏模式")}},audio:{init:function(e,t,i){var n=e.toJSON().file,a="Audio_"+e.id+t.id,r=t.iPageId+t.id;if(!(n.indexOf("<script")>-1)&&(n=_g.util.htmlspecialchars(n),t.src=n,t.audioid=a,".m3u8"!=_g.string.getUrlExt(n)&&".M3U8"!=_g.string.getUrlExt(n))){var o=t.iview.getdetail();t.iview.getcommon();if(i&&"undefined"!=typeof bgsound_id&&"undefined"!=typeof bgsound_src&&bgsound_id==t.id&&window.bgsoundEl){if(t.media=audio,interaction_view.bgsound=t,t.isBgsound=!0,!audio)return audioelement=t,t.loaded=!0,e.set("loaded",!0),void e.page.ipreloadlist.preloadcheck(e.toJSON().file,!0,t);s=$("audio#bgsound"),o.iAutoplay&&(t.autoplay=!0,t.media.play(),t.iview.sliderplay&&t.iview.sliderplay()),t.media.paused||(t.hasPlayed=!0)}else{if(window.preload_audios&&window.preload_audios[r]){var s=$(preload_audios[r]);t.media=preload_audios[r],"undefined"!=typeof bgsound_id&&bgsound_id==t.id&&o.iAutoplay&&(interaction_view.bgsound=t,preload_audios[r].autoplay=!0)}else{var l="";interaction_view.isQQ&&(l=' preload="none" ');var s=$('<audio id="'+a+'" style="position:absolute;" '+l+'> <source src="'+n+'" /> </audio>');t.iview.$el.removeClass("hide").children(".Element").append(s),t.media=s[0]}!_g.device.android()&&o.iRepeat&&s.attr("loop",""),t.autoplay=o.iAutoplay||!1}t.loaded=!0,e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,!0,t),s.on("loadstart",function(e){}).on("error",function(e){}).on("timeupdate",function(e){if(t.iview.slider){var i=t.media.currentTime,n=t.media.duration,a=100*_g.number.decimal(i/n,2);t.iview.onSliderChange(a)}}),s.on("ended",function(e){if(o.iRepeat)_g.device.android()&&t.media.play();else{if(t.iview.slider&&t.iview.sliderstop(),0==t.media.seekable.length)return;try{}catch(i){}t.onAnimationStart&&(interaction_view.events.onAnimationEnd(t.onAnimationStart),t.onAnimationStart=null)}})}},getDuration:function(e){return e.duration},play:function(t){e.video.play(t)},reset:function(t){e.video.reset(t)}},getTimeByPercent:function(e,t){if(!e.media)return null;var i=e.media.duration;return t/100*i}};return e}),"undefined"==typeof jwplayer&&(jwplayer=function(e){return jwplayer.api?jwplayer.api.selectPlayer(e):void 0},jwplayer.version="6.8.4616",jwplayer.vid=document.createElement("video"),jwplayer.audio=document.createElement("audio"),jwplayer.source=document.createElement("source"),function(e){function t(e){return function(){return l(e)}}function i(e,t,i,n,a){return function(){var r,s;if(a)i(e);else{try{if((r=e.responseXML)&&(s=r.firstChild,r.lastChild&&"parsererror"===r.lastChild.nodeName))return void(n&&n("Invalid XML"))}catch(l){}if(r&&s)return i(e);(r=o.parseXML(e.responseText))&&r.firstChild?(e=o.extend({},e,{responseXML:r}),i(e)):n&&n(e.responseText?"Invalid XML":t)}}}var n=document,a=window,r=navigator,o=e.utils=function(){};o.exists=function(e){switch(typeof e){case"string":return 0<e.length;case"object":return null!==e;case"undefined":return!1}return!0},o.styleDimension=function(e){return e+(0<e.toString().indexOf("%")?"":"px")},o.getAbsolutePath=function(e,t){if(o.exists(t)||(t=n.location.href),o.exists(e)){var i;if(o.exists(e)){i=e.indexOf("://");var a=e.indexOf("?");i=i>0&&(0>a||a>i)}else i=void 0;if(i)return e;i=t.substring(0,t.indexOf("://")+3);var r,a=t.substring(i.length,t.indexOf("/",i.length+1));0===e.indexOf("/")?r=e.split("/"):(r=t.split("?")[0],r=r.substring(i.length+a.length+1,r.lastIndexOf("/")),r=r.split("/").concat(e.split("/")));for(var s=[],l=0;l<r.length;l++)r[l]&&o.exists(r[l])&&"."!=r[l]&&(".."==r[l]?s.pop():s.push(r[l]));return i+a+"/"+s.join("/")}},o.extend=function(){var e=o.extend.arguments;if(1<e.length){for(var t=1;t<e.length;t++)o.foreach(e[t],function(t,i){try{o.exists(i)&&(e[0][t]=i)}catch(n){}});return e[0]}return null};var s=window.console=window.console||{log:function(){}};o.log=function(){var e=Array.prototype.slice.call(arguments,0);"object"==typeof s.log?s.log(e):s.log.apply(s,e)};var l=o.userAgentMatch=function(e){return null!==r.userAgent.toLowerCase().match(e)};o.isIE=o.isMSIE=t(/msie/i),o.isFF=t(/firefox/i),o.isChrome=t(/chrome/i),o.isIPod=t(/iP(hone|od)/i),o.isIPad=t(/iPad/i),o.isSafari602=t(/Macintosh.*Mac OS X 10_8.*6\.0\.\d* Safari/i),o.isIETrident=function(e){return e?(e=parseFloat(e).toFixed(1),l(RegExp("msie\\s*"+e+"|trident/.+rv:\\s*"+e,"i"))):l(/msie|trident/i)},o.isSafari=function(){return l(/safari/i)&&!l(/chrome/i)&&!l(/chromium/i)&&!l(/android/i)},o.isIOS=function(e){return l(e?RegExp("iP(hone|ad|od).+\\sOS\\s"+e,"i"):/iP(hone|ad|od)/i)},o.isAndroid=function(e,t){var i=t?!l(/chrome\/[23456789]/i):!0;return e?i&&l(RegExp("android.*"+e,"i")):i&&l(/android/i)},o.isMobile=function(){return o.isIOS()||o.isAndroid()},o.saveCookie=function(e,t){n.cookie="jwplayer."+e+"="+t+"; path=/"},o.getCookies=function(){for(var e={},t=n.cookie.split("; "),i=0;i<t.length;i++){var a=t[i].split("=");0===a[0].indexOf("jwplayer.")&&(e[a[0].substring(9,a[0].length)]=a[1])}return e},o.typeOf=function(e){var t=typeof e;return"object"===t?e?e instanceof Array?"array":t:"null":t},o.translateEventResponse=function(t,i){var n=o.extend({},i);if(t!=e.events.JWPLAYER_FULLSCREEN||n.fullscreen)if("object"==typeof n.data){var a=n.data;delete n.data,n=o.extend(n,a)}else"object"==typeof n.metadata&&o.deepReplaceKeyName(n.metadata,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]);else n.fullscreen="true"==n.message?!0:!1,delete n.message;return o.foreach(["position","duration","offset"],function(e,t){n[t]&&(n[t]=Math.round(1e3*n[t])/1e3)}),n},o.flashVersion=function(){if(o.isAndroid())return 0;var e,t=r.plugins;try{if("undefined"!==t&&(e=t["Shockwave Flash"]))return parseInt(e.description.replace(/\D+(\d+)\..*/,"$1"),10)}catch(i){}if("undefined"!=typeof a.ActiveXObject)try{if(e=new a.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return parseInt(e.GetVariable("$version").split(" ")[1].split(",")[0],10)}catch(n){}return 0},o.getScriptPath=function(e){for(var t=n.getElementsByTagName("script"),i=0;i<t.length;i++){var a=t[i].src;if(a&&0<=a.indexOf(e))return a.substr(0,a.indexOf(e))}return""},o.deepReplaceKeyName=function(t,i,n){switch(e.utils.typeOf(t)){case"array":for(var a=0;a<t.length;a++)t[a]=e.utils.deepReplaceKeyName(t[a],i,n);break;case"object":o.foreach(t,function(a,r){var o;if(i instanceof Array&&n instanceof Array){if(i.length!=n.length)return;o=i}else o=[i];for(var s=a,l=0;l<o.length;l++)s=s.replace(RegExp(i[l],"g"),n[l]);t[s]=e.utils.deepReplaceKeyName(r,i,n),a!=s&&delete t[a]})}return t};var c=o.pluginPathType={ABSOLUTE:0,RELATIVE:1,CDN:2};o.getPluginPathType=function(e){if("string"==typeof e){e=e.split("?")[0];var t=e.indexOf("://");if(t>0)return c.ABSOLUTE;var i=e.indexOf("/");return e=o.extension(e),!(0>t&&0>i)||e&&isNaN(e)?c.RELATIVE:c.CDN}},o.getPluginName=function(e){return e.replace(/^(.*\/)?([^-]*)-?.*\.(swf|js)$/,"$2")},o.getPluginVersion=function(e){return e.replace(/[^-]*-?([^\.]*).*$/,"$1")},o.isYouTube=function(e){return/^(http|\/\/).*(youtube\.com|youtu\.be)\/.+/.test(e)},o.youTubeID=function(e){try{return/v[=\/]([^?&]*)|youtu\.be\/([^?]*)|^([\w-]*)$/i.exec(e).slice(1).join("").replace("?","")}catch(t){return""}},o.isRtmp=function(e,t){return 0===e.indexOf("rtmp")||"rtmp"==t},o.foreach=function(e,t){var i,n;for(i in e)"function"==o.typeOf(e.hasOwnProperty)?e.hasOwnProperty(i)&&(n=e[i],t(i,n)):(n=e[i],t(i,n))},o.isHTTPS=function(){return 0===a.location.href.indexOf("https")},o.repo=function(){var t=web_url+e.version.split(/\W/).splice(0,2).join("/")+"/";try{o.isHTTPS()&&(t=t.replace("http://","https://ssl."))}catch(i){}return t},o.ajax=function(e,t,n,r){var s;if(0<e.indexOf("#")&&(e=e.replace(/#.*$/,"")),e&&0<=e.indexOf("://")&&e.split("/")[2]!=a.location.href.split("/")[2]&&o.exists(a.XDomainRequest))s=new a.XDomainRequest,s.onload=i(s,e,t,n,r),s.ontimeout=s.onprogress=function(){},s.timeout=5e3;else{if(!o.exists(a.XMLHttpRequest))return n&&n(),s;var l=s=new a.XMLHttpRequest,c=e;s.onreadystatechange=function(){if(4===l.readyState)switch(l.status){case 200:i(l,c,t,n,r)();break;case 404:n("File not found")}}}return s.overrideMimeType&&s.overrideMimeType("text/xml"),s.onerror=function(){n("Error loading file")},setTimeout(function(){try{s.open("GET",e,!0),s.send()}catch(t){n&&n(e)}},0),s},o.parseXML=function(e){var t;try{if(a.DOMParser){if(t=(new a.DOMParser).parseFromString(e,"text/xml"),t.childNodes&&t.childNodes.length&&"parsererror"==t.childNodes[0].firstChild.nodeName)return}else t=new a.ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)}catch(i){return}return t},o.filterPlaylist=function(e,t){var i,n,a,r,s=[];for(i=0;i<e.length;i++)if(n=o.extend({},e[i]),n.sources=o.filterSources(n.sources),0<n.sources.length){for(a=0;a<n.sources.length;a++)r=n.sources[a],r.label||(r.label=a.toString());s.push(n)}if(t&&0===s.length)for(i=0;i<e.length;i++)if(n=o.extend({},e[i]),n.sources=o.filterSources(n.sources,!0),0<n.sources.length){for(a=0;a<n.sources.length;a++)r=n.sources[a],r.label||(r.label=a.toString());s.push(n)}return s},o.filterSources=function(t,i){var n,a,r=o.extensionmap;if(t){a=[];for(var s=0;s<t.length;s++){var l=t[s].type,c=t[s].file;c&&(c=o.trim(c)),l||(l=r.extType(o.extension(c)),t[s].type=l),i?e.embed.flashCanPlay(c,l)&&(n||(n=l),l==n&&a.push(o.extend({},t[s]))):o.canPlayHTML5(l)&&(n||(n=l),l==n&&a.push(o.extend({},t[s])))}}return a},o.canPlayHTML5=function(t){return!o.isAndroid()||"hls"!=t&&"m3u"!=t&&"m3u8"!=t?(t=o.extensionmap.types[t],!!t&&!!e.vid.canPlayType&&e.vid.canPlayType(t)):!1},o.seconds=function(e){e=e.replace(",",".");var t=e.split(":"),i=0;return"s"==e.slice(-1)?i=parseFloat(e):"m"==e.slice(-1)?i=60*parseFloat(e):"h"==e.slice(-1)?i=3600*parseFloat(e):1<t.length?(i=parseFloat(t[t.length-1]),i+=60*parseFloat(t[t.length-2]),3==t.length&&(i+=3600*parseFloat(t[t.length-3]))):i=parseFloat(e),i},o.serialize=function(e){return null==e?null:"true"==e.toString().toLowerCase()?!0:"false"==e.toString().toLowerCase()?!1:isNaN(Number(e))||5<e.length||0===e.length?e:Number(e)}}(jwplayer),function(e){var t="video/",i=e.foreach,n={mp4:t+"mp4",vorbis:"audio/ogg",ogg:t+"ogg",webm:t+"webm",aac:"audio/mp4",mp3:"audio/mpeg",hls:"application/vnd.apple.mpegurl"},a={mp4:n.mp4,f4v:n.mp4,m4v:n.mp4,mov:n.mp4,m4a:n.aac,f4a:n.aac,aac:n.aac,mp3:n.mp3,ogv:n.ogg,ogg:n.vorbis,oga:n.vorbis,webm:n.webm,m3u8:n.hls,hls:n.hls},t="video",t={flv:t,f4v:t,mov:t,m4a:t,m4v:t,mp4:t,aac:t,f4a:t,mp3:"sound",smil:"rtmp",m3u8:"hls",hls:"hls"},r=e.extensionmap={};i(a,function(e,t){r[e]={html5:t}}),i(t,function(e,t){r[e]||(r[e]={}),r[e].flash=t}),r.types=n,r.mimeType=function(e){var t;return i(n,function(i,n){!t&&n==e&&(t=i)}),t},r.extType=function(e){return r.mimeType(a[e])}}(jwplayer.utils),function(e){var t=e.loaderstatus={NEW:0,LOADING:1,ERROR:2,COMPLETE:3},i=document;e.scriptloader=function(n){function a(){o=t.ERROR,l.sendEvent(s.ERROR)}function r(){o=t.COMPLETE,l.sendEvent(s.COMPLETE)}var o=t.NEW,s=jwplayer.events,l=new s.eventdispatcher;e.extend(this,l),this.load=function(){var l=e.scriptloader.loaders[n];if(!l||l.getStatus()!=t.NEW&&l.getStatus()!=t.LOADING){if(e.scriptloader.loaders[n]=this,o==t.NEW){o=t.LOADING;var c=i.createElement("script");c.addEventListener?(c.onload=r,c.onerror=a):c.readyState&&(c.onreadystatechange=function(){("loaded"==c.readyState||"complete"==c.readyState)&&r()}),i.getElementsByTagName("head")[0].appendChild(c),c.src=n}}else l.addEventListener(s.ERROR,a),l.addEventListener(s.COMPLETE,r)},this.getStatus=function(){return o}},e.scriptloader.loaders={}}(jwplayer.utils),function(e){e.trim=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},e.pad=function(e,t,i){for(i||(i="0");e.length<t;)e=i+e;return e},e.xmlAttribute=function(e,t){for(var i=0;i<e.attributes.length;i++)if(e.attributes[i].name&&e.attributes[i].name.toLowerCase()==t.toLowerCase())return e.attributes[i].value.toString();return""},e.extension=function(e){return e&&"rtmp"!=e.substr(0,4)?(e=e.substring(e.lastIndexOf("/")+1,e.length).split("?")[0].split("#")[0],-1<e.lastIndexOf(".")?e.substr(e.lastIndexOf(".")+1,e.length).toLowerCase():void 0):""},e.stringToColor=function(e){return e=e.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2"),3==e.length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)}}(jwplayer.utils),function(e){var t="touchmove",i="touchstart";e.touch=function(n){function a(e){e.type==i?(l=!0,d=o(u.DRAG_START,e)):e.type==t?l&&(h||(r(u.DRAG_START,e,d),h=!0),r(u.DRAG,e)):(l&&(h?r(u.DRAG_END,e):(e.cancelBubble=!0,r(u.TAP,e))),l=h=!1,d=null)}function r(e,t,i){c[e]&&(t.preventManipulation&&t.preventManipulation(),t.preventDefault&&t.preventDefault(),t=i?i:o(e,t))&&c[e](t)}function o(e,t){var i=null;if(t.touches&&t.touches.length?i=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(i=t.changedTouches[0]),!i)return null;var n=s.getBoundingClientRect(),i={type:e,target:s,x:i.pageX-window.pageXOffset-n.left,y:i.pageY,deltaX:0,deltaY:0};return e!=u.TAP&&d&&(i.deltaX=i.x-d.x,i.deltaY=i.y-d.y),i}var s=n,l=!1,c={},d=null,h=!1,u=e.touchEvents;return document.addEventListener(t,a),document.addEventListener("touchend",function(e){l&&h&&r(u.DRAG_END,e),l=h=!1,d=null}),document.addEventListener("touchcancel",a),n.addEventListener(i,a),n.addEventListener("touchend",a),this.addEventListener=function(e,t){c[e]=t},this.removeEventListener=function(e){delete c[e]},this}}(jwplayer.utils),function(e){e.touchEvents={DRAG:"jwplayerDrag",DRAG_START:"jwplayerDragStart",DRAG_END:"jwplayerDragEnd",TAP:"jwplayerTap"}}(jwplayer.utils),function(e){e.key=function(t){var i,n,a;this.edition=function(){return a&&a.getTime()<(new Date).getTime()?"invalid":i},this.token=function(){return n},e.exists(t)||(t="");try{t=e.tea.decrypt(t,"36QXq4W@GSBV^teR");var r=t.split("/");(i=r[0])?/^(free|pro|premium|ads)$/i.test(i)?(n=r[1],r[2]&&0<parseInt(r[2])&&(a=new Date,a.setTime(String(r[2])))):i="invalid":i="free"}catch(o){i="invalid"}}}(jwplayer.utils),function(e){var t=e.tea={};t.encrypt=function(e,a){if(0==e.length)return"";var r=t.strToLongs(n.encode(e));1>=r.length&&(r[1]=0);for(var o,s=t.strToLongs(n.encode(a).slice(0,16)),l=r.length,c=r[l-1],d=r[0],h=Math.floor(6+52/l),u=0;0<h--;){u+=2654435769,o=u>>>2&3;for(var p=0;l>p;p++)d=r[(p+1)%l],c=(c>>>5^d<<2)+(d>>>3^c<<4)^(u^d)+(s[3&p^o]^c),c=r[p]+=c}return r=t.longsToStr(r),i.encode(r)},t.decrypt=function(e,a){if(0==e.length)return"";for(var r,o=t.strToLongs(i.decode(e)),s=t.strToLongs(n.encode(a).slice(0,16)),l=o.length,c=o[l-1],d=o[0],h=2654435769*Math.floor(6+52/l);0!=h;){r=h>>>2&3;for(var u=l-1;u>=0;u--)c=o[u>0?u-1:l-1],c=(c>>>5^d<<2)+(d>>>3^c<<4)^(h^d)+(s[3&u^r]^c),d=o[u]-=c;h-=2654435769}return o=t.longsToStr(o),o=o.replace(/\0+$/,""),n.decode(o)},t.strToLongs=function(e){for(var t=Array(Math.ceil(e.length/4)),i=0;i<t.length;i++)t[i]=e.charCodeAt(4*i)+(e.charCodeAt(4*i+1)<<8)+(e.charCodeAt(4*i+2)<<16)+(e.charCodeAt(4*i+3)<<24);return t},t.longsToStr=function(e){for(var t=Array(e.length),i=0;i<e.length;i++)t[i]=String.fromCharCode(255&e[i],e[i]>>>8&255,e[i]>>>16&255,e[i]>>>24&255);return t.join("")};var i={code:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e,t){var a,r,o,s,l,c,d=[],h="",u=i.code;if(c=("undefined"==typeof t?0:t)?n.encode(e):e,l=c.length%3,l>0)for(;3>l++;)h+="=",c+="\x00";for(l=0;l<c.length;l+=3)a=c.charCodeAt(l),r=c.charCodeAt(l+1),o=c.charCodeAt(l+2),s=a<<16|r<<8|o,a=s>>18&63,r=s>>12&63,o=s>>6&63,s&=63,d[l/3]=u.charAt(a)+u.charAt(r)+u.charAt(o)+u.charAt(s);return d=d.join(""),d=d.slice(0,d.length-h.length)+h},decode:function(e,t){t="undefined"==typeof t?!1:t;var a,r,o,s,l,c,d=[],h=i.code;c=t?n.decode(e):e;for(var u=0;u<c.length;u+=4)a=h.indexOf(c.charAt(u)),r=h.indexOf(c.charAt(u+1)),s=h.indexOf(c.charAt(u+2)),l=h.indexOf(c.charAt(u+3)),o=a<<18|r<<12|s<<6|l,a=o>>>16&255,r=o>>>8&255,o&=255,d[u/4]=String.fromCharCode(a,r,o),64==l&&(d[u/4]=String.fromCharCode(a,r)),64==s&&(d[u/4]=String.fromCharCode(a));return s=d.join(""),t?n.decode(s):s}},n={encode:function(e){return e=e.replace(/[\u0080-\u07ff]/g,function(e){return e=e.charCodeAt(0),String.fromCharCode(192|e>>6,128|63&e)}),e=e.replace(/[\u0800-\uffff]/g,function(e){return e=e.charCodeAt(0),String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})},decode:function(e){return e=e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){return e=(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2),String.fromCharCode(e)}),e=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){return e=(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1),String.fromCharCode(e)})}}}(jwplayer.utils),function(e){e.events={COMPLETE:"COMPLETE",ERROR:"ERROR",API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_SETUP_ERROR:"jwplayerSetupError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_COMPONENT_SHOW:"jwplayerComponentShow",JWPLAYER_COMPONENT_HIDE:"jwplayerComponentHide",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_MEDIA_LEVELS:"jwplayerMediaLevels",JWPLAYER_MEDIA_LEVEL_CHANGED:"jwplayerMediaLevelChanged",JWPLAYER_CAPTIONS_CHANGED:"jwplayerCaptionsChanged",JWPLAYER_CAPTIONS_LIST:"jwplayerCaptionsList",JWPLAYER_CAPTIONS_LOADED:"jwplayerCaptionsLoaded",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",state:{BUFFERING:"BUFFERING",IDLE:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING"},JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_PLAYLIST_COMPLETE:"jwplayerPlaylistComplete",JWPLAYER_DISPLAY_CLICK:"jwplayerViewClick",JWPLAYER_CONTROLS:"jwplayerViewControls",JWPLAYER_USER_ACTION:"jwplayerUserAction",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed",JWPLAYER_AD_TIME:"jwplayerAdTime",JWPLAYER_AD_ERROR:"jwplayerAdError",JWPLAYER_AD_CLICK:"jwplayerAdClicked",JWPLAYER_AD_COMPLETE:"jwplayerAdComplete",JWPLAYER_AD_IMPRESSION:"jwplayerAdImpression",JWPLAYER_AD_COMPANIONS:"jwplayerAdCompanions",JWPLAYER_AD_SKIPPED:"jwplayerAdSkipped"}}(jwplayer),function(e){var t=e.utils;e.events.eventdispatcher=function(i,n){function a(e,i,n){if(e)for(var a=0;a<e.length;a++){var r=e[a];if(r){null!==r.count&&0===--r.count&&delete e[a];try{r.listener(i)}catch(o){t.log('Error handling "'+n+'" event listener ['+a+"]: "+o.toString(),r.listener,i)}}}}var r,o;this.resetEventListeners=function(){r={},o=[]},this.resetEventListeners(),this.addEventListener=function(e,i,n){try{t.exists(r[e])||(r[e]=[]),"string"==t.typeOf(i)&&(i=new Function("return "+i)()),r[e].push({listener:i,count:n||null})}catch(a){t.log("error",a)}return!1},this.removeEventListener=function(e,i){if(r[e]){try{for(var n=0;n<r[e].length;n++)if(r[e][n].listener.toString()==i.toString()){r[e].splice(n,1);break}}catch(a){t.log("error",a)}return!1}},this.addGlobalListener=function(e,i){try{"string"==t.typeOf(e)&&(e=new Function("return "+e)()),o.push({listener:e,count:i||null})}catch(n){t.log("error",n)}return!1},this.removeGlobalListener=function(e){if(e){try{for(var i=o.length;i--;)o[i].listener.toString()==e.toString()&&o.splice(i,1)}catch(n){t.log("error",n)}return!1}},this.sendEvent=function(s,l){t.exists(l)||(l={}),t.extend(l,{id:i,version:e.version,type:s}),n&&t.log(s,l),a(r[s],l,s),a(o,l,s)}}}(window.jwplayer),function(e){var t={},i={};e.plugins=function(){},e.plugins.loadPlugins=function(n,a){return i[n]=new e.plugins.pluginloader(new e.plugins.model(t),a),i[n]},e.plugins.registerPlugin=function(i,n,a,r){var o=e.utils.getPluginName(i);t[o]||(t[o]=new e.plugins.plugin(i)),t[o].registerPlugin(i,n,a,r)}}(jwplayer),function(e){e.plugins.model=function(t){this.addPlugin=function(i){var n=e.utils.getPluginName(i);return t[n]||(t[n]=new e.plugins.plugin(i)),t[n]},this.getPlugins=function(){return t}}}(jwplayer),function(e){var t=jwplayer.utils,i=jwplayer.events;e.pluginmodes={FLASH:0,JAVASCRIPT:1,HYBRID:2},e.plugin=function(n){function a(){switch(t.getPluginPathType(n)){case t.pluginPathType.ABSOLUTE:return n;case t.pluginPathType.RELATIVE:return t.getAbsolutePath(n,window.location.href)}}function r(){d=setTimeout(function(){h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE)},1e3)}function o(){h=t.loaderstatus.ERROR,u.sendEvent(i.ERROR)}var s,l,c,d,h=t.loaderstatus.NEW,u=new i.eventdispatcher;t.extend(this,u),this.load=function(){if(h==t.loaderstatus.NEW)if(0<n.lastIndexOf(".swf"))s=n,h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE);else if(t.getPluginPathType(n)==t.pluginPathType.CDN)h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE);else{h=t.loaderstatus.LOADING;var e=new t.scriptloader(a());e.addEventListener(i.COMPLETE,r),e.addEventListener(i.ERROR,o),e.load()}},this.registerPlugin=function(e,n,a,r){d&&(clearTimeout(d),d=void 0),c=n,a&&r?(s=r,l=a):"string"==typeof a?s=a:"function"==typeof a?l=a:!a&&!r&&(s=e),h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE)},this.getStatus=function(){return h},this.getPluginName=function(){return t.getPluginName(n)},this.getFlashPath=function(){if(s)switch(t.getPluginPathType(s)){case t.pluginPathType.ABSOLUTE:return s;case t.pluginPathType.RELATIVE:return 0<n.lastIndexOf(".swf")?t.getAbsolutePath(s,window.location.href):t.getAbsolutePath(s,a())}return null},this.getJS=function(){return l},this.getTarget=function(){return c},this.getPluginmode=function(){return"undefined"!=typeof s&&"undefined"!=typeof l?e.pluginmodes.HYBRID:"undefined"!=typeof s?e.pluginmodes.FLASH:"undefined"!=typeof l?e.pluginmodes.JAVASCRIPT:void 0},this.getNewInstance=function(e,t,i){return new l(e,t,i)},this.getURL=function(){return n}}}(jwplayer.plugins),function(e){var t=e.utils,i=e.events,n=t.foreach;e.plugins.pluginloader=function(a,r){function o(){h?p.sendEvent(i.ERROR,{message:l}):d||(d=!0,c=t.loaderstatus.COMPLETE,p.sendEvent(i.COMPLETE))}function s(){if(u||o(),!d&&!h){var i=0,n=a.getPlugins();t.foreach(u,function(a){a=t.getPluginName(a);var r=n[a];a=r.getJS();var s=r.getTarget(),r=r.getStatus();r==t.loaderstatus.LOADING||r==t.loaderstatus.NEW?i++:a&&(!s||parseFloat(s)>parseFloat(e.version))&&(h=!0,l="Incompatible player version",o())}),0==i&&o()}}var l,c=t.loaderstatus.NEW,d=!1,h=!1,u=r,p=new i.eventdispatcher;t.extend(this,p),this.setupPlugins=function(e,i,r){var o={length:0,plugins:{}},s=0,l={},c=a.getPlugins();return n(i.plugins,function(n,a){var d=t.getPluginName(n),h=c[d],u=h.getFlashPath(),p=h.getJS(),f=h.getURL();u&&(o.plugins[u]=t.extend({},a),o.plugins[u].pluginmode=h.getPluginmode(),o.length++);try{if(p&&i.plugins&&i.plugins[f]){var v=document.createElement("div");v.id=e.id+"_"+d,v.style.position="absolute",v.style.top=0,v.style.zIndex=s+10,l[d]=h.getNewInstance(e,t.extend({},i.plugins[f]),v),s++,e.onReady(r(l[d],v,!0)),e.onResize(r(l[d],v))}}catch(g){t.log("ERROR: Failed to load "+d+".")}}),e.plugins=l,o},this.load=function(){if(!t.exists(r)||"object"==t.typeOf(r)){c=t.loaderstatus.LOADING,n(r,function(e){t.exists(e)&&(e=a.addPlugin(e),e.addEventListener(i.COMPLETE,s),e.addEventListener(i.ERROR,f))});var e=a.getPlugins();n(e,function(e,t){t.load()})}s()};var f=this.pluginFailed=function(){h||(h=!0,l="File not found",
o())};this.getStatus=function(){return c}}}(jwplayer),function(){jwplayer.parsers={localName:function(e){return e?e.localName?e.localName:e.baseName?e.baseName:"":""},textContent:function(e){return e?e.textContent?jwplayer.utils.trim(e.textContent):e.text?jwplayer.utils.trim(e.text):"":""},getChildNode:function(e,t){return e.childNodes[t]},numChildren:function(e){return e.childNodes?e.childNodes.length:0}}}(jwplayer),function(e){var t=e.parsers;(t.jwparser=function(){}).parseEntry=function(i,n){for(var a=[],r=[],o=e.utils.xmlAttribute,s=0;s<i.childNodes.length;s++){var l=i.childNodes[s];if("jwplayer"==l.prefix){var c=t.localName(l);"source"==c?(delete n.sources,a.push({file:o(l,"file"),"default":o(l,"default"),label:o(l,"label"),type:o(l,"type")})):"track"==c?(delete n.tracks,r.push({file:o(l,"file"),"default":o(l,"default"),kind:o(l,"kind"),label:o(l,"label")})):(n[c]=e.utils.serialize(t.textContent(l)),"file"==c&&n.sources&&delete n.sources)}n.file||(n.file=n.link)}if(a.length)for(n.sources=[],s=0;s<a.length;s++)0<a[s].file.length&&(a[s]["default"]="true"==a[s]["default"]?!0:!1,a[s].label.length||delete a[s].label,n.sources.push(a[s]));if(r.length)for(n.tracks=[],s=0;s<r.length;s++)0<r[s].file.length&&(r[s]["default"]="true"==r[s]["default"]?!0:!1,r[s].kind=r[s].kind.length?r[s].kind:"captions",r[s].label.length||delete r[s].label,n.tracks.push(r[s]));return n}}(jwplayer),function(e){var t=jwplayer.utils,i=t.xmlAttribute,n=e.localName,a=e.textContent,r=e.numChildren,o=e.mediaparser=function(){};o.parseGroup=function(e,s){var l,c,d=[];for(c=0;c<r(e);c++)if(l=e.childNodes[c],"media"==l.prefix&&n(l))switch(n(l).toLowerCase()){case"content":i(l,"duration")&&(s.duration=t.seconds(i(l,"duration"))),0<r(l)&&(s=o.parseGroup(l,s)),i(l,"url")&&(s.sources||(s.sources=[]),s.sources.push({file:i(l,"url"),type:i(l,"type"),width:i(l,"width"),label:i(l,"label")}));break;case"title":s.title=a(l);break;case"description":s.description=a(l);break;case"guid":s.mediaid=a(l);break;case"thumbnail":s.image||(s.image=i(l,"url"));break;case"group":o.parseGroup(l,s);break;case"subtitle":var h={};if(h.file=i(l,"url"),h.kind="captions",0<i(l,"lang").length){var u=h;l=i(l,"lang");var p={zh:"Chinese",nl:"Dutch",en:"English",fr:"French",de:"German",it:"Italian",ja:"Japanese",pt:"Portuguese",ru:"Russian",es:"Spanish"};l=p[l]?p[l]:l,u.label=l}d.push(h)}for(s.hasOwnProperty("tracks")||(s.tracks=[]),c=0;c<d.length;c++)s.tracks.push(d[c]);return s}}(jwplayer.parsers),function(e){function t(t){for(var a={},r=0;r<t.childNodes.length;r++){var s=t.childNodes[r],l=o(s);if(l)switch(l.toLowerCase()){case"enclosure":a.file=i.xmlAttribute(s,"url");break;case"title":a.title=n(s);break;case"guid":a.mediaid=n(s);break;case"pubdate":a.date=n(s);break;case"description":a.description=n(s);break;case"link":a.link=n(s);break;case"category":a.tags=a.tags?a.tags+n(s):n(s)}}return a=e.mediaparser.parseGroup(t,a),a=e.jwparser.parseEntry(t,a),new jwplayer.playlist.item(a)}var i=jwplayer.utils,n=e.textContent,a=e.getChildNode,r=e.numChildren,o=e.localName;e.rssparser={},e.rssparser.parse=function(e){for(var i=[],n=0;n<r(e);n++){var s=a(e,n);if("channel"==o(s).toLowerCase())for(var l=0;l<r(s);l++){var c=a(s,l);"item"==o(c).toLowerCase()&&i.push(t(c))}}return i}}(jwplayer.parsers),function(e){e.playlist=function(t){var i=[];if("array"==e.utils.typeOf(t))for(var n=0;n<t.length;n++)i.push(new e.playlist.item(t[n]));else i.push(new e.playlist.item(t));return i}}(jwplayer),function(e){var t=e.item=function(i){var n=jwplayer.utils,a=n.extend({},t.defaults,i);a.tracks=i&&n.exists(i.tracks)?i.tracks:[],0==a.sources.length&&(a.sources=[new e.source(a)]);for(var r=0;r<a.sources.length;r++){var o=a.sources[r]["default"];a.sources[r]["default"]=o?"true"==o.toString():!1,a.sources[r]=new e.source(a.sources[r])}if(a.captions&&!n.exists(i.tracks)){for(i=0;i<a.captions.length;i++)a.tracks.push(a.captions[i]);delete a.captions}for(r=0;r<a.tracks.length;r++)a.tracks[r]=new e.track(a.tracks[r]);return a};t.defaults={description:"",image:"",mediaid:"",title:"",sources:[],tracks:[]}}(jwplayer.playlist),function(e){var t=jwplayer,i=t.utils,n=t.events,a=t.parsers;e.loader=function(){function t(t){try{var i=t.responseXML.childNodes;t="";for(var r=0;r<i.length&&(t=i[r],!(8!=t.nodeType));r++);if("xml"==a.localName(t)&&(t=t.nextSibling),"rss"!=a.localName(t))o("Not a valid RSS feed");else{var l=new e(a.rssparser.parse(t));s.sendEvent(n.JWPLAYER_PLAYLIST_LOADED,{playlist:l})}}catch(c){o()}}function r(e){o(e.match(/invalid/i)?"Not a valid RSS feed":"")}function o(e){s.sendEvent(n.JWPLAYER_ERROR,{message:e?e:"Error loading file"})}var s=new n.eventdispatcher;i.extend(this,s),this.load=function(e){i.ajax(e,t,r)}}}(jwplayer.playlist),function(e){var t=jwplayer.utils,i={file:void 0,label:void 0,type:void 0,"default":void 0};e.source=function(e){var n=t.extend({},i);return t.foreach(i,function(i){t.exists(e[i])&&(n[i]=e[i],delete e[i])}),n.type&&0<n.type.indexOf("/")&&(n.type=t.extensionmap.mimeType(n.type)),"m3u8"==n.type&&(n.type="hls"),"smil"==n.type&&(n.type="rtmp"),n}}(jwplayer.playlist),function(e){var t=jwplayer.utils,i={file:void 0,label:void 0,kind:"captions","default":!1};e.track=function(e){var n=t.extend({},i);return e||(e={}),t.foreach(i,function(i){t.exists(e[i])&&(n[i]=e[i],delete e[i])}),n}}(jwplayer.playlist),function(e){function t(e,t,n){var a=e.style;a.backgroundColor="#000",a.color="#FFF",a.width=i.styleDimension(n.width),a.height=i.styleDimension(n.height),a.display="table",a.opacity=1,n=document.createElement("p"),a=n.style,a.verticalAlign="middle",a.textAlign="center",a.display="table-cell",a.font="15px/20px Arial, Helvetica, sans-serif",n.innerHTML=t.replace(":",":<br>"),e.innerHTML="",e.appendChild(n)}var i=e.utils,n=e.events,a=!0,r=!1,o=document,s=e.embed=function(l){function c(e,t){i.foreach(t,function(t,i){"function"==typeof e[t]&&e[t].call(e,i)})}function d(){if(!T)if("array"==i.typeOf(_.playlist)&&2>_.playlist.length&&(0==_.playlist.length||!_.playlist[0].sources||0==_.playlist[0].sources.length))p();else if(!C)if("string"==i.typeOf(_.playlist)){var t=new e.playlist.loader;t.addEventListener(n.JWPLAYER_PLAYLIST_LOADED,function(e){_.playlist=e.playlist,C=r,d()}),t.addEventListener(n.JWPLAYER_ERROR,function(e){C=r,p(e)}),C=a,t.load(_.playlist)}else if(S.getStatus()==i.loaderstatus.COMPLETE){for(t=0;t<_.modes.length;t++)if(_.modes[t].type&&s[_.modes[t].type]){var o=i.extend({},_),u=new s[_.modes[t].type](g,_.modes[t],o,S,l);if(u.supportsConfig())return u.addEventListener(n.ERROR,h),u.embed(),c(l,o.events),l}var v;_.fallback?(v="No suitable players found and fallback enabled",k=setTimeout(function(){f(v,a)},10),i.log(v),new s.download(g,_,p)):(v="No suitable players found and fallback disabled",f(v,r),i.log(v),g.parentNode.replaceChild(w,g))}}function h(e){v(x+e.message)}function u(e){v("Could not load plugins: "+e.message)}function p(e){v(e&&e.message?"Error loading playlist: "+e.message:x+"No playable sources found")}function f(e,t){k&&(clearTimeout(k),k=null),k=setTimeout(function(){k=null,l.dispatchEvent(n.JWPLAYER_SETUP_ERROR,{message:e,fallback:t})},0)}function v(e){T||(_.fallback?(T=a,t(g,e,_),f(e,a)):f(e,r))}var g,m,w,_=new s.config(l.config),y=_.width,b=_.height,x="Error loading player: ",S=e.plugins.loadPlugins(l.id,_.plugins),C=r,T=r,k=null;return _.fallbackDiv&&(w=_.fallbackDiv,delete _.fallbackDiv),_.id=l.id,m=o.getElementById(l.id),_.aspectratio?l.config.aspectratio=_.aspectratio:delete l.config.aspectratio,g=o.createElement("div"),g.id=m.id,g.style.width=0<y.toString().indexOf("%")?y:y+"px",g.style.height=0<b.toString().indexOf("%")?b:b+"px",m.parentNode.replaceChild(g,m),this.embed=function(){T||(S.addEventListener(n.COMPLETE,d),S.addEventListener(n.ERROR,u),S.load())},this.errorScreen=v,this};e.embed.errorScreen=t}(jwplayer),function(e){function t(e){if(e.playlist)for(var t=0;t<e.playlist.length;t++)e.playlist[t]=new a(e.playlist[t]);else{var r={};n.foreach(a.defaults,function(t){i(e,r,t)}),r.sources||(e.levels?(r.sources=e.levels,delete e.levels):(t={},i(e,t,"file"),i(e,t,"type"),r.sources=t.file?[t]:[])),e.playlist=[new a(r)]}}function i(e,t,i){n.exists(e[i])&&(t[i]=e[i],delete e[i])}var n=e.utils,a=e.playlist.item;(e.embed.config=function(i){var a={fallback:!0,height:270,primary:"html5",width:480,base:i.base?i.base:n.getScriptPath("jwplayer.js"),aspectratio:""};i=n.extend(a,e.defaults,i);var a={type:"html5",src:i.base+"jwplayer.html5.js"},r={type:"flash",src:i.base+"jwplayer.flash.swf"};if(i.modes="flash"==i.primary?[r,a]:[a,r],i.listbar&&(i.playlistsize=i.listbar.size,i.playlistposition=i.listbar.position,i.playlistlayout=i.listbar.layout),i.flashplayer&&(r.src=i.flashplayer),i.html5player&&(a.src=i.html5player),t(i),r=i.aspectratio,"string"==typeof r&&n.exists(r)){var o=r.indexOf(":");-1==o?a=0:(a=parseFloat(r.substr(0,o)),r=parseFloat(r.substr(o+1)),a=0>=a||0>=r?0:100*(r/a)+"%")}else a=0;return-1==i.width.toString().indexOf("%")?delete i.aspectratio:a?i.aspectratio=a:delete i.aspectratio,i}).addConfig=function(e,i){return t(i),n.extend(e,i)}}(jwplayer),function(e){var t=e.utils,i=document;e.embed.download=function(e,n,a){function r(e,n){for(var a=i.querySelectorAll(e),r=0;r<a.length;r++)t.foreach(n,function(e,t){a[r].style[e]=t})}function o(e,t,n){return e=i.createElement(e),t&&(e.className="jwdownload"+t),n&&n.appendChild(e),e}var s,l=t.extend({},n),c=l.width?l.width:480,d=l.height?l.height:320;n=n.logo?n.logo:{prefix:t.repo(),file:"logo.png",margin:10};var h,u,p,f,l=l.playlist,v=["mp4","aac","mp3"];if(l&&l.length){for(f=l[0],s=f.sources,l=0;l<s.length;l++){var g=s[l],m=g.type?g.type:t.extensionmap.extType(t.extension(g.file));g.file&&t.foreach(v,function(e){m==v[e]?(h=g.file,u=f.image):t.isYouTube(g.file)&&(p=g.file)})}h?(s=h,a=u,e&&(l=o("a","display",e),o("div","icon",l),o("div","logo",l),s&&l.setAttribute("href",t.getAbsolutePath(s))),l="#"+e.id+" .jwdownload",e.style.width="",e.style.height="",r(l+"display",{width:t.styleDimension(Math.max(320,c)),height:t.styleDimension(Math.max(180,d)),background:"black center no-repeat "+(a?"url("+a+")":""),backgroundSize:"contain",position:"relative",border:"none",display:"block"}),r(l+"display div",{position:"absolute",width:"100%",height:"100%"}),r(l+"logo",{top:n.margin+"px",right:n.margin+"px",background:"top right no-repeat url("+n.prefix+n.file+")"}),r(l+"icon",{background:"center no-repeat url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAgNJREFUeNrs28lqwkAYB/CZqNVDDj2r6FN41QeIy8Fe+gj6BL275Q08u9FbT8ZdwVfotSBYEPUkxFOoks4EKiJdaDuTjMn3wWBO0V/+sySR8SNSqVRKIR8qaXHkzlqS9jCfzzWcTCYp9hF5o+59sVjsiRzcegSckFzcjT+ruN80TeSlAjCAAXzdJSGPFXRpAAMYwACGZQkSdhG4WCzehMNhqV6vG6vVSrirKVEw66YoSqDb7cqlUilE8JjHd/y1MQefVzqdDmiaJpfLZWHgXMHn8F6vJ1cqlVAkEsGuAn83J4gAd2RZymQygX6/L1erVQt+9ZPWb+CDwcCC2zXGJaewl/DhcHhK3DVj+KfKZrMWvFarcYNLomAv4aPRSFZVlTlcSPA5fDweW/BoNIqFnKV53JvncjkLns/n/cLdS+92O7RYLLgsKfv9/t8XlDn4eDyiw+HA9Jyz2eyt0+kY2+3WFC5hluej0Ha7zQQq9PPwdDq1Et1sNsx/nFBgCqWJ8oAK1aUptNVqcYWewE4nahfU0YQnk4ntUEfGMIU2m01HoLaCKbTRaDgKtaVLk9tBYaBcE/6Artdr4RZ5TB6/dC+9iIe/WgAMYADDpAUJAxjAAAYwgGFZgoS/AtNNTF7Z2bL0BYPBV3Jw5xFwwWcYxgtBP5OkE8i9G7aWGOOCruvauwADALMLMEbKf4SdAAAAAElFTkSuQmCC)"})):p?(n=p,e=o("iframe","",e),e.src="http://www.youtube.com/embed/"+t.youTubeID(n),e.width=c,e.height=d,e.style.border="none"):a()}}}(jwplayer),function(e){var t=e.utils,i=e.events,n={};(e.embed.flash=function(r,o,s,l,c){function d(e,t,i){var n=document.createElement("param");n.setAttribute("name",t),n.setAttribute("value",i),e.appendChild(n)}function h(e,t,i){return function(){try{i&&document.getElementById(c.id+"_wrapper").appendChild(t);var n=document.getElementById(c.id).getPluginConfig("display");"function"==typeof e.resize&&e.resize(n.width,n.height),t.style.left=n.x,t.style.top=n.h}catch(a){}}}function u(e){if(!e)return{};var i={},n=[];return t.foreach(e,function(e,a){var r=t.getPluginName(e);n.push(e),t.foreach(a,function(e,t){i[r+"."+e]=t})}),i.plugins=n.join(","),i}var p=new e.events.eventdispatcher,f=t.flashVersion();t.extend(this,p),this.embed=function(){if(s.id=c.id,10>f)return p.sendEvent(i.ERROR,{message:"Flash version must be 10.0 or greater"}),!1;var e,a,v=c.config.listbar,g=t.extend({},s);if(r.id+"_wrapper"==r.parentNode.id)e=document.getElementById(r.id+"_wrapper");else{if(e=document.createElement("div"),a=document.createElement("div"),a.style.display="none",a.id=r.id+"_aspect",e.id=r.id+"_wrapper",e.style.position="relative",e.style.display="block",e.style.width=t.styleDimension(g.width),e.style.height=t.styleDimension(g.height),c.config.aspectratio){var m=parseFloat(c.config.aspectratio);a.style.display="block",a.style.marginTop=c.config.aspectratio,e.style.height="auto",e.style.display="inline-block",v&&("bottom"==v.position?a.style.paddingBottom=v.size+"px":"right"==v.position&&(a.style.marginBottom=-1*v.size*(m/100)+"px"))}r.parentNode.replaceChild(e,r),e.appendChild(r),e.appendChild(a)}for(e=l.setupPlugins(c,g,h),0<e.length?t.extend(g,u(e.plugins)):delete g.plugins,"undefined"!=typeof g["dock.position"]&&"false"==g["dock.position"].toString().toLowerCase()&&(g.dock=g["dock.position"],delete g["dock.position"]),e=g.wmode?g.wmode:g.height&&40>=g.height?"transparent":"opaque",a="height width modes events primary base fallback volume".split(" "),v=0;v<a.length;v++)delete g[a[v]];a=t.getCookies(),t.foreach(a,function(e,t){"undefined"==typeof g[e]&&(g[e]=t)}),a=window.location.href.split("/"),a.splice(a.length-1,1),a=a.join("/"),g.base=a+"/",n[r.id]=g,t.isIE()?(a='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" " width="100%" height="100%"id="'+r.id+'" name="'+r.id+'" tabindex=0"">',a+='<param name="movie" value="'+o.src+'">',a+='<param name="allowfullscreen" value="true"><param name="allowscriptaccess" value="always">',a+='<param name="seamlesstabbing" value="true">',a+='<param name="wmode" value="'+e+'">',a+='<param name="bgcolor" value="#000000">',a+="</object>",r.outerHTML=a,e=document.getElementById(r.id)):(a=document.createElement("object"),a.setAttribute("type","application/x-shockwave-flash"),a.setAttribute("data",o.src),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("bgcolor","#000000"),a.setAttribute("id",r.id),a.setAttribute("name",r.id),a.setAttribute("tabindex",0),d(a,"allowfullscreen","true"),d(a,"allowscriptaccess","always"),d(a,"seamlesstabbing","true"),d(a,"wmode",e),r.parentNode.replaceChild(a,r),e=a),c.config.aspectratio&&(e.style.position="absolute"),c.container=e,c.setPlayer(e,"flash")},this.supportsConfig=function(){if(f){if(!s)return!0;if("string"==t.typeOf(s.playlist))return!0;try{var e=s.playlist[0].sources;if("undefined"==typeof e)return!0;for(var i=0;i<e.length;i++)if(e[i].file&&a(e[i].file,e[i].type))return!0}catch(n){}}return!1}}).getVars=function(e){return n[e]};var a=e.embed.flashCanPlay=function(e,i){if(t.isYouTube(e)||t.isRtmp(e,i)||"hls"==i)return!0;var n=t.extensionmap[i?i:t.extension(e)];return n?!!n.flash:!1}}(jwplayer),function(e){var t=e.utils,i=t.extensionmap,n=e.events;e.embed.html5=function(a,r,o,s,l){function c(e,t,i){return function(){try{var n=document.querySelector("#"+a.id+" .jwmain");i&&n.appendChild(t),"function"==typeof e.resize&&(e.resize(n.clientWidth,n.clientHeight),setTimeout(function(){e.resize(n.clientWidth,n.clientHeight)},400)),t.left=n.style.left,t.top=n.style.top}catch(r){}}}function d(e){h.sendEvent(e.type,{message:"HTML5 player not found"})}var h=this,u=new n.eventdispatcher;t.extend(h,u),h.embed=function(){if(e.html5){s.setupPlugins(l,o,c),a.innerHTML="";var i=e.utils.extend({},o);delete i.volume,i=new e.html5.player(i),l.container=document.getElementById(l.id),l.setPlayer(i,"html5")}else i=new t.scriptloader(r.src),i.addEventListener(n.ERROR,d),i.addEventListener(n.COMPLETE,h.embed),i.load()},h.supportsConfig=function(){if(e.vid.canPlayType)try{if("string"==t.typeOf(o.playlist))return!0;for(var n=o.playlist[0].sources,a=0;a<n.length;a++){var r,s=n[a].file,l=n[a].type;if(null!==navigator.userAgent.match(/BlackBerry/i)||t.isAndroid()&&("m3u"==t.extension(s)||"m3u8"==t.extension(s))||t.isRtmp(s,l))r=!1;else{var c,d=i[l?l:t.extension(s)];if(!d||d.flash&&!d.html5)c=!1;else{var h=d.html5,u=e.vid;if(h)try{c=u.canPlayType(h)?!0:!1}catch(p){c=!1}else c=!0}r=c}if(r)return!0}}catch(f){}return!1}}}(jwplayer),function(e){var t=e.embed,i=e.utils,n=/\.(js|swf)$/;e.embed=i.extend(function(a){function r(){o="Adobe SiteCatalyst Error: Could not find Media Module"}var o,s=i.repo(),l=i.extend({},e.defaults),c=i.extend({},l,a.config),d=a.config,h=c.plugins,u=c.analytics,p=s+"jwpsrv.js",f=s+"sharing.js",v=s+"related.js",g=s+"gapro.js",l=e.key?e.key:l.key,m=new e.utils.key(l).edition(),h=h?h:{};switch("ads"==m&&c.advertising&&(n.test(c.advertising.client)?h[c.advertising.client]=c.advertising:h[s+c.advertising.client+".js"]=c.advertising),delete d.advertising,d.key=l,c.analytics&&n.test(c.analytics.client)&&(p=c.analytics.client),delete d.analytics,u&&"ads"!==m&&delete u.enabled,"free"!=m&&u&&!1===u.enabled||(h[p]=u?u:{}),delete h.sharing,delete h.related,m){case"ads":if(d.sitecatalyst)try{window.s&&window.s.hasOwnProperty("Media")?new e.embed.sitecatalyst(a):r()}catch(w){r()}case"premium":c.related&&(n.test(c.related.client)&&(v=c.related.client),h[v]=c.related),c.ga&&(n.test(c.ga.client)&&(g=c.ga.client),h[g]=c.ga);case"pro":c.sharing&&(n.test(c.sharing.client)&&(f=c.sharing.client),h[f]=c.sharing),c.skin&&(d.skin=c.skin.replace(/^(beelden|bekle|five|glow|modieus|roundster|stormtrooper|vapor)$/i,i.repo()+"skins/$1.xml"))}return d.plugins=h,a.config=d,a=new t(a),o&&a.errorScreen(o),a},e.embed)}(jwplayer),function(e){var t=jwplayer.utils;e.sitecatalyst=function(e){function i(e){u.debug&&t.log(e)}function n(e){return e=e.split("/"),e=e[e.length-1],e=e.split("?"),e[0]}function a(){if(!f){f=!0;var e=h.getPosition();i("stop: "+o+" : "+e),s.Media.stop(o,e)}}function r(){v||(a(),v=!0,i("close: "+o),s.Media.close(o),d=!0,c=0)}var o,l,c,d,h=e,u=t.extend({},h.config.sitecatalyst),p={onPlay:function(){if(!d){var e=h.getPosition();f=!1,i("play: "+o+" : "+e),s.Media.play(o,e)}},onPause:a,onBuffer:a,onIdle:r,onPlaylistItem:function(e){try{d=!0,r(),c=0;var i;if(u.mediaName)i=u.mediaName;else{var a=h.getPlaylistItem(e.index);i=a.title?a.title:a.file?n(a.file):a.sources&&a.sources.length?n(a.sources[0].file):""}o=i,l=u.playerName?u.playerName:h.id}catch(s){t.log(s)}},onTime:function(){if(d){var e=h.getDuration();if(-1==e)return;v=f=d=!1,i("open: "+o+" : "+e+" : "+l),s.Media.open(o,e,l),i("play: "+o+" : 0"),s.Media.play(o,0)}if(e=h.getPosition(),3<=Math.abs(e-c)){var t=c;i("seek: "+t+" to "+e),i("stop: "+o+" : "+t),s.Media.stop(o,t),i("play: "+o+" : "+e),s.Media.play(o,e)}c=e},onComplete:r},f=!0,v=!0;t.foreach(p,function(e){h[e](p[e])})}}(jwplayer.embed),function(e,t){var i=[],n=e.utils,a=e.events,r=a.state,o=document,s=e.api=function(i){function l(e,t){return function(i){return t(e,i)}}function c(e,t){return m[e]||(m[e]=[],h(a.JWPLAYER_PLAYER_STATE,function(t){var i=t.newstate;if(t=t.oldstate,i==e){var n=m[i];if(n)for(var a=0;a<n.length;a++){var r=n[a];"function"==typeof r&&r.call(this,{oldstate:t,newstate:i})}}})),m[e].push(t),v}function d(e,t){try{e.jwAddEventListener(t,'function(dat) { jwplayer("'+v.id+'").dispatchEvent("'+t+'", dat); }')}catch(i){n.log("Could not add internal listener")}}function h(e,t){return g[e]||(g[e]=[],p&&w&&d(p,e)),g[e].push(t),v}function u(){if(w){if(p){var e=Array.prototype.slice.call(arguments,0),t=e.shift();if("function"==typeof p[t]){switch(e.length){case 6:return p[t](e[0],e[1],e[2],e[3],e[4],e[5]);case 5:return p[t](e[0],e[1],e[2],e[3],e[4]);case 4:return p[t](e[0],e[1],e[2],e[3]);case 3:return p[t](e[0],e[1],e[2]);case 2:return p[t](e[0],e[1]);case 1:return p[t](e[0])}return p[t]()}}return null}_.push(arguments)}var p,f,v=this,g={},m={},w=!1,_=[],y={},b={};v.container=i,v.id=i.id,v.getBuffer=function(){return u("jwGetBuffer")},v.getContainer=function(){return v.container},v.addButton=function(e,t,i,a){try{b[a]=i,u("jwDockAddButton",e,t,"jwplayer('"+v.id+"').callback('"+a+"')",a)}catch(r){n.log("Could not add dock button"+r.message)}},v.removeButton=function(e){u("jwDockRemoveButton",e)},v.callback=function(e){b[e]&&b[e]()},v.forceState=function(e){return u("jwForceState",e),v},v.releaseState=function(){return u("jwReleaseState")},v.getDuration=function(){return u("jwGetDuration")},v.getFullscreen=function(){return u("jwGetFullscreen")},v.getHeight=function(){return u("jwGetHeight")},v.getLockState=function(){return u("jwGetLockState")},v.getMeta=function(){return v.getItemMeta()},v.getMute=function(){return u("jwGetMute")},v.getPlaylist=function(){var e=u("jwGetPlaylist");return"flash"==v.renderingMode&&n.deepReplaceKeyName(e,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),e},v.getPlaylistItem=function(e){return n.exists(e)||(e=v.getPlaylistIndex()),v.getPlaylist()[e]},v.getPlaylistIndex=function(){return u("jwGetPlaylistIndex")},v.getPosition=function(){return u("jwGetPosition")},v.getRenderingMode=function(){return v.renderingMode},v.getState=function(){return u("jwGetState")},v.getVolume=function(){return u("jwGetVolume")},v.getWidth=function(){return u("jwGetWidth")},v.setFullscreen=function(e){return n.exists(e)?u("jwSetFullscreen",e):u("jwSetFullscreen",!u("jwGetFullscreen")),v},v.setMute=function(e){return n.exists(e)?u("jwSetMute",e):u("jwSetMute",!u("jwGetMute")),v},v.lock=function(){return v},v.unlock=function(){return v},v.load=function(e){return u("jwLoad",e),v},v.playlistItem=function(e){return u("jwPlaylistItem",parseInt(e,10)),v},v.playlistPrev=function(){return u("jwPlaylistPrev"),v},v.playlistNext=function(){return u("jwPlaylistNext"),v},v.resize=function(e,t){if("flash"!==v.renderingMode)u("jwResize",e,t);else{var i=o.getElementById(v.id+"_wrapper"),a=o.getElementById(v.id+"_aspect");a&&(a.style.display="none"),i&&(i.style.display="block",i.style.width=n.styleDimension(e),i.style.height=n.styleDimension(t))}return v},v.play=function(e){return e===t?(e=v.getState(),u(e==r.PLAYING||e==r.BUFFERING?"jwPause":"jwPlay")):u("jwPlay",e),v},v.pause=function(e){return e===t?(e=v.getState(),u(e==r.PLAYING||e==r.BUFFERING?"jwPause":"jwPlay")):u("jwPause",e),v},v.stop=function(){return u("jwStop"),v},v.seek=function(e){return u("jwSeek",e),v},v.setVolume=function(e){return u("jwSetVolume",e),v},v.createInstream=function(){return new s.instream(this,p)},v.setInstream=function(e){return f=e},v.loadInstream=function(e,t){return f=v.setInstream(v.createInstream()).init(t),f.loadItem(e),f},v.getQualityLevels=function(){return u("jwGetQualityLevels")},v.getCurrentQuality=function(){return u("jwGetCurrentQuality")},v.setCurrentQuality=function(e){u("jwSetCurrentQuality",e)},v.getCaptionsList=function(){return u("jwGetCaptionsList")},v.getCurrentCaptions=function(){return u("jwGetCurrentCaptions")},v.setCurrentCaptions=function(e){u("jwSetCurrentCaptions",e)},v.getControls=function(){return u("jwGetControls")},v.getSafeRegion=function(){return u("jwGetSafeRegion")},v.setControls=function(e){u("jwSetControls",e)},v.destroyPlayer=function(){u("jwPlayerDestroy")},v.playAd=function(t){var i=e(v.id).plugins;i.vast&&i.vast.jwPlayAd(t)},v.pauseAd=function(){var t=e(v.id).plugins;t.vast?t.vast.jwPauseAd():u("jwPauseAd")};var x={onBufferChange:a.JWPLAYER_MEDIA_BUFFER,onBufferFull:a.JWPLAYER_MEDIA_BUFFER_FULL,onError:a.JWPLAYER_ERROR,onSetupError:a.JWPLAYER_SETUP_ERROR,onFullscreen:a.JWPLAYER_FULLSCREEN,onMeta:a.JWPLAYER_MEDIA_META,onMute:a.JWPLAYER_MEDIA_MUTE,onPlaylist:a.JWPLAYER_PLAYLIST_LOADED,onPlaylistItem:a.JWPLAYER_PLAYLIST_ITEM,onPlaylistComplete:a.JWPLAYER_PLAYLIST_COMPLETE,onReady:a.API_READY,onResize:a.JWPLAYER_RESIZE,onComplete:a.JWPLAYER_MEDIA_COMPLETE,onSeek:a.JWPLAYER_MEDIA_SEEK,onTime:a.JWPLAYER_MEDIA_TIME,onVolume:a.JWPLAYER_MEDIA_VOLUME,onBeforePlay:a.JWPLAYER_MEDIA_BEFOREPLAY,onBeforeComplete:a.JWPLAYER_MEDIA_BEFORECOMPLETE,onDisplayClick:a.JWPLAYER_DISPLAY_CLICK,onControls:a.JWPLAYER_CONTROLS,onQualityLevels:a.JWPLAYER_MEDIA_LEVELS,onQualityChange:a.JWPLAYER_MEDIA_LEVEL_CHANGED,onCaptionsList:a.JWPLAYER_CAPTIONS_LIST,onCaptionsChange:a.JWPLAYER_CAPTIONS_CHANGED,onAdError:a.JWPLAYER_AD_ERROR,onAdClick:a.JWPLAYER_AD_CLICK,onAdImpression:a.JWPLAYER_AD_IMPRESSION,onAdTime:a.JWPLAYER_AD_TIME,onAdComplete:a.JWPLAYER_AD_COMPLETE,onAdCompanions:a.JWPLAYER_AD_COMPANIONS,onAdSkipped:a.JWPLAYER_AD_SKIPPED};n.foreach(x,function(e){v[e]=l(x[e],h)});var S={onBuffer:r.BUFFERING,onPause:r.PAUSED,onPlay:r.PLAYING,onIdle:r.IDLE};return n.foreach(S,function(e){v[e]=l(S[e],c)}),v.remove=function(){if(!w)throw"Cannot call remove() before player is ready";_=[],s.destroyPlayer(this.id)},v.setup=function(t){if(e.embed){var i=o.getElementById(v.id);return i&&(t.fallbackDiv=i),i=v,_=[],s.destroyPlayer(i.id),i=e(v.id),i.config=t,new e.embed(i).embed(),i}return v},v.registerPlugin=function(t,i,n,a){e.plugins.registerPlugin(t,i,n,a)},v.setPlayer=function(e,t){p=e,v.renderingMode=t},v.detachMedia=function(){return"html5"==v.renderingMode?u("jwDetachMedia"):void 0},v.attachMedia=function(e){return"html5"==v.renderingMode?u("jwAttachMedia",e):void 0},v.removeEventListener=function(e,t){var i=g[e];if(i)for(var n=i.length;n--;)i[n]===t&&i.splice(n,1)},v.dispatchEvent=function(e,t){var i=g[e];if(i)for(var i=i.slice(0),r=n.translateEventResponse(e,t),o=0;o<i.length;o++){var s=i[o];if("function"==typeof s)try{e===a.JWPLAYER_PLAYLIST_LOADED&&n.deepReplaceKeyName(r.playlist,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),s.call(this,r)}catch(l){n.log("There was an error calling back an event handler")}}},v.dispatchInstreamEvent=function(e){f&&f.dispatchEvent(e,arguments)},v.callInternal=u,v.playerReady=function(e){for(w=!0,p||v.setPlayer(o.getElementById(e.id)),v.container=o.getElementById(v.id),n.foreach(g,function(e){d(p,e)}),h(a.JWPLAYER_PLAYLIST_ITEM,function(){y={}}),h(a.JWPLAYER_MEDIA_META,function(e){n.extend(y,e.metadata)}),v.dispatchEvent(a.API_READY);0<_.length;)u.apply(this,_.shift())},v.getItemMeta=function(){return y},v.isBeforePlay=function(){return u("jwIsBeforePlay")},v.isBeforeComplete=function(){return u("jwIsBeforeComplete")},v};s.selectPlayer=function(e){var t;return n.exists(e)||(e=0),e.nodeType?t=e:"string"==typeof e&&(t=o.getElementById(e)),t?(e=s.playerById(t.id))?e:s.addPlayer(new s(t)):"number"==typeof e?i[e]:null},s.playerById=function(e){for(var t=0;t<i.length;t++)if(i[t].id==e)return i[t];return null},s.addPlayer=function(e){for(var t=0;t<i.length;t++)if(i[t]==e)return e;return i.push(e),e},s.destroyPlayer=function(e){for(var t,a=-1,r=0;r<i.length;r++)i[r].id==e&&(a=r,t=i[r]);return a>=0&&(e=t.id,r=o.getElementById(e+("flash"==t.renderingMode?"_wrapper":"")),n.clearCss&&n.clearCss("#"+e),r&&("html5"==t.renderingMode&&t.destroyPlayer(),t=o.createElement("div"),t.id=e,r.parentNode.replaceChild(t,r)),i.splice(a,1)),null},e.playerReady=function(t){var i=e.api.playerById(t.id);i?i.playerReady(t):e.api.selectPlayer(t.id).playerReady(t)}}(window.jwplayer),function(e){var t=e.events,i=e.utils,n=t.state;e.api.instream=function(e,a){function r(t,i){return c[t]||(c[t]=[],a.jwInstreamAddEventListener(t,'function(dat) { jwplayer("'+e.id+'").dispatchInstreamEvent("'+t+'", dat); }')),c[t].push(i),this}function o(e,i){return d[e]||(d[e]=[],r(t.JWPLAYER_PLAYER_STATE,function(t){var i=t.newstate,n=t.oldstate;if(i==e){var a=d[i];if(a)for(var r=0;r<a.length;r++){var o=a[r];"function"==typeof o&&o.call(this,{oldstate:n,newstate:i,type:t.type})}}})),d[e].push(i),this}var s,l,c={},d={},h=this;h.type="instream",h.init=function(){return e.callInternal("jwInitInstream"),h},h.loadItem=function(t,n){s=t,l=n||{},"array"==i.typeOf(t)?e.callInternal("jwLoadArrayInstream",s,l):e.callInternal("jwLoadItemInstream",s,l)},h.removeEvents=function(){c=d={}},h.removeEventListener=function(e,t){var i=c[e];if(i)for(var n=i.length;n--;)i[n]===t&&i.splice(n,1)},h.dispatchEvent=function(e,t){var n=c[e];if(n)for(var n=n.slice(0),a=i.translateEventResponse(e,t[1]),r=0;r<n.length;r++){var o=n[r];"function"==typeof o&&o.call(this,a)}},h.onError=function(e){return r(t.JWPLAYER_ERROR,e)},h.onMediaError=function(e){return r(t.JWPLAYER_MEDIA_ERROR,e)},h.onFullscreen=function(e){return r(t.JWPLAYER_FULLSCREEN,e)},h.onMeta=function(e){return r(t.JWPLAYER_MEDIA_META,e)},h.onMute=function(e){return r(t.JWPLAYER_MEDIA_MUTE,e)},h.onComplete=function(e){return r(t.JWPLAYER_MEDIA_COMPLETE,e)},h.onPlaylistComplete=function(e){return r(t.JWPLAYER_PLAYLIST_COMPLETE,e)},h.onPlaylistItem=function(e){return r(t.JWPLAYER_PLAYLIST_ITEM,e)},h.onTime=function(e){return r(t.JWPLAYER_MEDIA_TIME,e)},h.onBuffer=function(e){return o(n.BUFFERING,e)},h.onPause=function(e){return o(n.PAUSED,e)},h.onPlay=function(e){return o(n.PLAYING,e)},h.onIdle=function(e){return o(n.IDLE,e)},h.onClick=function(e){return r(t.JWPLAYER_INSTREAM_CLICK,e)},h.onInstreamDestroyed=function(e){return r(t.JWPLAYER_INSTREAM_DESTROYED,e)},h.onAdSkipped=function(e){return r(t.JWPLAYER_AD_SKIPPED,e)},h.play=function(e){a.jwInstreamPlay(e)},h.pause=function(e){a.jwInstreamPause(e)},h.hide=function(){e.callInternal("jwInstreamHide")},h.destroy=function(){h.removeEvents(),e.callInternal("jwInstreamDestroy")},h.setText=function(e){a.jwInstreamSetText(e?e:"")},h.getState=function(){return a.jwInstreamState()},h.setClick=function(e){a.jwInstreamClick&&a.jwInstreamClick(e)}}}(window.jwplayer),function(e){var t=e.api,i=t.selectPlayer;t.selectPlayer=function(t){return(t=i(t))?t:{registerPlugin:function(t,i,n){e.plugins.registerPlugin(t,i,n)}}}}(jwplayer)),define("jwplayer/jwplayer",function(){}),define("interaction_view/ui/media",["interaction_view/ui/mobilemedia","jwplayer/jwplayer"],function(){jwplayer.key="pi2CAQ+8YcxsOQV3Qj6nu+xcVJPULv/CrOegByy/3hg=";var e=require("interaction_view/ui/mobilemedia");return e.seek=function(t,i,n){if(n&&(i=e.getTimeByPercent(t,n)),t.hls){console.log(i);try{t.media.seek(i),t.iview.sliderplay&&t.iview.sliderplay()}catch(a){}}else try{t.media.currentTime=i}catch(a){}},e.changeSrc=function(e,t){if(e.hls)try{e.media.load([{file:t+"_audio.m3u8"}])}catch(i){}else try{e.media.setSrc(t)}catch(i){}},e.video.initH=function(e,t,i){iview=t.iview,t.hls=!0,t.isPaused=!0;var n=t.get("iDetail"),a=n.iRepeat||!1,r=n.iControl||!1,o=iview.getcommon(),s=(t.autoplay=n.iAutoplay||!1,i);console.log("videosrc="+s),t.videoloaded=!1;var l=n.iAutohide;null==l&&(l=!0),iview.$el.removeClass("hide"),iview.$el.children(".Element").append('<div class="hls_video"></div>'),iview.$el.children(".Element").children("div").attr("id","Video_"+t.id+e.id),jwplayer("Video_"+t.id+e.id).setup({playlist:[{image:n.iFile[0].picture,file:i,type:"hls"}],flashplayer:web_url+"thirdparty/jwplayer/jwplayer.flash.swf",html5player:web_url+"thirdparty/jwplayer/jwplayer.html5.js",primary:$.browser.safari?"html5":interaction_view.ismobile?"html5":"flash",height:o.iHeight,width:o.iWidth,controls:r,repeat:a,displaytitle:!1,logo:{hide:!0},stretching:"exactfit",startparam:"starttime",stagevideo:!1});var c=!1;jwplayer("Video_"+t.id+e.id).onSetupError(function(){t.loaded=!1}),jwplayer("Video_"+t.id+e.id).onReady(function(){jwplayer("Video_"+t.id+e.id).onMeta(function(){c||(c=!0,t.reseted=!1)}),t.start_seek&&(t.start_seek=!1,t.media.play(!0))}),jwplayer("Video_"+t.id+e.id).onError(function(){t.loaded=!1}),jwplayer("Video_"+t.id+e.id).onComplete(function(){a?$.browser.safari&&(t.iview.$el.css("opacity",0),setTimeout(function(){t.iview.$el.css("opacity",1)},800)):(t.completed=!0,l&&(t.iview.$el.addClass("hide"),t.hided=!0),t.onAnimationStart&&(interaction_view.events.onAnimationEnd(t.onAnimationStart),t.onAnimationStart=null));var e=_.filter(interaction_view.events.mediaEvents,function(e){return e.overlay_id==t.id&&"onEnded"==e.type});if(e.length)for(var i=0;i<e.length;i++)e[i].func()}),jwplayer("Video_"+t.id+e.id).onPlay(function(e){console.log("The Video is start to play from "+e.oldstate);var i=_.filter(interaction_view.events.mediaEvents,function(e){
return e.overlay_id==t.id&&"onStartPlay"==e.type});if(i.length)for(var n=0;n<i.length;n++)i[n].func()}),jwplayer("Video_"+t.id+e.id).onTime(function(e,i){0==t.iview.$el.css("opacity")&&setTimeout(function(){t.iview.$el.css("opacity",1)},800)}),t.loaded=!0,t.videoloaded=!0,t.media=jwplayer("Video_"+t.id+e.id),e.get("loaded")||(t.reseted=!0,t.completed=!0,e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,!0,t))},e.video.playH=function(e){if(!e.loaded||!e.media)return!1;e.notallowed=!1,e.isPaused=!1;try{e.iview.$el.css("opacity",1),e.completed||e.reseted?e.media&&(e.media.seek(0),e.start_seek=!0):e.media&&e.media.play(!0)}catch(t){}e.completed=!1,e.reseted=!1},e.pause=function(e){if(!e.media||e.media.paused)return!1;if(e.hls){try{e.media.pause(!0)}catch(t){}return!0}try{e.media.pause()}catch(t){}e.iview.slider&&e.iview.sliderstop()},e.video.resetH=function(e,t){if(!e.reseted){try{e.media.pause(!0)}catch(i){}e.media.completed=!0,e.reseted=!0,e.disabled=!0}},e.video.getDurationH=function(e){return e.getDuration()},e.getTimeByPercent=function(e,t){if(!e.media)return null;if(e.hls)var i=e.media.getDuration();else var i=e.media.duration;return t/100*i},e}),define("interaction_view/ui/adapt",[],function(){var e={elements:[],size:{x:0,y:0},adjustSize:function(){},adjustPosition:function(){},parseSize:function(e){return e.width&&$.zoom&&1!=$.zoom&&(e.width=e.width/$.zoom),e.height&&$.zoom&&1!=$.zoom&&(e.height=e.height/$.zoom),e},parseOffset:function(e,t){return t||(t={}),e.model.isMasterOverlay||e.model.isBackgroundOverlay||(0!=t.x&&(e.x=e.x-Reveal.marginLeft),0!=t.y&&(e.y=e.y-Reveal.marginTop)),e},adjustElement:function(e){var t=e.view.getcommon();Reveal._getScreenScale();if(e.view.x=t.iStartx+t.iWidth/2,e.view.y=t.iStarty+t.iHeight/2,e.view.staticX=t.iStartx,e.view.staticY=t.iStarty,e.adapt&&5!=e.adapt)switch(console.log(e.adapt),e.adapt){case 1:e.view.sizeLeft=!0,e.view.sizeTop=!0,e.view=interaction_view.adapt.parseOffset(e.view),e.view.model.isPositionAdapt=!0;break;case 2:e.view.sizeTop=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i,e.view=interaction_view.adapt.parseOffset(e.view),e.view.model.isPositionAdapt=!0;break;case 3:e.view.sizeTop=!0,e.view.sizeRight=!0;var i=t.iStartx+t.iWidth/2,n=interaction_view.size.x-i;e.view.x=Reveal.slideScreenWidth-n,e.view.staticX=e.view.x-t.iWidth/2,e.view=interaction_view.adapt.parseOffset(e.view),e.view.model.isPositionAdapt=!0;break;case 4:e.view.sizeLeft=!0;var a=t.iStarty+t.iHeight/2;Reveal.slideScreenHeight>Reveal.slideHeight?e.view.y=a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:e.view.y=a,e.view.staticY=e.view.y-t.iHeight/2,e.view=interaction_view.adapt.parseOffset(e.view);break;case 5:break;case 6:e.view.sizeRight=!0;var i=t.iStartx+t.iWidth/2,n=interaction_view.size.x-i;e.view.x=Reveal.slideScreenWidth-n;var a=t.iStarty+t.iHeight/2;Reveal.slideScreenHeight>Reveal.slideHeight?e.view.y=a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:e.view.y=a,e.view.staticX=e.view.x-t.iWidth/2,e.view.staticY=e.view.y-t.iHeight/2,e.view=interaction_view.adapt.parseOffset(e.view);break;case 7:e.view.sizeLeft=!0,e.view.sizeBottom=!0;var a=t.iStarty+t.iHeight/2,r=interaction_view.size.y-a;e.view.y=Reveal.slideScreenHeight-r,e.view.staticY=e.view.y-t.iHeight/2,e.view=interaction_view.adapt.parseOffset(e.view),e.view.model.isPositionAdapt=!0;break;case 8:e.view.sizeBottom=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.x=e.view.x):e.view.x=i;var a=t.iStarty+t.iHeight/2,r=interaction_view.size.y-a;e.view.y=Reveal.slideScreenHeight-r,e.view.staticX=e.view.x-t.iWidth/2,e.view.staticY=e.view.y-t.iHeight/2,e.view=interaction_view.adapt.parseOffset(e.view),e.view.model.isPositionAdapt=!0;break;case 9:e.view.sizeBottom=!0,e.view.sizeRight=!0;var i=t.iStartx+t.iWidth/2,n=interaction_view.size.x-i;e.view.x=Reveal.slideScreenWidth-n;var a=t.iStarty+t.iHeight/2,r=interaction_view.size.y-a;e.view.y=Reveal.slideScreenHeight-r,e.view.staticX=e.view.x-t.iWidth/2,e.view.staticY=e.view.y-t.iHeight/2,e.view=interaction_view.adapt.parseOffset(e.view),e.view.model.isPositionAdapt=!0;break;case 10:e.view.sizeLeft=!0,e.view.sizeRight=!0;var o=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=o-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s;var a=t.iStarty+t.iHeight/2;Reveal.slideScreenHeight>Reveal.slideHeight?e.view.y=a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:e.view.y=a,e.view=interaction_view.adapt.parseSize(e.view),e.view.x=e.view.staticX+e.view.width/2,e.view.staticY=e.view.y-e.view.originHeight/2,e.view=interaction_view.adapt.parseOffset(e.view);break;case 11:e.view.sizeTop=!0,e.view.sizeBottom=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-e.view.originWidth/2):e.view.x=i;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view=interaction_view.adapt.parseSize(e.view),e.view.y=e.view.staticY+e.view.height/2,e.view=interaction_view.adapt.parseOffset(e.view);break;case 12:e.view.sizeLeft=!0,e.view.sizeRight=!0,e.view.sizeTop=!0,e.view.sizeBottom=!0;var o=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=o-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view=interaction_view.adapt.parseSize(e.view),e.view.staticX=t.iStartx,e.view.staticY=t.iStarty,e.view.x=t.iStartx+e.view.width/2,e.view.y=t.iStarty+e.view.height/2,e.view=interaction_view.adapt.parseOffset(e.view);break;case 13:e.view.sizeLeft=!0,e.view.sizeRight=!0,e.view.sizeBottom=!0;var o=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=o-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s,e.view=interaction_view.adapt.parseSize(e.view),e.view.x=e.view.staticX+e.view.width/2;var a=t.iStarty+t.iHeight/2,r=interaction_view.size.y-a;e.view.y=Reveal.slideScreenHeight-r,e.view.staticY=e.view.y-t.iHeight/2,e.view=interaction_view.adapt.parseOffset(e.view),e.view.model.isPositionAdapt=!0;break;case 14:e.view.sizeLeft=!0,e.view.sizeRight=!0,e.view.sizeTop=!0;var o=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=o-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s,e.view=interaction_view.adapt.parseSize(e.view),e.view.x=e.view.staticX+e.view.width/2;var a=t.iStarty+t.iHeight/2;Reveal.slideScreenHeight>Reveal.slideHeight?e.view.y=a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:e.view.y=a,e.view.staticY=e.view.y-t.iHeight/2;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view=interaction_view.adapt.parseOffset(e.view);break;case 15:if(e.view.sizeLeft=!0,e.view.sizeTop=!0,e.view.sizeBottom=!0,Reveal.slideScreenWidth>Reveal.slideWidth)var d=Reveal.slideScreenWidth-Reveal.slideWidth;else var d=0;var o=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=o-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth)-d;e.view.width=s;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view=interaction_view.adapt.parseSize(e.view),e.view.x=e.view.staticX+e.view.width/2,e.view.y=e.view.staticY+e.view.height/2,e.view=interaction_view.adapt.parseOffset(e.view);break;case 16:e.view.sizeRight=!0,e.view.sizeTop=!0,e.view.sizeBottom=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i;var o=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=o-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view=interaction_view.adapt.parseSize(e.view),e.view.y=e.view.staticY+e.view.height/2,e.view=interaction_view.adapt.parseOffset(e.view);break;case 17:e.view.sizeTop=!0,e.view.staticY=e.view.y-t.iHeight/2,e.view.height=t.iHeight+Reveal.marginTop,e.view.y=e.view.y+Reveal.marginTop/2,e.view=interaction_view.adapt.parseOffset(e.view,{x:!1});break;case 18:e.view.sizeRight=!0,e.view.staticY=e.view.y-t.iHeight/2,e.view.width=t.iWidth+Reveal.marginLeft,e.view.x=e.view.x+Reveal.marginLeft/2,e.view=interaction_view.adapt.parseOffset(e.view,{x:!1,y:!1});break;case 19:e.view.sizeBottom=!0,e.view.staticY=e.view.y-t.iHeight/2,e.view.height=t.iHeight+Reveal.marginTop,e.view.model.isMasterOverlay||e.view.model.isBackgroundOverlay?e.view.y=e.view.y+Reveal.marginTop:e.view.y=e.view.y+Reveal.marginTop/2,e.view=interaction_view.adapt.parseOffset(e.view,{x:!1,y:!1});break;case 20:e.view.sizeLeft=!0,e.view.staticY=e.view.y-t.iHeight/2,e.view.width=t.iWidth+Reveal.marginLeft,e.view.x=e.view.x+Reveal.marginLeft/2,e.view=interaction_view.adapt.parseOffset(e.view,{y:!1})}else{var i=t.iStartx+t.iWidth/2,a=t.iStarty+t.iHeight/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i,Reveal.slideScreenHeight>Reveal.slideHeight?(e.view.y=a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2,e.view.staticY=e.view.y-t.iHeight/2):e.view.y=a,e.view=interaction_view.adapt.parseOffset(e.view)}},change:function(){_.each(interaction_view.adapt.elements,function(e){interaction_view.adapt.excute(e)})},excute:function(e){interaction_view.adapt.adjustElement(e);var t=!1;e.view.model.get("isStatic")?(e.view.width&&(t=!0,e.view.originWidth=e.view.width,e.view.$el.width(e.view.width),e.view.$el.children(".Element").width(e.view.width)),e.view.height&&(t=!0,e.view.originHeight=e.view.height,e.view.$el.height(e.view.height),e.view.$el.children(".Element").height(e.view.height)),e.view.$el.css({left:e.view.staticX,top:e.view.staticY})):(interaction_view.setPos(e.view.$el[0],{x:e.view.x,y:e.view.y}),e.view.width&&(t=!0,e.view.originWidth=e.view.width,e.view.$el.children(".Element").width(e.view.width),e.view.$el.children(".Element").css("left",-e.view.width/2)),e.view.height&&(t=!0,e.view.originHeight=e.view.height,e.view.$el.children(".Element").height(e.view.height),e.view.$el.children(".Element").css("top",-e.view.height/2)),e.view.copyelstyle=e.view.$el.attr("style"),e.view.copyelementstyle=e.view.$el.children(".Element").attr("style")),t&&e.view.onSizeAdaptChange&&e.view.onSizeAdaptChange()}};return e}),define("text!interaction_view/template/analytics.tpl",[],function(){return'<iframe src="<%=data.src%>" style="border:none;width:0;height:0;" class="analytics_frame"></iframe>'}),define("interaction_view/ui/analytics",["text!interaction_view/template/analytics.tpl"],function(){var e=(require("text!interaction_view/template/analytics.tpl"),{set:function(e){}});return e}),define("interaction_view/ui/application",["text!interaction_view/template/alertbox.tpl"],function(){var e=(require("text!interaction_view/template/alertbox.tpl"),{buttons:[],buttonGroups:[],initForm:function(e){_.each(e.data,function(t){if(t.binding)if(_.include(["radio","checkboxes","dropdown"],t.field_type)){var i=[];_.each(t.binding,function(n,a){n&&(interaction_view.events.formEvents.push({overlay:n,func:function(i){interaction_view.application.setValue(e.id,t.cid,a,i),"checkboxes"!=t.field_type&&interaction_view.application.execBindingButton(n)},clearValue:function(i){interaction_view.application.clearValue(e.id,t.cid,a)},i:t,cid:t.cid,key:a,id:e.id,bindSwitch:"checkboxes"!=t.field_type}),i.push(n))}),"checkboxes"!=t.field_type&&i.length>1&&interaction_view.application.buttonGroups.push({overlays:i})}else interaction_view.events.formEvents.push({overlay:t.binding,func:function(i){if(i&&"number"==t.field_type){i=Number(i);var n=interaction_view.application.validateNumber(i,t.field_options.min,t.field_options.max);n&&interaction_view.application.errorAlert(n)}interaction_view.application.setValue(e.id,t.cid,null,i)},clearValue:function(i){interaction_view.application.clearValue(e.id,t.cid,key)},i:t,cid:t.cid,id:e.id})})},getValue:function(e,t,i){var n=_.find(interaction_view.applications,function(t){return t.id==e}),a=_.find(n.data,function(e){return e.cid==t});return _.include(["radio","dropdown"],a.field_type)?i?i==a.value?1:0:a.value:_.include(["checkboxes"],a.field_type)?i&&a.value&&a.value.length?_.include(a.value,i):!1:a.value},setValue:function(e,t,i,n){var a=_.find(interaction_view.applications,function(t){return t.id==e});return"submit"==t?(interaction_view.application.submitForm(e),!1):void(a.data=_.map(a.data,function(e){return e.cid==t&&(_.include(["radio","dropdown"],e.field_type)?e.value=i:_.include(["checkboxes"],e.field_type)?(e.value||(e.value=[]),n?e.value=_.union(e.value,[i]):e.value=_.without(e.value,i)):e.value=n),e}))},clearValue:function(e,t,i){var n=_.find(interaction_view.applications,function(t){return t.id==e});return"submit"==t?!1:void(n.data=_.map(n.data,function(e){if(e.cid==t)if(_.include(["radio","dropdown"],e.field_type))e.value===i&&(e.value="");else if(_.include(["checkboxes"],e.field_type)){if(!e.value)return e;e.value=_.without(e.value,i)}return e}))},sendOverlayToButtonGroup:function(e){var t=e.createPath(),i=interaction_view.hashPath(t);_.include(_.pluck(interaction_view.application.buttons,"hash"),i)?interaction_view.application.buttons=_.map(interaction_view.application.buttons,function(t){return t.hash==i&&(t.overlay=e),t}):interaction_view.application.buttons.push({hash:i,overlay:e})},getHashs:function(e){var t=[];return _.each(e,function(e){t.push(interaction_view.hashPath(e.path)+e.id)}),t},execBindingButton:function(e){var t=interaction_view.hashPath(e.path)+e.id,i=[];_.find(interaction_view.application.buttonGroups,function(e){_.include(interaction_view.application.getHashs(e.overlays),t)&&_.each(e.overlays,function(e){interaction_view.hashPath(e.path)+e.id==t||i.push(e)})});i.length&&_.each(i,function(e){var t=interaction_view.hashPath(e.path)+e.id,i=_.find(interaction_view.application.buttons,function(e){return e.hash==t});i&&i.overlay.iview.resetButtonStatus()})},isBindingButton:function(e){var t=!1;return _.each(interaction_view.application.buttonGroups,function(i){_.include(interaction_view.application.getHashs(i.overlays),interaction_view.hashPath(e.createPath()))&&(t=!0)}),t},errorMsg:function(e,t,i,n){var a=_.find(interaction_view.applications,function(t){return t.id==e}),r=_.find(a.data,function(e){return e.cid==t});return i?r.label+(n||"中填写的数值不正确"):_.include(["radio","dropdown","checkboxes"],r.field_type)?"请选择"+r.label:r.label+(n||"不能为空")},errorAlert:function(e){interaction_view.errorAlert(e)},submitForm:function(e){var t=_.find(interaction_view.applications,function(t){return t.id==e});if(!t)return!1;var i,n={},a=!0,r="";if(_.each(t.data,function(t){if(n[t.cid]=t.value,"number"==t.field_type){var o=!1;if((n[t.cid]||_.isNumber(n[t.cid]))&&(o=!0),t.field_options.integer_only&&_.isNumber(n[t.cid])&&(n[t.cid]=Math.round(n[t.cid])),!_.isNumber(n[t.cid])||_.isNaN(n[t.cid]))(t.required||o)&&(i||(i=interaction_view.application.errorMsg(e,t.cid,o?!0:!1)),a=!1);else{var s=interaction_view.application.validateNumber(n[t.cid],t.field_options.min,t.field_options.max);s&&(i=interaction_view.application.errorMsg(e,t.cid,!0,s),a=!1)}}else if("mobile"==t.field_type){var l=$.trim(n[t.cid]);if(t.required&&!l)a=!1,i=interaction_view.application.errorMsg(e,t.cid);else if(l){var c=interaction_view.MOBILEREG;c.test(l)||(a=!1,i="请输入正确手机号码！")}r=l}else t.required&&!n[t.cid]&&(i||(i=interaction_view.application.errorMsg(e,t.cid)),a=!1)}),!a)return void(i&&interaction_view.application.errorAlert(i));if(_.each(interaction_view.environment.otherFormValue,function(e,t){n[t]=e.value,(""==e.value||void 0==e.value)&&(interaction_view.application.errorAlert(e.errMsg),a=!1)}),a){r&&(epub360_userinfo=epub360_userinfo||{},epub360_userinfo.mobile=r),"undefined"!=typeof epub360_sourceinfo&&epub360_sourceinfo.openid&&(n.source_openid=epub360_sourceinfo.openid);var o="/form/"+t.app_id+"/?format=json";_g.ajax.post({traditional:!0,url:o,data:n,callback:function(i){var n=null;if(200==i.code)interaction_view.events.onFormSubmitEvent(70,t.id),"function"==typeof epub360FromSubmited&&epub360FromSubmited();else{var a=i.msg;if(_.keys(a).length){var r=_.keys(a)[0];n=interaction_view.application.errorMsg(e,r),interaction_view.application.errorAlert(n)}}}})}},setFormData:function(e,t,i,n){var a=_.find(interaction_view.applications,function(t){return t.id==e});if(!a)return!1;3==i&&(n=null);_.each(a.data,function(e){if(e.cid==t){if(1==i||2==i){if(n=Number(n),e.value=Number(e.value),_.isNaN(n)||!_.isNumber(n))return!1;(_.isNaN(e.value)||!_.isNumber(e.value))&&(e.value=0)}1==i?e.value+=n:2==i?e.value-=n:"number"==e.field_type?e.value=Number(n):e.value=n}})},validateNumber:function(e,t,i){if(_.isNaN(e)||!_.isNumber(e))return"请输入数字";var n=!1,a="取值范围:";return void 0!=t&&(a=a+"大于"+t,t>=e&&(n=!0)),void 0!=i&&(a=a+"小于"+i,e>=i&&(n=!0)),n?a:void 0},getFormFieldValue:function(e){if(2!=e.split("_").length)return null;var t=e.split("_")[0],i=e.split("_")[1],n=_.find(interaction_view.applications,function(e){return e.app_id==t});if(!n)return null;for(var a=null,r=0;r<n.data.length;r++)if(n.data[r].cid==i){"undefined"!=typeof n.data[r].value&&(a=n.data[r].value);break}return a}});return e}),define("interaction_view/ui/weixin",[],function(){var e={chooseimage:function(e){if(interaction_view.forceUpload)this.chooseLocalImage(e),console.log(e);else{if(interaction_view.foredit)return void global.message("warning","请在微信模式预览该功能");"undefined"!=typeof wx_permissions&&wx_permissions.chooseImage?wx.chooseImage({success:function(t){t.localIds&&t.localIds.length?e&&e(t.localIds):e&&e(null)}}):interaction_view.weixin.error()}},chooseLocalImage:function(e){var t=this;$("body").append("<input type='file' id='image' name='image' accept='image/*' style='display:none;'>"),$("#image").click(),$("#image").off("change").on("change",function(){var i=document.createElement("canvas");$(this).append(i),i.id="clipboarda",$("#clipboarda").hide();var n,a=document.getElementById("clipboarda"),r=a.getContext("2d"),o=this.files[0],s=o.type;if(o){EXIF.getData(o,function(){EXIF.getAllTags(this),n=EXIF.getTag(this,"Orientation")});var l=new FileReader,c=new Image;l.readAsDataURL(o),l.onload=function(i){var o=i.target.result;c.src=o,c.onload=function(){var i=c.width,o=c.height,l=t.judgeSize(i,o);switch(n){case 6:a.setAttribute("width",l.newH+"px"),a.setAttribute("height",l.newW+"px"),r.rotate(90*Math.PI/180),r.drawImage(c,0,-l.newH,l.newW,l.newH);break;case 8:a.setAttribute("width",l.newH+"px"),a.setAttribute("height",l.newW+"px"),r.rotate(-90*Math.PI/180),r.drawImage(c,-l.newW,0,l.newW,l.newH);break;case 3:a.setAttribute("width",l.newW+"px"),a.setAttribute("height",l.newH+"px"),r.rotate(180*Math.PI/180),r.drawImage(c,-l.newW,-l.newH,l.newW,l.newH);break;default:a.setAttribute("width",l.newW+"px"),a.setAttribute("height",l.newH+"px"),r.drawImage(c,0,0,l.newW,l.newH)}var d=a.toDataURL(s);e(d),$("#clipboarda").remove()}}}})},judgeSize:function(e,t){var i,n=750/1206,a=e/t;return 750>e&&1206>t?i={newW:e,newH:t}:e>=750&&1206>t?i={newW:750,newH:750/a}:750>e&&t>=1206?i={newH:1206,newW:1206*a}:e>=750&&t>=1206&&(i=a>n?{newW:750,newH:750/a}:{newH:1206,newW:1206*a}),i},voiceauth:function(){if(interaction_view.foredit)return void global.message("warning","请在微信模式预览该功能");if("undefined"!=typeof wx_permissions&&wx_permissions.startRecord){if(interaction_view.weixinvoiceauth)return;wx.startRecord({success:function(){wx.stopRecord({})},cancel:function(){interaction_view.errorAlert("开启微信功能失败")}}),interaction_view.weixinvoiceauth=!0}},shareable:function(){return"undefined"!=typeof wx_permissions&&wx_permissions.onMenuShareTimeline?!0:!1},eventStatistic:function(e){var t="system",i=e,n="weixin",a="www.epub360.com";current_host=window.location.host,-1!=current_host.indexOf("tu960")&&(a=current_host);var r="http://"+a+"/manage/book/"+interaction_view.book_id+"/event.gif?opt_category="+t+"&opt_action="+n+"&opt_label="+i+"&t="+_g.uuid(),o=document.createElement("img");o.src=r,o.onload=function(){}},share:function(){if("undefined"!=typeof wx_permissions&&wx_permissions.onMenuShareTimeline){message_link;"current"==interaction_view.share_page_id?message_link=_g.changeURLPar(message_link,"pageid",interaction_view.currentPage):"first"!=interaction_view.share_page_id?message_link=_g.changeURLPar(message_link,"pageid",interaction_view.share_page_id):"first"==interaction_view.share_page_id&&message_link.indexOf("pageid")>0&&(message_link=_g.changeURLPar(message_link,"pageid","")),wx.onMenuShareAppMessage({title:msgTitle,desc:msgContent,link:message_link,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","appmessage","click"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("发送给朋友"),_gaq.push(["_trackSocial","Wechat","appmessage",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","appmessage"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","appmessage","cancel"])},fail:function(){_gaq.push(["_trackEvent","error","weixinjsapi","appmessage",""])}}),wx.onMenuShareTimeline({title:shareTitle,link:message_link,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","timeline","click"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("分享到朋友圈"),_gaq.push(["_trackSocial","Wechat","timeline",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","timeline"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","timeline","cancel"])},fail:function(){_gaq.push(["_trackEvent","error","weixinjsapi","timeline",""])}}),wx.onMenuShareQQ({title:msgTitle,desc:msgContent,link:message_link,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","QQ","click"])},complete:function(){_gaq.push(["_trackEvent","weixin","share","QQ","complete"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("分享到QQ"),_gaq.push(["_trackSocial","Wechat","QQ",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","QQ"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","QQ","cancel"])},fail:function(){_gaq.push(["_trackEvent","error","weixinjsapi","QQ",""])}}),wx.onMenuShareWeibo({title:msgTitle,desc:msgContent,link:message_link,imgUrl:imgUrl,trigger:function(){_paq.push(["trackEvent","weixin","share","Weibo","click"])},complete:function(){_paq.push(["trackEvent","weixin","share","Weibo","complete"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("分享到微博"),_gaq.push(["_trackSocial","Wechat","Weibo",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","Weibo"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","Weibo","cancel"])},fail:function(){_gaq.push(["_trackEvent","error","weixinjsapi","Weibo",""])}})}},error:function(e){interaction_view.errorAlert("开启微信功能失败")},processLocalId:function(e,t){window.__wxjs_is_wkwebview===!0?wx.getLocalImgData({localId:e,success:function(e){var i=e.localData;t&&t(i)}}):t&&t(e)},previewImage:function(e,t){if(interaction_view.foredit)return void global.message("warning","请在微信模式预览该功能");if(e&&t){var i="",n=[];i=/(http:)|(https:)/.test(e)?e:location.protocol+e;for(var a=0;a<t.length;a++)/(http:)|(https:)/.test(t[a])?n.push(t[a]):n.push(location.protocol+t[a]);wx.previewImage({current:i,urls:n})}}};return e}),window.desktop_upload=function(e,t){$("body").append("<input type='file' id='image' name='image' style='display:none;'></input>"),$("#image").click();var i=context_url+"uploadimage";$("#image").attr("id"),$("#image").val();$("#image").off("change").on("change",function(){if(e.executeactions.length)for(var n=0;n<e.executeactions.length;n++){var a=e.executeactions[n];"onUploadStart"==a.attributes.iDetail.customType&&a.iview.executeAction(a.iview)}_file_change_simple($(this),["jpg","png","bmp","gif","jpeg"],i,function(i){console.log(i);var n=i.results[0];if(t&&(t(n),e.executeactions.length))for(var a=0;a<e.executeactions.length;a++){var r=e.executeactions[a];"onUploadEnd"==r.attributes.iDetail.customType&&r.iview.executeAction(r.iview)}})})},define("interaction_view/modules/desktop/uploadimage_desktop",function(){}),function(e,t){"use strict";function i(){n.READY||(n.event.determineEventTypes(),n.utils.each(n.gestures,function(e){n.detection.register(e)}),n.event.onTouch(n.DOCUMENT,n.EVENT_MOVE,n.detection.detect),n.event.onTouch(n.DOCUMENT,n.EVENT_END,n.detection.detect),n.READY=!0)}var n=function(e,t){return new n.Instance(e,t||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in e,n.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&e.navigator.userAgent.match(n.MOBILE_REGEX),n.EVENT_TYPES={},n.DIRECTION_DOWN="down",n.DIRECTION_LEFT="left",n.DIRECTION_UP="up",n.DIRECTION_RIGHT="right",n.POINTER_MOUSE="mouse",n.POINTER_TOUCH="touch",n.POINTER_PEN="pen",n.EVENT_START="start",n.EVENT_MOVE="move",n.EVENT_END="end",n.DOCUMENT=e.document,n.plugins=n.plugins||{},n.gestures=n.gestures||{},n.READY=!1,n.utils={extend:function(e,i,n){for(var a in i)e[a]!==t&&n||(e[a]=i[a]);return e},each:function(e,i,n){var a,r;if("forEach"in e)e.forEach(i,n);else if(e.length!==t){for(a=0,r=e.length;r>a;a++)if(i.call(n,e[a],a,e)===!1)return}else for(a in e)if(e.hasOwnProperty(a)&&i.call(n,e[a],a,e)===!1)return},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){var t=[],i=[];return n.utils.each(e,function(e){t.push("undefined"!=typeof e.clientX?e.clientX:e.pageX),i.push("undefined"!=typeof e.clientY?e.clientY:e.pageY)}),{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,i)+Math.max.apply(Math,i))/2}},getVelocity:function(e,t,i){return{x:Math.abs(t/e)||0,y:Math.abs(i/e)||0}},getAngle:function(e,t){var i=t.pageY-e.pageY,n=t.pageX-e.pageX;return 180*Math.atan2(i,n)/Math.PI},getDirection:function(e,t){var i=Math.abs(e.pageX-t.pageX),a=Math.abs(e.pageY-t.pageY);return i>=a?e.pageX-t.pageX>0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT:e.pageY-t.pageY>0?n.DIRECTION_UP:n.DIRECTION_DOWN},getDistance:function(e,t){var i=t.pageX-e.pageX,n=t.pageY-e.pageY;return Math.sqrt(i*i+n*n)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==n.DIRECTION_UP||e==n.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(e,t){t&&e&&e.style&&(n.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(i){n.utils.each(t,function(t,n){i&&(n=i+n.substring(0,1).toUpperCase()+n.substring(1)),n in e.style&&(e.style[n]=t)})}),"none"==t.userSelect&&(e.onselectstart=function(){return!1}),"none"==t.userDrag&&(e.ondragstart=function(){return!1}))}},n.Instance=function(e,t){var a=this;return i(),this.element=e,this.enabled=!0,this.options=n.utils.extend(n.utils.extend({},n.defaults),t||{}),this.options.stop_browser_behavior&&n.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),n.event.onTouch(e,n.EVENT_START,function(e){a.enabled&&n.detection.startDetect(a,e)}),this},n.Instance.prototype={on:function(e,t){var i=e.split(" ");return n.utils.each(i,function(e){this.element.addEventListener(e,t,s?{passive:!1}:!1)},this),this},off:function(e,t){var i=e.split(" ");return n.utils.each(i,function(e){this.element.removeEventListener(e,t,!1)},this),this},trigger:function(e,t){t||(t={});var i=n.DOCUMENT.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t;var a=this.element;return n.utils.hasParent(t.target,a)&&(a=t.target),a.dispatchEvent(i),this},enable:function(e){return this.enabled=e,this},reset:function(){a=null,r=!1,o=!1,n.PointerEvent.reset()}};var a=null,r=!1,o=!1,s=!1;try{var l=Object.defineProperty({},"passive",{get:function(){s=!0}});e.addEventListener("testPassive",null,l),e.removeEventListener("testPassive",null,l)}catch(c){}n.event={bindDom:function(e,t,i){var a=t.split(" ");n.utils.each(a,function(t){e.addEventListener(t,i,s?{passive:!1}:!1)})},onTouch:function(e,t,i){var s=this;this.bindDom(e,n.EVENT_TYPES[t],function(l){var c=l.type.toLowerCase();if(!c.match(/mouse/)||!o){c.match(/touch/)||c.match(/pointerdown/)||c.match(/mouse/)&&1===l.which?r=!0:c.match(/mouse/)&&!l.which&&(r=!1),c.match(/touch|pointer/)&&(o=!0);var d=0;r&&(n.HAS_POINTEREVENTS&&t!=n.EVENT_END?d=n.PointerEvent.updatePointer(t,l):c.match(/touch/)?d=l.touches.length:o||(d=c.match(/up/)?0:1),d>0&&t==n.EVENT_END?t=n.EVENT_MOVE:d||(t=n.EVENT_END),(d||null===a)&&(a=l),i.call(n.detection,s.collectEventData(e,t,s.getTouchList(a,t),l)),n.HAS_POINTEREVENTS&&t==n.EVENT_END&&(d=n.PointerEvent.updatePointer(t,l))),d||(a=null,r=!1,o=!1,n.PointerEvent.reset())}})},determineEventTypes:function(){var e;e=n.HAS_POINTEREVENTS?n.PointerEvent.getEvents():n.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],n.EVENT_TYPES[n.EVENT_START]=e[0],n.EVENT_TYPES[n.EVENT_MOVE]=e[1],n.EVENT_TYPES[n.EVENT_END]=e[2]},getTouchList:function(e){return n.HAS_POINTEREVENTS?n.PointerEvent.getTouchList():e.touches?e.touches:(e.identifier=1,[e])},collectEventData:function(e,t,i,a){var r=n.POINTER_TOUCH;return(a.type.match(/mouse/)||n.PointerEvent.matchType(n.POINTER_MOUSE,a))&&(r=n.POINTER_MOUSE),{center:n.utils.getCenter(i),timeStamp:(new Date).getTime(),target:a.target,touches:i,eventType:t,pointerType:r,srcEvent:a,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return n.detection.stopDetect()}}}},n.PointerEvent={pointers:{},getTouchList:function(){var e=this,t=[];return n.utils.each(e.pointers,function(e){t.push(e)}),t},updatePointer:function(e,t){return e==n.EVENT_END?this.pointers={}:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var i=t.pointerType,a={};return a[n.POINTER_MOUSE]=i===t.MSPOINTER_TYPE_MOUSE||i===n.POINTER_MOUSE,a[n.POINTER_TOUCH]=i===t.MSPOINTER_TYPE_TOUCH||i===n.POINTER_TOUCH,a[n.POINTER_PEN]=i===t.MSPOINTER_TYPE_PEN||i===n.POINTER_PEN,a[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){this.current||(this.stopped=!1,this.current={inst:e,startEvent:n.utils.extend({},t),lastEvent:!1,name:""},this.detect(t))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);var t=this.current.inst.options;return n.utils.each(this.gestures,function(i){
return this.stopped||t[i.name]===!1||i.handler.call(i,e,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=e),e.eventType==n.EVENT_END&&!e.touches.length-1&&this.stopDetect(),e}},stopDetect:function(){this.previous=n.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(e){var t=this.current.startEvent;!t||e.touches.length==t.touches.length&&e.touches!==t.touches||(t.touches=[],n.utils.each(e.touches,function(e){t.touches.push(n.utils.extend({},e))}));var i,a,r=e.timeStamp-t.timeStamp,o=e.center.pageX-t.center.pageX,s=e.center.pageY-t.center.pageY,l=n.utils.getVelocity(r,o,s);return"end"===e.eventType?(i=this.current.lastEvent&&this.current.lastEvent.interimAngle,a=this.current.lastEvent&&this.current.lastEvent.interimDirection):(i=this.current.lastEvent&&n.utils.getAngle(this.current.lastEvent.center,e.center),a=this.current.lastEvent&&n.utils.getDirection(this.current.lastEvent.center,e.center)),n.utils.extend(e,{deltaTime:r,deltaX:o,deltaY:s,velocityX:l.x,velocityY:l.y,distance:n.utils.getDistance(t.center,e.center),angle:n.utils.getAngle(t.center,e.center),interimAngle:i,direction:n.utils.getDirection(t.center,e.center),interimDirection:a,scale:n.utils.getScale(t.touches,e.touches),rotation:n.utils.getRotation(t.touches,e.touches),startEvent:t}),e},register:function(e){var i=e.defaults||{};return i[e.name]===t&&(i[e.name]=!0),n.utils.extend(n.defaults,i,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}},n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:-1!==e.navigator.userAgent.toLowerCase().indexOf("android")?5:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,t){if(n.detection.current&&n.detection.current.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(t.options.drag_max_touches>0&&e.touches.length>t.options.drag_max_touches))switch(e.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:if(e.distance<t.options.drag_min_distance&&n.detection.current.name!=this.name)return;if(n.detection.current.name!=this.name&&(n.detection.current.name=this.name,t.options.correct_for_drag_min_distance&&e.distance>0)){var i=Math.abs(t.options.drag_min_distance/e.distance);n.detection.current.startEvent.center.pageX+=e.deltaX*i,n.detection.current.startEvent.center.pageY+=e.deltaY*i,e=n.detection.extendEventData(e)}(n.detection.current.lastEvent.drag_locked_to_axis||t.options.drag_lock_to_axis&&t.options.drag_lock_min_distance<=e.distance)&&(e.drag_locked_to_axis=!0);var a=n.detection.current.lastEvent.direction;e.drag_locked_to_axis&&a!==e.direction&&(n.utils.isVertical(a)?e.direction=e.deltaY<0?n.DIRECTION_UP:n.DIRECTION_DOWN:e.direction=e.deltaX<0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT),this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),t.trigger(this.name+e.direction,e),(t.options.drag_block_vertical&&n.utils.isVertical(e.direction)||t.options.drag_block_horizontal&&!n.utils.isVertical(e.direction))&&e.preventDefault();break;case n.EVENT_END:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:800,hold_threshold:1},timer:null,handler:function(e,t){switch(e.eventType){case n.EVENT_START:clearTimeout(this.timer),n.detection.current.name=this.name,this.timer=setTimeout(function(){n.detection.current&&"hold"==n.detection.current.name&&t.trigger("hold",e)},t.options.hold_timeout);break;case n.EVENT_MOVE:e.distance>t.options.hold_threshold&&clearTimeout(this.timer);break;case n.EVENT_END:clearTimeout(this.timer)}}},n.gestures.Release={name:"release",index:1/0,handler:function(e,t){e.eventType==n.EVENT_END&&t.trigger(this.name,e)}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(e,t){if(e.eventType==n.EVENT_END){if(t.options.swipe_max_touches>0&&e.touches.length<t.options.swipe_min_touches&&e.touches.length>t.options.swipe_max_touches)return;(e.velocityX>t.options.swipe_velocity||e.velocityY>t.options.swipe_velocity)&&(t.trigger(this.name,e),t.trigger(this.name+e.direction,e))}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(e,t){if(e.eventType==n.EVENT_END&&"touchcancel"!=e.srcEvent.type){var i=n.detection.previous,a=!1;if(e.deltaTime>t.options.tap_max_touchtime||e.distance>t.options.tap_max_distance)return;i&&"tap"==i.name&&e.timeStamp-i.lastEvent.timeStamp<t.options.doubletap_interval&&e.distance<t.options.doubletap_distance&&(t.trigger("doubletap",e),a=!0),(!a||t.options.tap_always)&&(n.detection.current.name="tap",t.trigger(n.detection.current.name,e))}}},n.gestures.Touch={name:"touch",index:-(1/0),defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,t){return t.options.prevent_mouseevents&&e.pointerType==n.POINTER_MOUSE?void e.stopDetect():(t.options.prevent_default&&e.preventDefault(),void(e.eventType==n.EVENT_START&&t.trigger(this.name,e)))}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(e,t){if(n.detection.current.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(e.touches.length<2))switch(t.options.transform_always_block&&e.preventDefault(),e.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:var i=Math.abs(1-e.scale),a=Math.abs(e.rotation);if(i<t.options.transform_min_scale&&a<t.options.transform_min_rotation)return;n.detection.current.name=this.name,this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),a>t.options.transform_min_rotation&&t.trigger("rotate",e),i>t.options.transform_min_scale&&(t.trigger("pinch",e),t.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case n.EVENT_END:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},"function"==typeof define&&define.amd?define("hammerjs",[],function(){return n}):"object"==typeof module&&module.exports?module.exports=n:e.Hammer=n}(window),function(e,t){"use strict";function i(e,i){e.event.bindDom=function(e,n,a){i(e).on(n,function(e){var i=e.originalEvent||e;i.pageX===t&&(i.pageX=e.pageX,i.pageY=e.pageY),i.target||(i.target=e.target),i.which===t&&(i.which=i.button),i.preventDefault||(i.preventDefault=e.preventDefault),i.stopPropagation||(i.stopPropagation=e.stopPropagation),a.call(this,i)})},e.Instance.prototype.on=function(e,t){return i(this.element).on(e,t)},e.Instance.prototype.off=function(e,t){return i(this.element).off(e,t)},e.Instance.prototype.trigger=function(e,t){var n=i(this.element);return n.has(t.target).length&&(n=i(t.target)),n.trigger({type:e,gesture:t})},i.fn.hammer=function(t){return this.each(function(){var n=i(this),a=n.data("hammer");a?"reset"==t?e.detection.current=null:a&&t&&e.utils.extend(a.options,t):n.data("hammer",new e(this,t||{}))})}}"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("jquery.hammer",["hammerjs","jquery"],i):i(e.Hammer,e.jQuery||e.Zepto)}(this),function(e){function t(e){if(e in h.style)return e;var t=["Moz","Webkit","O","ms"],i=e.charAt(0).toUpperCase()+e.substr(1);if(e in h.style)return e;for(var n=0;n<t.length;++n){var a=t[n]+i;if(a in h.style)return a}}function i(){return h.style[u.transform]="",h.style[u.transform]="rotateY(90deg)",""!==h.style[u.transform]}function n(e){return"string"==typeof e&&this.parse(e),this}function a(e,t,i){t===!0?e.queue(i):t?e.queue(t,i):i()}function r(t){var i=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=l(t),-1===e.inArray(t,i)&&i.push(t)}),i}function o(t,i,n,a){var o=r(t);e.cssEase[n]&&(n=e.cssEase[n]);var s=""+d(i)+" "+n;parseInt(a,10)>0&&(s+=" "+d(a));var l=[];return e.each(o,function(e,t){l.push(t+" "+s)}),l.join(", ")}function s(t,i){i||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=u.transform,e.cssHooks[t]={get:function(i){var n=e(i).css("transit:transform");return n.get(t)},set:function(i,n){var a=e(i).css("transit:transform");a.setFromString(t,n),e(i).css({"transit:transform":a})}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function c(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function d(t){var i=t;return e.fx.speeds[i]&&(i=e.fx.speeds[i]),c(i,"ms")}e.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var h=document.createElement("div"),u={},p=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;u.transition=t("transition"),u.transitionDelay=t("transitionDelay"),u.transform=t("transform"),u.transformOrigin=t("transformOrigin"),u.transform3d=i();var f={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},v=u.transitionEnd=f[u.transition]||null;for(var g in u)u.hasOwnProperty(g)&&"undefined"==typeof e.support[g]&&(e.support[g]=u[g]);h=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)",epubOut:"cubic-bezier(.3,1,.0,1)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new n},set:function(t,i){var a=i;a instanceof n||(a=new n(a)),"WebkitTransform"!==u.transform||p?t.style[u.transform]=a.toString():t.style[u.transform]=a.toString(!0),e(t).data("transform",a)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[u.transformOrigin]},set:function(e,t){e.style[u.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[u.transition]},set:function(e,t){e.style[u.transition]=t}}),s("scale"),s("translate"),s("translateZ"),s("rotate"),s("rotateX"),s("rotateY"),s("rotate3d"),s("perspective"),s("skewX"),s("skewY"),s("x",!0),s("y",!0),n.prototype={setFromString:function(e,t){var i="string"==typeof t?t.split(","):t.constructor===Array?t:[t];i.unshift(e),n.prototype.set.apply(this,i)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=c(e,"deg")},rotateX:function(e){this.rotateX=c(e,"deg")},rotateY:function(e){this.rotateY=c(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=c(e,"deg")},skewY:function(e){this.skewY=c(e,"deg")},perspective:function(e){this.perspective=c(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=c(e,"px")),null!==t&&void 0!==t&&(this._translateY=c(t,"px")),this.translate=this._translateX+","+this._translateY},translateZ:function(e){this.translateZ=c(e,"px")}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},translateZ:function(){return this.translateZ||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=c(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,i,n){t.setFromString(i,n)})},toString:function(e){var t=[];for(var i in this)if(this.hasOwnProperty(i)){if(!u.transform3d&&("rotateX"===i||"rotateY"===i||"translateZ"===i||"perspective"===i||"transformOrigin"===i))continue;"_"!==i[0]&&(e&&"scale"===i?t.push(i+"3d("+this[i]+",1)"):e&&"translate"===i?t.push(i+"3d("+this[i]+",0)"):t.push(i+"("+this[i]+")"))}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,i,n,r){var s=this,l=0,c=!0;"function"==typeof i&&(r=i,i=void 0),"function"==typeof n&&(r=n,n=void 0),"undefined"!=typeof t.easing&&(n=t.easing,delete t.easing),"undefined"!=typeof t.duration&&(i=t.duration,delete t.duration),"undefined"!=typeof t.complete&&(r=t.complete,delete t.complete),"undefined"!=typeof t.queue&&(c=t.queue,delete t.queue),"undefined"!=typeof t.delay&&(l=t.delay,delete t.delay),"undefined"==typeof i&&(i=e.fx.speeds._default),"undefined"==typeof n&&(n=e.cssEase._default),e.fx.off&&(i=0),i=d(i);var h=o(t,i,n,l),p=e.transit.enabled&&u.transition,f=p?parseInt(i,10)+parseInt(l,10):0;if(0===f){var g=function(e){s.css(t),r&&r.apply(s),e&&e()};return a(s,c,g),s}var m={},w=function(i){var n=!1,a=function(){n&&s.unbind(v,a),f>0&&s.each(function(){this.style[u.transition]=m[this]||null}),"function"==typeof r&&r.apply(s),"function"==typeof i&&i()};f>0&&v&&e.transit.useTransitionEnd?(n=!0,s.bind(v,a)):window.setTimeout(a,f),s.each(function(){f>0&&(this.style[u.transition]=h),e(this).css(t)})},_=function(e){this.offsetWidth,w(e)};return a(s,c,_),this},e.transit.getTransitionValue=o}("undefined"!=typeof jQuery?jQuery:Zepto),define("jquery.transit",["jquery"],function(){}),function(){var e={0:{x:{activeItem:{x:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{x:function(e,t){return e*t*100+"%"}}},y:{activeItem:{y:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{y:function(e,t){return e*t*100+"%"}}},perspective:!1,currentEasing:"snap",activeEasing:"snap"},1:{x:{activeItem:{x:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{x:0}},y:{activeItem:{y:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{y:0}},activeTop:!0,perspective:!1,currentEasing:"snap",activeEasing:"snap"},2:{x:{activeItem:{},currentItem:{opacity:function(e,t){return 1-t}}},y:{activeItem:{},currentItem:{opacity:function(e,t){return 1-t}}},currentTop:!0,perspective:!1,currentEasing:"snap",activeEasing:"snap"},3:{perspective:!0,currentEasing:"out",activeEasing:"in",currentTop:!0,percentcontrol:[.5,1],.5:{x:{activeItem:{rotateY:function(e,t){return 90*-e+"deg"},opacity:.2},currentItem:{rotateY:function(e,t){return 90*e*t*2+"deg"},opacity:function(e,t){return.2+.8*(1-2*t)}}},y:{activeItem:{rotateX:function(e,t){return 90*e+"deg"},opacity:.2},currentItem:{rotateX:function(e,t){return 90*-e*t*2+"deg"},opacity:function(e,t){return.2+.8*(1-2*t)}}}},1:{x:{activeItem:{rotateY:function(e,t){return 90*-e*(1-2*(t-.5))+"deg"},opacity:function(e,t){return.2+.8*(t-.5)*2}},currentItem:{rotateY:function(e,t){return 90*e+"deg"},opacity:.2}},y:{activeItem:{rotateX:function(e,t){return 90*e*(1-2*(t-.5))+"deg"},opacity:function(e,t){return.2+.8*(t-.5)*2}},currentItem:{rotateX:function(e,t){return 90*-e+"deg"},opacity:.2}}}},4:{x:{css:{currentItem:{transformOrigin:function(e,t){return 0>e?"100% 50%":"0% 50%"}},activeItem:{transformOrigin:function(e,t){return e>0?"100% 50%":"0% 50%"}}},activeItem:{x:function(e,t){return-e*(1-t)*100+"%"},opacity:function(e,t){return t},rotateY:function(e,t){return-e*(1-t)*90+"deg"}},currentItem:{x:function(e,t){return e*t*100+"%"},rotateY:function(e,t){return e*t*90+"deg"},opacity:function(e,t){return 1-t}}},y:{css:{currentItem:{transformOrigin:function(e,t){return 0>e?"50% 100%":"50% 0%"}},activeItem:{transformOrigin:function(e,t){return e>0?"50% 100%":"50% 0%"}}},activeItem:{y:function(e,t){return-e*(1-t)*100+"%"},opacity:function(e,t){return t},rotateX:function(e,t){return e*(1-t)*90+"deg"}},currentItem:{y:function(e,t){return e*t*100+"%"},rotateX:function(e,t){return-e*t*90+"deg"},opacity:function(e,t){return 1-t}}},currentTop:!0,perspective:!0,currentEasing:"easeOutCubic",activeEasing:"easeOutCubic"},5:{x:{css:{currentItem:{transformOrigin:function(e,t){return e>0?"100% 50%":"0% 50%"}}},activeItem:{x:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{x:0,scale:function(e,t){return.5+.5*(1-t)}}},y:{css:{currentItem:{transformOrigin:function(e,t){return e>0?"50% 100%":"50% 0%"}}},activeItem:{y:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{y:0,scale:function(e,t){return.5+.5*(1-t)}}},activeTop:!0,perspective:!1,currentEasing:"epubOut",activeEasing:"epubOut"}};"undefined"==typeof require?(window._g||(window._g={}),window._g.transitionargs=e):define("_g/transitionargs",["_g/base"],function(){return window._g.transitionargs=e,window._g.transitionargs})}(window),function(){function e(e,t){var i=1200;return"x"===e?"perspective("+i+"px) rotateY("+t+"rad)":"perspective("+i+"px) rotateX("+-t+"rad)"}var t={support:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}(),bind:function(){}},n=document.createElement("div"),a=function(e,t){return null==t&&(t=n),void 0!==t.style[e]?e:void 0},r=a("webkitTransform"),o=(a("webkitTransitionProperty"),a("webkitTransitionDuration")),s=(a("webkitTransitionTimingFunction"),a("webkitTransition")),l=function(e){this.init(e)};l.prototype={isDraged:!1,init:function(e){var t={containment:null,containmentClass:"c-transition-containment",perspectiveClass:"c-perspective",itemClass:"c-transition-item",currentClass:"c-transition-current",leftClass:"c-transition-left",rightClass:"c-transition-right",upClass:"c-transition-up",downClass:"c-transition-down",activeClass:"c-transition-active",topClass:"c-transition-top",repeat:!1,direction:0,type:1,duration:1e3,onStart:null,onEnd:function(){},onCancel:function(){},control:!0,autoplay:!1,width:null,height:null,disableControlled:!1,autoplayDirection:-1,autoplayAxis:null};if(this.opts=e?$.extend(!0,{},t,e):t,!this.opts.containment)return!1;if($(this.opts.containment).addClass(this.opts.containmentClass),_.bindAll(this),7==this.opts.type){var i="flipboardStyle";if(!document.getElementById(i)){var n=document.createElement("style");n.setAttribute("id",i),n.innerHTML='[data-flap]{-webkit-backface-visibility:hidden;backface-visibility:hidden}[data-flap].backface-visible{-webkit-backface-visibility:visible;backface-visibility:visible}[data-flap="left"],[data-flap="right"]{z-index:1}[data-flap="front"],[data-flap="back"]{z-index:2}.flap-shadow{position:absolute;top:0;width:50%;height:100%;background:#000;z-index:99999}.flap-shadowY{position:absolute;left:0;width:100%;height:50%;background:#000;z-index:99999}.flap-shadow.left,.flap-shadow.back{left:0}.flap-shadow.right,.flap-shadow.front{right:0}.flap-shadowY.up,.flap-shadowY.bottom{top:0}.flap-shadowY.down,.flap-shadowY.top{bottom:0}.flap-shadow.flap-gradient{background:linear-gradient(to right,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}.flap-shadow.back.flap-gradient{background:linear-gradient(to left,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}.flap-shadowY.flap-gradient{background:linear-gradient(to top,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%);background:-webkit-linear-gradient(to top,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}.flap-shadowY.top.flap-gradient{background:linear-gradient(to bottom,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%);background:-webkit-linear-gradient(to bottom,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}',(document.getElementsByTagName("head")[0]||document.body).appendChild(n)}var a=$(this.opts.containment);this.container=a[0],this.$container=a;var r=this.opts.width||this.$container.width(),o=this.opts.height||this.$container.height();this.width=r%2?r+1:r,this.height=o%2?o+1:o,this.hack=this.width>r||this.height>o,a.attr("data-hack",this.hack);var s=a.offset(),l=this.opts.boundary||0;interaction_view.ismobile?(this.boundaryStart=l+s.left,this.boundaryEnd=r-l-s.left,this.boundaryStartY=l+s.top,this.boundaryEndY=o-l-s.top):(this.boundaryStart=l,this.boundaryEnd=r-l,this.boundaryStartY=l,this.boundaryEndY=o-l),this.PI=Math.PI,this.dur=this.opts.duration||"1000",this.rad=this.opts.rad||.5,this.isTransiting=!1,this.shadowOpacity=this.opts.shadowOpacity||.1;var c=this;$(window).resize(function(){c.resize()}),$(this.opts.containment).on("touchend",function(e){setTimeout(function(){c.key&&!c.isTransiting&&(console.log("transition is touchended"),c.clearNode(!0))},50)})}return this.opts.control&&(this.control(),this.opts.disableControlled&&this.disableControl()),this.opts.autostart?(this.timerDisabled=!1,this.timerstart({})):this.timerDisabled=!0,this},resize:function(){var e=this.opts.width||this.$container.width(),t=this.opts.height||this.$container.height();this.width=e%2?e+1:e,this.height=t%2?t+1:t,this.hack=this.width>e||this.height>t,this.$container.attr("data-hack",this.hack);var i=this.$container.offset(),n=this.opts.boundary||20;this.boundaryStart=n+i.left,this.boundaryEnd=e-n-i.left,this.boundaryStartY=n+i.top,this.boundaryEndY=t-n-i.top},disableControlled:!1,disableControl:function(){this.disableControlled=!0},enableControl:function(){this.disableControlled=!1},control:function(){var e=this;_g.dragcontrol.bind({el:this.opts.containment,dragstart:function(t){e.disableControlled||e.start(t)},dragleft:function(t){e.disableControlled||e.dragX(t)},dragright:function(t){e.disableControlled||e.dragX(t)},dragup:function(t){e.disableControlled||e.dragY(t)},dragdown:function(t){e.disableControled||e.dragY(t)},dragend:function(t){if(!e.disableControlled){if(e.direction&&!e.timerDisabled){var i="x"==e.direction?t.gesture.deltaX:t.gesture.deltaY;e.TimerDirection=i>0?1:-1}e.dragEnd(t)}},canDragX:function(){return e.opts.autoplayAxis&&"x"!=e.opts.autoplayAxis?!1:!0},canDragY:function(){return e.opts.autoplayAxis&&"y"!=e.opts.autoplayAxis?!1:!0}})},stashitemClass:function(){$(this.opts.containment).find("."+this.opts.itemClass).css({transform:"","-moz-transform":"","-webkit-transform":"","-o-transform":"","-ms-transform":"",opacity:""}),this.stashClass={current:$(this.opts.containment).find("."+this.opts.currentClass).attr("style"),left:$(this.opts.containment).find("."+this.opts.leftClass).attr("style"),right:$(this.opts.containment).find("."+this.opts.rightClass).attr("style"),up:$(this.opts.containment).find("."+this.opts.upClass).attr("style"),down:$(this.opts.containment).find("."+this.opts.downClass).attr("style")},this.stashed=!0},recoveritemClass:function(){if(this.stashed)try{this.currentItem.attr("style",this.stashClass.current||""),this.activeItem.hasClass(this.opts.leftClass)?this.activeItem.attr("style",this.stashClass.left||""):this.activeItem.hasClass(this.opts.rightClass)?this.activeItem.attr("style",this.stashClass.right||""):this.activeItem.hasClass(this.opts.upClass)?this.activeItem.attr("style",this.stashClass.up||""):this.activeItem.hasClass(this.opts.downClass)&&this.activeItem.attr("style",this.stashClass.down||"")}catch(e){console.log(e)}$(this.opts.containment).find("."+this.opts.itemClass).css({transform:"","-moz-transform":"","-webkit-transform":"","-o-transform":"","-ms-transform":"",opacity:""}),this.stashed=!1},start:function(e,t){this.isTransiting||(this.key=1*new Date,void 0==t&&(t=this.opts.type),this.args=_g.transitionargs[t]||{},this.args.perspective?$(this.opts.containment).addClass(this.opts.perspectiveClass):$(this.opts.containment).removeClass(this.opts.perspectiveClass),this.currentItem=$(this.opts.containment).find(">."+this.opts.currentClass),this.currentItem.addClass(this.opts.topClass),this.stashitemClass())},startInit:function(e,t,i){this.dur=this.opts.duration,this.lastsubpi=0,this.startObj={x:0,y:0},this.end={x:0,y:0};var n=this.getPos(e,i);this.startObj.x=this.end.x=n.x,this.startObj.y=this.end.y=n.y,this.touchStartDirection=!1,this.realslide=!1},clearNode:function(e){var t=this;$(t.fromNodeCloneNode).remove(),$(t.toNodeCloneNode).remove(),$(t.fromNodeFlapShadow).remove(),$(t.toNodeFlapShadow).remove(),$(t.fromNodeCloneNodeFlapShadow).remove(),$(t.toNodeCloneNodeFlapShadow).remove(),e&&(t.currentItem&&t.currentItem.length&&(t.currentItem[0].style.removeProperty("visibility"),t.currentItem[0].style.removeProperty("clip"),t.currentItem[0].style.removeProperty("opacity")),t.activeItem&&t.activeItem.length&&(t.activeItem[0].style.removeProperty("visibility"),t.activeItem[0].style.removeProperty("clip"),t.activeItem[0].style.removeProperty("opacity")),t.isTransiting=!1,t.key=null)},initNode:function(e){this.fromNode=this.currentItem[0],this.toNode=this.activeItem[0],this.fromNodeCloneNode=this.fromNode.cloneNode(!0),this.toNodeCloneNode=this.toNode.cloneNode(!0),this.r=this.boundaryEnd-this.startObj.x,this.l=this.startObj.x-this.boundaryStart,this.u=this.startObj.y-this.boundaryStartY,this.d=this.boundaryEndY-this.startObj.y,$(this.toNode).css({visibility:"visible"}),$(this.fromNode).css({visibility:"visible"}),$(this.fromNodeCloneNode).css({visibility:"visible"}),$(this.toNodeCloneNode).css({visibility:"visible"})},dragX:function(e,t,i){if(!this.isTransiting&&this.key&&(e.gesture.deltaX<=0?(this.plus=-1,this.activeItem=$(this.opts.containment).find(">."+this.opts.rightClass)):(this.plus=1,this.activeItem=$(this.opts.containment).find(">."+this.opts.leftClass)),this.activeItem.length)){var n=e.gesture.deltaX;if(this.direction="x",void 0==t&&(t=this.opts.type),7!=t)this.dragHandle(n,t);else{if(this.isOverstepBoundary("x",e,i))return;this.touchStartDirection!=e.type&&(console.log("------------------------------",this.isOverstepBoundary("x",e)),this.startInit(e,t,i),this.startObj.x<this.width/2?this.flipSide="l2r":this.flipSide="r2l",this.touchStartDirection=e.type,this.clearNode(),this.initNode(e),"dragleft"==e.type?this.leftFlap():this.rightFlap());var a=this.getPos(e,i);this.end.x=a.x,this.end.y=a.y,this.dragHandle(this.end.x-this.startObj.x,t)}}},dragY:function(e,t,i){if(!this.isTransiting&&this.key&&(e.gesture.deltaY<=0?(this.plus=-1,this.activeItem=$(this.opts.containment).find("."+this.opts.downClass)):(this.plus=1,this.activeItem=$(this.opts.containment).find("."+this.opts.upClass)),this.activeItem.length)){var n=e.gesture.deltaY;if(this.direction="y",void 0==t&&(t=this.opts.type),7!=t)this.dragHandle(n,t);else{if(this.isOverstepBoundary("y",e,i))return;this.touchStartDirection!=e.type&&(this.startInit(e,t,i),this.direction="y",this.touchStartDirection=e.type,this.startObj.y<this.height/2?this.flipSide="u2d":this.flipSide="d2u",this.clearNode(),this.initNode(e),this.r=this.d,this.l=this.u,"dragup"==e.type?this.upFlap():this.downFlap());var a=this.getPos(e,i);this.end.x=a.x,this.end.y=a.y,this.dragHandle(this.end.y-this.startObj.y,t)}}},getIsPassMiddlePosition:function(){var e,t,i=this.end.x,n=this.end.y,a=this.startObj.x,r=this.startObj.y,o=this.l,s=this.r,l=this.rad,c=0;return"l2r"==this.flipSide?"dragleft"==this.touchStartDirection?a-o*l>i?(e=this.endRotate,c=1,t=(o-(a-i))/o):(e=0,c=0,t=(a-i)/o):"dragright"==this.touchStartDirection&&(i>a+s*l?(e=this.endRotate,c=1,t=(s-(i-a))/s):(e=0,c=0,t=(i-a)/s)):"r2l"==this.flipSide?"dragleft"==this.touchStartDirection?a-o*l>i?(e=this.endRotate,c=1,t=(o-(a-i))/o):(e=0,c=0,t=(a-i)/o):"dragright"==this.touchStartDirection&&(i>a+s*l?(e=this.endRotate,c=1,t=(s-(i-a))/s):(e=0,c=0,t=(i-a)/s)):"u2d"==this.flipSide?"dragup"==this.touchStartDirection?r-o*l>n?(e=this.endRotate,c=1,t=(o-(r-n))/o):(e=0,c=0,t=(r-n)/o):"dragdown"==this.touchStartDirection&&(n>r+s*l?(e=this.endRotate,c=1,t=(s-(n-r))/s):(e=0,c=0,t=(n-r)/s)):"d2u"==this.flipSide&&("dragup"==this.touchStartDirection?r-o*l>n?(e=this.endRotate,c=1,t=(o-(r-n))/o):(e=0,c=0,t=(r-n)/o):"dragdown"==this.touchStartDirection&&(n>r+s*l?(e=this.endRotate,c=1,t=(s-(n-r))/s):(e=0,c=0,t=(n-r)/s))),{subpi:e,isPassMiddlePosition:c,dur:t}},dragHandle:function(t,n){if(isDraged=!0,this.opts.onStopPlay&&this.opts.onStopPlay(),$(this.opts.containment).find("."+this.opts.itemClass).removeClass(this.opts.activeClass),this.activeItem.addClass(this.opts.activeClass),this.currentItem=$(this.opts.containment).find("."+this.opts.currentClass),void 0==n&&(n=this.opts.type),7!=n){var a=Math.abs(t)/$(this.opts.containment).width();if(_g.browserSupport({msie:9}))if(this.args.percentcontrol){for(i=0;i<this.args.percentcontrol.length;i++)if(a<=this.args.percentcontrol[i]){if(this.args[this.args.percentcontrol[i]][this.direction].css){var o=this.args[this.args.percentcontrol[i]][this.direction].css;o.currentItem&&this.currentItem.css(this.getArgs(o.currentItem,this.plus,a)),o.activeItem&&this.activeItem.css(this.getArgs(o.activeItem,this.plus,a))}this.activeItem.css(this.getArgs(this.args[this.args.percentcontrol[i]][this.direction].activeItem,this.plus,a)),this.currentItem.css(this.getArgs(this.args[this.args.percentcontrol[i]][this.direction].currentItem,this.plus,a));break}}else{if(this.args[this.direction].css){var o=this.args[this.direction].css;o.currentItem&&this.currentItem.css(this.getArgs(o.currentItem,this.plus,a)),o.activeItem&&this.activeItem.css(this.getArgs(o.activeItem,this.plus,a))}this.activeItem.css(this.getArgs(this.args[this.direction].activeItem,this.plus,a)),this.currentItem.css(this.getArgs(this.args[this.direction].currentItem,this.plus,a))}else this.currentItem.css("x"==this.direction?"margin-left":"margin-top",this.plus*a*100+"%"),this.activeItem.css("x"==this.direction?"margin-left":"margin-top",-this.plus*(1-a)*100+"%");this.args.currentTop?this.currentItem.addClass(this.opts.topClass):this.currentItem.removeClass(this.opts.topClass),this.args.activeTop&&this.activeItem.addClass(this.opts.topClass),this.opts.onTransition&&this.opts.onTransition(event,a)}else{var t=Math.round(Math.abs(t)),s=t,l=this.startObj.x,c=this.end.x,d=this.startObj.y,h=this.end.y;if("x"==this.direction){c<this.boundaryStart&&(c=this.boundaryStart,s=l-this.boundaryStart),c>this.boundaryEnd&&(c=this.boundaryEnd,s=this.boundaryEnd-l);1*(this.width/2)}else{h<this.boundaryStartY&&(h=this.boundaryStartY,s=d-this.boundaryStartY),h>this.boundaryEndY&&(h=this.boundaryEndY,s=this.boundaryEndY-d);1*(this.height/2)}var u="";if("l2r"==this.flipSide?"dragleft"==this.touchStartDirection?(c>=l&&(c=l,s=0),u=-this.PI*(s/this.l)):"dragright"==this.touchStartDirection&&(l>=c&&(c=l,s=0),u=this.PI*(s/this.r)):"r2l"==this.flipSide?"dragleft"==this.touchStartDirection?(c>=l&&(c=l,s=0),u=-this.PI*(s/this.l)):"dragright"==this.touchStartDirection&&(l>=c&&(c=l,s=0),u=this.PI*(s/this.r)):"u2d"==this.flipSide?"dragup"==this.touchStartDirection?(h>=d&&(h=d,s=0),u=-this.PI*(s/this.l)):"dragdown"==this.touchStartDirection&&(d>=h&&(h=d,s=0),u=this.PI*(s/this.r)):"d2u"==this.flipSide&&("dragup"==this.touchStartDirection?(h>=d&&(h=d,s=0),u=-this.PI*(s/this.l)):"dragdown"==this.touchStartDirection&&(d>=h&&(h=d,s=0),u=this.PI*(s/this.r))),this.lastsubpi==u)return;this.lastsubpi=u,console.log("[this.lastsubpi:",this.lastsubpi,"]"),this.fromNodeCloneNode.style[r]=e(this.direction,u),this.toNodeCloneNode.style[r]=e(this.direction,this.PI+u),this.toNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?0:.7-2*Math.abs(u)/this.PI*.7,
this.fromNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?.7-2*(this.PI-Math.abs(u))/this.PI*.7:0,this.fromNodeCloneNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?this.shadowOpacity:2*Math.abs(u)/this.PI*this.shadowOpacity,this.toNodeCloneNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?2*(this.PI-Math.abs(u))/this.PI*this.shadowOpacity:this.shadowOpacity,this.args.currentTop?this.currentItem.addClass(this.opts.topClass):this.currentItem.removeClass(this.opts.topClass),this.args.activeTop&&this.activeItem.addClass(this.opts.topClass),this.opts.onTransition&&this.opts.onTransition(event,a)}},dragEnd:function(t,n,a){function l(){3==g&&(v.lastsubpi=_,v.realslide=!1,$(v.toNodeCloneNode).remove(),$(v.toNodeFlapShadow).remove(),$(v.fromNodeCloneNode).remove(),$(v.fromNodeFlapShadow).remove(),v.touchStartDirection=!1,v.isTransiting=!1,v.key=null,v.currentItem[0].style.removeProperty("visibility"),v.currentItem[0].style.removeProperty("clip"),v.currentItem[0].style.removeProperty("opacity"),v.activeItem[0].style.removeProperty("visibility"),v.activeItem[0].style.removeProperty("clip"),v.activeItem[0].style.removeProperty("opacity"),w?v.opts.onEnd&&v.opts.onEnd(w):v.opts.onCancel&&v.opts.onCancel(w))}if(!this.isTransiting)if(void 0==n&&(n=this.opts.type),7!=n){if(!this.currentItem.length||!this.activeItem.length)return;this.currentItem.addClass("c-transition-noevents");var c=this;this.isTransiting=!0;var d="x"==this.direction?t.gesture.deltaX:t.gesture.deltaY,h=Math.abs(d)/$(this.opts.containment).width();if(_g.browserSupport({msie:9}))if(this.args.percentcontrol){for(c.currentItem.removeClass("c-transition-noevents"),this.percent=h,i=0;i<this.args.percentcontrol.length;i++)if(h<=this.args.percentcontrol[i]){this.transitPercent(i);break}}else{var u=1100,p=this.getArgs(this.args[this.direction].currentItem,this.plus,1);p.duration=u,p.easing=this.args.currentEasing;var f=this.getArgs(this.args[this.direction].activeItem,this.plus,1);f.duration=u,f.easing=this.args.activeEasing,f.complete=function(){c.currentItem.removeClass("c-transition-noevents"),c.isTransiting=!1,_g.device.android()?setTimeout(function(){c.onTransitionEnd()},100):c.onTransitionEnd()},this.currentItem.transit(p),this.activeItem.transit(f)}else this.activeItem.css("x"==this.direction?"margin-left":"margin-top","0%"),this.currentItem.css("x"==this.direction?"margin-left":"margin-top",100*-this.plus+"%")}else{var v=this,g=1;v.isTransiting=!0;var m=v.getIsPassMiddlePosition(),w=m.isPassMiddlePosition;if(v.dur=v.dur*m.dur,!(this.currentItem.length&&this.activeItem.length&&v.fromNodeCloneNode&&this.key&&this.touchStartDirection))return w=0,void l();var _=m.subpi;if(a){v.dur=500;var _="x"==v.direction?t.gesture.deltaX<0?-3.141592653589793:3.141592653589793:t.gesture.deltaY<0?-3.141592653589793:3.141592653589793}else if(v.l<=0||v.r<=0||v.lastsubpi==_)return $(v.fromNodeCloneNode).remove(),v.fromNode.style.clip="rect(0px "+v.width+"px "+v.height+"px 0px)",w&&$(v.fromNode).css({visibility:"hidden"}),w||$(v.toNode).css({visibility:"hidden"}),$(v.toNodeCloneNode).remove(),v.toNode.style.clip="rect(0px "+v.width+"px "+v.height+"px 0px)",$(v.fromNodeFlapShadow).remove(),$(v.toNodeFlapShadow).remove(),g=3,void l();$(v.fromNodeCloneNode).on("webkitTransitionEnd",function(){$(v.fromNodeCloneNode).off("webkitTransitionEnd"),$(v.fromNodeCloneNode).remove(),v.fromNode.style.clip="rect(0px "+(v.width+1)+"px "+v.height+"px 0px)",w&&$(v.fromNode).css({visibility:"hidden"}),$(v.fromNodeFlapShadow).remove(),g++,l(),setTimeout(function(){3>g&&(g++,l())},v.dur/2)}),$(v.toNodeCloneNode).on("webkitTransitionEnd",function(){$(v.toNodeCloneNode).off("webkitTransitionEnd"),w||$(v.toNode).css({visibility:"hidden"}),$(v.toNodeCloneNode).remove(),$(v.toNodeFlapShadow).remove(),v.toNode.style.clip="rect(0px "+v.width+"px "+v.height+"px 0px)",g++,l()}),w||a?(v.toNodeFlapShadow.style[s]="opacity "+v.dur/2+"ms ease-in",v.fromNodeFlapShadow.style[s]="opacity "+v.dur/2+"ms ease-in",v.fromNodeFlapShadow.style.opacity=.7,v.toNodeFlapShadow.style.opacity=0,v.fromNodeCloneNodeFlapShadow.style.opacity=0,v.toNodeCloneNodeFlapShadow.style.opacity=0,v.fromNodeCloneNode.style[r]=e(v.direction,_),v.fromNodeCloneNode.style[o]=v.dur+"ms",v.toNodeCloneNode.style[r]=e(v.direction,v.PI+_),v.toNodeCloneNode.style[o]=1.5*v.dur+"ms"):(v.toNodeFlapShadow.style[s]="opacity "+v.dur/2+"ms ease-in",v.fromNodeFlapShadow.style[s]="opacity "+v.dur/2+"ms ease-in",v.toNodeFlapShadow.style.opacity=.7,v.fromNodeFlapShadow.style.opacity=0,v.fromNodeCloneNodeFlapShadow.style.opacity=0,v.toNodeCloneNodeFlapShadow.style.opacity=0,v.fromNodeCloneNode.style[r]=e(v.direction,_),v.fromNodeCloneNode.style[o]=1.5*v.dur+"ms",v.toNodeCloneNode.style[r]=e(v.direction,v.PI+_),v.toNodeCloneNode.style[o]=v.dur+"ms"),console.log("[isPassMiddlePosition:",w,"]"),console.log("[touchStartDirection:",this.touchStartDirection,"]"),console.log("[that.fromNodeCloneNode:",v.fromNodeCloneNode,"]"),console.log("[that.toNodeCloneNode:",v.toNodeCloneNode,"]"),console.log("[that.direction:",v.direction,"]"),console.log("[subpi:",_,"]"),console.log("[lastsubpi:",v.lastsubpi,"]"),console.log("[that.dur:",v.dur,"]")}},onTransitionEnd:function(){var e=this;this.recoveritemClass(),this.currentItem.removeClass(this.opts.currentClass),this.activeItem.addClass(this.opts.currentClass).removeClass(this.opts.activeClass).removeClass(this.opts.upClass).removeClass(this.opts.rightClass).removeClass(this.opts.leftClass).removeClass(this.opts.downClass),$(this.opts.containment).find("."+this.opts.itemClass).removeClass(this.opts.topClass);var t=this.currentItem.index(),i=this.activeItem.index();$(this.opts.containment).removeClass(this.opts.perspectiveClass),e.opts.onEnd&&e.opts.onEnd(t,i),this.timerStart()},transitPercent:function(e){var t=this;if(e<this.args.percentcontrol.length){var t=this,i=this.opts.duration*(this.args.percentcontrol[e]-this.percent),n=this.getArgs(this.args[this.args.percentcontrol[e]][this.direction].currentItem,this.plus,this.args.percentcontrol[e]);n.duration=i,n.easing=this.args.currentEasing;var a=this.getArgs(this.args[this.args.percentcontrol[e]][this.direction].activeItem,this.plus,this.args.percentcontrol[e]);a.duration=i,a.easing=this.args.activeEasing,a.complete=function(){t.transitPercent(e+1)},this.percent=this.args.percentcontrol[e],this.currentItem.transit(n),this.activeItem.transit(a)}else t.isTransiting=!1,this.onTransitionEnd()},getArgs:function(e,t,i){var n={};for(var a in e)"function"==typeof e[a]?n[a]=e[a](t,i):n[a]=e[a];return n},autostart:function(e,t,i){if(!this.isTransiting&&(this.args=_g.transitionargs[e]||{},this.currentItem=$(this.opts.containment).find("."+this.opts.currentClass),this.stashitemClass(),this.key=1*new Date,"x"==t&&(0>i?this.activeItem=$(this.opts.containment).find("."+this.opts.rightClass):this.activeItem=$(this.opts.containment).find("."+this.opts.leftClass)),"y"==t&&(0>i?this.activeItem=$(this.opts.containment).find("."+this.opts.downClass):this.activeItem=$(this.opts.containment).find("."+this.opts.upClass)),this.activeItem.length))if(7!=e){this.args.currentTop&&this.currentItem.addClass(this.opts.topClass),this.plus=i,this.direction=t,this.args.perspective?$(this.opts.containment).addClass(this.opts.perspectiveClass):$(this.opts.containment).removeClass(this.opts.perspectiveClass);var n={gesture:{}};"x"==t?n.gesture.deltaX=0:n.gesture.deltaY=0,this.dragHandle(0,e),this.dragEnd(n,e)}else{if("x"==t){if(0>i)var n={gesture:{deltaX:-.01},type:"dragleft"};else var n={gesture:{deltaX:.01},type:"dragright"};this.dragX(n,e,!0)}if("y"==t){if(0>i)var n={gesture:{deltaY:-.01},type:"dragup"};else var n={gesture:{deltaY:.01},type:"dragbottom"};this.dragY(n,e,!0)}this.dragEnd(n,e,!0)}},enableTimer:function(){this.timerDisabled=!1},disableTimer:function(){this.timerDisabled=!0},setCurrent:function(e,t){var i,n=this;$(this.opts.containment).children("."+this.opts.itemClass).removeClass(this.opts.topClass).removeClass(this.opts.activeClass).removeClass(this.opts.upClass).removeClass(this.opts.rightClass).removeClass(this.opts.leftClass).removeClass(this.opts.downClass);var a=$(this.opts.containment).children().length;if(e>=a){if(!this.opts.repeat)return void this.timerStop();this.current=0,e=0}else if(0>e){if(!this.opts.repeat)return void this.timerStop();this.current=a-1,e=a-1}if($(this.opts.containment).children().each(function(){$(this).index()==e?(i=$(this),$(this).addClass(n.opts.currentClass)):$(this).removeClass(n.opts.currentClass)}),t&&i){if("x"==t)var r=this.opts.leftClass,o=this.opts.rightClass;else var r=this.opts.upClass,o=this.opts.downClass;i.prev().length?i.prev().addClass(r):this.opts.repeat&&$(this.opts.containment).children().last().addClass(r),i.next().length?i.next().addClass(o):this.opts.repeat&&$(this.opts.containment).children().first().addClass(o)}},timerStart:function(e){if(!this.timerDisabled){var t=this;if(e)e.type||(e.type=t.opts.type),e.axis||(e.axis="x"),e.diretion||(e.direction=-1),e.startAt||(e.startAt=0),this.setCurrent(e.startAt,e.axis),this.current=e.startAt,this.TimerArgs=e;else{if(!this.TimerArgs)return;e=this.TimerArgs,this.TimerDirection=this.TimerDirection||t.opts.autoplayDirection,this.current=null!=this.tempCurrent?this.tempCurrent:-1==this.TimerDirection?this.current+1:this.current-1,this.tempCurrent=null,this.TimerDirection=null,this.setCurrent(this.current,e.axis)}this.Timer&&window.clearTimeout(this.Timer),this.Timer=window.setTimeout(function(){t.autostart(e.type,e.axis,e.direction)},this.opts.interval)}},timerStop:function(e){this.Timer&&(window.clearTimeout(this.Timer),this.Timer=null),this.TimerArgs=null,this.disableTimer()},isOverstepBoundary:function(e,t,i){if(i)return!1;var n=this.getPos(t,i),a=n.x,r=n.y;if(console.log(a,"[",this.boundaryStart,this.boundaryEnd,"]"),console.log("this.key[",this.key,"]"),console.log("direction[",e,"]"),"x"==e){if(a<=this.boundaryStart||a>=this.boundaryEnd)return!0}else if("y"==e&&(r<=this.boundaryStartY||r>=this.boundaryEndY))return!0;return!1},getPos:function(e,t){var i=e.gesture.touches?e.gesture.touches[0]:{};return interaction_view.ismobile?t?{x:interaction_view.size.x,y:interaction_view.size.y}:{x:i.pageX,y:i.pageY}:t?{x:this.$container.offset().left+interaction_view.size.x,y:this.$container.offset().top+interaction_view.size.y}:{x:i.pageX-this.$container.offset().left,y:i.pageY-this.$container.offset().top}},addCloneAttr:function(){$(this.fromNodeFlapShadow).attr("data-clone","fromNodeFlapShadow"),$(this.toNodeFlapShadow).attr("data-clone","toNodeFlapShadow"),$(this.fromNodeCloneNodeFlapShadow).attr("data-clone","fromNodeCloneNodeFlapShadow"),$(this.toNodeCloneNodeFlapShadow).attr("data-clone","toNodeCloneNodeFlapShadow"),$(this.fromNodeCloneNode).attr("data-clone","fromNodeCloneNode"),$(this.toNodeCloneNode).attr("data-clone","toNodeCloneNode")},leftFlap:function(){this.endRotate=-this.PI,this.middlePosition=this.startObj.x-this.l/2,this.fromNodeFlapShadow=$('<div class="flap-shadow flat left" style="opacity: 0;"></div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadow flat right" style="opacity: 0.7;"></div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient front" style="opacity: 0;width:'+this.width/2+"px;height:"+this.height+'px;"></div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient back" style="opacity: '+this.shadowOpacity+";width:"+this.width/2+"px;height:"+this.height+'px;"></div>')[0],this.container.appendChild(this.fromNodeCloneNode),this.container.appendChild(this.toNodeCloneNode),this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.addCloneAttr(),this.hack?(this.fromNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)",this.toNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+(this.width/2-1)+"px)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+(this.width/2-1)+"px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY("+this.PI+"rad)"):(this.fromNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)",this.toNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY("+this.PI+"rad)")},rightFlap:function(){this.endRotate=this.PI,this.middlePosition=this.startObj.x+this.r/2,this.hack?(this.toNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)",this.fromNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+(this.width/2-1)+"px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)"):(this.toNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)",this.fromNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)"),this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(0rad)",this.container.appendChild(this.toNodeCloneNode),this.container.appendChild(this.fromNodeCloneNode),this.fromNodeFlapShadow=$('<div class="flap-shadow flat right" style="opacity: 0;">A</div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadow flat left" style="opacity: 0.7;">B</div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient back" style="opacity: 0;width:'+this.width/2+"px;height:"+this.height+'px;">C</div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient front" style="opacity: '+this.shadowOpacity+";width:"+this.width/2+"px;height:"+this.height+'px;">D</div>')[0],this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.addCloneAttr()},upFlap:function(){this.endRotate=-this.PI,this.middlePosition=this.startObj.y-this.l/2,this.fromNodeFlapShadow=$('<div class="flap-shadowY flat up" style="opacity: 0;"></div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadowY flat down" style="opacity: 0.7;"></div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient top" style="opacity: 0;width:'+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient bottom" style="opacity: '+this.shadowOpacity+";width:"+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.fromNodeCloneNode=this.fromNode.cloneNode(!0),this.toNodeCloneNode=this.toNode.cloneNode(!0),this.container.appendChild(this.fromNodeCloneNode),this.container.appendChild(this.toNodeCloneNode),this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.hack?(this.fromNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)",this.toNode.style.clip="rect("+(this.height/2-1)+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.clip="rect("+(this.height/2-1)+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX("+this.PI+"rad)"):(this.fromNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)",this.toNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX("+this.PI+"rad)"),this.addCloneAttr()},downFlap:function(){this.endRotate=this.PI,this.middlePosition=this.startObj.y+this.r/2,this.hack?(this.toNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)",this.fromNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.clip="rect("+(this.height/2-1)+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)"):(this.toNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)",this.fromNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)"),this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(0rad)",this.container.appendChild(this.toNodeCloneNode),this.container.appendChild(this.fromNodeCloneNode),this.fromNodeFlapShadow=$('<div class="flap-shadowY flat down" style="opacity: 0;"></div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadowY flat up" style="opacity: 0.7;"></div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient bottom" style="opacity: 0;width:'+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient top" style="opacity: '+this.shadowOpacity+";width:"+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.addCloneAttr()}};var c=function(e){this.init(e)};c.prototype={init:function(e){var t={body:"window",containment:".touchslide",slidesclass:".slides",groupclass:".group",itemclass:".Presentation",width:1024,height:768,overview:!0,controls:!0,progress:!0,slideNumber:!1,history:!1,disableHistoryStart:!1,keyboard:!0,overview:!0,center:!0,touch:!0,loop:!1,rtl:!1,fragments:!0,mouseWheel:!1,hideAddressBar:!0,previewLinks:!1,transition:0,transitionSpeed:"default",onReady:null,onSlideChange:null,canDragX:null,canDragY:null,canDragEnd:null,adapt:!1,screen_mode:1,show_excontent:!1,continuous:!1};if(this.options=e?$.extend(!0,{},t,e):t,_g.browserSupport({msie:9})||(this.options.canDragX=this.options.canDragY=function(e){return!1}),_.bindAll(this),this._initVaribles(),this._initControls(),this._initScreenSet(),this._initSlideItems(),this.transition=new _g.transition({type:this.options.transition,containment:this.slideContent,control:!1,onEnd:this._complete,onStopPlay:this._onStopPlay,onCancel:this._cancel,duration:700,shadowOpacity:.3,rad:.1}),this._initSlideStyle(),this.options.onReady){var i=3==this.slideType?this.indexes[0][0]:this.indexes[0];this.options.onReady(this,i)}return this.options.controls&&(this._bindControllers(),this.setControllers()),this.options.progress&&this.setProgressBar(),this.options.keyboard&&this._bindKeyboard(),this.options.mouseWheel&&this._bindMouseWheel(),this.options.history&&this._bindRoute(),e_api.event.triggerReady("ready"),this},_bindRoute:function(){var e=this,t=Backbone.Router.extend({routes:{"page/:query":"page"}});this.Router=new t,this.Router.on("route:page",function(t,i){var n=e.getSlidePositionById(t);n&&e.slide(n.h,n.v)});var i=!1;e.options.disableHistoryStart&&(i=!0);var n=_g.getUrlParameterByName("pageid");if("undefined"!=typeof message_link&&(message_link=_g.changeURLPar(message_link,"pageid",""),interaction_view.weixin.share()),n&&(i=!1),e.options.disableHistoryStart)n&&(Backbone.history.start({silent:!1}),this.Router.navigate("page/"+n,{trigger:!0}),Backbone.history.stop());else{try{void 0!=e_api.variables.start_page&&(n=_.isNumber(e_api.variables.start_page)?interaction_view.ipagelist.getPages()[e_api.variables.start_page].id||n:e_api.variables.start_page||n)}catch(a){}Backbone.history.start({silent:i}),this.Router.navigate("page/"+(n||this.getCurrentSlideId()),{trigger:n&&!0})}},_initVaribles:function(){this.indexv=0,this.indexh=0,this.currentSlideDirection=null,this.dragstart=!1,this.dragging=!1,this.sliding=!1},_initControls:function(){function e(e,a){a=window.emulateLandscape.emulateDirection(a);var r=l[a];if(i=void 0,window.emulateLandscape.modHammer(e),console.log("------drag"+r.direction),n.sliding)return e.gesture.preventDefault(),!1;if(!interaction_view.stopDragging){if(null==n.currentSlideDirection&&(n.currentSlideDirection=r.directionCode),n.dragLock||interaction_view.events.onPageSwipeEvent(r.eventCode,interaction_view.currentPage))return n.dragLock=!0,e.gesture.preventDefault(),n.dragstart=!1,!1;if(n.dragLock||n.options.continuous&&n.continuous(r.direction))return n.dragLock=!0,e.gesture.preventDefault(),!1;if(!n.options[r.canDrag]||n.options[r.canDrag](e)){if(!n._testSlideDragEventAccess(e))return e.gesture.preventDefault(),!1;n.dragstart=!0,$.zoom&&1!=$.zoom&&(e.gesture[r.delta]=e.gesture[r.delta]/$.zoom),i=e.gesture[r.delta],t()||n.options.smooth||n._doDragingEvent(e),e.gesture.preventDefault()}}}function t(){return 1==interaction_view.getCurrentPageModel().get("prevent_slide")}var i,n=this,a=0,r=0,o=$(this.options.containment),s=o.hammer();this.hammertime=s,s.on("dragstart",function(e){return interaction_view.stopDragging?void 0:n.sliding?(e.gesture.preventDefault(),!1):void((!n.options.canDrag||n.options.canDrag(e))&&(n.dragstart=!0,n._doStartEvent(e)))}),s.on("drag",function(e){return n.sliding?(e.gesture.preventDefault(),!1):void 0});var l={left:{direction:"left",directionCode:1,eventCode:38,canDrag:"canDragX",delta:"deltaX"},right:{direction:"right",directionCode:1,eventCode:39,canDrag:"canDragX",delta:"deltaX"},up:{direction:"up",directionCode:2,eventCode:36,canDrag:"canDragY",delta:"deltaY"},down:{direction:"down",directionCode:2,eventCode:37,canDrag:"canDragY",delta:"deltaY"}};s.on("dragleft",function(t){e(t,"left"),void 0!=i&&(window.emulateLandscape.swapped?r=i:a=i)}).on("dragright",function(t){e(t,"right"),void 0!=i&&(window.emulateLandscape.swapped?r=i:a=i)}),o.hammer({drag_lock_to_axis:!0}).on("dragup",function(t){e(t,"up"),void 0!=i&&(window.emulateLandscape.swapped?a=i:r=i)}).on("dragdown",function(t){e(t,"down"),void 0!=i&&(window.emulateLandscape.swapped?a=i:r=i)}),s.on("dragend",function(e){if(window.emulateLandscape.modHammer(e),!interaction_view.stopDragging&&(console.log("slide is dragended"),n.dragstart||(n.currentSlideDirection=null),n.dragLock=!1,(!n.options.canDrag||n.options.canDrag(e))&&(n.options.canDragEnd&&n.options.canDragEnd(e),n._testSlideDragEventAccess(e)))){if(!t()&&(1==n.currentSlideDirection&&a||2==n.currentSlideDirection&&r))if(n.options.smooth){var i=n.getSlideDirections(),o=1==n.currentSlideDirection?"x":"y";n.originh=n.indexh,n.originv=n.indexv;var s=!0;if(1==n.currentSlideDirection){var l=a/Math.abs(a);0>l&&!i.right?s=!1:l>0&&!i.left?s=!1:(n._onStopPlay(),n.indexh=0>l?n.indexh+1:n.indexh-1,n.indexv=0)}else{var l=r/Math.abs(r);0>l&&!i.down?s=!1:l>0&&!i.up?s=!1:(n._onStopPlay(),n.indexv=0>l?n.indexv+1:n.indexv-1)}s&&n.transition.autostart(n.options.transition,o,l)}else $.zoom&&1!=$.zoom&&(2==n.currentSlideDirection&&r&&(e.gesture.deltaY=e.gesture.deltaY/$.zoom),1==n.currentSlideDirection&&a&&(e.gesture.deltaX=e.gesture.deltaX/$.zoom)),n._doDragEndEvent(e);return n.dragstart=!1,n.currentSlideDirection=null,a=0,r=0,e.gesture&&e.gesture.preventDefault(),!1}}),o.on("touchend",function(e){console.log("slide is touchended")})},_initSlideItems:function(){var e=0,t=0,i=this,n=[];if(this.slideItems=[],this.slideIds={},this.slideIdsArray=[],0==this.slideContent.children(".slideTempContainer").length&&this.slideContent.append('<div class="slideTempContainer" style="position:absolute;left:-99999px;top:-99999px;"></div>'),this.slideContent.hasClass("c-transition-containment")||this.slideContent.addClass("c-transition-containment"),this.slideTempContainer=this.slideContent.children(".slideTempContainer"),this.slideContent.children(this.options.groupclass).length>0){this.slideType=3,this.slideContent.children(this.options.groupclass).each(function(){n[t]=[],i.slideItems[t]=[],$(this).children(i.options.itemclass).each(function(){var a=$(this).attr("id");n[t][e]=a||1,i.slideItems[t][e]=this,a&&(i.slideIds[a]={h:t,v:e},i.slideIdsArray.push(a)),e+=1}),t+=1,e=0});var a=this.slideContent.children(this.options.groupclass).detach();this.slideTempContainer.append(a)}else{this.slideType=1,this.slideContent.children(this.options.itemclass).each(function(){var e=$(this).attr("id");n[t]=$(this).attr("id")||1,i.slideItems[t]=this,e&&(i.slideIds[e]={h:t,v:null},i.slideIdsArray.push(e)),t+=1});var a=this.slideContent.children(this.options.itemclass).detach();this.slideTempContainer.append(a)}this.indexes=n,this.options.continuous&&(1==this.slideType?this.options.continuous=1:this.indexes[this.indexes.length-1]&&this.indexes[this.indexes.length-2]&&1==this.indexes[this.indexes.length-1].length&&1==this.indexes[this.indexes.length-2].length?this.options.continuous=1:this.options.continuous=2),this.options.show_overview&&this._drawOverview()},_initSlideStyle:function(){var e=this;this.slideContent.find(this.options.itemclass).each(function(){$(this).css({width:"100%",height:"100%"}),$(this).children(".interaction-area").css({width:"100%",height:"100%"}),$(this).addClass("c-transition-item")}),this.setSlideItems(),e.setAdaptSlideItems()},_initScreenSet:function(){this.slideScreenWidth=this.options.width,this.slideScreenHeight=this.options.height,this.slideWidth=this.options.width,this.slideHeight=this.options.height,this.slideContainment=$(this.options.containment),this.slideContent=$(this.options.containment).find(this.options.slidesclass).first(),0==this.slideContainment.children(".slides-wrap").length&&this.slideContent.wrap('<div class="slides-wrap" style="position:absolute;width:100%;height:100%;left:0;top:0;z-index:1000;"></div>'),this.slideWrap=this.slideContainment.children(".slides-wrap"),this.slideContainment.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideContent.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideGroup=this.slideContent.children(),this.options.adapt&&(this.adapt=!0),this.setAdaptScreen()},sendSlide2Content:function(e){var t=$(e).detach();this.slideContent.append(t)},sendSlide2Temp:function(e){var t=$(e).detach();this.slideTempContainer.append(t)},setSingleSlideItem:function(e,t,i){this.slideContent.find(this.options.itemclass).removeClass("c-transition-"+i),this.slideItem=this.getSlideItem(e,t),$(this.slideItem).addClass("c-transition-"+i),$(this.slideItem).parent().is(this.slideContent)||this.sendSlide2Content(this.slideItem)},setSlideItems:function(){var e=this;this.currentItem=this.getCurrentSlide(),this.leftItem=null,this.rightItem=null,this.upItem=null,this.downItem=null;var t=[];t.push(this.getCurrentSlideId()),$(this.currentItem).parent().is(this.slideContent)||this.sendSlide2Content(this.currentItem);var i=this.getSlideDirections();i.left&&(t.push(this.getLeft()),this.leftItem=this.getSlideItemById(this.getLeft()),$(this.leftItem).parent().is(this.slideContent)||this.sendSlide2Content(this.leftItem),$(this.currentItem).attr("data-left","1")),i.right&&(t.push(this.getRight()),this.rightItem=this.getSlideItemById(this.getRight()),$(this.rightItem).parent().is(this.slideContent)||this.sendSlide2Content(this.rightItem),$(this.currentItem).attr("data-right","1")),3==this.slideType&&(i.up&&(t.push(this.getUp()),this.upItem=this.getSlideItemById(this.getUp()),$(this.upItem).parent().is(this.slideContent)||this.sendSlide2Content(this.upItem),$(this.currentItem).attr("data-up","1")),i.down&&(t.push(this.getDown()),this.downItem=this.getSlideItemById(this.getDown()),$(this.downItem).parent().is(this.slideContent)||this.sendSlide2Content(this.downItem),$(this.currentItem).attr("data-down","1"))),this.slideContent.children(this.options.itemclass).each(function(){var i=$(this).attr("id");_.include(t,i)||e.sendSlide2Temp(this)}),this.slideContent.find(".c-transition-item").each(function(){this.id!=e.currentItem.id&&$(this).removeClass("c-transition-current"),$(this).removeClass("c-transition-left").removeClass("c-transition-right").removeClass("c-transition-up").removeClass("c-transition-down")}),$(this.currentItem).addClass("c-transition-current"),this.rightItem&&$(this.rightItem).addClass("c-transition-right"),this.leftItem&&$(this.leftItem).addClass("c-transition-left"),this.upItem&&$(this.upItem).addClass("c-transition-up"),this.downItem&&$(this.downItem).addClass("c-transition-down")},setAdaptScreen:function(){var e=(this.options.screen_mode,this.options.adapt,this.options.show_excontent,this._getScreenSize()),t=this._getScreenScale();if(this.options.adapt){var e=this._getScreenSize(),t=this._getScreenScale();0==this.options.screen_mode?(this.slideScreenWidth=e.x,this.slideScreenHeight=e.y):1==this.options.screen_mode?(t.x&&(e.x=parseInt(e.x/t.x,10)),t.y&&(e.y=parseInt(e.y/t.y,10)),t.x&&(this.slideScreenWidth=e.x>this.options.width?e.x:this.options.width,this.slideScreenHeight=this.options.height),t.y&&(this.slideScreenHeight=e.y>this.options.height?e.y:this.options.height,this.slideScreenWidth=this.options.width)):(t.y&&(e.x=parseInt(e.x/t.y,10)),t.x&&(e.y=parseInt(e.y/t.x,10)),t.y&&(this.slideScreenWidth=e.x<this.options.width?e.x:this.options.width,this.slideScreenHeight=this.options.height),t.x&&(this.slideScreenHeight=e.y<this.options.height?e.y:this.options.height,this.slideScreenWidth=this.options.width)),this.slideContainment.css({width:this.slideScreenWidth+2,height:this.slideScreenHeight}),this.slideContent.css({width:this.slideScreenWidth+2,height:this.slideScreenHeight}),this.slideContent.find(".Presentation").css({overflow:"hidden"}),this.options.show_excontent&&this.slideContent.find(".interaction-view").css({overflow:"visible"}),this.slideWrap.css({overflow:"hidden"}),this.slideContainment.css({overflow:"visible"})}else if(2==this.options.screen_mode){var e=this._getScreenSize(),t=this._getScreenScale();t.y&&(e.x=parseInt(e.x/t.y,10)),t.x&&(e.y=parseInt(e.y/t.x,10)),t.y&&(this.slideScreenWidth=e.x<this.options.width?e.x:this.options.width,this.slideScreenHeight=this.options.height),t.x&&(this.slideScreenHeight=e.y<this.options.height?e.y:this.options.height,this.slideScreenWidth=this.options.width),this.slideContainment.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideContent.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideContent.find(".Presentation").css({overflow:"hidden"}),this.slideWrap.css({overflow:"hidden"}),this.slideContainment.css({overflow:"visible"
})}},setAdaptSlideItems:function(){var e=(this._getScreenScale(),(this.slideScreenWidth-this.slideWidth)/2),t=(this.slideScreenHeight-this.slideHeight)/2;this.marginLeft=e,this.marginTop=t,this.slideContent.find(".interaction-area").css({"margin-left":e}),this.slideContent.find(".interaction-area").css({"margin-top":t})},_getScreenSize:function(){var e,t;if(interaction_view.isWeixin&&_g.device.ios())return{x:$(window).width(),y:$(window).height()};if("window"==this.options.body){var i=window,n=document,a=n.documentElement,r=n.getElementsByTagName("body")[0];e=i.innerWidth||a.clientWidth||r.clientWidth,t=i.innerHeight||a.clientHeight||r.clientHeight}else e=parseInt($(this.options.body).css("width"),10),t=parseInt($(this.options.body).css("height"),10);return{x:e,y:t}},_getScreenScale:function(){var e=this._getScreenSize(),t=e.x,i=e.y,n=this.options.width,a=this.options.height,r=null;r=n>=a?t/i>=n/a?i/a:t/n:i/t>a/n?t/n:i/a,$.zoom&&(r=$.zoom);var o;return o=t/i>=n/a?{x:r,y:null}:{x:null,y:r}},_bindControllers:function(){var e=this;$(".action-control").children("button").on("click",function(){$(this).hasClass("enabled")&&($(this).hasClass("navigate-right")&&e.next(),$(this).hasClass("navigate-left")&&e.prev(),$(this).hasClass("navigate-up")&&e.up(),$(this).hasClass("navigate-down")&&e.down())})},_bindKeyboard:function(){var e=this;$(document).on("keydown",function(t){var i=!1,n=e.getSlideDirections();if(37==t.keyCode&&n.left&&(e.options.onKeyboard&&e.options.onKeyboard(),e.prev(),i=!0),38==t.keyCode&&n.up&&(e.options.onKeyboard&&e.options.onKeyboard(),e.up(),i=!0),39==t.keyCode&&n.right&&(e.options.onKeyboard&&e.options.onKeyboard(),e.next(),i=!0),40==t.keyCode&&n.down&&(e.options.onKeyboard&&e.options.onKeyboard(),e.down(),i=!0),27==t.keyCode){if(interaction_view.doc.get("scorm"))return;e.options.overview&&e.options.show_controlbar&&(e.show_overview?e.toggleOverview(!1):e.toggleOverview(!0))}i&&t.preventDefault()})},_bindMouseWheel:function(){var e=this,t=0,i=0;e.wheelLock=!1,e.wheelEventLock=!1,$(this.options.containment).addClass("iMouseWheel enableMouseWheel"),$(this.options.containment).on("wheelstart",function(t,i){console.log("wstart"),$(t.target).is(this)&&(e.sliding||e.wheelLock||(e.wheelstart=!0))}),$(this.options.containment).on("wheelleft",function(i,n){if($(i.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),r=a.x,o=Math.max(-1,Math.min(1,r||0));null==e.currentSlideDirection&&(e.currentSlideDirection=1);var s=parseInt(e.slideScreenWidth/25,10);if(t+=o/Math.abs(o)*s,i.gesture={deltaX:-1},-100>t&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(38,interaction_view.currentPage)))return e.wheelEventLock=!0,void(t=0);if(-100>t&&(e.wheelEventLock||e.options.continuous&&e.continuous("left")))return e.wheelEventLock=!0,t=0,!1;if(e._testSlideDragEventAccess(i)&&(e.wheelstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),-100>t&&!e.wheelLock)){var l=e.getSlideDirections();if(!l.right)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexh=e.indexh+1,e.indexv=0,e.transition.autostart(e.options.transition,"x",i.gesture.deltaX)}}}),$(this.options.containment).on("wheelright",function(i,n){if($(i.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),r=a.x,o=Math.max(-1,Math.min(1,r||0));null==e.currentSlideDirection&&(e.currentSlideDirection=1);var s=parseInt(e.slideScreenWidth/25,10);if(t+=o/Math.abs(o)*s,i.gesture={deltaX:1},t>100&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(39,interaction_view.currentPage)))return e.wheelEventLock=!0,void(t=0);if(t>100&&(e.wheelEventLock||e.options.continuous&&e.continuous("right")))return e.wheelEventLock=!0,t=0,!1;if(e._testSlideDragEventAccess(i)&&(e.wheelstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),t>100&&!e.wheelLock)){var l=e.getSlideDirections();if(!l.left)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexh=e.indexh-1,e.indexv=0,e.transition.autostart(e.options.transition,"x",i.gesture.deltaX)}}}),$(this.options.containment).on("wheelup",function(t,n){if(console.log(t.currentTarget),$(t.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),r=a.y,o=Math.max(-1,Math.min(1,r));null==e.currentSlideDirection&&(e.currentSlideDirection=2);var s=parseInt(e.slideScreenHeight/25,10);if(i+=o/Math.abs(o)*s,t.gesture={deltaY:-1},-50>i&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(36,interaction_view.currentPage)))return e.wheelEventLock=!0,void(i=0);if(-50>i&&(e.wheelEventLock||e.options.continuous&&e.continuous("up")))return e.wheelEventLock=!0,i=0,!1;if(e._testSlideDragEventAccess(t)&&(e.dragstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),-50>i&&!e.wheelLock)){var l=e.getSlideDirections();if(!l.down)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexv+=1,e.transition.autostart(e.options.transition,"y",t.gesture.deltaY)}}}),$(this.options.containment).on("wheeldown",function(t,n){if($(t.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),r=(a.y,Math.max(-1,Math.min(1,n.wheelDeltaY)));null==e.currentSlideDirection&&(e.currentSlideDirection=2);var o=parseInt(e.slideScreenHeight/25,10);if(i+=r/Math.abs(r)*o,t.gesture={deltaY:1},i>50&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(38,interaction_view.currentPage)))return e.wheelEventLock=!0,void(i=0);if(i>50&&(e.wheelEventLock||e.options.continuous&&e.continuous("down")))return e.wheelEventLock=!0,i=0,!1;if(e._testSlideDragEventAccess(t)&&(e.wheelstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),i>50&&!e.wheelLock)){var s=e.getSlideDirections();if(!s.up)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexv-=1,e.transition.autostart(e.options.transition,"y",t.gesture.deltaY)}}}),$(this.options.containment).on("wheelend",function(n,a){console.log("wend"),$(n.target).is(this)&&(e.wheelstart||(e.currentSlideDirection=null),e.wheelEventLock=!1,e.wheelstart=!1,e.wheelLock=!1,e.currentSlideDirection=null,t=0,i=0)})},_bindOverviewEvents:function(){var e=this;this.touchoverviewelement.hammer().on("tap",function(t){if(console.log(t.target),$(t.target).is(".touchslide_overview_item")){var i=$(t.target).attr("data-indexh"),n=$(t.target).attr("data-indexv");i&&n&&e.slide(Number(i),Number(n))}return e.toggleOverview(!1),!1})},_drawOverview:function(){var e=this,t=this._getScreenSize(),n=this.slideScreenWidth/this.slideScreenHeight,a=parseInt(t.x/4<250?t.x/4:250,10),r=parseInt(a/n,10);if(this.overview_width=a,this.overview_height=r,$("body").append('<div class="touchslide_overview disableMouseWheel iMouseWheel" style="width:100%;height:100%;position:absolute;left:0;z-index:10000;overflow:auto;top:0;display:none;"></div>'),this.touchoverviewelement=$("body").children(".touchslide_overview"),this.touchoverviewelement.append('<div class="touchslide_overview_container"></div>'),this.touchoverviewcontainerel=this.touchoverviewelement.children(".touchslide_overview_container"),this.touchoverviewcontainerel.append('<div class="touchslide_overview_wrap disableMouseWheel iMouseWheel"></div>'),this.touchoverviewel=this.touchoverviewcontainerel.children(".touchslide_overview_wrap"),this.touchoverviewel.css("top",0),this.touchoverviewcontainerel.css({width:a+"px",height:r+"px","margin-left":"-"+a/2+"px","margin-top":"-"+r/2+"px"}),3==this.slideType){for(i=0;i<this.indexes.length;i++){var o=i*a+10*i;for(e.touchoverviewel.append('<div class="touchslide_overview_group" data-index="'+i+'" style="position:absolute;left:'+o+'px;top:0;"></div>'),j=0;j<this.indexes[i].length;j++){var s=j*r+10*j,l=this.options.getOverview?this.options.getOverview(this.indexes[i][j]):null;$(e.touchoverviewel.children()[i]).append('<div class="touchslide_overview_item" data-indexh="'+i+'" data-indexv="'+j+'" style="position:absolute;top:'+s+"px;left:0;width:"+a+"px;height:"+r+'px;"></div>'),$(e.touchoverviewel.children()[i]).children('[data-indexv="'+j+'"]').css({"background-color":"#FFF",outline:"1px solid #ccc"}),l&&$(e.touchoverviewel.children()[i]).children('[data-indexv="'+j+'"]').css({"background-image":"url("+l+")","background-size":"contain","background-position":"center center","background-repeat":"no-repeat"})}}$($(e.touchoverviewel.children()[0]).children()[0]).css("outline","2px solid red")}else{for(i=0;i<this.indexes.length;i++){var o=i*a+10*i,l=this.options.getOverview?this.options.getOverview(this.indexes[i]):null;e.touchoverviewel.append('<div class="touchslide_overview_item" data-indexh="'+i+'" data-indexv="0" style="position:absolute;left:'+o+"px;bottom:0;width:"+a+"px;height:"+r+'px;top:0;"></div>'),$(e.touchoverviewel.children()[i]).css({"background-color":"#FFF",outline:"1px solid #ccc"}),l&&$(e.touchoverviewel.children()[i]).css({"background-image":"url("+l+")","background-size":"contain","background-position":"center center","background-repeat":"no-repeat"})}$(e.touchoverviewel.children()[0]).css("outline","2px solid red")}this._bindOverviewEvents()},continuous:function(e){if(!this.isLast()||"up"!=e&&"left"!=e||this.getCurrentSlideId()!=interaction_view.currentPage){if(this.Ended&&this.isFirst()&&("down"==e||"right"==e)&&this.getCurrentSlideId()==interaction_view.currentPage){var t=0;if("down"==e&&2==this.options.continuous)switch(this.options.transition){case 0:t=0;break;case 1:t=4;break;case 2:t=8;break;case 3:t=10;break;case 4:t=14;break;case 5:t=18}else{if("right"!=e||1!=this.options.continuous)return!1;switch(this.options.transition){case 0:t=3;break;case 1:t=7;break;case 2:t=8;break;case 3:t=13;break;case 4:t=17;break;case 5:t=21}}var i=this.getLast();return presentation.gotopage(i,t),!0}return!1}var t=0;if("up"==e&&2==this.options.continuous)switch(this.options.transition){case 0:t=2;break;case 1:t=6;break;case 2:t=8;break;case 3:t=12;break;case 4:t=16;break;case 5:t=20}else{if("left"!=e||1!=this.options.continuous)return!1;switch(this.options.transition){case 0:t=1;break;case 1:t=5;break;case 2:t=8;break;case 3:t=11;break;case 4:t=15;break;case 5:t=19}}var n=this.getFirst();return presentation.gotopage(n,t),this.Ended=!0,!0},isLast:function(){return 3==this.slideType?this.indexh==this.slideItems.length-1&&this.indexv==this.slideItems[this.indexh].length-1:this.indexh==this.slideItems.length-1},isFirst:function(){return 3==this.slideType?0==this.indexh&&0==this.indexv:0==this.indexh},toggleOverview:function(e){if(this.options.show_overview)if(e){$(".reveal").css("opacity",.1);var t=this.indexh*this.overview_width+10*this.indexh;this.touchoverviewelement.show(),this.touchoverviewelement.scrollLeft(t),this.touchoverviewelement.scrollTop(0),this.show_overview=!0}else $(".reveal").css("opacity",""),this.touchoverviewelement.hide(),this.show_overview=!1},getSlideDirections:function(){var e={left:!1,right:!1,up:!1,down:!1};return 1==this.slideType?(this.indexh>0&&(e.left=!0),this.indexh<this.indexes.length-1&&(e.right=!0)):(this.indexh>0&&(this.options.checkSlidePermission?this.options.checkSlidePermission(this,this.slideType,"left",this.indexh,this.indexv)&&(e.left=!0):e.left=!0),this.indexh<this.indexes.length-1&&(this.options.checkSlidePermission?this.options.checkSlidePermission(this,this.slideType,"right",this.indexh,this.indexv)&&(e.right=!0):e.right=!0),this.indexv>0&&(e.up=!0),this.indexv<this.indexes[this.indexh].length-1&&(e.down=!0)),e},_testSlideDragEventAccess:function(e){var t=!0;return this.dragstart||this.wheelstart?(1==this.currentSlideDirection&&("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type)&&(t=!1),2==this.currentSlideDirection&&("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type)&&(t=!1),1==this.slideType&&("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type)&&(t=!1),2==this.slideType&&("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type)&&(t=!1),("dragend"==e.type||"wheelend"==e.type)&&(this.currentSlideDirection||(t=!1))):t=!1,t},_doStartEvent:function(e){this.transition.start(e)},_doDragingEvent:function(e){var t=this._getDragDistance(e),i=this.getSlideDirections();this.transition.opts.type;if("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type){var n=e.gesture.deltaX;if(-1!=e.type.indexOf("right")&&!i.left)return void(this.dragstart=!1);if(-1!=e.type.indexOf("left")&&!i.right)return void(this.dragstart=!1);interaction_view.transitionPagePreLoad=null,n<t.min&&(e.gesture.deltaX=t.min),n>t.max&&(e.gesture.deltaX=t.max),this.transition.dragX(e)}if("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type){if(-1!=e.type.indexOf("down")&&!i.up)return void(this.dragstart=!1);if(-1!=e.type.indexOf("up")&&!i.down)return void(this.dragstart=!1);interaction_view.transitionPagePreLoad=null;var a=e.gesture.deltaY;a<t.min&&(e.gesture.deltaY=t.min),a>t.max&&(e.gesture.deltaY=t.max),this.transition.dragY(e)}},_doDragEndEvent:function(e,t){var i=(this.transition.opts.type,this._getDragDistance({type:1==this.currentSlideDirection?"dragleft":"dragup"})),n=[0,0],a=!1,r=this.getSlideDirections();if(e&&e.gesture){if(1==this.currentSlideDirection){var o=e.gesture.deltaX;if(o<i.min&&(e.gesture.deltaX=i.min),o>i.max&&(e.gesture.deltaX=i.max),0!=o&&(this.originh=this.indexh,this.originv=this.indexv,0>o&&r.right&&(a=!0,this.indexh+=1),o>0&&r.left&&(a=!0,this.indexh-=1),this.indexv=0),a){var s=this.getCurrentSlideId();this.options.onSlideChangeStart&&this.options.onSlideChangeStart(s),(o>0&&r.left||0>o&&r.right)&&(this.sliding=!0,this.transition.dragEnd(e))}}if(2==this.currentSlideDirection){var l=e.gesture.deltaY;if(l<i.min&&(e.gesture.deltaY=i.min),l>i.max&&(e.gesture.deltaY=i.max),0!=l&&(this.originh=this.indexh,this.originv=this.indexv,0>l&&r.down&&(a=!0,n=[0,i.min],this.indexv+=1),l>0&&r.up&&(a=!0,n=[0,i.max],this.indexv-=1)),a){var s=this.getCurrentSlideId();this.options.onSlideChangeStart&&this.options.onSlideChangeStart(s),(l>0&&r.up||0>l&&r.down)&&(this.sliding=!0,this.transition.dragEnd(e))}}a||this.transition.recoveritemClass()}},_complete:function(e){var t=this;this.slideContent.find(".c-transition-item").removeClass("c-transition-left").removeClass("c-transition-right").removeClass("c-transition-up").removeClass("c-transition-down").removeClass("c-transition-active"),console.log(t.indexh,t.originh);var i=3==t.slideType?t.indexes[t.indexh][t.indexv]:t.indexes[t.indexh],n=3==t.slideType?t.indexes[t.originh][t.originv]:t.indexes[t.originh];t.preStoped=!1,t.sliding=!1,t.onSlideChange(i,n)},_cancel:function(){var e=this;this.indexh=this.originh,this.indexv=this.originv,7==e.transition.opts.type&&this.slideContent.find(".c-transition-item").removeClass("c-transition-active"),this.slideContent.find(".c-transition-item").removeClass("c-transition-left").removeClass("c-transition-right").removeClass("c-transition-up").removeClass("c-transition-down"),this.setSlideItems(),e.sliding=!1;var t=3==e.slideType?e.indexes[e.indexh][e.indexv]:e.indexes[e.indexh];this.options.onContinuePlay&&this.options.onContinuePlay(t)},_getDragDistance:function(e){var t={min:0,max:0},i=this.getSlideDirections();return("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type)&&(i.right&&(t.min=-this.slideScreenWidth),i.left&&(t.max=this.slideScreenWidth)),("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type)&&(i.down&&(t.min=-this.slideScreenHeight),i.up&&(t.max=this.slideScreenHeight)),t},_getCurrentPosition:function(){var e=-this.indexh*this.slideScreenWidth,t=-this.indexv*this.slideScreenHeight;return{x:e,y:t}},isOverview:function(){return!1},getSlideItem:function(e,t){return 3==this.slideType?this.slideItems[e][t]:this.slideItems[e]},getSlideItemById:function(e){var t=this.getSlidePositionById(e);return t?3==this.slideType?this.slideItems[t.h][t.v]:this.slideItems[t.h]:null},getCurrentSlide:function(){return 3==this.slideType?this.slideItems[this.indexh][this.indexv]:this.slideItems[this.indexh]},getCurrentSlideId:function(){return 3==this.slideType?this.indexes[this.indexh][this.indexv]:this.indexes[this.indexh]},getIndices:function(){return{h:this.indexh,v:this.indexv}},getAllSlideIds:function(){return this.slideIdsArray},getFirst:function(){var e=this.getAllSlideIds();return e?e[0]:null},getLast:function(){var e=this.getAllSlideIds();return e?e[e.length-1]:null},getRight:function(){return this.getSlideDirections().right?3==this.slideType?this.indexes[this.indexh+1][0]:this.indexes[this.indexh+1]:null},getLeft:function(){return this.getSlideDirections().left?3==this.slideType?this.indexes[this.indexh-1][0]:this.indexes[this.indexh-1]:null},getUp:function(){return this.getSlideDirections().up&&3==this.slideType?this.indexes[this.indexh][this.indexv-1]:null},getDown:function(){return this.getSlideDirections().down&&3==this.slideType?this.indexes[this.indexh][this.indexv+1]:null},getPrev:function(){return this.getSlideDirections().up?this.getUp():"object"==typeof this.indexes[this.indexh-1]&&this.indexes[this.indexh-1][0]?_.last(this.indexes[this.indexh-1]):this.indexes[this.indexh-1]},getNext:function(){var e;return e=this.getSlideDirections().down?this.getDown():this.getRight(),!e&&Reveal.indexes.length>this.indexh+1&&(e=this.indexes[this.indexh+1][0]),e},getSlidePositionById:function(e){var t=this.slideIds[e];return t},getVerticalLength:function(){return 3==this.slideType?this.indexes[this.indexh].length:1},getHorizontalLength:function(){return this.indexes.length},slide:function(e,t){if(void 0!=e&&(e!=this.indexh||t!=this.indexv)){var i=this.getCurrentSlideId();this.indexh=e,this.indexv=t?t:0;var n=(e*this.slideScreenWidth,t?t*this.slideScreenHeight:0,this.getCurrentSlideId());this.onSlideChange(n,i)}},setControllers:function(){var e=this.getSlideDirections();$(".action-control").children("button").removeClass("enabled"),e.right&&$(".action-control").children(".navigate-right").addClass("enabled"),e.left&&$(".action-control").children(".navigate-left").addClass("enabled"),e.up&&$(".action-control").children(".navigate-up").addClass("enabled"),e.down&&$(".action-control").children(".navigate-down").addClass("enabled")},setProgressBar:function(){var e=parseInt((this.indexh+1)/this.indexes.length*100,10);$(".controlbar").children(".progress").children("span").css({width:e+"%"})},onSlideChange:function(e,t){var i=this;this.setSlideItems(),this.previousSlide=t,this.currentSlide=e,this.options.history&&this.Router.navigate("page/"+e),i.options.onSlideChange&&i.options.onSlideChange(i.currentSlide,i.previousSlide),i.options.controls&&i.setControllers(),i.options.progress&&i.setProgressBar()},_onStopPlay:function(){if(!this.preStoped){var e=this,t=3==e.slideType?e.indexes[e.indexh][e.indexv]:e.indexes[e.indexh];this.options.onStopPlay&&this.options.onStopPlay(t),this.preStoped=!0}},prev:function(){0==this.indexh||this.indexes.length<2||this.slide(this.indexh-1)},next:function(){this.indexh==this.indexes.length-1||this.indexes.length<2||this.slide(this.indexh+1)},up:function(){3==this.slideType&&this.indexes[this.indexh][this.indexv-1]&&this.slide(this.indexh,this.indexv-1)},down:function(){3==this.slideType&&this.indexes[this.indexh][this.indexv+1]&&this.slide(this.indexh,this.indexv+1)},changeOverview:function(e,t){if(this.options.show_overview){var i=t?t*this.overview_height+10*t:0;$(this.touchoverviewel).find(".touchslide_overview_item").css("outline","1px solid #ccc"),3==this.slideType?($($(this.touchoverviewel.children()[this.indexh]).children()[this.indexv]).css("outline","2px solid red"),this.touchoverviewel.children().css("top",0),this.touchoverviewel.children().eq(e).css({top:-i})):$(this.touchoverviewel.children()[this.indexh]).css("outline","2px solid red")}}},"undefined"==typeof require?(window._g||(window._g={}),window._g.touch=t,window._g.transition=l,window._g.touchslide=c):define("interaction_view/ui/pageslide",["_g/base","jquery.hammer","underscore","jquery.transit","backbone","_g/transitionargs"],function(){window._g.touch=t,window._g.transition=l,window._g.touchslide=c})}(window),function(){var e,t,i,n,a,r,o,s,l,c={};t=window.document.documentElement,l=window.navigator.userAgent.toLowerCase(),c.ios=function(){return c.iphone()||c.ipod()||c.ipad()},c.iphone=function(){return i("iphone")},c.ipod=function(){return i("ipod")},c.ipad=function(){return i("ipad")},c.android=function(){return i("android")},c.androidPhone=function(){return c.android()&&i("mobile")},c.androidTablet=function(){return c.android()&&!i("mobile")},c.blackberry=function(){return i("blackberry")||i("bb10")||i("rim")},c.blackberryPhone=function(){return c.blackberry()&&!i("tablet")},c.blackberryTablet=function(){return c.blackberry()&&i("tablet")},c.windows=function(){return i("windows")},c.mac=function(){return-1!=l.indexOf("mac")&&-1==l.indexOf("iphone")?!0:!1},c.linux=function(){return i("linux")},c.windowsPhone=function(){return c.windows()&&i("phone")},c.windowsTablet=function(){return c.windows()&&i("touch")},c.fxos=function(){return(i("(mobile;")||i("(tablet;"))&&i("; rv:")},c.fxosPhone=function(){return c.fxos()&&i("mobile")},c.fxosTablet=function(){return c.fxos()&&i("tablet")},c.meego=function(){return i("meego")},c.mobile=function(){return c.androidPhone()||c.iphone()||c.ipod()||c.windowsPhone()||c.blackberryPhone()||c.fxosPhone()||c.meego()},c.tablet=function(){return c.ipad()||c.androidTablet()||c.blackberryTablet()||c.windowsTablet()||c.fxosTablet()},c.msie=function(){return $.browser.msie||!!navigator.userAgent.match(/Trident\/7\./)},c.portrait=function(){return 90!==Math.abs(window.orientation)},c.landscape=function(){return 90===Math.abs(window.orientation)},c.noConflict=function(){return this},c.svg=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")},c.online=function(e,t,i){var n=new Image;n.onload=function(){console.log("online"),t&&t.constructor==Function&&t()},n.onerror=function(){console.log("offline"),i&&i.constructor==Function&&i()},n.src=e+"?t="+_g.uuid()},c.WKWebview=function(){return window.__wxjs_is_wkwebview===!0},c.screenSize=function(){var e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0],a=e.innerWidth||i.clientWidth||n.clientWidth,r=e.innerHeight||i.clientHeight||n.clientHeight;return{x:a,y:r}},c.isWeixin=function(){var e=navigator.userAgent.toLowerCase(),t=/windowswechat/.test(e),i=/micromessenger/.test(e);return i&&!t?!0:!1},c.isQQ=function(){var e=navigator.userAgent.toLowerCase(),t=/qq/.test(e);return t},i=function(e){return-1!==l.indexOf(e)},a=function(e){var i;return i=new RegExp(e,"i"),t.className.match(i)},e=function(e){return a(e)?void 0:t.className+=" "+e},o=function(e){return a(e)?t.className=t.className.replace(e,""):void 0};var d=function(){c.ios()?c.ipad()?e("ios ipad tablet"):c.iphone()?e("ios iphone mobile"):c.ipod()&&e("ios ipod mobile"):e(c.android()?c.androidTablet()?"android tablet":"android mobile":c.blackberry()?c.blackberryTablet()?"blackberry tablet":"blackberry mobile":c.windows()?c.windowsTablet()?"windows tablet":c.windowsPhone()?"windows mobile":"desktop":c.fxos()?c.fxosTablet()?"fxos tablet":"fxos mobile":c.meego()?"meego mobile":"desktop")};n=function(){return c.landscape()?(o("portrait"),e("landscape")):(o("landscape"),e("portrait"))},s="onorientationchange"in window,r=s?"orientationchange":"resize",window.addEventListener?window.addEventListener(r,n,!1):window.attachEvent?window.attachEvent(r,n):window[r]=n,n(),c.initDom=d,window._g_device=c,"undefined"==typeof require?(window._g||(window._g={}),window._g.device=_g_device):define("_g/device",["_g/base"],function(){return window._g.device=_g_device,window._g.device})}(window),function(){function e(){return 1==interaction_view.getCurrentPageModel().get("prevent_slide")}var t={support:function(){},init:function(){_g.mousewheel.wheelstart=!1,_g.mousewheel.wheeltimer=null,_g.mousewheel.checkflag=!1,_g.mousewheel.preventDefault=!0,_g.mousewheel.direction=null,_g.mousewheel.direction_lock=!0,_g.mousewheel.currentTarget=null,_g.mousewheel.mouseWheelSpeed=20;var e=function(e){if(!_g.mousewheel.disabled){_g.mousewheel.e=e;var t=_g.mousewheel.getMouseWheel(e),i=t.x,n=t.y;if(void 0!=i||void 0!=n)return _g.mousewheel.direction_lock?null==_g.mousewheel.direction&&(0!=n&&(_g.mousewheel.direction=1),0!=i&&(_g.mousewheel.direction=0)):(0!=n&&(_g.mousewheel.direction=1),0!=i&&(_g.mousewheel.direction=0)),_g.mousewheel.wheelstart?(_g.mousewheel.checkflag=!1,_g.mousewheel.onWheel(e),_g.mousewheel.direction?0>n?_g.mousewheel.onWheelUp(e):_g.mousewheel.onWheelDown(e):0>i?_g.mousewheel.onWheelLeft(e):_g.mousewheel.onWheelRight(e)):(_g.mousewheel.wheelstart=!0,_g.mousewheel.onStart(e),_g.mousewheel.checkflag=!0,_g.mousewheel.wheeltimer=window.setInterval(function(){_g.mousewheel.checkflag?(_g.mousewheel.checkflag=!1,_g.mousewheel.wheelstart=!1,window.clearInterval(_g.mousewheel.wheeltimer),_g.mousewheel.onEnd(_g.mousewheel.e),_g.mousewheel.direction=null):_g.mousewheel.checkflag=!0},100)),_g.mousewheel.preventDefault?(_g.mousewheel.preventDefault=!1,e.preventDefault(),!1):void 0}};_g.event.addEvent(window,"wheel",e),_g.event.addEvent(window,"mousewheel",e),_g.event.addEvent(window,"DOMMouseScroll",e)},getMouseWheel:function(e){_g.mousewheel.mouseWheelSpeed=20;var t,i;return"deltaX"in e?(t=-e.deltaX,i=-e.deltaY):"wheelDeltaX"in e?(t=e.wheelDeltaX/120*_g.mousewheel.mouseWheelSpeed,i=e.wheelDeltaY/120*_g.mousewheel.mouseWheelSpeed):t=i="wheelDelta"in e?e.wheelDelta/120*_g.mousewheel.mouseWheelSpeed:"detail"in e?-e.detail/3*_g.mousewheel.mouseWheelSpeed:void 0,{x:t,y:i}},getElement:function(e,t,i){var n,a=t?".iMouseWheel.enableMouseWheelX,.iMouseWheel.enableMouseWheel":i?".iMouseWheel.enableMouseWheelY,iMouseWheel.enableMouseWheel":".iMouseWheel";return _g.mousewheel.currentTarget?n=_g.mousewheel.currentTarget:t||i?t?n=$(e.target).is(a)?$(e.target):$(e.target).closest(".iMouseWheel.enableMouseWheelX").length?$(e.target).closest(".iMouseWheel.enableMouseWheelX"):$(e.target).closest(".iMouseWheel.enableMouseWheel"):i&&(n=$(e.target).is(a)?$(e.target):$(e.target).closest(".iMouseWheel.enableMouseWheelY").length?$(e.target).closest(".iMouseWheel.enableMouseWheelY"):$(e.target).closest(".iMouseWheel.enableMouseWheel")):n=$(e.target).is(".iMouseWheel")?$(e.target):$(e.target).closest(".iMouseWheel"),n},available:function(e){var t=_g.mousewheel.getElement(e);return t.length?t.hasClass("disableMouseWheel")?!1:t.hasClass("disableMouseWheelX")&&0==_g.mousewheel.direction?!1:t.hasClass("disableMouseWheelY")&&1==_g.mousewheel.direction?!1:t.hasClass("enableMouseWheel")?(e.preventDefault(),t):t.hasClass("enableMouseWheelX")&&0==_g.mousewheel.direction?(e.preventDefault(),t):t.hasClass("enableMouseWheelY")&&1==_g.mousewheel.direction?(e.preventDefault(),t):(t=_g.mousewheel.getElement(e,!_g.mousewheel.direction,_g.mousewheel.direction),t.length?(e.preventDefault(),t):null):(_g.mousewheel.preventDefault&&e.preventDefault(),null)},onStart:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelstart",e)},onWheel:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelmove",e)},onEnd:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelend",e),_g.mousewheel.currentTarget=null}},i={onWheelLeft:"wheelleft",onWheelRight:"wheelright",onWheelUp:"wheelup",onWheelDown:"wheeldown"};Object.keys(i).forEach(function(n){var a=i[n];t[n]=function(t){var i=_g.mousewheel.available(t);i&&(e()||i.trigger(a,t))}}),"undefined"==typeof require?(window._g||(window._g={}),window._g.mousewheel=t):define("_g/mousewheel",["_g/base","_g/event"],function(){return window._g.mousewheel=t,window._g.mousewheel})}(window),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var a=function(){if(!i)try{e(n).trigger(e.support.transition.end)}catch(t){}};return setTimeout(a,t),this},e(function(){e.support.transition=t()})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),a=i.data("bs.alert");a||i.data("bs.alert",a=new n(this)),"string"==typeof t&&a[t].call(i)})}var i='[data-dismiss="alert"]',n=function(t){e(t).on("click",i,this.close)};n.VERSION="3.1.1",n.prototype.close=function(t){function i(){r.detach().trigger("closed.bs.alert").remove()}var n=e(this),a=n.attr("data-target");a||(a=n.attr("href"),a=a&&a.replace(/.*(?=#[^\s]*$)/,""));var r=e(a);t&&t.preventDefault(),r.length||(r=n.hasClass("alert")?n:n.parent()),r.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(r.removeClass("in"),e.support.transition&&r.hasClass("fade")?r.one(e.support.transition.end,i).emulateTransitionEnd(150):i())};var a=e.fn.alert;e.fn.alert=t,e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=a,this},e(document).on("click.bs.alert.data-api",i,n.prototype.close)}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),a=n.data("bs.button"),r="object"==typeof t&&t;a||n.data("bs.button",a=new i(this,r)),"toggle"==t?a.toggle():t&&a.setState(t)})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.1.1",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(t){var i="disabled",n=this.$element,a=n.is("input")?"val":"html",r=n.data();t+="Text",null==r.resetText&&n.data("resetText",n[a]()),n[a](null==r[t]?this.options[t]:r[t]),setTimeout(e.proxy(function(){"loadingText"==t?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))},this),0)},i.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}e&&this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=t,e.fn.button.Constructor=i,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=e(i.target);n.hasClass("btn")||(n=n.closest(".btn")),t.call(n,"toggle"),i.preventDefault()})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),a=n.data("bs.carousel"),r=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t),o="string"==typeof t?t:r.slide;a||n.data("bs.carousel",a=new i(this,r)),"number"==typeof t?a.to(t):o?a[o]():r.interval&&a.pause().cycle()})}var i=function(t,i){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};i.VERSION="3.1.1",i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},i.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},i.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(".item"),this.$items.index(this.$active)},i.prototype.to=function(t){var i=this,n=this.getActiveIndex();return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]));
},i.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){return this.sliding?void 0:this.slide("next")},i.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},i.prototype.slide=function(t,i){var n=this.$element.find(".item.active"),a=i||n[t](),r=this.interval,o="next"==t?"left":"right",s="next"==t?"first":"last",l=this;if(!a.length){if(!this.options.wrap)return;a=this.$element.find(".item")[s]()}if(a.hasClass("active"))return this.sliding=!1;var c=a[0],d=e.Event("slide.bs.carousel",{relatedTarget:c,direction:o});if(this.$element.trigger(d),!d.isDefaultPrevented()){this.sliding=!0,r&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var t=e(l.$indicators.children()[l.getActiveIndex()]);t&&t.addClass("active")}));var h=e.Event("slid.bs.carousel",{relatedTarget:c,direction:o});return e.support.transition&&this.$element.hasClass("slide")?(a.addClass(t),a[0].offsetWidth,n.addClass(o),a.addClass(o),n.one(e.support.transition.end,function(){a.removeClass([t,o].join(" ")).addClass("active"),n.removeClass(["active",o].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(h)},0)}).emulateTransitionEnd(1e3*n.css("transition-duration").slice(0,-1))):(n.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(h)),r&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=i,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(i){var n,a=e(this),r=e(a.attr("data-target")||(n=a.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),o=e.extend({},r.data(),a.data()),s=a.attr("data-slide-to");s&&(o.interval=!1),t.call(r,o),(s=a.attr("data-slide-to"))&&r.data("bs.carousel").to(s),i.preventDefault()}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var i=e(this);t.call(i,i.data())})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),a=n.data("bs.collapse"),r=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t);!a&&r.toggle&&"show"==t&&(t=!t),a||n.data("bs.collapse",a=new i(this,r)),"string"==typeof t&&a[t]()})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};i.VERSION="3.1.1",i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i=e.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var a=n.data("bs.collapse");if(a&&a.transitioning)return;t.call(n,"hide"),a||n.data("bs.collapse",null)}var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0),this.transitioning=1;var o=function(t){return t&&t.target!=this.$element[0]?void this.$element.one(e.support.transition.end,e.proxy(o,this)):(this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,void this.$element.off(e.support.transition.end+".bs.collapse").trigger("shown.bs.collapse"))};if(!e.support.transition)return o.call(this);var s=e.camelCase(["scroll",r].join("-"));this.$element.on(e.support.transition.end+".bs.collapse",e.proxy(o,this)).emulateTransitionEnd(350)[r](this.$element[0][s])}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(t){return t&&t.target!=this.$element[0]?void this.$element.one(e.support.transition.end,e.proxy(n,this)):(this.transitioning=0,void this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse"))};return e.support.transition?void this.$element[i](0).one(e.support.transition.end,e.proxy(n,this)).emulateTransitionEnd(350):n.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=t,e.fn.collapse.Constructor=i,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var n,a=e(this),r=a.attr("data-target")||i.preventDefault()||(n=a.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),o=e(r),s=o.data("bs.collapse"),l=s?"toggle":a.data(),c=a.attr("data-parent"),d=c&&e(c);s&&s.transitioning||(d&&d.find('[data-toggle="collapse"][data-parent="'+c+'"]').not(a).addClass("collapsed"),a[o.hasClass("in")?"addClass":"removeClass"]("collapsed")),t.call(o,l)})}(jQuery),+function(e){"use strict";function t(t){t&&3===t.which||(e(a).remove(),e(r).each(function(){var n=i(e(this)),a={relatedTarget:this};n.hasClass("open")&&(n.trigger(t=e.Event("hide.bs.dropdown",a)),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown",a))}))}function i(t){var i=t.attr("data-target");i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&e(i);return n&&n.length?n:t.parent()}function n(t){return this.each(function(){var i=e(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new o(this)),"string"==typeof t&&n[t].call(i)})}var a=".dropdown-backdrop",r='[data-toggle="dropdown"]',o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.VERSION="3.1.1",o.prototype.toggle=function(n){var a=e(this);if(!a.is(".disabled, :disabled")){var r=i(a),o=r.hasClass("open");if(t(),!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var s={relatedTarget:this};if(r.trigger(n=e.Event("show.bs.dropdown",s)),n.isDefaultPrevented())return;a.trigger("focus"),r.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=e(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var a=i(n),o=a.hasClass("open");if(!o||o&&27==t.keyCode)return 27==t.which&&a.find(r).trigger("focus"),n.trigger("click");var s=" li:not(.divider):visible a",l=a.find('[role="menu"]'+s+', [role="listbox"]'+s);if(l.length){var c=l.index(l.filter(":focus"));38==t.keyCode&&c>0&&c--,40==t.keyCode&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var s=e.fn.dropdown;e.fn.dropdown=n,e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,o.prototype.toggle).on("keydown.bs.dropdown.data-api",r+', [role="menu"], [role="listbox"]',o.prototype.keydown)}(jQuery),+function(e){"use strict";function t(t,n){return this.each(function(){var a=e(this),r=a.data("bs.modal"),o=e.extend({},i.DEFAULTS,a.data(),"object"==typeof t&&t);r||a.data("bs.modal",r=new i(this,o)),"string"==typeof t?r[t](n):o.show&&r.show(n)})}var i=function(t,i){this.options=i,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.1.1",i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},i.prototype.show=function(t){var i=this,n=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var n=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var a=e.Event("shown.bs.modal",{relatedTarget:t});n?i.$element.find(".modal-dialog").one(e.support.transition.end,function(){i.$element.trigger("focus").trigger(a)}).emulateTransitionEnd(300):i.$element.trigger("focus").trigger(a)}))},i.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},i.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},i.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(t){var i=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var a=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),a&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;a?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var r=function(){i.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,r).emulateTransitionEnd(150):r()}else t&&t()},i.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},i.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},i.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var n=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=i,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=e(this),a=n.attr("href"),r=e(n.attr("data-target")||a&&a.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(a)&&a},r.data(),n.data());n.is("a")&&i.preventDefault(),t.call(r,o,this),r.one("hide.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),a=n.data("bs.tooltip"),r="object"==typeof t&&t;(a||"destroy"!=t)&&(a||n.data("bs.tooltip",a=new i(this,r)),"string"==typeof t&&a[t]())})}var i=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};i.VERSION="3.1.1",i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(t,i,n){this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var a=this.options.trigger.split(" "),r=a.length;r--;){var o=a[r];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){var s="hover"==o?"mouseenter":"focusin",l="hover"==o?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},i.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},i.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show()},i.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var i=this,n=this.tip();this.setContent(),this.options.animation&&n.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,r=/\s?auto?\s?/i,o=r.test(a);o&&(a=a.replace(r,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(a),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var s=this.getPosition(),l=n[0].offsetWidth,c=n[0].offsetHeight;if(o){var d=a,h=this.$element.parent(),u=this.getPosition(h);a="bottom"==a&&s.top+s.height+c-u.scroll>u.height?"top":"top"==a&&s.top-u.scroll-c<0?"bottom":"right"==a&&s.right+l>u.width?"left":"left"==a&&s.left-l<u.left?"right":a,n.removeClass(d).addClass(a)}var p=this.getCalculatedOffset(a,s,l,c);this.applyPlacement(p,a),this.hoverState=null;var f=function(){i.$element.trigger("shown.bs."+i.type)};e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,f).emulateTransitionEnd(150):f()}},i.prototype.applyPlacement=function(t,i){var n=this.tip(),a=n[0].offsetWidth,r=n[0].offsetHeight,o=parseInt(n.css("margin-top"),10),s=parseInt(n.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(s)&&(s=0),t.top=t.top+o,t.left=t.left+s,e.offset.setOffset(n[0],e.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),n.addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;"top"==i&&c!=r&&(t.top=t.top+r-c);var d=this.getViewportAdjustedDelta(i,t,l,c);d.left?t.left+=d.left:t.top+=d.top;var h=d.left?2*d.left-a+l:2*d.top-r+c,u=d.left?"left":"top",p=d.left?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(h,n[0][p],u)},i.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},i.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},i.prototype.hide=function(){function t(){"in"!=i.hoverState&&n.detach(),i.$element.trigger("hidden.bs."+i.type)}var i=this,n=this.tip(),a=e.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},i.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(t){t=t||this.$element;var i=t[0],n="BODY"==i.tagName;return e.extend({},"function"==typeof i.getBoundingClientRect?i.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:n?e(window).width():t.outerWidth(),height:n?e(window).height():t.outerHeight()},n?{top:0,left:0}:t.offset())},i.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},i.prototype.getViewportAdjustedDelta=function(e,t,i,n){var a={top:0,left:0};if(!this.$viewport)return a;var r=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-r-o.scroll,l=t.top+r-o.scroll+n;s<o.top?a.top=o.top-s:l>o.top+o.height&&(a.top=o.top+o.height-l)}else{var c=t.left-r,d=t.left+r+i;c<o.left?a.left=o.left-c:d>o.width&&(a.left=o.left+o.width-d)}return a},i.prototype.getTitle=function(){var e,t=this.$element,i=this.options;return e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title)},i.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(t){var i=this;t&&(i=e(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=i,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),a=n.data("bs.popover"),r="object"==typeof t&&t;(a||"destroy"!=t)&&(a||n.data("bs.popover",a=new i(this,r)),"string"==typeof t&&a[t]())})}var i=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.1.1",i.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},i.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=i,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),+function(e){"use strict";function t(i,n){var a,r=e.proxy(this.process,this);this.$element=e(e(i).is("body")?window:i),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scrollspy",r),this.options=e.extend({},t.DEFAULTS,n),this.selector=(this.options.target||(a=e(i).attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}function i(i){return this.each(function(){var n=e(this),a=n.data("bs.scrollspy"),r="object"==typeof i&&i;a||n.data("bs.scrollspy",a=new t(this,r)),"string"==typeof i&&a[i]()})}t.VERSION="3.1.1",t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var i=this;this.$body.find(this.selector).filter(":visible").map(function(){var n=e(this),a=n.data("target")||n.attr("href"),r=/^#./.test(a)&&e(a);return r&&r.length&&r.is(":visible")&&[[r[t]().top+(!e.isWindow(i.$scrollElement.get(0))&&i.$scrollElement.scrollTop()),a]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight),n=i-this.$scrollElement.height(),a=this.offsets,r=this.targets,o=this.activeTarget;if(t>=n)return o!=(e=r.last()[0])&&this.activate(e);if(o&&t<=a[0])return o!=(e=r[0])&&this.activate(e);for(e=a.length;e--;)o!=r[e]&&t>=a[e]&&(!a[e+1]||t<=a[e+1])&&this.activate(r[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var n=e.fn.scrollspy;e.fn.scrollspy=i,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);i.call(t,t.data())})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),a=n.data("bs.tab");a||n.data("bs.tab",a=new i(this)),"string"==typeof t&&a[t]()})}var i=function(t){this.element=e(t)};i.VERSION="3.1.1",i.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var a=i.find(".active:last a")[0],r=e.Event("show.bs.tab",{relatedTarget:a});if(t.trigger(r),!r.isDefaultPrevented()){var o=e(n);this.activate(t.closest("li"),i),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:a})})}}},i.prototype.activate=function(t,i,n){function a(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var r=i.find("> .active"),o=n&&e.support.transition&&r.hasClass("fade");o?r.one(e.support.transition.end,a).emulateTransitionEnd(150):a(),r.removeClass("in")};var n=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=i,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(i){i.preventDefault(),t.call(e(this),"show")})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),a=n.data("bs.affix"),r="object"==typeof t&&t;a||n.data("bs.affix",a=new i(this,r)),"string"==typeof t&&a[t]()})}var i=function(t,n){this.options=e.extend({},i.DEFAULTS,n),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.1.1",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},i.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=e(document).height(),n=this.$target.scrollTop(),a=this.$element.offset(),r=this.options.offset,o=r.top,s=r.bottom;"object"!=typeof r&&(s=o=r),"function"==typeof o&&(o=r.top(this.$element)),"function"==typeof s&&(s=r.bottom(this.$element));var l=null!=this.unpin&&n+this.unpin<=a.top?!1:null!=s&&a.top+this.$element.height()>=t-s?"bottom":null!=o&&o>=n?"top":!1;if(this.affixed!==l){null!=this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),d=e.Event(c+".bs.affix");this.$element.trigger(d),d.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(c).trigger(e.Event(c.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:t-this.$element.height()-s}))}}};var n=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=i,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var i=e(this),n=i.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.call(i,n)})})}(jQuery),!function(e){"use strict";var t=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"==typeof this.options.autoSelect?this.options.autoSelect:!0,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.delay="number"==typeof this.options.delay?this.options.delay:250,this.$menu=e(this.options.menu),this.shown=!1,this.listen(),this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus?this.options.showHintOnFocus:!1};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").data("value");return(this.autoSelect||e)&&this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},setSource:function(e){this.source=e},show:function(){var t,i=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return t="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,this.$menu.insertAfter(this.$element).css({top:i.top+i.height+t,left:i.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var i;if("undefined"!=typeof t&&null!==t?this.query=t:this.query=this.$element.val()||"",this.query.length<this.options.minLength)return this.shown?this.hide():this;var n=e.proxy(function(){i=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,i&&this.process(i)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(n,this.delay)},process:function(t){var i=this;return t=e.grep(t,function(e){return i.matcher(e)}),t=this.sorter(t),t.length?"all"==this.options.items?this.render(t).show():this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,i=[],n=[],a=[];t=e.shift();)t.toLowerCase().indexOf(this.query.toLowerCase())?~t.indexOf(this.query)?n.push(t):a.push(t):i.push(t);return i.concat(n,a)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var i=this;return t=e(t).map(function(t,n){return t=e(i.options.item).data("value",n),t.find("a").html(i.highlighter(n)),t[0]}),this.autoSelect&&t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var i=this.$menu.find(".active").removeClass("active"),n=i.next();n.length||(n=e(this.$menu.find("li")[0])),n.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),i=t.prev();i.length||(i=this.$menu.find("li").last()),i.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.shown||40!=t.keyCode?this.move(t):this.lookup("")},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused||(this.focused=!0,(0===this.options.minLength&&!this.$element.val()||this.options.showHintOnFocus)&&this.lookup())},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var i=e.fn.typeahead;e.fn.typeahead=function(i){var n=arguments;return this.each(function(){var a=e(this),r=a.data("typeahead"),o="object"==typeof i&&i;r||a.data("typeahead",r=new t(this,o)),"string"==typeof i&&(n.length>1?r[i].apply(r,Array.prototype.slice.call(n,1)):r[i]());
})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=i,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var i=e(this);i.data("typeahead")||i.typeahead(i.data())})}(window.jQuery),+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var a=function(){i||e(n).trigger(e.support.transition.end)};return setTimeout(a,t),this},e(function(){e.support.transition=t()})}(jQuery),define("bootstrap",["jquery"],function(){}),window.bootbox=window.bootbox||function t(e,i){"use strict";function n(e){var t=w[g.locale];return t?t[e]:w.en[e]}function a(t,i,n){t.preventDefault();var a=e.isFunction(n)&&n(t)===!1;a||i.modal("hide")}function r(e){var t,i=0;for(t in e)i++;return i}function o(t,i){var n=0;e.each(t,function(e,t){i(e,t,n++)})}function s(t){var i,n;if("object"!=typeof t)throw new Error("Please supply an object of options");if(!t.message)throw new Error("Please specify a message");return t=e.extend({},g,t),t.buttons||(t.buttons={}),t.backdrop=t.backdrop?"static":!1,i=t.buttons,n=r(i),o(i,function(t,a,r){if(e.isFunction(a)&&(a=i[t]={callback:a}),"object"!==e.type(a))throw new Error("button with key "+t+" must be an object");a.label||(a.label=t),a.className||(2>=n&&r===n-1?a.className="btn-primary":a.className="btn-default")}),t}function l(e,t){var i=e.length,n={};if(1>i||i>2)throw new Error("Invalid argument length");return 2===i||"string"==typeof e[0]?(n[t[0]]=e[0],n[t[1]]=e[1]):n=e[0],n}function c(t,i,n){return e.extend(!0,{},t,l(i,n))}function d(e,t,i){return p(c(u.apply(null,e),t,i),e)}function h(){for(var e={},t=0,i=arguments.length;i>t;t++){var a=arguments[t],r=a.toLowerCase(),o=a.toUpperCase();e[r]={label:n(o)}}return e}function u(){return{buttons:h.apply(null,arguments)}}function p(e,t){var n={};return o(t,function(e,t){n[t]=!0}),o(e.buttons,function(e){if(n[e]===i)throw new Error("button key "+e+" is not allowed (options are "+t.join("\n")+")")}),e}var f={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' id='closePreview'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input form-control' autocomplete=off type=text />"}},v=e("body"),g={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0},m={};m.alert=function(){var t;if(t=d(["ok"],arguments,["message","callback"]),t.callback&&!e.isFunction(t.callback))throw new Error("alert requires callback property to be a function when provided");return t.buttons.ok.callback=t.onEscape=function(){return e.isFunction(t.callback)?t.callback():!0},m.dialog(t)},m.confirm=function(){var t;if(t=d(["cancel","confirm"],arguments,["message","callback"]),t.buttons.cancel.callback=t.onEscape=function(){return t.callback(!1)},t.buttons.confirm.callback=function(){return t.callback(!0)},!e.isFunction(t.callback))throw new Error("confirm requires a callback");return m.dialog(t)},m.prompt=function(){var t,n,a,r,o,s;if(r=e(f.form),n={buttons:h("cancel","confirm"),value:""},t=p(c(n,arguments,["title","callback"]),["cancel","confirm"]),s=t.show===i?!0:t.show,t.message=r,t.buttons.cancel.callback=t.onEscape=function(){return t.callback(null)},t.buttons.confirm.callback=function(){return t.callback(o.val())},t.show=!1,!t.title)throw new Error("prompt requires a title");if(!e.isFunction(t.callback))throw new Error("prompt requires a callback");return o=e(f.inputs.text),o.val(t.value),r.append(o),r.on("submit",function(e){e.preventDefault(),a.find(".btn-primary").click()}),a=m.dialog(t),a.off("shown.bs.modal"),a.on("shown.bs.modal",function(){o.focus()}),s===!0&&a.modal("show"),a},m.dialog=function(t){t=s(t);var i=e(f.dialog),n=i.find(".modal-body"),r=t.buttons,l="",c={onEscape:t.onEscape};if(o(r,function(e,t){l+="<button data-bb-handler='"+e+"' type='button' class='btn "+t.className+"'>"+t.label+"</button>",c[e]=t.callback}),n.find(".bootbox-body").html(t.message),t.animate===!0&&i.addClass("fade"),t.className&&i.addClass(t.className),t.title&&n.before(f.header),t.closeButton){var d=e(f.closeButton);t.title?i.find(".modal-header").prepend(d):d.css("margin-top","-10px").prependTo(n)}return t.title&&i.find(".modal-title").html(t.title),l.length&&(n.after(f.footer),i.find(".modal-footer").html(l)),t.width&&t.height&&(i.width(t.width),i.height(t.height),i.css({left:"50%",top:"50%","margin-top":function(){return-(e(this).height()/2)},"margin-left":function(){return-(e(this).width()/2)}}),i.children(".modal-dialog").width(t.width).height(t.height)),i.on("hidden.bs.modal",function(e){e.target===this&&i.remove()}),i.on("shown.bs.modal",function(){i.find(".btn-primary:first").focus()}),i.on("escape.close.bb",function(e){c.onEscape&&a(e,i,c.onEscape)}),i.on("click",".modal-footer button",function(t){var n=e(this).data("bb-handler");a(t,i,c[n])}),i.on("click",".bootbox-close-button",function(e){a(e,i,c.onEscape)}),i.on("keyup",function(e){27===e.which&&i.trigger("escape.close.bb")}),v.append(i),i.modal({backdrop:t.backdrop,keyboard:!1,show:!1}),t.draggable&&i.draggable(),t.show&&i.modal("show"),i},m.setDefaults=function(t){e.extend(g,t)},m.hideAll=function(){e(".bootbox").modal("hide")};var w={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return m.init=function(i){window.bootbox=t(i||e)},m}(window.jQuery),define("bootboxjs",["bootstrap"],function(){}),define("text!share/template/share.js",[],function(){return'<form class="form-horizontal">\n  <h5 style="color:#f80; margin:0 0 20px;">分享给站外好友：</h5>\n  <div class="control-group">\n    <label for="inc_http" class="control-label">地址：</label>\n    <div class="controls">\n      <input type="text" value="<%-url%>" id="inc_http" style="width:450px; line-height:18px;">\n    </div>\n  </div>\n  <h5 style="color:#f80; margin:0 0 20px;">把内容贴到Blog或BBS：</h5>\n  <div class="control-group">\n    <label class="control-label" for="inputWidth">自定义尺寸：</label>\n    <div class="controls">\n      <div style="width:180px; float:left;">\n        <label class="control-label" for="inputWidth" style="width:60px;">宽度</label>\n        <input type="text" id="inputWidth" class="input-small" placeholder="自定义高度" value="650" style="width:40px; margin:0 10px;">\n        px </div>\n      <div style="width:180px; float:left;">\n        <label class="control-label" for="inputHeight" style="width:60px;">高度</label>\n        <input type="text" id="inputHeight" class="input-small" placeholder="自定义宽度" value="540" style="width:40px; margin:0 10px;">\n        px </div>\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label">是否显示播放条：</label>\n    <div class="controls">\n      <label class="radio inline" style="margin-left:30px;">\n        <input type="radio" name="controlbar" id="controlbar1" value="1" checked="">\n        是 </label>\n      <label class="radio inline" style="margin-left:30px;">\n        <input type="radio" name="controlbar" id="controlbar0" value="0" >\n        否 </label>\n    </div>\n  </div>\n  <div class="control-group">\n    <label for="inc_http" class="control-label">复制iframe代码：</label>\n    <div class="controls">\n      <input type="text" id="embedIframe" value="<%-iframecode%>" id="inc_http" style="width:450px; line-height:18px;">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="embedHtml">复制Html代码：</label>\n    <div class="controls">\n      <textarea rows="4" style="width: 450px; margin: 0px; height: 160px; resize: none;" id="embedHtml"><%-code%></textarea>\n    </div>\n  </div>\n</form>'}),require(["bootboxjs","_g/ui","text!share/template/share.js"],function(){window.share=function(e,t){function i(e){var i=parseInt(e.find("#inputWidth").val())||650,n=parseInt(e.find("#inputHeight").val())||540,s=parseInt(e.find('input[name="controlbar"]:checked').val());e.find("textarea#embedHtml").val(_.template(r,{origin:a,url:t,w:i,h:n,controlbar:s})),e.find("input#embedIframe").val(_.template(o,{origin:a,url:t,w:i,h:n,controlbar:s}))}var n="epub360player"+_g.uuid(),a="http://"+location.host;t=a+t;var r="<div id="+n+'>\n   <script type="text/javascript" src="<%=origin%>/staticfs/thirdparty/play/player.js?v='+n+'"></script>\n   <script>\n       epub360PlayerInit("'+n+'",<%=w%>,<%=h%>,"<%=url%>?autoplay=false<% if (controlbar==0){ %>&controlbar=false<% } %>","<%=origin%>");\n   </script></div>',o='<iframe style="width: <%=w%>px; height: <%=h%>px; border: none;" src="<%=url%>?autoplay=false<% if (controlbar==0){ %>&controlbar=false<% } %>"></iframe>',s=require("text!rightpanel/share.js"),l=bootbox.dialog({title:"<h3>分享: "+e+"<h3>",message:_.template(s,{url:t,code:_.template(r,{origin:a,url:t,w:650,h:540,controlbar:1}),iframecode:_.template(o,{origin:a,url:t,w:650,h:540,controlbar:1})})});$(l).css({width:"700px",height:"490px"}).find(".modal-body").css("max-height","600px"),_g.ui.center({Item:l}),setTimeout('$(".bootbox").find(".modal-dialog").css("margin-top", $(".bootbox").offset().top-$(".bootbox").find(".modal-dialog").offset().top+"px");',200),$(l).find("input[type='text'], textarea").mouseenter(function(){$(this).select()}),$(l).find("#inputWidth, #inputHeight").keyup(function(){i($(l))}),$(l).find("input[name='controlbar']").click(function(){i($(l))})}}),define("share/main",function(){}),function(e){e.fn.addBack=e.fn.addBack||e.fn.andSelf,e.fn.extend({actual:function(t,i){if(!this[t])throw'$.actual => The jQuery method "'+t+'" you called does not exist';var n,a,r={absolute:!1,clone:!1,includeMargin:!1},o=e.extend(r,i),s=this.eq(0);if(o.clone===!0)n=function(){var e="position: absolute !important; top: -1000 !important; ";s=s.clone().attr("style",e).appendTo("body")},a=function(){s.remove()};else{var l,c=[],d="";n=function(){l=s.parents().addBack().filter(":hidden"),d+="visibility: hidden !important; display: block !important; ",o.absolute===!0&&(d+="position: absolute !important; "),l.each(function(){var t=e(this),i=t.attr("style");c.push(i),t.attr("style",i?i+";"+d:d)})},a=function(){l.each(function(t){var i=e(this),n=c[t];void 0===n?i.removeAttr("style"):i.attr("style",n)})}}n();var h=/(outer)/.test(t)?s[t](o.includeMargin):s[t]();return a(),h}})}(jQuery),define("jquery.actual",["jquery"],function(){}),define("text!interaction_view/template/controlbar.tpl",[],function(){return'<div class=\'presentation-area\'>\n    <div class="controlbar">\n            <div class="logo"><% if (typeof cbt_data=="undefined"){ %><% if(typeof has_logo != \'undefined\' &&  has_logo){ %><a href="http://www.epub360.com" target="_blank"><img alt="logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAaCAYAAAAkJwuaAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABhFJREFUeNrsmVlwlEUQx7+sSTwikSAqiAciJCJQQVFBA4WAZwyXoiioUUAi+CBe4IMFXg8ioIKlgoIHhhKltDzAg0IpopJQbjQYTVKh1NKICUSUwygJC7Gb+k3ZTu2GXcyDD9tV/5qd6S/zfdPT3fPvSUo4HA48WSqYLNggKBasFPwRJCWqDBgw4GAbiqKrFuwUDBW8IKgXPJA0WdsSzZALBFmCHMFCwbGCRwRvJ82VmCHPFpwrqBXMEJwj+FkwWrA8abL4DTlfUC74UjBOUCE4X/Cn4CYMmpQ4DPkEB4164irBLYIGwXj0zyXN1rYhjxF0F6wTXCwoYPwlQaZgtaBG0FWQmzRddEPqYfKT4AfBbsGDgjWCSeifpH2FdnAC79D08Ficz6Ycpu5/YcgboDfHM9ZBMEcwAW90xlD5irZ3Au/QlDBLMK+NZ9T7PxE0CpbwDfbwUz67XfAWB6GTIwT3C+pMTo8lRwumC+YKrouiV6d5XHAz81qZiO5GQSfBCJyjqLy8PPPgLgshV8/LJ3R1wTMFhXhkAWG8X/ANXtFPsAfvjUfWCi5lUyZF0Q8RlHhjYQ64boIfoyysj6DKzG2lMAq70MVvEvQ0Yx8LLuH3OozjROceSCGyzPtu5dgdTf8XQV7IDH7ABB/Rz8djN2NElVbB1wkY0Ybk5hj622kX4W27BOcxNhIjKhUbJHiT8f6CdIzYRE5/CN3MKO+4GyNWkcZ2YLjObNYIouFhwRaioD/rVyO2oCvDXvvplwpOVg8PMahyFO0WysSnbSVEaH4mWCy4wOiW8IG30R+G4T80O+hCNNfzCpXTad8gdTjvzGahKp/jUcX0tVjowe8KWMbr9HVhGd47utLqt88WrKDfzxycK0lp8807XArbgO4++uvpz6I/MBUvU/nNhFXYW6jt52luwEM20fZm4e6j+2C4gN1UmQoCPGuc8fIAZhDAV1WOE+zldyptlnnWD3eX4zPw1iaja/Lmce/qTuoIjEO5CDrRbMhew2zsmly/S6p5WT5/0IG4X8P4nbQN5J5rBGcyrgfSNvS7PENsbYOr6hz3svtFLLzCeK5bUITfEUPFqmAYvb35Q2aRB2KkkTTaF0lR64ggq0unbRbs83Rp3oa4/l92kdcKXhM8j5s7ca6/DFeeY0IoMC87VI5cgHe/S3+GSexDCNsywm07edjl7ysJ3dlEQT0ee7jyKZSuzoT9fxLrkTvwOnXnL6Lsogv9PbS9PA88lDTgSeqFo7w8tsh79juSfycXOoayTGZDtrYTBWxu78pGeVFfwRkez3JhcqR3KEUSJMoZXl45ALdTOQvjTsNAF3Lr1IC+hG/S8D9NMKYdDZne3oZsMZyr0FxO+DvW2k5RECEtaJ69WvA+p2op+h7m3dXU/XPpD4pyMiciY2EbPYmSdgntNG/sCsHLGCwU/HM7HjEpIDCnZqpncP+EjKUPMed0mEA1d54pJqWke1HQbObM8MZazHeFYhwy7tlRXMZs5IrQ6ixTSEnEI5sN3bA0Yov3Ee5Dx3intAt9dzCc6n1YxKMup3jz1XsG7mzmjZiy1dKWfeRQ+3yLSTXNMQ48f0N2Gl2ml4Ja4zhI/+WRpVQG00jiY9GVmhpV5R68J9vkLVd/699MEZxENRJAL5xe6+1b2aQCQ6QDDjbllAvxkKHG81dT446EslyGrtZ4Ul9O/Bz6NRyAWjFdZAh4EUwhm3tVlUpzWE7AqKNNERC3IbXW7saEWWZ8N7VmDTXpcO/vyvDMbRBXrWROMPq9UJow45UY2ebjwRixI/PlGP1TgrtM5TTVoy5XwR50Y58xul/hqCV4up72dwie5VJkmHl2OWdBwEZM9O4HLocSasX1LRs2HmpYDd+9HspYm8rpl0vO6ALNWWoYv3P990CdKf8COF8uNalyy9+5bnOpoRH9ZOpaDadX2SQXXn3x2F6Q5LVm/iKKgzw2ZpXROQMVMs9ik3IexSMr6Q/nHTncJ6w38+itzjvU+Bv5HbDWYv5j4A69FV5f9RUpUf4d64vbySmQ8qTYS4g2/h3rS0dTlyYlDh4ZS74nXBqT5ootfwswAIGagOhx/Kc1AAAAAElFTkSuQmCC"></a><% } %><% } %></div>\n            <div class="progress"><span></span></div>\n            <% if(controlbar_settings.arrow){%>\n              <% if(play_mode==0){ %>\n                <div class="btn-group action-control" style="margin-left: -40px;">\n                   <button class="btn navigate-left" href="#" ><i class="icon-chevron-left icon-2x"></i></button>\n                   <button class="btn navigate-right" href="#" ><i class="icon-chevron-right icon-2x"></i></button>                  \n              <% } else {%>\n                <div class="btn-group action-control" style="margin-left: -90px;">\n                    <button class="btn navigate-left" href="#" ><i class="icon-chevron-left icon-2x"></i></button>\n                    <button class="btn navigate-right" href="#" ><i class="icon-chevron-right icon-2x"></i></button>\n                    <button class="btn navigate-up" href="#" ><i class="icon-chevron-up icon-2x"></i></button>\n                    <button class="btn navigate-down" href="#" ><i class="icon-chevron-down icon-2x"></i></button>\n               <% } %>\n            </div>\n            <% } %>\n    </div>\n</div>'}),define("interaction_view/ui/screenset/calc_reveal_fit",["require"],function(e){function t(e,t,s,l,c,d,h,u){function p(t){return window.self!=window.top?t:1==t?t:t*((e+.5)/e)}if(u){var f=e;e=t,t=f}h=h||{};var v,g=h.left||0,m=h.right||0,w=h.top||0,_=h.bottom||0,y=g+m,b=w+_,x="raw"!=h.mode;x?(s+=y,l+=b):(e-=y,t-=b);var S,C,T;C=e/t,T=s/l;var k,P,E,D;if(d?(S=C,1==c?D=n(s,l,S):2==c?D=a(s,l,S):0==c&&(D=[e,t]),P=D[0],E=D[1],k=t/E,k=p(k)):(D=[s,l],P=D[0],E=D[1],1==c?k=r(e,t,P,E):2==c?k=o(e,t,P,E):0==c&&(k=1),k=p(k)),u){var f=e;e=t,t=f}var I,$,O,A,N=i(e,t,P,E,k);I=N.left,$=N.top,O=(P-s)/2,A=(E-l)/2,I=Math.abs(I)<.5?0:I,$=Math.abs($)<.5?0:$;var R,M,L,F;x?(s-=y,l-=b,R=P,M=E,L=I,F=$,P-=y,E-=b,I+=g,$+=w,v=k):(e+=y,t+=b,L=I*k,F=$*k,I+=g/k,$+=w/k,R=P*k+y,M=E*k+b,v=1);var W={zoom:k,wrapperWidth:R,wrapperHeight:M,wrapperLeft:L,wrapperTop:F,wrapperZoom:v,revealWidth:P,revealHeight:E,revealLeft:I,revealTop:$,pageWidth:s,pageHeight:l,pageLeft:O,pageTop:A,screenWidth:e,screenHeight:t};return W}function i(e,t,i,n,a){return a=a||1,{left:(e/a-i)/2,top:(t/a-n)/2,center:[e/2,t/2]}}function n(e,t,i){var n,a,r=e/t;return r>i?(n=e,a=n/i):(a=t,n=a*i),[n,a]}function a(e,t,i){var n,a,r=e/t;return i>r?(n=e,a=n/i):(a=t,n=a*i),[n,a]}function r(e,t,i,n){var a,r=e/t,o=i/n;return a=r>o?t/n:e/i}function o(e,t,i,n){var a,r=e/t,o=i/n;return a=r>o?e/i:t/n}return t}),define("interaction_view/ui/screenset",["require","_g/device","text!interaction_view/template/controlbar.tpl","./screenset/calc_reveal_fit"],function(e){function t(){window.get_window_size=i,window.recover_screen=n,window.adjust_screen=a,window.screenSizeLock=r,window.screenSizeRelease=o,window.patchForMobileOrientation=v}function i(){var e,t;if(interaction_view.isWeixin&&interaction_view.isIos)return{x:$(window).width(),y:$(window).height()};if(!interaction_view.isWeixin&&interaction_view.isAndroid)return{x:$(window).width(),y:$(window).height()};if(interaction_view.forpreview)e=parseInt($(".interaction-preview").css("width"),10),t=parseInt($(".interaction-preview").css("height"),10);else{var i=window,n=document,a=n.documentElement,r=n.getElementsByTagName("body")[0];e=i.innerWidth||a.clientWidth||r.clientWidth,t=i.innerHeight||a.clientHeight||r.clientHeight}return{x:e,y:t}}function n(){l(1,0)}function a(e){setTimeout(function(){s(e)},0),"undefined"!=typeof e_Debug_onresize&&e_Debug_onresize&&e_Debug_onresize()}function r(){n(),window.screenLock=!0,c(),d()}function o(){window.screenLock=!1,a()}function s(e){function t(e){return interaction_view.isAndroid&&interaction_view.isWeixin&&interaction_view.currentScreenSize&&e.x===interaction_view.currentScreenSize.x?!0:!1}function n(e,t){var n=i();interaction_view.currentScreenSize=n;var a=window.emulateLandscape.swapped,r=e.wrapper,a=window.emulateLandscape.swapped,o=w(n.x,n.y,Reveal.options.width,Reveal.options.height,Reveal.options.screen_mode,Reveal.options.adapt,r,a);return Backbone.trigger("screenCalculated",o),o}function a(e){var t=300,i={none:"0ms",swap:"0ms",tick:t+"ms",orient:t+"ms"}[window.emulateLandscape.from];window.emulateLandscape.available&&Reveal.slideContainment.css({"transition-duration":i,transform:"rotate("+window.emulateLandscape.degree+"deg)","transform-origin":"center"}),Reveal.slideContainment.css({position:"relative",width:e.revealWidth,height:e.revealHeight,"margin-left":e.revealLeft,"margin-top":e.revealTop,zoom:e.zoom}),Reveal.slideContent.css({width:e.revealWidth,height:e.revealHeight});var n={width:e.pageWidth,height:e.pageHeight,left:e.pageLeft,top:e.pageTop};Reveal.slideContent.find(".interaction-area").css({width:n.width,height:n.height,"margin-left":n.left,"margin-top":n.top}),Reveal.slideContent.find(".interaction-view").css({overflow:"visible"}),$.zoom=e.zoom,Reveal.slideScreenWidth=e.revealWidth,Reveal.slideScreenHeight=e.revealHeight,Reveal.marginLeft=e.pageLeft,Reveal.marginTop=e.pageTop,interaction_view.adapt.change()}e=e||{};var r=i();if(e.force||window.onceForceAdjustScreen||!t(r)){window.onceForceAdjustScreen&&(window.onceForceAdjustScreen=null),interaction_view.currentScreenSize=r;var o=window.scormPlayer&&window.scormPlayer.wrapperSpec||{},s={};s.wrapper=o;var l=n(s,e);a(l),_g.device.msie()&&Reveal.slideContainment.css({left:0,top:0})}}function l(e,t){t=t||0;var i=document.querySelectorAll(".reveal")[0];i.style.transformOrigin="center";var n="scale("+e+") ",a="rotate("+t+"deg) ",r=n+a;i.style.zoom=e,i.style.transform=a,i.style.MozTransform=r,$.zoom=e}function c(){if("undefined"!=typeof Reveal&&Reveal.adapt)Reveal.setAdaptScreen(),Reveal._initSlideStyle(),interaction_view.adapt.change();else{var e="undefined"!=typeof Reveal?Reveal.slideWidth:interaction_view.size.x,t="undefined"!=typeof Reveal?Reveal.slideHeight:interaction_view.size.y,n=i(),a=(n.y-t)/2,r=(n.x-e)/2;$(".reveal").css({"margin-top":parseInt(a),"margin-left":parseInt(r)})}i()}function d(){2==interaction_view.screen_mode&&(Reveal.setAdaptScreen(),Reveal._initSlideStyle())}function h(){interaction_view.controlbarStatus=1,interaction_view.ismobile||$("body").on("mouseover",function(){$(".loading").length>0&&$(".loading").show(),0==interaction_view.controlbarStatus&&interaction_view.screenset.controlbarel&&interaction_view.screenset.controlbarel.show(500),interaction_view.controlbarStatus=1,u()})}function u(){"number"==typeof interaction_view.controlbarTimeOut&&(window.clearTimeout(interaction_view.controlbarTimeOut),delete interaction_view.controlbarTimeOut),interaction_view.controlbarTimeOut=window.setTimeout(function(){interaction_view.screenset.controlbarel&&interaction_view.screenset.controlbarel.hide(),$(".loading").length>0&&$(".loading").hide(500),interaction_view.controlbarStatus=0},3e3)}function p(e){return e.bg_color=_g.getUrlParameterByName("bg_color")?"#"+_g.getUrlParameterByName("bg_color"):e.bg_color,e.bg_opacity=_g.getUrlParameterByName("bg_opacity")?Number(_g.getUrlParameterByName("bg_opacity")):e.bg_opacity,e.screen_mode=_g.getUrlParameterByName("screen_mode")?Number(_g.getUrlParameterByName("screen_mode")):e.screen_mode,e.show_controlbar=_g.getUrlParameterByName("controlbar")?_g.string.string2boolean(_g.getUrlParameterByName("controlbar")):e.show_controlbar,e.controlbar_settings=_g.getUrlParameterByName("controlbar_settings")?JSON.parse(_g.getUrlParameterByName("controlbar_settings")):e.controlbar_settings,e}function f(){y.values.show_controlbar&&(interaction_view.containment.append(_.template(m,y.values)),interaction_view.screenset.controlbarel=$("div.presentation-area"),interaction_view.screenset.controlbarel.find("[rel=tooltip]").tooltip())}function v(){var e=interaction_view.doc.toJSON().vertical,t=interaction_view.doc.toJSON().horizontal,i=!1,n=null;return e||t?(t?e||_g.device.portrait()&&(i=!0,$("body").children(".book_mask").length||$("body").append('<div class="book_mask"><img src="'+web_url+'diazo/img/screendirectionlock.png"><div>请调整到适合屏幕阅读的方向</div></div>')):_g.device.landscape()&&(i=!0,$("body").children(".book_mask").length||$("body").append('<div class="book_mask"><img src="'+web_url+'diazo/img/screendirectionlock.png"><div>请调整到适合屏幕阅读的方向</div></div>')),i||$("body").children(".book_mask").remove(),n=_g.device.portrait()?1:0,void(interaction_view.isAndroid||window.__wxjs_is_wkwebview===!0?setTimeout(function(){a()},400):a())):!1}function g(){workEnd("-------- 6. screenset  1 add style 1 --------"),y.values.bg_opacity?interaction_view.containment.css("background",y.values.bg_color):interaction_view.containment.css("background-color","transparent"),workEnd("-------- 6. screenset  1 add style 1 --------"),0==y.values.screen_mode&&(window.screenLock=!0,interaction_view.screenset.controlbarel&&(interaction_view.screenset.controlbarel.find("button.actualsize").addClass("active"),interaction_view.screenset.controlbarel.find("button.adaptive").removeClass("active")),n())}e("_g/device");var m=e("text!interaction_view/template/controlbar.tpl"),w=e("./screenset/calc_reveal_fit"),y={init:function(){if(window.screenLock=!1,window.screenScale=null,window.bar_height=0,t(),interaction_view.ismobile)if(interaction_view.isIos)window.onresize=v,window.onpageshow=v;else{var e="onorientationchange"in window,i=e?"orientationchange":"resize";window.addEventListener?window.addEventListener(i,v,!1):window.attachEvent?window.attachEvent(i,v):window[i]=v,v()}else interaction_view.forpreview||(window.onresize=function(e){a()},window.onload=a)},render:function(){var e=interaction_view.doc.toJSON();interaction_view.screenset.values=y.values=p(e),interaction_view.ismobile||interaction_view.forpreview||f(),g(),h(),interaction_view.ismobile&&u()},patchForWeiXin:function(){"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)&&$(".reveal").css("transform","scale(1.005,1.005)")}};return y}),define("interaction_view/ui/touchinit",[],function(){var e={init:function(){interaction_view.TransformPrefix=interaction_view._checkPropPrefix("transform"),interaction_view.queue=new Queue,interaction_view.iImgs={},interaction_view.share_page_id="first",interaction_view.share_app_data={},interaction_view.LayerActionLoaded={},window.shareSuccess=function(){$("#epub360-ad").addClass("show");var e=!1;"function"==typeof epub360ShareEvent&&epub360ShareEvent();for(var t=["epub360.cn","epub360.com.cn","epub360.com","creatby.com"],i=0;i<t.length;i++)if(window.location.host.indexOf(t[i])>0){e=!0;break}if(window.enabledShareSuccess&&(e=!1),!e){var n=_.filter(interaction_view.events.pageWXShareSuccessEvents,function(e){return e.page_id==interaction_view.currentPage});_.each(n,function(e){e.func()})}},interaction_view.wait=function(){$("#jswait-loading").hide(),$("body").append('<div class="mejs-overlay-button player-control-button" style="cursor:pointer;margin-top: -35px;position: absolute;top: 50%;left: 50%;width: 100px;height: 100px;margin: -50px 0 0 -50px;z-index: 1000001;background: url(http://qn.static.epub360.com/thirdparty/mediaelementjs/bigplay.svg);"></div>'),$(".player-control-button").on("click",function(){$("#jswait-loading").show(),$("div#epub360player-cover").remove(),$(".player-control-button").remove(),loading_progress_timer=setInterval(function(){compute_loadding_progress(),set_loading_progress()},200),interaction_view.start()})},interaction_view.start=function(){if(!interaction_view.foredit)for(var e=0;e<interaction_view.events.epub360StartEvents.length;e++)interaction_view.events.epub360StartEvents[e]();workEnd("-------- 1. touchinit 3 interaction_view.start start --------");var t=void 0!=interaction_view.doc.get("disable_history")?interaction_view.doc.get("disable_history"):!0;1==_g.getUrlParameterByName("disableHistoryStart")&&(t=!0),0==_g.getUrlParameterByName("disableHistoryStart")&&(t=!1),workEnd("-------- 1. touchinit 3 add style 1 --------"),interaction_view.ismobile&&$("body").addClass("ios"),workEnd("-------- 1. touchinit 3 add style 1 --------");var i=interaction_view.doc.get("play_mode");interaction_view.book_id=interaction_view.doc.get("id"),interaction_view.play_mode=i,interaction_view.screen_mode=interaction_view.doc.get("screen_mode"),interaction_view.events.init(),interaction_view.screenset.init(),interaction_view.screenset.render();var n=interaction_view.doc.toJSON();interaction_view.ismobile&&$("body").one("touchstart",function(){presentation.preloadpageAudio()}),interaction_view.continuous=n.continuous,interaction_view.hasArrow=n.arrow,interaction_view.forceUpload=n.force_upload,interaction_view.scorm=n.scorm,workEnd("-------- 1. touchinit 3 interaction_view.start 1 --------"),new _g.touchslide({body:interaction_view.forpreview?".interaction-preview":"window",width:interaction_view.size.x,height:interaction_view.size.y,containment:".reveal",keyboard:!interaction_view.foredit&&!interaction_view.ismobile,controls:!interaction_view.ismobile,mouseWheel:!interaction_view.ismobile&&n.desktop_mousewheel,progress:!interaction_view.ismobile,adapt:n.adapt,history:interaction_view.forpreview?!1:!0,disableHistoryStart:t,show_excontent:n.show_excontent,screen_mode:n.screen_mode,transition:n.switch_mode,overview:interaction_view.forpreview?!1:n.controlbar_settings.overview,show_overview:interaction_view.ismobile?!1:interaction_view.forpreview?!1:!0,show_controlbar:n.show_controlbar,continuous:n.continuous,smooth:n.smooth,onReady:function(e,t){workEnd("-------- 1. touchinit 3 interaction_view.start  _g.touchslide.onReady  start ------------"),interaction_view.screenset.patchForWeiXin(),window.Reveal=e,interaction_view.forpreview||adjust_screen(),interaction_view.playstatus="wait",interaction_view.currentPage=t;var i=require("interaction_view/view/master");interaction_view.imasterlist.length&&interaction_view.imasterlist.at(0).addView("iview",i),workEnd("-------- 1. touchinit 3 interaction_view.start  masterview ------------");var n=require("interaction_view/view/background");interaction_view.ibackgroundlist.length&&interaction_view.ibackgroundlist.at(0).addView("iview",n),"undefined"!=typeof configpage&&configpage.renderView(),presentation.startLoad(),interaction_view.ismobile&&(presentation.isFirstPageLoading=interaction_view.currentPage),presentation.pageLoad(interaction_view.currentPage)},slidePlay:function(e){var t=e;interaction_view.currentPage=e;var i=interaction_view.ipagelist.getPage(interaction_view.currentPage);i.get("loaded")&&interaction_view.imasterlist.at(0).get("loaded")&&interaction_view.ibackgroundlist.at(0).get("loaded")?(interaction_view.playstatus="play",interaction_view.containment.find("#jswait-loading").remove(),interaction_view.android?window.setTimeout(function(){interaction_view.play(t)},50):interaction_view.play(t)):(!interaction_view.containment.has("#jswait-loading").length>0&&interaction_view.containment.jswait&&interaction_view.containment.jswait(),interaction_view.playstatus="wait",i.isStartLoad||interaction_view.ipagelist.getPage(i.id)&&presentation.pageLoad(i.id))},onSlideChangeStart:function(e){Reveal.options.slidePlay(e),Reveal.played=e,interaction_view.ismobile&&window.setTimeout(function(){presentation.preloadFourDirections()},0)},onStopPlay:function(e){interaction_view.pausePlay(e)},onContinuePlay:function(e){interaction_view.continuePlay(e)},onSlideChange:function(e,t){Reveal.lockAction=!1;var i=t;interaction_view.stopPlay(i),Reveal.played!=e&&(Reveal.options.slidePlay(e),interaction_view.ismobile&&window.setTimeout(function(){presentation.preloadFourDirections()},0)),Reveal.played=null,interaction_view.ismobile&&window.setTimeout(function(){presentation.clearPreloadPages()},0),interaction_view.hasArrow&&!interaction_view.continuous&&Reveal.isLast()?($(".master_arrow_icon").hide(),interaction_view.hideArrow=!0):interaction_view.hideArrow&&($(".master_arrow_icon").show(),interaction_view.hideArrow=!1),e_api.event.trigger("page_changed",e)},onKeyboard:function(){interaction_view.transitionPagePreLoad=null},onWheel:function(){interaction_view.transitionPagePreLoad=null},canDrag:function(e){return 0!=$(e.target).closest(".disableDragX").length&&0!=$(e.target).closest(".disableDragY").length&&0==$(e.target).closest(".dragConnector").length?!1:!0},canDragX:function(e){if(0!=$(e.target).closest(".disableDragX").length){if($(e.target).closest(".disableDragX").hasClass("is_exceededX"))return!0;var t=$(e.target).closest(".dragConnector.disableDragX").data("dragfuncs");return t&&t.length&&(connector.dragcontroller($(e.target).closest(".dragConnector.disableDragX"),e,t,0),e.gesture.preventDefault()),!1}return!0},canDragY:function(e){if(0!=$(e.target).closest(".disableDragY").length){if($(e.target).closest(".disableDragY").hasClass("is_exceededY"))return!0;var t=$(e.target).closest(".dragConnector.disableDragY").data("dragfuncs");return t&&t.length&&(connector.dragcontroller($(e.target).closest(".dragConnector.disableDragY"),e,t,1),e.gesture.preventDefault()),!1}return!0},canDragEnd:function(e){var t=$(e.target).closest(".dragConnector").data("dragfuncs");t&&t.length&&connector.dragcontroller($(e.target).closest(".dragConnector"),e,t)},checkSlidePermission:function(e,t,i,n,a){if("left"==i){var r=e.getCurrentSlideId();return interaction_view.control.getLeft(r)?!0:!1}if("right"==i){var r=e.getCurrentSlideId();return interaction_view.control.getRight(r)?!0:!1}return!0},getOverview:function(e){return interaction_view.ipagelist.getPage(e)&&interaction_view.ipagelist.getPage(e).toJSON().nav?interaction_view.ipagelist.getPage(e).toJSON().nav.thumbnail:null}}),interaction_view.ismobile||(interaction_view.presentate=new $.presentate(!0)),window.emulateLandscape.refresh()},interaction_view.init=function(){interaction_view.PluginLoaded||(interaction_view.PluginLoaded=!0,interaction_view.PluginManage.init()),interaction_view.forpreview?interaction_view.containment=$(".interaction-preview"):interaction_view.containment=$("body"),
presentation.forpreview(),presentation.screencontrol(),_e.preloadpage&&_e.preloadpage.init(),window.iPageDirection="landscape";var e=require("interaction_view/model/doc");if(interaction_view.doc=new e({id:"doc"}),"undefined"!=typeof cbt_data||"undefined"!=typeof epub360_book_data){interaction_view.forpreview||(interaction_view.isPack=!0);var t;workEnd("-------- 1. touchinit 1 page list start --------"),"undefined"!=typeof epub360_book_data?(t=interaction_view.doc.parse(epub360_book_data),workEnd("-------- 1.1 touchinit 1 page parse --------")):t=interaction_view.doc.parse(cbt_data),interaction_view.doc.set(t),workEnd("-------- 1. touchinit 2 page list ready --------"),"false"==_g.getUrlParameterByName("autoplay")?interaction_view.wait():interaction_view.start(),workEnd("-------- 1. touchinit 3 interaction_view.start end --------")}else interaction_view.doc.fetch({success:function(e,t){"false"==_g.getUrlParameterByName("autoplay")?interaction_view.wait():interaction_view.start()}})}}};return e}),define("interaction_view/ui/timeline",["interaction_view/model/base"],function(){interaction_view.timeline={render:function(e){(epub360.isV2||epub360.variable.isV2)&&(e.timelines=[],e.iOverlaylist.each(function(t){var i=t.get("iAnis");if(i.length&&!t.iAnimationlist){t.iAnimationlist=new interaction_view.collection.Animation,t.iAnimationlist.pageid=e.id;for(var n=[],t=0;t<i.length;t++){var a=$.extend(!0,{},i[t]);a.id=_g.uuid(4),a.iKind||(a.iKind=0),a.pageid=e.id,n.push(a)}t.iAnimationlist.reset(n),e.timelines.push(t.iAnimationlist)}}))},setPlay:function(e){e.timelines&&e.timelines.length&&_.each(e.timelines,function(e){e.setParams(),e.setPlay()})},play:function(e){e.timelines&&e.timelines.length&&_.each(e.timelines,function(e){e.timeline.play(0,!1)})}}}),define("interaction_view/ui/expression",["interaction_view/model/base"],function(){interaction_view.expression={Reg:[/\@/g,/\$/g],Regs:[/\@[^\@]+\@/g,/\$[^\$]+\$/g],Spliter:".",isVar:function(e){e+="";var t=e.match(this.Regs[0])||e.match(this.Regs[1])||e.match(/[\+\-\*\/\>\=\<\!]/g);if(!t){var i=e.match(/\d+/g);return i&&1==i.length&&i[0]==e}return t},id2values_db:function(text){if(!this.isVar(text))return text;var view=this;text=""+text;var ids=text.match(view.Regs[1]);return eval(text)},id2value_db:function(e,t){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[1],"");var i=e.substr(2),n=i.match(this.Regs[0]);if(null!=n)for(var a=0;a<n.length;a++)this.id2value(n[a],function(e){i=i.replace(n[a],e)});var r=i.split(this.Spliter),o="";switch(r.length){case 2:o=this.getRule(i,t);break;case 3:o=this.getLine(i,t);break;case 4:o=this.getFields(i,t)}return o},id2values:function(text,callback,opts){if(opts||(opts={}),!this.isVar(text)&&!opts.force_compute){if('""'===text&&(text=""),text&&text.indexOf&&0===text.indexOf("e_api"))try{var v=eval(text);text=v}catch(e){}return callback&&callback(text),opts._promise&&opts._promise.done(),text}opts.$contentGridRow&&(this.$contentGridRow=opts.$contentGridRow);var view=this;text=""+text;var ids_var=text.match(view.Regs[0]),funs=[],text_ids=[];if(!opts.noDb){var ids_db=text.match(view.Regs[1]);if(null!=ids_db)for(var func_db=function(e){var t=new promise.Promise;return view.id2value_db(e,function(e){"object"==typeof e&&t.done(e&&e.statusText),_.isNaN(e)&&t.done(e),""===e&&t.done(null,""),e=interaction_view.parseVar(e),t.done(null,e)}),t},i=0;i<ids_db.length;i++){var v=ids_db[i];funs.push(func_db(v)),text_ids.push(v)}}if(null!=ids_var)for(var func_var=function(e){var t=new promise.Promise;return view.id2value(e,function(e){t.done(null,e)}),t},j=0;j<ids_var.length;j++){var m=ids_var[j];funs.push(func_var(m)),text_ids.push(m)}if(funs.length)promise.join(funs).then(function(results){for(var err=[],r=0;r<results.length;r++)if(results[r]){var v=results[r][1];null!=results[r][0]?err.push(results[0]):(""===v&&text!=text_ids[r]&&(v='""'),text=text.replace(text_ids[r],v))}if(err.length)return callback&&callback(),void(opts._promise&&opts._promise.done());try{""===text||(opts.no_compute||(text=eval(text)),_.isString(text)&&("'"==text[0]&&"'"==text[text.length-1]||'"'==text[0]&&'"'==text[text.length-1])&&(text=text.substr(1,text.length-2)),text&&text.replace&&(text=text.replace(/_epub_br_/g,"\n"))),callback&&callback(text),err.length>0?opts._promise&&opts._promise.done():opts._promise&&opts._promise.done()}catch(e){console.log(e),text&&text.replace&&(text=text.replace(/<br>+/g,"\n").replace(/"+/g,"'").replace(/<\/div><div>/g,"\n").replace(/<div>/g,"").replace(/<\/div>/g,"").replace(/'/g,""),text=text.replace(/_epub_br_/g,"\n")),callback&&callback(text),opts._promise&&opts._promise.done()}});else{if(!opts.no_compute)try{text=eval(text)}catch(err){}if(_.isString(text)&&("'"==text[0]&&"'"==text[text.length-1]||'"'==text[0]&&'"'==text[text.length-1])&&(text=text.substr(1,text.length-2)),text&&text.indexOf&&0===text.indexOf("e_api"))try{var v=eval(text);text=v}catch(e){}callback&&callback(text),opts._promise&&opts._promise.done()}return text},id2value:function(e,t){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[0],"");var i=e.indexOf("_"),n=e.substr(0,i),a=e.substr(i+1),r="";switch(n){case"s":r=this.getSystemVar(a);break;case"u":r=this.getUserInfo(a);break;case"g":r=this.getGlobal(a);break;case"m":r=this.getMasterElValue(a);break;case"b":r=this.getBackgroundElValue(a);break;case"p":r=this.getPageElValue(a);break;case"l":r=this.getLayerElValue(a);break;case"v":r=this.getVote(a);break;case"z":r=this.getZhuli(a);break;case"f":r=this.getForm(a);break;case"c":r=this.getConfigElValue(a);break;case"c0":case"c1":case"c2":r=this.getContentGrid(n,a);break;case"il":r=this.getInsideLayerElValue(a);break;case"h":r=this.getHtmlControl(e);break;default:r=this.getOld(e)}return""===r?(t&&t(r),r):(r=interaction_view.parseVar(r),t&&t(r),r)},getSystemVar:function(e){switch(e){case"time":return(new Date).toLocaleString();case"countnum":return interaction_view.forpreview?123:"undefined"!=typeof wx_config&&wx_config.countnum?wx_config.countnum:0;case"orientation_x":return _e.orientation?_e.orientation.x:0;case"orientation_y":return _e.orientation?_e.orientation.y:0;case"orientation_z":return _e.orientation?_e.orientation.z:0;case"pagenumber":if(!interaction_view.foredit)return interaction_view.ipagelist.getPages().indexOf(interaction_view.ipagelist.getPage(interaction_view.currentPage));if("Page"==interaction.doc.mode)return iPagelist.getPages().indexOf(iPagelist.getPage(interaction_view.currentPage));global.message("warning","请使用预览全部模式预览该功能");case"messagelink":if(!interaction_view.foredit)return"undefined"!=typeof message_link?message_link:"";global.message("warning","请使用预览全部模式预览该功能")}return""},getPagePath:function(e){if("undefined"==typeof e)return null;e=""+e,e=e.replace(this.Reg[0],"");var t=e.indexOf("_"),i=e.substr(0,t),n=e.substr(t+1);if(_.include(["p","m","b","h","c"],i)){var a=n.split(this.Spliter),r={type:i,page_id:a[0],element_id:a[1]};return"h"==i&&(r.dom_id=a[2]),r}return null},getUserInfo:function(e){switch(e){case"openid":return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.openid?epub360_userinfo.openid:"";case"uid":return"81234671";case"name":return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?epub360_userinfo.nickname:"user1";case"portrait":return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.portrait?epub360_userinfo.portrait:"http://qty83k.creatby.com/materials/origin/9fb6a5037931d82e0841933fdd983eba_origin.png"}return""},getGlobalEl:function(e){var t=interaction_view.globallist.where({id:e})[0];return t},getGlobal:function(e){var t=interaction_view.globallist.where({id:e})[0];return t?0==t.attributes.iDetail.iKind||2==t.attributes.iDetail.iKind?Number(t.attributes.iDetail.initial):String(t.attributes.iDetail.initial):""},getMasterEl:function(e){var t=e.split(this.Spliter),i=interaction_view.imasterlist.where({id:t[0]})[0];return i.iOverlaylist.where({id:t[1]})[0]},getMasterElValue:function(e){var t=e.split(this.Spliter),i=interaction_view.imasterlist.where({id:t[0]})[0];return i?this.getOverlayValue(i,t[1]):""},getBackgroundEl:function(e){var t=e.split(this.Spliter),i=interaction_view.ibackgroundlist.where({id:t[0]})[0];return i.iOverlaylist.where({id:t[1]})[0]},getBackgroundElValue:function(e){var t=e.split(this.Spliter),i=interaction_view.ibackgroundlist.where({id:t[0]})[0];return i?this.getOverlayValue(i,t[1]):""},getPageEl:function(e){var t=e.split(this.Spliter),i=interaction_view.ipagelist&&interaction_view.ipagelist.getPage(t[0]);return i?i.iOverlaylist.where({id:t[1]})[0]:null},getPageElValue:function(e){var t=e.split(this.Spliter),i=interaction_view.ipagelist&&interaction_view.ipagelist.getPage(t[0]);return i?this.getOverlayValue(i,t[1]):""},getLayerElValue:function(e){var t=e.split(this.Spliter),i=interaction_view.ipagelist&&interaction_view.ipagelist.getPage(t[0]);if(i){var n=i.iOverlaylist.where({id:t[1]})[0];if(n){var a=n.layer[t[2]];if(a){var r=a.iOverlaylist.get(t[3]);if(r)return interaction_view.expression.getElValueByType(r)}}}return""},getLayerEl:function(e){var t=e.split(this.Spliter),i=interaction_view.ipagelist&&interaction_view.ipagelist.getPage(t[0]);if(i){var n=i.iOverlaylist.where({id:t[1]})[0];if(n){var a=n.layer[t[2]];if(a){var r=a.iOverlaylist.get(t[3]);if(r)return r}}}return null},getConfigEl:function(e){if(void 0!=typeof configpage&&configpage.page){var t=e.split(this.Spliter),i=configpage.page.iOverlaylist.where({id:t[1]})[0];return i}return null},getConfigElValue:function(e){if(void 0!=typeof configpage&&configpage.page){var t=e.split(this.Spliter);return this.getOverlayValue(configpage.page,t[1])}return""},getOverlayValue:function(e,t,i){i||(i={});var n=e.iOverlaylist.where({id:t})[0];return n||(n={attributes:e.attributes.overlays.filter(function(e){return e.id==t})[0]}),interaction_view.expression.getElValueByType(n,i)},getAnimationEl:function(e){var t=e.split(this.Spliter),i=interaction_view.getPage(t[0]);return i?i.iAnimationlist.where({id:t[1]})[0]:null},returnTimerParam:function(e){var t=e.toJSON().iDetail,i=t.iKind,n="";if(e.iview&&e.iview.$el.find(".iTimer").length){if(1==i)return-1!=String(t.initial-t.currentTime).indexOf(".")?Number(t.initial-t.currentTime).toFixed(3):Number(t.initial-t.currentTime)||0;if(0==i)return-1!=String(t.currentTime).indexOf(".")?Number(t.currentTime).toFixed(3):Number(t.currentTime)||"";if(n=e.iview.$el.find(".iTimer").html()||"",""==n)return;return interaction_view.Html2Txt(n)}},getVote:function(e){var t=this.isVote(e);return t?this.getVoteVal(t):0},getVoteVal:function(e){var t=e.item[0],i=e.item[0].attributes.iDetail,n=parseInt(i.initial);return""==e.ext||""!=e.ext&&"position"!=e.ext&&"voted"!=e.ext?n=t.get("value")||parseInt(i.initial):"position"==e.ext?n=t.get("position")||0:"voted"==e.ext&&(n=t.get("voted")||0),n},isVote:function(e){var t,i;return t=e.split("_"),i=t.length>1?t[1]:"",t.length>1&&["position","voted"].indexOf(i)>-1&&(e=t[0]),item=_.filter(interaction_view.environment.Votes.collection,function(t){return t.id==e}),item.length?{item:item,ext:i}:!1},getZhuli:function(e){switch(e){case"identity":if("undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname)return interaction_view.environment.Shareapp.usertype();case"count":if("undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname)return interaction_view.environment.Shareapp.total();case"initiater":"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname&&(2==interaction_view.environment.Shareapp.status?1:0)}return""},getForm:function(e){var t=interaction_view.application.getFormFieldValue(e);return null!=t?t:""},getContentGrid:function(e,t){var i=t.split(this.Spliter),n="",a=interaction_view.ipagelist.getPage(i[0])||interaction_view.ibackgroundlist.where({id:i[0]})[0]||interaction_view.imasterlist.where({id:i[0]})[0]||interaction_view.ilayerlist.where({id:i[0]})[0];if(a){var r=a.iOverlaylist.where({id:i[1]})[0]||a.overlays.filter(function(e){return e.id==i[1]})[0];if(r)switch(e){case"c0":var o=this.$contentGridRow.data("variables"),s=_.find(o,function(e){return e.id==i[2]});s&&(n=s.initial);break;case"c1":var l=this.$contentGridRow.find("[es-id="+i[2]+"]");l.length&&(_.include(["div"],l[0].tagName.toLowerCase())?n=l.css("background-image")&&l.css("background-image").substr(4,l.css("background-image").length-5)||"":_.include(["img"],l[0].tagName.toLowerCase())?n=l.attr("src"):_.include(["h1","h2","h3","h4","h5","h6","p"],l[0].tagName.toLowerCase())&&(n=l.text()));break;case"c2":n=this.$contentGridRow.data("value")[i[2]]}}return n},getInsideLayerEl:function(e){var t=e.split(this.Spliter);return this.InsideLayerRange?this.InsideLayerRange.iOverlaylist.where({id:t[1]})[0]:void 0},getInsideLayerElValue:function(e){var t=e.split(this.Spliter);return this.InsideLayerRange?this.getOverlayValue(this.InsideLayerRange,t[1]):void 0},getHtmlControl:function(e){var t=interaction_view.expression.getPagePath(e),i=interaction_view.ipagelist.getPage(t.page_id)||interaction_view.ibackgroundlist.where({id:t.page_id})[0]||interaction_view.imasterlist.where({id:t.page_id})[0]||interaction_view.ilayerlist.where({id:t.page_id})[0];if(i){var n=i.iOverlaylist.where({id:t.element_id})[0]||i.overlays.filter(function(e){return e.id==t.element_id})[0],a=_.find(n.attributes.iDetail.structure,function(e){return e.id==t.dom_id});if(a){var r=n.iview.$el.find("[es-id="+a.id+"]");if("文本"==a.type)return r.text();if("图片"==a.type)return r.attr("src");if("背景图片"==a.type)return r.css("background-image")&&r.css("background-image").substr(4,r.css("background-image").length-5)||""}}},getOld:function(e){switch(e){case"助力_用户身份":return this.getZhuli("identity");case"助力_助力数":return this.getZhuli("count");case"助力_是否发起":return this.getZhuli("initiater");case"微信_用户昵称":return this.getUserInfo("name")}var t=this.isVote(e);if(t)return this.getVoteVal(t);var i=interaction_view.ibackgroundlist.at(0).iOverlaylist.where({id:e})[0];if(i)return this.getOverlayValue(interaction_view.ibackgroundlist.at(0),e);if(i=interaction_view.imasterlist.at(0).iOverlaylist.where({id:e})[0])return this.getOverlayValue(interaction_view.imasterlist.at(0),e);var n=interaction_view.ipagelist.getPage(interaction_view.currentPage);return(i=n.iOverlaylist.where({id:e})[0])?this.getOverlayValue(n,e):""},getRule:function(e,t){if(0==interaction_view.dblist.length||!interaction_view.dblist.get(e.split(this.Spliter)[0]))return console.log("表组件 "+e.split(this.Spliter)[0]+" 不存在"),t&&t(""),"";var i=interaction_view.dblist.get(e.split(this.Spliter)[0]).get("sheet_id"),n=e.split(this.Spliter)[1],a=new DB.DBObject(i),r=a.getTableRules(i);switch(n){case"START":n="startTime";break;case"END":n="endTime";break;case"VALID":n="time_status";break;case"NUMS":n="can_save_nums";break;case"RULE":n="rule"}t&&t(r[n])},getLine:function(e,t){var i=this.getBasic(e);i||t&&t("");var n=new window.dboperate;if("COUNT"==e.split(this.Spliter)[2])if("0"==i.type||void 0==i.type)n.uploadQuery({value:i.queryValue,table_id:i.tableId,db_id:i.dbId,option:e.split(this.Spliter)[2]},t);else if("1"==i.type)if(epub360.dbs[i.dbId].query[i.queryId]){var a=epub360.dbs[i.dbId].query[i.queryId].list;t(a.length)}else t("0")},getFields:function(id,callback){var basic=this.getBasic(id);basic||callback&&callback("");var field=id.split(this.Spliter)[2],opera=id.split(this.Spliter)[3],dboperate=new window.dboperate,type=basic.type;if(void 0==type&&(type="0"),"MAX"==opera||"MIN"==opera||"SUM"==opera||"RANDOM"==opera){var _a=new DB.DBAggregate("table_id");switch(opera){case"MAX":_a.max(field);break;case"MIN":_a.min(field);break;case"SUM":_a.sum(field);break;case"RANDOM":_a.random(field)}dboperate.uploadQuery({value:basic.queryValue,table_id:basic.tableId,db_id:basic.dbId,agg:_a,option:opera},callback)}else if(null!=opera.match(/v_\[(.*)\]/)){var value=opera.match(/v_\[(.*)\]/)[1],result=value.split("=")[1],key=value.split("=")[0];if(result.match(/[\+\-\*\/\>\=\<\!]/g))try{result=eval(result)}catch(e){}if("LINENUMBER"==key){if("0"==type)dboperate.uploadQuery({value:basic.queryValue,table_id:basic.tableId,db_id:basic.dbId,option:opera,start:result-1,field:field},callback);else if("1"==type)if(epub360.dbs[basic.dbId].query[basic.queryId]){var _list=epub360.dbs[basic.dbId].query[basic.queryId].list;_list.length>=result?callback(_list.at(result-1).get(field)):callback()}else callback()}else if("ID"==key)try{if(result=eval(result),"0"==type)-1!=field.indexOf("|")?dboperate.uploadQuery({value:basic.queryValue,table_id:basic.tableId,db_id:basic.dbId,option:opera,id:result,join:field},callback):dboperate.uploadQuery({value:basic.queryValue,table_id:basic.tableId,db_id:basic.dbId,option:opera,id:result,field:field},callback);else if("1"==type)if(epub360.dbs[basic.dbId].query[basic.queryId]){var _list=epub360.dbs[basic.dbId].query[basic.queryId].list;_list.get(result)?callback(_list.get(result).get(field)):callback()}else callback()}catch(e){callback()}}},getBasic:function(e){var t=e.split(this.Spliter)[0];if(0==interaction_view.dblist.length||!interaction_view.dblist.get(t))return console.log("表组件 "+t+" 不存在"),"";for(var i,n,a,r=e.split(this.Spliter)[1],o=interaction_view.dblist.get(t).get("sheet_id"),s=0;s<interaction_view.dblist.get(t).get("querys").length;s++){var l=interaction_view.dblist.get(t).get("querys")[s];r==l.id&&(i=l,a=l.type)}return n={dbId:t,queryId:r,tableId:o,queryValue:i,type:a}},getFieldstype:function(e){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[1],"");var t,i=e.substr(2),n=i.split(this.Spliter),a=n.pop();return a=-1==a.indexOf("|")?a:a.split("|")[1],t="phone"==a?2:"p"==a.substr(0,1)||"weixin_avatar"==a?4:2},transferId:function(e,t){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[0],"");var i=e.indexOf("_"),n=e.substr(0,i),a=e.substr(i+1),r=this;switch(n){case"g":r.setGlobal(a,t);break;case"p":r.setVar(a,t);break;case"m":r.setVar(a,t);break;case"b":r.setVar(a,t);break;case"c":r.setVar(a,t)}},setGlobal:function(e,t){var i=interaction_view.globallist.get(e);if(!_.isUndefined(t)){var n,a=t;if(0==i.attributes.iDetail.iKind){var r=i.get("iDetail").precision;if(_.isNaN(Number(a)))a=a;else{var o=Number(a);o>0&&a[0]&&"0"===a[0]||(a=(Number(o)||0).toFixed(Number(r)||0))}}n=i.attributes.iDetail.initial,i.attributes.iDetail.initial=a,"ShareVariable"==i.attributes.iType&&String(n)!=String(a)&&(message_link=_g.changeURLPar(message_link,e,t),interaction_view.weixin.share())}},setVar:function(e,t,i){var n=e.split(this.Spliter);if(!_.isUndefined(t)){var a=interaction_view.getPage(n[0]);if(a){var r=a.iOverlaylist.get(n[1]);r&&(r.iview.setVariable?r.iview.setVariable("",t):r.iview.updateText?r.iview.updateText(t,addtourl=0):("ImageBlock"==r.get("iType")||"Image"==r.get("iType"))&&r.iview.replaceImg(t))}}},setLayerVar:function(e,t,i){var n=this.getLayerEl(e);n&&(n.iview.setVariable?n.iview.setVariable("",t):n.iview.updateText?n.iview.updateText(t,addtourl=0):("ImageBlock"==n.get("iType")||"Image"==n.get("iType"))&&n.iview.replaceImg(t))},setAssignment:function(e,t,i){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[0],""),i=i.results[0];var n=this,a=e.indexOf("_"),r=e.substr(0,a),o=e.substr(a+1);if(-1!=t.indexOf("|")){if(0==interaction_view.dblist.length||!interaction_view.dblist.get(t.split(".")[0]))return console.log("表组件 "+t.split(".")[0]+" 不存在"),"";t=t.replace("|","."),t=t.replace(t.split(".")[0],interaction_view.dblist.get(t.split(".")[0]).get("sheet_id"))}switch(r){case"p":n.setVar(o,i[t],!0);break;case"g":n.setGlobal(o,i[t]);break;case"m":n.setVar(o,i[t]);break;case"b":n.setVar(o,i[t]);break;case"c":n.setVar(o,i[t])}},setValue:function(e,t){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[0],"");var i=this,n=e.indexOf("_"),a=e.substr(0,n),r=e.substr(n+1);switch(a){case"p":i.setVar(r,t,!0);break;case"g":i.setGlobal(r,t);break;case"m":i.setVar(r,t);break;case"b":i.setVar(r,t);break;case"c":i.setVar(r,t);break;case"l":i.setLayerVar(r,t)}},doCondition:function(e,t){t&&t.$dom&&(this.$contentGridRow=t.$dom);var i=new promise.Promise;return interaction_view.expression.id2values(e,function(e){i.done(e)}),i},getDataById:function(e,t,i,n){if(0==interaction_view.dblist.length||!interaction_view.dblist.get(e))return console.log("表组件 "+e+" 不存在"),n&&n(""),"";var a=interaction_view.dblist.get(e).get("sheet_id"),r=new window.dboperate,o={value:{id:t,name:"全部",scope:0,filter:[{key:"",value:""},{key:"",value:""}],op:0,sort:{field:"created",order:-1},fetch_fields:"",type:"0"},table_id:a,db_id:e,id:i};r.uploadQuery(o,n)},getFieldValue:function(e,t){var i=this.idToObject(e);if(-1!=i.indexOf("|")){var n=i.split("|"),a=n[0],r=n[1];if(0==interaction_view.dblist.length||!interaction_view.dblist.get(a))return console.log("表组件 "+a+" 不存在"),"";i=interaction_view.dblist.get(a).get("sheet_id")+"."+r}var o=t[i];return o=interaction_view.parseVar(o)},idToObject:function(e){e=e.replace("$d_","").replace("$","");var t=e.split(".");return t[t.length-1]},getElByEid:function(e){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[0],"");var t,i=e.indexOf("_"),n=e.substr(0,i),a=e.substr(i+1);switch(n){case"s":break;case"u":break;case"g":t=this.getGlobalEl(a);break;case"m":t=this.getMasterEl(a);break;case"b":t=this.getBackgroundEl(a);break;case"p":t=this.getPageEl(a);break;case"l":t=this.getLayerEl(a);break;case"v":break;case"z":break;case"f":break;case"c":t=this.getConfigEl(a);break;case"c0":case"c1":case"c2":break;case"il":t=this.getInsideLayerEl(a);break;case"h":break;case"pani":case"mani":case"bani":t=this.getAnimationEl(a)}return t},getElStatus:function(e){if("string"==typeof e){var t,i=""+e;i=i.replace(this.Reg[0],"");var n=i.indexOf("_"),a=i.substr(0,n),r=i.substr(n+1);switch(a){case"s":break;case"u":break;case"g":return 2;case"m":return 2;case"b":return 2;case"p":var t=r.split(this.Spliter);if(interaction_view.currentPage&&interaction_view.currentPage==t[0])return 2;var o=interaction_view.getPage(t[0]);return o?o.attributes.loaded?1:0:-1;case"l":value=this.getLayerEl(t);break;case"v":return-1;case"z":return-1;case"f":return-1;case"c":return 2;case"c0":case"c1":case"c2":break;case"il":return 2;case"h":}return-1}},getElValue:function(e){var t=e;return"string"==typeof e&&(t=interaction_view.expression.getElByEid(e)),interaction_view.expression.getElValueByType(t)},getElValueByType:function(e,t){if(t||(t={}),!e||!e.attributes)return"";switch(e.attributes.iType){case"Variable":return 0==e.attributes.iDetail.iKind||2==e.attributes.iDetail.iKind?Number(e.attributes.iDetail.initial):String(e.attributes.iDetail.initial);case"Paragraph":if(e.iview){var i="";return e.iview.$el.find(".iText .iContent").length?i=e.iview.$el.find(".iText .iContent").html()||"":e.iview.$el.find(".iText").length&&(i=e.iview.$el.find(".iText").html()||""),""==i?"":interaction_view.Html2Txt(i)}return"";case"Input":return e.iview&&e.iview.$el.find("input").val()||"";case"Textarea":var n=e.iview&&e.iview.$el.find("textarea").val()||"";return t.raw?n:n.replace(/\n/g,"_epub_br_");case"ImageBlock":case"Image":return interaction_view.getImgSrc(e.iview.$el);case"Select":return e.iview&&e.iview.$el.find("select").val()||"";case"Palette":return e.iview&&e.iview.$el.find("canvas")[0].toDataURL();case"Gyroscope":return e.iview&&e.iview.model.value;case"ButtonGroup":return e.iview&&e.iview.getButtonGroupValue();case"QuizGroup":return e.iview&&e.iview.getButtonGroupValue();case"Timer":return this.returnTimerParam(e)}},setElValueByEid:function(e,t,i){}}}),define("interaction_view/ui/pluginmanage",["interaction_view/model/base"],function(){interaction_view.PluginManage={Actions:{},ActionExecutes:{},Global:{},init:function(){if(epub360.PlayerPlugins.length){for(var e=[],t=[],i=[],n=[],a=0;a<epub360.PlayerPlugins.length;a++){var r=epub360.PlayerPlugins[a];"actionexecute"==r.type?i.push(r):"action"==r.type?n.push(r):t.push(r)}for(var a=0;a<i.length;a++){var r=i[a];interaction_view.PluginManage.initActionExecute(r)}for(var a=0;a<n.length;a++){var r=n[a];interaction_view.PluginManage.initAction(r)}for(var o=0,a=0;a<t.length;a++)void 0==t[a].order&&(t[a].config.Model?_.find(t,function(e){return e.config.type==t[a].config.Model})?void 0===_.find(t,function(e){return e.config.type==t[a].config.Model}).order?(_.find(t,function(e){return e.config.type==t[a].config.Model}).order=o,o+=1,t[a].order=o,o+=1):t[a].order=o:(t[a].order=o,o+=1):void 0===t[a].order&&(t[a].order=o,o+=1));e=_.sortBy(t,function(e){return e.order});for(var a=0;a<e.length;a++){var s,r=e[a],l=r.config;if(l.category)"global"==l.category&&(interaction_view.view[l.type]=Backbone.View.extend(r));else if(!interaction_view.model[l.type]){var c=interaction_view.PluginManage.parsePluginConfig(l);l.template?(s=_eT[l.template]?_eT[l.template]:l.template,delete l.template):s=_eT.Container,window.funcT["_"+l.type]=_.template(s),interaction_view.PluginManage.initMVC(r,l,c)}}}},initMVC:function(e,t,i){var n=t.Model||"Base";delete t.Model;var a=e.onInitialize;delete e.onInitialize;var r=e.onEpubReady;if(r&&interaction_view.events.epub360StartEvents.push(r),delete e.onEpubReady,interaction_view.view[t.type]=interaction_view.view[n].extend(_.omit(e,"config")),t.model_object)var o=$.extend({},{defaults:i,setcollection:function(){},onInitialize:a},t.model_object);else var o={defaults:i,setcollection:function(){},setview:function(e){this.iview=new interaction_view.view[t.type]({model:this})},onInitialize:a};interaction_view.model[t.type]=interaction_view.model[n].extend(o)},parsePluginConfig:function(e){var t={iCommon:{},iDetail:{},iParentdiv:".interaction-view"};if(e.defaults&&(t=_.extend({},t,e.defaults),delete e.defaults),t.iType=e.type,e.actions&&e.actions.length)for(var i=0;i<e.actions.length;i++){var n=e.actions[i];interaction_view.PluginManage.Actions[n.type]||(interaction_view.PluginManage.Actions[n.type]=n.func)}return t},initAction:function(e){delete e.type;var t=e.config;interaction_view.PluginManage.Actions[t.type]=e.config.func},initActionExecute:function(e){delete e.type;var t=e.config;interaction_view.PluginManage.ActionExecutes[t.type]=e.config}}}),define("interaction_view/ui/transform",["interaction_view/model/base"],function(){interaction_view.transform={update:function(e,t,i,n){var a={};for(var r in e)e[r]===+e[r]&&(a[r]=e[r]);var o=a.init_rotation||0,s=a.rotationX||0,l=a.rotationY||0,c=a.skewX||0,d=a.skewY||0,h=(a.originX===+a.originX?a.originX:50)+"%",u=(a.originY===+a.originY?a.originY:50)+"%";CSSMatrix.setTransform(t,{rotation:o,rotationX:s,rotationY:l,transformPerspective:"600",skewX:c,skewY:d},{force3D:interaction_view.force3D}),i?TweenMax.set(t,{transformOrigin:h+" "+u,force3D:interaction_view.force3D}):$(t).css("transform-origin",h+" "+u),n&&$(t).css(n)},setState:function(e,t,i){if(i||(i={}),t.position){var n=e.iview.$el;i.duration?(t.position.ease=t.position.ease||i.ease,t.position.immediateRender=!1,t.position.onComplete=i.callback,t.position.force3D=interaction_view.force3D,i.onUpdate&&(t.position.onUpdate=i.onUpdate,t.position.onUpdateParams=i.onUpdateParams),TweenMax.to(n,i.duration,t.position)):(t.position.oper?(delete t.position.oper,TweenMax.set(n,t.position)):CSSMatrix.setTranslate(n,t.position.x,t.position.y),i.onUpdate&&i.onUpdate(i.onUpdateParams[0]),i.callback&&i.callback())}if(t.transform){var a=e.iview.wrap_el?e.iview.wrap_el[0]:e.iview.$el.children(".Element")[0];i.duration?(t.transform.ease=t.transform.ease||i.ease,t.transform.immediateRender=!1,t.transform.onComplete=i.callback,TweenMax.to(a,i.duration,t.transform)):(TweenMax.set(a,t.transform),i.callback&&i.callback())}if(t.size){var r,o=e.iview.$el.children(".Element"),s={size:{}};if(0===t.size.width||t.size.width?(t.size.oper_w?(t.size.left=t.size.oper_w+"="+t.size.w/2,delete t.size.oper_w,delete t.size.w,r=!0):t.size.left=-t.size.width/2,s.size.width=t.size.width):delete t.size.width,0===t.size.height||t.size.height?(t.size.oper_h?(t.size.top=t.size.oper_h+"="+t.size.h/2,delete t.size.oper_h,delete t.size.h,r=!0):t.size.top=-t.size.height/2,s.size.height=t.size.height):delete t.size.height,i.duration?(t.size.ease=t.size.ease||i.ease,t.size.immediateRender=!1,t.size.onComplete=i.callback,t.size.force3D=interaction_view.force3D,TweenMax.to(o[0],i.duration,t.size)):r?TweenMax.set(o[0],t.size):o.css(t.size),"LayerRef"==e.iview.iType||"LayerSlide"==e.iview.iType){var l=e.iview.$el.find(".layer-mask").first();i.duration?(t.size.ease=t.size.ease||i.ease,t.size.immediateRender=!1,t.size.onComplete=i.callback,t.size.force3D=interaction_view.force3D,TweenMax.to(l[0],i.duration,s.size)):r?TweenMax.set(l[0],s.size):l.css(s.size)}}},getState:function(e){var t={};t.position=CSSMatrix.getTranslate(e.iview.$el);var i=e.iview.$el.children(".Element");t.size={width:Number(i.css("width").replace("px","")),height:Number(i.css("height").replace("px",""))};var n=e.iview.wrap_el?e.iview.wrap_el[0]:e.iview.$el.children(".Element")[0];return t.transform=CSSMatrix.getTransform(n),t},getSize:function(e){var t=e.iview.$el.children(".Element"),i={width:Number(t.css("width").replace("px","")),height:Number(t.css("height").replace("px",""))};return i}}}),define("interaction_view/ui/facecompose",["interaction_view/model/base"],function(){interaction_view.face={uploadImg:function(e,t,i){var n=e.model.get("iDetail"),a=n.results[0].face;if(a){var r=a.imgsource;switch(r){case"1":this.getFromComponent(a,t,i);break;case"2":this.getFromLocal(a,t,i)}}},getFromComponent:function(e,t,i){var n=e.imgselect;if(n){var a=this;interaction_view.expression.id2values(n,function(r){if(r){var o=interaction_view.expression.getElByEid(n),r=o.get("iDetail").iImg[0];a.getFaceImg({image_url:r.picture},e,t,i)}})}},getFromLocal:function(e,t,i){var n=this;interaction_view.isWeixin&&"undefined"!=typeof wx_permissions&&wx_permissions.chooseImage?interaction_view.weixin.chooseimage(function(a){if(a&&a[0]){interaction_view.localIds=a;var r=a[0];wx.getLocalImgData({localId:r,success:function(a){var r,o=a.localData;if(interaction_view.isIos?(o=o.replace("jgp","jpeg"),r=_g.fileapi.base64urltoBase64(o)):r=o,r){var s=_g.fileapi.b64toBlob({b64Data:r});n.getFaceBy64({blob:s},e,t,i)}}})}}):this.desktop_faceUpload(e,t,i)},getFaceImg:function(e,t,i,n){var a=this;e&&$.ajax({url:context_url+"faced",data:e,type:"POST",success:function(e){if(200==e.code){var r=e.data.results[0];a.isNoFace(r,n)||a.compose(r,t,i)}else interaction_view.errorAlert(e.msg),n&&n()},error:function(e){interaction_view.errorAlert("获取/上传 图片失败"),n&&n()}})},getFaceBy64:function(e,t,i,n){var a=context_url+"faced",r=this;_g.fileapi.sendBinary({blob:e.blob,url:a,filekey:"image",filename:"base64图片"+_g.uuid(1),callback:function(e){if(200==e.code){var a=e.data.results[0];r.isNoFace(a,n)||r.compose(a,t,i)}else interaction_view.errorAlert(e.msg),n&&n()},onFail:function(){interaction_view.errorAlert("获取/上传 图片失败"),n&&n()}})},compose:function(e,t,i,n){var a=t.imagerelate,r=t.agerelate,o=t.genderrelate,s=t.beautyrelate;return e?(a&&this.imageRelate(e,t,a),r&&this.ageRelate(e.age,r),o&&this.genderRelate(e.gender,o),s&&this.beautyRelate(e.gender,e.beauty,s),void(i&&i())):(interaction_view.errorAlert("没有检测到人脸"),void(n&&n()))},desktop_faceUpload:function(e,t,i){$("#faceimage").length||$("body").append("<input type='file' id='faceimage' name='image' style='display:none;'></input>"),$("#faceimage").click();var n=context_url+"faced",a=this;$("#faceimage").off("change").on("change",function(){_file_change_simple($(this),["jpg","png","bmp","gif","jpeg"],n,function(n){var r=n.results[0];a.isNoFace(r,i)||a.compose(r,e,t)})})},imageRelate:function(e,t,i){var n,a=t.imgidenty||0;switch(a){case"1":n=e.face;break;case"2":n=e.header;break;case"3":n=e.certificate;break;default:n=e.face}if(n.search(/a\-/)>0){var r=n.split("/crop/")[0],o=n.split("/crop/!")[1],s=o.split("a")[0];n=r+"/crop/!"+s}return interaction_view.expression.setValue(i,n),!1},ageRelate:function(e,t){interaction_view.expression.setValue(t,e)},genderRelate:function(e,t){var i;return"Female"==e?i="女":"Male"==e&&(i="男"),i?(interaction_view.expression.setValue(t,i),!0):!1},beautyRelate:function(e,t,i){var n;return"Female"==e?n=t.female_score:"Male"==e&&(n=t.male_score),
void 0!=n?(interaction_view.expression.setValue(i,n),!0):!1},isNoFace:function(e,t){return e?!1:(interaction_view.errorAlert("没有检测到人脸"),t&&t(),!0)}}}),function(){function e(e){if("function"==typeof Event)var t=new Event(e);else{var t=document.createEvent("Event");t.initEvent(e,!0,!0)}window.dispatchEvent(t)}function t(){function t(t){var i=t.gamma,n=o,a=Math.abs(t.beta)<90,r=30;return a&&i>r||!a&&-r>i?o="right":(a&&-r>i||!a&&i>r)&&(o="left"),n!=o&&(n=o,e("orientationchange"),e("resize")),o}function i(){return r.available&&_g.device.mobile()?!0:!1}function n(){var e,t=a.x>a.y;return e=t?0:{left:1,right:3}[o]||1}var a={},r=window.emulateLandscape=function(){function e(){this.degreeCount=0,this.refreshType="refresh",this.refresh=this.refresh.bind(this),this.event=new _g.EventHandler,this.from="none"}return e.prototype={get degree(){return 90*this.degreeCount},get swapped(){return!!(this.degreeCount%2)},get rotated(){return 0!=this.degreeCount},refresh:function(){var e=this,t={};t[this.refreshType]=!0,window.get_window_size?a=window.get_window_size():"object"==typeof interaction&&(a=interaction.size||{}),a.x&&a.y||(a={x:0,y:0,error:!0});var r=this.degreeCount;i()||t.tick?(t.tick?this.degreeCount=(this.degreeCount+1)%4:this.degreeCount=n(),this.degreeCount!=r&&this.event.dispatch()):this.degreeCount=0;var o=Math.abs(r-this.degreeCount);t.tick?this.from="tick":this.from={0:"none",1:"swap",2:"orient",3:"swap"}[o],setTimeout(function(){e.refreshType="refresh"},400)},get available(){return interaction_view&&interaction_view.foredit?interaction.doc.get("force_landscape"):interaction_view?interaction_view.doc.get("force_landscape"):!1},emulatePoint:function(e,t,i){i=Object.assign({size:this.swapped?[a.y,a.x]:[a.x,a.y]},i);var n=i.size[0],r=i.size[1];return[[e,t],[t,r-e],[n-e,r-t],[n-t,e]][this.degreeCount]},emulateDelta:function(e,t){var i=e,n=t;return[[i,n],[n,-i],[-i,-n],[-n,i]][this.degreeCount]},emulateObjectPoint:function(e,t,i,n){var a=this.emulatePoint(e[t],e[i],n);return e[t]=a[0],e[i]=a[1],e},emulateObjectDelta:function(e,t,i){var n=this.emulateDelta(e[t],e[i]);return e[t]=n[0],e[i]=n[1],e},emulateDirection:function(e){for(var t={up:"left",left:"down",down:"right",right:"up"},i=0,n=this.degreeCount;n>i;i++)e=t[e];return e},modHammer:function(e){return this.rotated?(this.emulateObjectDelta(e.gesture,"deltaX","deltaY"),e.type="drag"+this.emulateDirection(e.type.replace(/^drag/,"")),e):e},emulateOrient:function(e,t){var i={},n={90:"left",270:"right",0:"normal"}[window.emulateLandscape.degree],a=e.alpha,r=e.beta,o=e.gamma;return"left"==n?(i.alpha=a-90,i.beta=-o,i.gamma=r):"right"==n?(i.alpha=a+90,i.beta=o,i.gamma=-r):(i.alpha=a,i.beta=r,i.gamma=o),i.alpha=(i.alpha+720)%360,i.beta=(i.beta+180+720)%360-180,i.gamma=(i.gamma+90+720)%180-90,t&&"normal"!=n&&(Object.defineProperties(e,{alpha:{value:i.alpha},beta:{value:i.beta},gamma:{value:i.gamma}}),i=e),i}},new e}();window.addEventListener("resize",r.refresh);var o="left";window.addEventListener("deviceorientation",t),e("deviceorientation")}!function(){function t(t){if(t){var i,n={position:"fixed",color:"#fff","background-color":"#5bc0de","border-color":"#5bc0de",border:"1px solid transparent",padding:".5rem","font-size":"1rem","border-radius":".25rem",right:"0",bottom:"10%",opacity:"0.7","user-select":"none","z-index":"9999999",transform:"translateZ(0)"};i=document.createElement("div"),i.innerHTML="测试<br>横屏<br>旋转",n.bottom="10%",Object.assign(i.style,n),i.addEventListener("touchstart",function(){var t="tick";window.emulateLandscape.refreshType=t,console.warn("forcelandscape dev",t),e("deviceorientation"),e("orientationchange"),e("resize")}),document.body.appendChild(i)}}var i=window.location.host.match(/^test/)&&window.location.pathname.match(/preview$/)&&window.location.href.replace(/^.*\?/,"").split("&").includes("-debug=1");window.manualRotationDevButton=t,t(i)}(),define("interaction_view/ui/force_landscape",["_g/base"],function(){t()})}(),define("interaction_view/ui/statemanage",[],function(){function e(){var e=interaction_view.getCurrentPageModel().iOverlaylist.models;return e.filter(function(e){return"Audio"===e.get("iType")})}function t(e){return e.media.currentTime>0&&e.media.currentTime<e.media.duration&&!e.media.ended&&e.media.readyState>2}function i(){var e=interaction_view.getCurrentPageModel().iOverlaylist.models;return e.filter(function(e){return"StateGroup"===e.get("iType")})}var n={pause:function(){e().forEach(function(e){interaction_view.media.pause(e)}),i().forEach(function(e){e.state.pause()})},continuePlay:function(){e().forEach(function(e){t(e)&&interaction_view.media.play(e)}),i().forEach(function(e){e.state.continuePlay()})},resetPlay:function(){i().forEach(function(e){e.state.resetPlay()})}};return n}),define("interaction_view/ui/util",[],function(){var e={mixDispatch:function(e){if("function"==typeof Event)var t=new Event(e);else{var t=document.createEvent("Event");t.initEvent(e,!0,!0)}window.dispatchEvent(t)}};return e}),function(e){"function"==typeof define&&define.amd?define("coverFlow",["jquery"],e):e(jQuery)}(function(e){if(!e.ui||!e.Widget){e.ui=e.ui||{};var t=0,i=Array.prototype.slice;e.widget=function(t,i,n){var a,r,o,s,l={},c=t.split(".")[0];return t=t.split(".")[1],a=c+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][a.toLowerCase()]=function(t){return!!e.data(t,a)},e[c]=e[c]||{},r=e[c][t],o=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,r,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),s=new i,s.options=e.widget.extend({},s.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},a=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,r=this._superApply;return this._super=e,this._superApply=a,t=n.apply(this,arguments),this._super=i,this._superApply=r,t}}()):void(l[t]=n)}),o.prototype=e.widget.extend(s,{widgetEventPrefix:r?s.widgetEventPrefix||t:t},l,{constructor:o,namespace:c,widgetName:t,widgetFullName:a}),r?(e.each(r._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,o,i._proto)}),delete r._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var n,a,r=i.call(arguments,1),o=0,s=r.length;s>o;o++)for(n in r[o])a=r[o][n],r[o].hasOwnProperty(n)&&void 0!==a&&(e.isPlainObject(a)?t[n]=e.isPlainObject(t[n])?e.widget.extend({},t[n],a):e.widget.extend({},a):t[n]=a);return t},e.widget.bridge=function(t,n){var a=n.prototype.widgetFullName||t;e.fn[t]=function(r){var o="string"==typeof r,s=i.call(arguments,1),l=this;return r=!o&&s.length?e.widget.extend.apply(null,[r].concat(s)):r,o?this.each(function(){var i,n=e.data(this,a);return"instance"===r?(l=n,!1):n?e.isFunction(n[r])&&"_"!==r.charAt(0)?(i=n[r].apply(n,s),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+r+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var t=e.data(this,a);t?(t.option(r||{}),t._init&&t._init()):e.data(this,a,new n(r,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},_on:function(t,i,n){var a,r=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=a=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,a=this.widget()),e.each(n,function(n,o){function s(){return t||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?r[o]:o).apply(r,arguments):void 0}"string"!=typeof o&&(s.guid=o.guid=o.guid||s.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+r.eventNamespace,d=l[2];d?a.delegate(d,c,s):i.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_trigger:function(t,i,n){var a,r,o=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],r=i.originalEvent)for(a in r)a in i||(i[a]=r[a]);return this.element.trigger(i,n),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}()}!function(e,t,i,n){function a(e,t,i,n){var a=this;a.widget=e,a.element=t,a.items=i,a.options=n}function r(e){return parseFloat((.017453*e).toFixed(6))}function o(){e.coverflow.renderer.Classic.apply(this,arguments)}function s(e,t){return typeof e===t}function l(e,t){return!!~(""+e).indexOf(t)}function c(e,t){var i,a;for(i in e)if(a=e[i],!l(a,"-")&&T[a]!==n)return"pfx"===t?a:!0;return!1}function d(t,i,a){var r,o;for(r in t)if(o=i[t[r]],o!==n)return a===!1?t[r]:s(o,"function")?e.proxy(o,a||i):o;return!1}function h(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+P.join(n+" ")+n).split(" ");return s(t,"string")||s(t,"undefined")?c(a,t):(a=(e+" "+E.join(n+" ")+n).split(" "),d(a,t,i))}e.coverflow={renderer:{},support:{}},a.prototype={cssClass:"classic",itemMargin:0,initialize:function(){var t=this,i=t.options,n={},a=t.items.eq(t.widget.currentIndex);t.itemSize=a.width(),t.outerWidth=t.element.parent().outerWidth(!1),t.itemMargin=-Math.floor(i.overlap/2*a.innerWidth()),t.items.css({marginLeft:t.itemMargin,marginRight:t.itemMargin}),n.width=t.items.width()*t.items.length,e.extend(n,t._getCenterPosition()),t.element.css(n)},_getCenterPosition:function(){var e,t=this,i=t.itemSize,n=t.widget.currentIndex;return e=(t.outerWidth-i)/2,e-=n*t.itemSize/2,e+=parseInt(t.element.css("paddingLeft"),10)||0,e-=n*t.itemMargin*2,e-=t.itemMargin,e=Math.round(e),{left:e}},select:function(){return this._getCenterPosition()},getElementTransitionStyles:function(t){var i=e.coverflow.transition[t.easing]||e.coverflow.transition.easeOutQuint;return e.extend(this._getCenterPosition(),{transition:"left "+t.duration+"ms "+i})},refresh:function(t,i,n){var a=this,r=a.options,o=a.items.length,s=a.itemSize,l=a.itemMargin;this.items.each(function(c){var d=c===n&&0>i-n||c-n>0?"left":"right",h=c===n?1-t:c===i?t:1,u={zIndex:o+("left"===d?n-c:c-n)+10},p=1-h*(1-r.scale),f=[p,h*("right"===d?-.15:.15),0,p,0,0];u.left=-c*(s/2)+("right"===d?-s/2+s/2*r.overlap:s/2-s/2*r.overlap)*h,e.coverflow.isOldie&&(c===n?(u.left+=l,u.top=0):u.top=Math.ceil(-l/2)),a._transform(this,u,f),e(this).css(u)})},_transform:function(){var t=this;return e.coverflow.support.transform?void t._matrixTransform.apply(t,arguments):void(e.coverflow.isOldie&&t._fallbackTransform.apply(t,arguments))},_matrixTransform:function(e,t,i){t.transform="matrix("+i.join(",")+")"},_fallbackTransform:function(e,t,i){e.filters["DXImageTransform.Microsoft.Matrix"]||(e.style.filter=(e.style.filter?"":" ")+'progid:DXImageTransform.Microsoft.Matrix(sizingMethod="auto expand")');var n=e.filters["DXImageTransform.Microsoft.Matrix"];n.M11=i[0],n.M12=i[2],n.M21=i[1],n.M22=i[3]}},e.extend(e.coverflow.renderer,{Classic:a}),o.prototype={cssClass:"3d",initialize:function(){var t=this,i={};t.itemSize=t.items.eq(t.widget.currentIndex).outerWidth(!0),t.outerWidth=t.element.parent().outerWidth(!1),i.width=t.itemSize*t.items.length,e.extend(i,t._getCenterPosition(),t._getPerspectiveOrigin()),t.element.css(i)},getItemRenderedWidth:function(){var e=this.options;return Math.cos(r(e.angle))*this.itemSize*e.scale},_getPerspectiveOrigin:function(){var e=this,t=e.options;return{perspectiveOrigin:Math.round(e.itemSize/2+e.widget.currentIndex*e.getItemRenderedWidth()*(1-t.overlap))+"px "+t.perspectiveY+"%"}},_getCenterPosition:function(){var e,t=this,i=t.getItemRenderedWidth(),n=t.widget.currentIndex;return e=(t.outerWidth-t.itemSize)/2,e-=n*i,e+=n*i*t.options.overlap,e-=parseInt(t.element.css("paddingLeft"),10)||0,e=Math.round(e),{left:e}},select:function(){return e.extend({},this._getCenterPosition(),this._getPerspectiveOrigin())},getElementTransitionStyles:function(t){var i=this,n=e.coverflow.transition[t.easing]||e.coverflow.transition.easeOutQuint,a={transitionProperty:"left",transitionDuration:t.duration+"ms",transitionTimingFunction:n,transitionDelay:"initial"};return e.extend(a,i._getCenterPosition(),i._getPerspectiveOrigin())},refresh:function(t,i,n){var a=this,o=a.options,s=a.items.length,l=a.itemSize,c=a.getItemRenderedWidth();this.items.each(function(a){var d,h=a===n&&0>i-n||a-n>0?"left":"right",u=a===n?1-t:a===i?t:1,p={zIndex:s+("left"===h?n-a:a-n)+10},f=1-u*(1-o.scale),v="right"===h?o.angle:-o.angle;v=r(u*v),p.left=Math.round(-a*l+u*a*c*(1-o.overlap)+(1-u)*a*c*(1-o.overlap)),d=[(f*Math.cos(v)).toFixed(6),0,Math.sin(-v).toFixed(6),0,0,f,0,0,Math.sin(v).toFixed(6),0,(f*Math.cos(v)).toFixed(6),0,0,0,0,1],p.transform="matrix3d("+d.join(", ")+")",p.transformOrigin="right"===h?"left center":"right center",e(this).css(p)})}},e.extend(e.coverflow.renderer,{ThreeD:o});for(var u=i.createElement("div"),p=u.style,f=0,v=["ms","moz","webkit","o"],g=v.length,m="",w=0,_=e.coverflow.support,y=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};g>w&&!t.requestAnimationFrame;w++)t.requestAnimationFrame=t[v[w]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[v[w]+"CancelAnimationFrame"]||t[v[w]+"CancelRequestAnimationFrame"];if(t.requestAnimationFrame||(t.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-f)),a=t.setTimeout(function(){e(i+n)},n);return f=i+n,a}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(e){clearTimeout(e)}),e.each(v,function(e,t){return"ms"!==t&&(t=y(t)),!_.transform&&t+"Transform"in p&&(_.transform=t+"Transform"),!_.transition&&t+"Transition"in p&&(_.transition=t+"Transition"),_.transform&&_.transition?(m=t,!1):!0}),_.transform&&_.transition||(_.transform="transform"in p?"transform":!1,_.transition="transition"in p?"transition":!1),null==e.support.transform&&(e.support.transform=_.transform),null==e.support.transition&&(e.support.transition=_.transition),null==e.cssProps)throw new Error("Your jQuery version is too old. Please upgrade.");m&&e.each(["transitionProperty","transitionDuration","transitionTimingFunction","transitionDelay","perspectiveOrigin"],function(t,i){null==e.cssProps[i]&&(e.cssProps[i]=m+y(i))}),u=null;var b,x=i.documentElement,S="coverflowjsfeaturedetection",C=i.createElement(S),T=C.style,k="Webkit Moz O ms",P=k.split(" "),E=k.toLowerCase().split(" "),D=function(e,t,n,a){var r,o,s,l,c=i.createElement("div"),d=i.body,h=d||i.createElement("body");if(parseInt(n,10))for(;n--;)s=i.createElement("div"),s.id=a?a[n]:S+(n+1),c.appendChild(s);return r=["&#173;","<style id='s",S,"'>",e,"</style>"].join(""),c.id=S,(d?c:h).innerHTML+=r,h.appendChild(c),d||(h.style.background="",h.style.overflow="hidden",l=x.style.overflow,x.style.overflow="hidden",x.appendChild(h)),o=t(c,e),d?c.parentNode.removeChild(c):(h.parentNode.removeChild(h),x.style.overflow=l),!!o},I={}.hasOwnProperty;b=s(I,"undefined")||s(I.call,"undefined")?function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")}:function(e,t){return I.call(e,t)},e.coverflow.support.transform3d=function(){var e=!!h("perspective");return e&&"webkitPerspective"in x.style&&D("@media (transform-3d),(-webkit-transform-3d){#coverflowjsfeaturedetection{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e}(),null==e.support.transform3d&&(e.support.transform3d=e.coverflow.support.transform3d);var $={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"transitionend"},O=navigator.userAgent.toLowerCase(),A=function(){var e=/(msie) ([\w.]+)/.exec(O);return null!==e&&e[1]&&~~e[2]<10}();e.coverflow=e.extend(!0,{},e.coverflow,{isAndroid:/android/.test(O),isOldie:A,transition:{easeInQuad:"cubic-bezier( .55,.085,.68,.53 )",easeInCubic:"cubic-bezier( .550, .055, .675, .190 )",easeInQuart:"cubic-bezier( .895, .03, .685, .22 )",easeInQuint:"cubic-bezier( .755, .05, .855, .06 )",easeInSine:"cubic-bezier( .47, 0, .745, .715 )",easeInExpo:"cubic-bezier( .95, .05, .795, .035 )",easeInCirc:"cubic-bezier( .6, .04, .98, .335 )",easeInBack:"cubic-bezier( .6, -.28, .735, .045 )",easeOutQuad:"cubic-bezier( .25,.46,.45,.94 )",easeOutCubic:"cubic-bezier( .215,.61,.355,1 )",easeOutQuart:"cubic-bezier( .165, .84, .44, 1 )",easeOutQuint:"cubic-bezier( .23, 1, .32, 1 )",easeOutSine:"cubic-bezier( .39, .575, .565, 1 )",easeOutExpo:"cubic-bezier( .19,1,.22,1 )",easeOutCirc:"cubic-bezier( .075, .82, .165, 1 )",easeOutBack:"cubic-bezier( .175, .885, .32, 1.275 )",easeInOutQuad:"cubic-bezier( .455, .03, .515, .955 )",easeInOutCubic:"cubic-bezier( .645, .045, .355, 1 )",easeInOutQuart:"cubic-bezier( .77, 0, .175, 1 )",easeInOutQuint:"cubic-bezier( .86, 0, .07, 1 )",easeInOutSine:"cubic-bezier( .445, .05, .55, .95 )",easeInOutExpo:"cubic-bezier( 1, 0, 0, 1 )",easeInOutCirc:"cubic-bezier( .785, .135, .15, .86 )",easeInOutBack:"cubic-bezier( .68, -.55, .265, 1.55 )"},renderer:{}}),e.widget("ui.coverflow",{options:{items:"> *",active:0,duration:400,easing:"easeOutQuint",angle:45,perspectiveY:45,scale:.7,overlap:.3,trigger:{itemfocus:!1,itemclick:!0,mousewheel:!0}},isTicking:!1,_create:function(){var i,n,a=this,r=this.options,o=e.coverflow.support||{};a.elementOrigStyle=a.element.attr("style"),a.items=a.element.find(r.items).each(function(){var t=e(this);t.data({coverflowOrigElemAttr:{style:t.attr("style"),"class":t.attr("class"),tabIndex:t.attr("tabIndex")}})}).addClass("ui-coverflow-item"),a._setDimensions(),a.support=o,i=o.transform&&!A&&null==t.opera&&o.transform3d?e.coverflow.renderer.ThreeD:e.coverflow.renderer.Classic,n={angle:r.angle,perspectiveY:r.perspectiveY,scale:r.scale,overlap:r.overlap,itemSize:a.itemSize,outerWidth:a.outerWidth},a.renderer=new i(a,a.element,a.items,n),a.element.addClass("ui-coverflow ui-coverflow-"+a.renderer.cssClass+"-render").parent().addClass("ui-coverflow-wrapper ui-clearfix"),r.trigger.itemfocus&&this._bindFocus(),r.trigger.itemclick&&a.element.data("CoverFlowDisableClick",!1)&&a._on(a.items,{click:function(e){a.element.data("CoverFlowDisableClick")||a._select(e)}}),r.trigger.mousewheel&&a._on({mousewheel:a._onMouseWheel,DOMMouseScroll:a._onMouseWheel}),a.useJqueryAnimate=!(o.transition&&e.isFunction(t.requestAnimationFrame)),a.coverflowrafid=0},_bindFocus:function(){var e=this;e.items.prop("tabIndex",0),e._on(e.items,{focus:e._select})},_init:function(){var e=this,t=e.options;t.duration=~~t.duration,t.duration<1&&(t.duration=1),e.currentIndex=e._isValidIndex(t.active,!0)?t.active:0,e.activeItem=e.items.removeClass("ui-state-active").eq(e.currentIndex).addClass("ui-state-active"),e._setDimensions(),e.renderer.initialize(),e._refresh(1,e._getFrom(),e.currentIndex),e._trigger("beforeselect",null,e._ui()),e._trigger("select",null,e._ui())},_setDimensions:function(){var e=this;e.itemWidth=e.items.width(),e.itemHeight=e.items.height(),e.itemSize=e.items.outerWidth(!0),e.outerWidth=e.element.parent().outerWidth(!1)},_isValidIndex:function(e,t){return t=!!t,e=~~e,(this.currentIndex!==e||t)&&e>-1&&!!this.items.get(e)},_select:function(e){this.select(e.currentTarget)},next:function(){return this.select(this.currentIndex+1)},prev:function(){return this.select(this.currentIndex-1)},_getFrom:function(){var e=this;return Math.abs(e.previous-e.currentIndex)<=1?e.previousIndex:e.currentIndex+(e.previousIndex<e.currentIndex?-1:1)},select:function(i){var n,a=this,r=a.options,o=isNaN(parseInt(i,10))?a.items.index(i):parseInt(i,10);return a._isValidIndex(o)?!1===a._trigger("beforeselect",null,this._ui(a.items.eq(o),o))?!1:(a.isTicking&&(a.useJqueryAnimate?a.element.stop(!0,!1):(a.coverflowrafid&&t.cancelAnimationFrame(a.coverflowrafid),a.element.unbind($[a.support.transition]))),a.isTicking=!0,a.previousIndex=a.currentIndex,r.active=a.currentIndex=o,n=e.extend({},a.renderer.select(),{coverflow:1}),a.useJqueryAnimate?a._animation(r,n):(r=e.extend({duration:r.duration,easing:r.easing},n),a._transition(r)),!0):!1},_animation:function(t,i){var n=this,a=this._getFrom();e.fx.step.coverflow=function(e){n._refresh(e.now,a,n.currentIndex)},n.element.animate(i,{duration:t.duration,easing:t.easing}).promise().done(function(){n._onAnimationEnd()})},_transition:function(i){var n=this,a=new Date,r=n._getFrom(),o=n.currentIndex,s={},l=function(){var e=((new Date).getTime()-a.getTime())/i.duration;e>1?n.isTicking=!1:n._refresh(e,r,o),n.isTicking&&(n.coverflowrafid=t.requestAnimationFrame(l))};e.isFunction(n.renderer.getElementTransitionStyles)&&(s=e.extend(s,n.renderer.getElementTransitionStyles(i))),n.element.one($[n.support.transition],function(){n._refresh(1,r,o),n._onAnimationEnd()}).css(s),n.coverflowrafid=t.requestAnimationFrame(l)},_onAnimationEnd:function(){var e=this;e.coverflowrafid&&cancelAnimationFrame(e.coverflowrafid),e.isTicking=!1,e.activeItem=e.items.removeClass("ui-state-active").eq(e.currentIndex).addClass("ui-state-active"),e._trigger("select",null,e._ui())},_refresh:function(e,t,i){this.element.parent().scrollTop(0),this.renderer.refresh(e,t,i)},_ui:function(e,t){return{active:e||this.activeItem,index:null!=t?t:this.currentIndex}},_onMouseWheel:function(e){var t=e.originalEvent;return e.preventDefault(),t.wheelDelta>0||t.detail<0?void this.prev():void this.next()},_destroy:function(){var t=this;t.elementOrigStyle!==n?t.element.attr("style",this.elementOrigStyle):t.element.removeAttr("style"),t.element.removeClass("ui-coverflow ui-helper-clearfix ui-coverflow-"+(t.renderer.cssClass||"classic")+"-render").parent().removeClass("ui-coverflow-wrapper ui-clearfix"),t.items.removeClass("ui-coverflow-item ui-state-active").each(function(){var t=e(this),i=t.data("coverflowOrigElemAttr");e.each(i,function(e,i){i!==n?t.attr(e,i):t.removeAttr(e)}),t.data("coverflowOrigElemAttr",null)}),t._super()}})}(e,this,this.document)}),function(){function e(e,t,i,n){this.x=e||0,this.y=t||0,this.inkAmount=i,this.color=n,this._latestPos={x:this.x,y:this.y}}function t(e,t,i){var n=2*(e.pageX/$.zoom-i.posX),a=2*(e.pageY/$.zoom-i.posY),r=window.emulateLandscape.emulatePoint(n,a,{size:[2*t.width(),2*t.height()]});return n=r[0],a=r[1],[n,a]}e.prototype={x:0,y:0,inkAmount:14,color:"#000",_latestPos:null,render:function(e,t,i,n,a){this._latestPos.x=this.x,this._latestPos.y=this.y,this.x+=t,this.y+=i;var r=n?14/n:0;r>1?r=1:0>r&&(r=0),e.lineCap=e.lineJoin="round",e.lineWidth=14*r,e.beginPath(),e.moveTo(this._latestPos.x,this._latestPos.y),e.lineTo(this.x,this.y),e.stroke()}};var n={init:function(){var e={init:function(t){return this.each(function(){var i=$(this),n=i.data("eraser"),a=interaction_view.environment.variables.completeRatio;if(!n){var r=t.imageWidth||i.width(),o=t.imageHeight||i.height(),s=i.offset(),l=$("<canvas style='width:"+r+"px;height:"+o+"px;'/>"),c=l.get(0),d=t.imageWidth,h=t.imageHeight,u=t&&t.size?t.size:40,p=t&&t.completeRatio?t.completeRatio:a,f=t&&t.completeFunction?t.completeFunction:null,v=t&&t.completeRatioFunction?t.completeRatioFunction:null,g=t&&t.onPaintStart?t.onPaintStart:null,m=[],w=Math.floor(2*r/u)||1,_=w*(Math.floor(2*o/u)||1),y=_,b=t.brush,x=c.getContext("2d");i.after(l),c.id=this.id,c.className=this.className,c.width=2*r,c.height=2*o;var S=function(a,c){for(t.draw||(x.globalCompositeOperation="destination-out"),t.color?x.strokeStyle=t.color:x.strokeStyle="rgba(255,0,0,255)",x.lineWidth=2*u,x.lineCap="round",l.bind("mousedown.eraser",e.mouseDown),l.bind("touchstart.eraser",e.touchStart),l.bind("touchmove.eraser",e.touchMove),l.bind("touchend.eraser",e.touchEnd);y--;)m.push(1);$.zoom||($.zoom=1),n={posX:s.left,posY:s.top,touchDown:!1,touchID:-999,touchX:0,touchY:0,ptouchX:0,ptouchY:0,canvas:l,ctx:x,w:r,h:o,source:C,size:u,parts:m,colParts:w,numParts:_,ratio:0,complete:!1,completeRatio:p,completeFunction:f,completeRatioFunction:v,imageWidth:d,imageHeight:h,brush:b,onPaintStartFunction:g,totalPoint:a,totalLucencyPoint:c},l.data("eraser",n),i.data("eraser",n),$(window).resize(function(){$.zoom||($.zoom=1);var e=l.offset();n.posX=e.left,n.posY=e.top,l.data("eraser",n)})};if(t.draw)S(),i.remove();else{if(!this.src)return;var C=new Image;C.crossOrigin="Anonymous",C.src=this.src,console.log("in"),C.complete?(console.log("completed"),d&&h?x.drawImage(C,0,0,2*d,2*h):x.drawImage(C,0,0),i.remove(),S()):C.onload=function(){console.log("loaded"),d&&h?x.drawImage(C,0,0,2*d,2*h):x.drawImage(C,0,0);for(var e=x.getImageData(0,0,2*d,2*h).data,t=e.length,n=0,a=0;a<e.length;a++)0==e[a]&&n++;i.remove(),S(t,n)}}}})},touchStart:function(i){var a=$(this),r=a.data("eraser");if(!r.disabled){var o=a.offset();if(r.posX=o.left,r.posY=o.top,!r.touchDown){var s=i.originalEvent.changedTouches[0],l=t(s,a,r);tx=l[0],ty=l[1],r.touchDown=!0,r.touchID=s.identifier,r.touchX=tx,r.touchY=ty,r.brush&&n._resetTip(r,r.touchX,r.touchY,r.size),r.onPaintStartFunction&&r.onPaintStartFunction(),$("section#"+interaction_view.currentPage).children().data("is_scrollPage")&&interaction_view.ipagelist.getPage(interaction_view.currentPage).iview.scrollview.iScroll.disable(),r.brush||e.countPoint(r),i.preventDefault()}}},touchMove:function(n){var a=$(this),r=a.data("eraser");if(!r.disabled){var o=a.offset();if(r.posX=o.left,r.posY=o.top,r.touchDown)for(var s=n.originalEvent.changedTouches,l=s.length;l--;)if(s[l].identifier==r.touchID){var c=t(s[l],a,r);if(tx=c[0],ty=c[1],r.brush){var d,h=r._tip;for(dx=tx-r.touchX,dy=ty-r.touchY,console.log(dx,dy),d=Math.sqrt(dx*dx+dy*dy),i=0,len=h.length;i<len;i++)h[i].render(r.ctx,dx,dy,d,r.size);r.touchX=tx,r.touchY=ty}else r.ctx.beginPath(),r.ctx.moveTo(r.touchX,r.touchY),r.touchX=tx,r.touchY=ty,r.ctx.lineTo(r.touchX,r.touchY),r.ctx.stroke(),e.countPoint(r);n.preventDefault();break}}},touchEnd:function(e){var t=$(this),i=t.data("eraser");if(!i.disabled){var n=t.offset();if(i.posX=n.left,i.posY=n.top,i.touchDown){for(var a=e.originalEvent.changedTouches,r=a.length;r--;)if(a[r].identifier==i.touchID){i.touchDown=!1,e.preventDefault();break}$("section#"+interaction_view.currentPage).children().data("is_scrollPage")&&interaction_view.ipagelist.getPage(interaction_view.currentPage).iview.scrollview.iScroll.enable()}}},countPoint:function(e){var t;t=1==e.completeRatio?.999:e.completeRatio;for(var i=e.ctx.getImageData(0,0,2*e.imageWidth,2*e.imageHeight).data,n=0,a=0;a<i.length;a++)0==i[a]&&n++;var r=n-Number(e.totalLucencyPoint);e.complete||r/(e.totalPoint-e.totalLucencyPoint)>=t&&(e.complete=!0,null!=e.completeRatioFunction&&e.completeRatioFunction())},mouseDown:function(i){var a=$(this),r=a.data("eraser");if(!r.disabled){var o=a.offset();r.posX=o.left,r.posY=o.top;var s=t(i,a,r);tx=s[0],ty=s[1],console.log("mouse page "+i.pageX+" "+i.pageY),console.log("offset "+r.posX+" "+r.posY),r.touchDown=!0,r.touchX=tx,r.touchY=ty,r.ctx.beginPath(),r.ctx.moveTo(r.touchX-1,r.touchY),r.ctx.lineTo(r.touchX,r.touchY),r.ctx.stroke(),a.bind("mousemove.eraser",e.mouseMove),$(document).bind("mouseup.eraser",r,e.mouseUp),r.brush&&n._resetTip(r,r.touchX,r.touchY,r.size),r.onPaintStartFunction&&r.onPaintStartFunction(),$("section#"+interaction_view.currentPage).children().data("is_scrollPage")&&interaction_view.ipagelist.getPage(interaction_view.currentPage).iview.scrollview.iScroll.disable(),r.brush||e.countPoint(r),i.preventDefault()}},mouseMove:function(n){var a=$(this),r=a.data("eraser");if(!r.disabled){var o=a.offset();r.posX=o.left,r.posY=o.top;var s=t(n,a,r);if(tx=s[0],ty=s[1],r.brush){var l,c=r._tip;for(dx=tx-r.touchX,dy=ty-r.touchY,console.log(dx,dy),l=Math.sqrt(dx*dx+dy*dy),i=0,len=c.length;i<len;i++)c[i].render(r.ctx,dx,dy,l,r.size);r.touchX=tx,r.touchY=ty}else r.ctx.beginPath(),r.ctx.moveTo(r.touchX,r.touchY),r.touchX=tx,r.touchY=ty,r.ctx.lineTo(r.touchX,r.touchY),r.ctx.stroke(),e.countPoint(r);n.preventDefault()}},mouseUp:function(e){var t=e.data,i=t.canvas;t.disabled||(t.touchDown=!1,i.unbind("mousemove.eraser"),$(document).unbind("mouseup.eraser"),$("section#"+interaction_view.currentPage).children().data("is_scrollPage")&&interaction_view.ipagelist.getPage(interaction_view.currentPage).iview.scrollview.iScroll.enable(),e.preventDefault())},clear:function(){var e=$(this),t=e.data("eraser");if(t){h=0;var i=function(){t.ctx.clearRect(0,0,2*t.w,2*t.h);for(var e=t.numParts;e--;)t.parts[e]=0;t.ratio=t.numParts,t.complete=!0,null!=t.completeFunction&&t.completeFunction()};i()}},size:function(e){var t=$(this),i=t.data("eraser");i&&e&&(i.size=e,i.ctx.lineWidth=2*e)},reset:function(){var e=$(this),t=e.data("eraser");if(t){t.ctx.globalCompositeOperation="source-over",t.imageWidth&&t.imageHeight?t.ctx.drawImage(t.source,0,0,2*t.imageWidth,2*t.imageHeight):t.ctx.drawImage(t.source,0,0),t.ctx.globalCompositeOperation="destination-out";for(var i=t.numParts;i--;)t.parts[i]=1;t.ratio=0,t.complete=!1}},color:function(e){var t=$(this),i=t.data("eraser");i&&e&&(i.strokeStyle=e,i.ctx.strokeStyle=e)},enable:function(){var e=$(this),t=e.data("eraser");t.disabled=!1},disable:function(){var e=$(this),t=e.data("eraser");t.disabled=!0},setmode:function(e){var t=$(this),i=t.data("eraser");e?i.ctx.globalCompositeOperation="source-over":i.ctx.globalCompositeOperation="destination-out"}};$.fn.eraser=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void $.error("Method "+t+" does not yet exist on jQuery.eraser"):e.init.apply(this,arguments)}},set:function(e,t,i,n,a){var r;r=0!=a&&a?Number(a)/10:interaction_view.environment.variables.completeRatio,$(e).eraser({size:40,imageWidth:t,imageHeight:i,completeRatio:r,completeRatioFunction:function(){$(e).eraser("clear"),interaction_view.events.onEraserEvent(n)},completeFunction:function(){n.$el.addClass("invisible noevents")}})},reset:function(e){$(e).eraser("reset")},_resetTip:function(t,i,n,a){console.log("resetTip");var r,o,s,l,c,d,h,u,p,f,v=t._tip=[],g=.5*a;for(d=2*Math.PI*Math.random(),f=g*g*Math.PI/a|0,1>f&&(f=1),console.log("Tip length",f),p=0;f>p;p++)r=g*Math.random(),o=.5*r,s=2*Math.PI*Math.random(),l=r*Math.sin(s),c=o*Math.cos(s),h=Math.cos(d),u=Math.sin(d),v.push(new e(i+l*h-c*u,n+l*u+c*h,7,"#000000"))}};"undefined"==typeof require?(window._e||(window._e={}),window._e.eraser=n):define("_e/eraser",["jquery"],function(){return window._e||(window._e={}),window._e.eraser=n,_e.eraser.init(),window._e.eraser})}(window),function(){function e(e){if(this.options={className:"child_Element",onStart:null,onEnd:null,autoClear:!1},"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.init()}var t={1:"bounce",2:"flash",3:"pulse",4:"rubberBand",5:"shake",6:"swing",7:"tada",8:"wobble",9:"jello",12:"rotate",20:"bounceIn",21:"bounceInDown",22:"bounceInLeft",23:"bounceInRight",24:"bounceInUp",61:"bounceOut",
62:"bounceOutDown",63:"bounceOutLeft",64:"bounceOutRight",65:"bounceOutUp",25:"fadeIn",26:"fadeInDown",27:"fadeInDownBig",28:"fadeInLeft",29:"fadeInLeftBig",30:"fadeInRight",31:"fadeInRightBig",32:"fadeInUp",33:"fadeInUpBig",67:"fadeOut",68:"fadeOutDown",69:"fadeOutDownBig",70:"fadeOutLeft",71:"fadeOutLeftBig",72:"fadeOutRight",73:"fadeOutRightBig",74:"fadeOutUp",75:"fadeOutUpBig",11:"flip",34:"flipInX",35:"flipInY",76:"flipOutX",77:"flipOutY",36:"lightSpeedIn",78:"lightSpeedOut",37:"rotateIn",38:"rotateInDownLeft",39:"rotateInDownRight",40:"rotateInUpLeft",41:"rotateInUpRight",79:"rotateOut",80:"rotateOutDownLeft",81:"rotateOutDownRight",82:"rotateOutUpLeft",83:"rotateOutUpRight",10:"hinge",42:"rollIn",93:"rollOut",44:"zoomIn",45:"zoomInDown",46:"zoomInLeft",47:"zoomInRight",48:"zoomInUp",84:"zoomOut",85:"zoomOutDown",86:"zoomOutLeft",87:"zoomOutRight",88:"zoomOutUp",49:"slideInDown",50:"slideInLeft",51:"slideInRight",52:"slideInUp",89:"slideOutDown",90:"slideOutLeft",91:"slideOutRight",92:"slideOutUp"};e.prototype.init=function(){for(var e=0;e<this.options.items.length;e++){var t=this.options.items[e];this.options.items[e].origin_el=t.el,t.el.wrapInner('<div class="'+this.options.className+'" style="position:absolute;top:0;left:0;width:100%;height:100%;"></div>'),this.options.items[e].originClass=this.options.className,this.options.items[e].el=t.el.children("div"),this.options.items[e].child=!0}},e.prototype.play=function(){this.options.onStart&&this.options.onStart();for(var e=0;e<this.options.items.length;e++){var i=this.options.items[e],n=i.repeat;n=n?-1==n?"infinite":n:"1";var a=i.el;a.data("anitype",i.type),this.bindEnd(e,a);var r=t[i.type],o=i.originClass.replace("hide","")+" "+r+" animated";if(a[0].style.animationDuration=i.duration+"s",a[0].style.animationDelay=i.delay+"s",a[0].style.animationIterationCount=n,a[0].style.webkitAnimationDuration=i.duration+"s",a[0].style.webkitAnimationDelay=i.delay+"s",a[0].style.webkitAnimationIterationCount=n,i.type<20?a.attr("data-effect","1"):i.type>=20&&i.type<=60?(a.closest(".iView").hasClass("hide")&&(a[0].initHide=!0,a.closest(".iView").removeClass("hide")),i.onShow&&i.onShow(),a.attr("data-in","1"),this.options.autoClear&&a.closest(".iView").find("[data-out]").children().unwrap()):i.type>60&&(a.attr("data-out","1"),this.options.autoClear&&a.closest(".iView").find("[data-in]").children().unwrap()),a[0].className=o,a.find("iframe").length){console.log("has iframe");var s=a.find("iframe").first().data("content");s&&(a.find("iframe").first()[0].contentWindow.document.body.innerText="",a.find("iframe").first()[0].contentWindow.document.write(s),a.find("iframe").first()[0].contentWindow.document.body.style.margin=0,a.find("iframe").first()[0].contentWindow.document.body.style.padding=0)}}},e.prototype.stop=function(){for(var e=0;e<this.options.items.length;e++){var t=this.options.items[e];t.el[0].className=this.options.className,t.el[0].style.animationDuration="",t.el[0].style.animationDelay="",t.el[0].style.animationIterationCount="",t.el[0].style.webkitAnimationDuration="",t.el[0].style.webkitAnimationDelay="",t.el[0].style.webkitAnimationIterationCount="",t.el[0].initHide&&t.el.closest(".iView").addClass("hide"),t.el.closest(".iView").find(".child_Action_Element").children().unwrap()}},e.prototype.bindEnd=function(e,t){var i=this;t.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(t){$(this).unbind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend");var n=$(this).data("anitype");n>=20&&60>=n?$(this).closest(".iView").removeClass("noevents"):n>60&&100>n&&$(this).closest(".iView").addClass("noevents"),i.options.items[e].finished=!0,i.options.autoClear&&$(this).attr("data-effect")&&$(this).children().length&&$(this).children().unwrap(),i.end()})},e.prototype.end=function(){_.filter(this.options.items,function(e){return e.finished}).length==this.options.items.length&&this.options.onEnd&&this.options.onEnd()},window.Animate=e,window.ANIMATE_TYPE_VALUE=t}(window),define("_e/cssanimate",function(){}),function(){window.animation=function(e){this.defaults={countTime:0,currentFrame:0,path:null,raster:null,animation:null},this.options=e,this.options=$.extend(!0,{},this.defaults,"object"==typeof e&&e),this.page=this.options.collection.page,this.options.old_animation=$.extend(!0,{},this.options.animation),!interaction_view.imasterlist.at(0)||this.page.id!=interaction_view.imasterlist.at(0).id&&this.page.id!=interaction_view.ibackgroundlist.at(0).id||(this.actionNoClear=!0),this.init()},window.animation.prototype={init:function(){_.bindAll(this),this.handleVars(),0==this.options.animation.iKind&&this.setparam(),1==this.options.animation.iKind&&this.setgroupparam()},refresh:function(){this.options.animation=$.extend(!0,{},this.options.old_animation),this.init()},handleVars:function(){var e=this.options.animation,t=interaction_view.getVarsOp(this.page.id,[0,2]);_.each(this.options.animation.iTiming,function(i,n){"object"!=typeof i&&(e.iTiming[n]=Number(t.var2val(i)))}),_.each(this.options.animation.iDetail,function(i,n){var a=String(i);a.length&&"%"!=a[a.length-1]&&"object"!=typeof i&&(e.iDetail[n]=Number(t.var2val(i)))})},cssTovalue:function(e){var t=e;return t=Number(e.split("px")[0])},EaseTypes:{0:"Linear.easeNone",1:"Power0.easeIn",2:"Power0.easeInOut",3:"Power0.easeOut",4:"Power1.easeIn",5:"Power1.easeInOut",6:"Power1.easeOut",7:"Power2.easeIn",8:"Power2.easeInOut",9:"Power2.easeOut",10:"Power3.easeIn",11:"Power3.easeInOut",12:"Power3.easeOut",13:"Power4.easeIn",14:"Power4.easeInOut",15:"Power4.easeOut",16:"Quad.easeIn",17:"Quad.easeInOut",18:"Quad.easeOut",19:"Cubic.easeIn",20:"Cubic.easeInOut",21:"Cubic.easeOut",22:"Quart.easeIn",23:"Quart.easeInOut",24:"Quart.easeOut",25:"Quint.easeIn",26:"Quint.easeInOut",27:"Quint.easeOut",28:"Strong.easeIn",29:"Strong.easeInOut",30:"Strong.easeOut",31:"Back.easeIn",32:"Back.easeInOut",33:"Back.easeOut",34:"Bounce.easeIn",35:"Bounce.easeInOut",36:"Bounce.easeOut",37:"Circ.easeIn",38:"Circ.easeInOut",39:"Circ.easeOut",40:"Elastic.easeIn",41:"Elastic.easeInOut",42:"Elastic.easeOut",43:"Expo.easeIn",44:"Expo.easeInOut",45:"Expo.easeOut",46:"Sine.easeIn",47:"Sine.easeInOut",48:"Sine.easeOut",49:"SlowMo.ease"},getTypeName:function(e){switch(e){case 100:return"出现动画";case 101:return"飞入";case 102:return"放大";case 103:return"渐现";case 104:return"缩小出现";case 200:return"消失动画";case 201:return"飞出";case 202:return"缩小";case 203:return"渐隐";case 204:return"放大消失";case 300:return"运动路径";case 301:return"直线运动";case 302:return"曲线运动";case 400:return"强调动画";case 401:return"放大缩小";case 402:return"透明";case 403:return"旋转";case 500:return"媒体动画";case 501:return"播放";case 502:return"暂停";case 503:return"结束";case 601:return"逐字出现";case 701:return"SVG描绘动画";case 702:return"SVG变形动画"}},setpathparam:function(e){this.pathoriginalpoint={};var t=this.page.iOverlaylist.get(this.options.animation.overlay_id),i=t.get("_offset_x")||0,n=t.get("_offset_y")||0;this.options.animation.pano_eid?(this.obj=t.iview.$el.children(".Element"),i-=t.iview.x,n-=t.iview.y):this.obj=t.iview.$el[0];var a=this.options.animation.iDetail.autoRotate||!1;if(a){t.iview.$el[0]}var r=this.options.animation.iDetail.closed;if(302==e){if(!this.options.animation.iDetail.path||this.options.animation.iDetail.path.length<2)return this.param=null,!1;if(!this.options.animation.iDetail.path[0].handleOut)return this.param=null,!1;var o=[];_.each(this.options.animation.iDetail.path,function(e,t,a){if(0!=t&&e.handleIn){var s={};s.x=e.handleIn.x+e.point.x+i,s.y=e.handleIn.y+e.point.y+n,o.push(s)}if(o.push({x:e.point.x+i,y:e.point.y+n}),e.handleOut){var l={};l.x=e.handleOut.x+e.point.x+i,l.y=e.handleOut.y+e.point.y+n,o.push(l)}if(t==a.length-1&&r&&e.handleOut&&a[0].handleIn){var c=a[0].handleIn,d=a[0].point,s={};s.x=c.x+d.x+i,s.y=c.y+d.y+n,d.x=d.x+i,d.y=d.y+n,o.push(s),o.push(d)}}),this.param.bezier={values:o,type:"cubic",autoRotate:a}}if(301==e){if(!this.options.animation.iDetail.path||this.options.animation.iDetail.path.length<2)return this.param=null,!1;var s,o=[];for(s=0;s<this.options.animation.iDetail.path.length;s++){if(0!=s){var l=this.options.animation.iDetail.path[s-1],c=this.options.animation.iDetail.path[s],d={x:(l.point.x+c.point.x)/2+i,y:(l.point.y+c.point.y)/2+n};o.push(d)}if(o.push({x:this.options.animation.iDetail.path[s].point.x+i,y:this.options.animation.iDetail.path[s].point.y+n}),s==this.options.animation.iDetail.path.length-1&&r){var l=this.options.animation.iDetail.path[s],c=this.options.animation.iDetail.path[0],d={x:(l.point.x+c.point.x)/2+i,y:(l.point.y+c.point.y)/2+n};o.push(d),o.push({x:this.options.animation.iDetail.path[0].point.x+i,y:this.options.animation.iDetail.path[0].point.y+n})}}this.param.bezier={values:o,type:"quadratic",autoRotate:a}}},setappearparam:function(e){this.startshow=!0,this.fromparam={},this.toparam={},this.toparam.onStart=this.onStart,this.toparam.immediateRender=!1,this.toparam.onComplete=this.param.onComplete,this.toparam.delay=this.param.delay,this.toparam.repeat=this.param.repeat,this.toparam.ease=this.param.ease;var t=this.page.iOverlaylist.get(this.options.animation.overlay_id),i=0,n=0;this.options.animation.pano_eid&&(i-=t.iview.x,n-=t.iview.y);var a,r,o;if(101==e){this.stopshow=!0,a=this.options.animation.iDetail.direction||0;var s=this.options.animation.iDetail.pathlength||0,l=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview,c=l.x+i,d=l.y+n,h=l.common.iWidth,u=l.common.iHeight;r={x:c,y:d};var p=window.ScrollPage.getScrollPos();switch(a){case 0:r.y=s?l.y-s:-u;break;case 1:r.x=s?l.x+s:interaction_view.size.x+h,r.x+=p.x;break;case 2:r.y=s?l.y+s:interaction_view.size.y+u,r.y+=p.y;break;case 3:r.x=s?l.x-s:-u}this.param.css=r,this.fromparam.css={x:Number(r.x),y:Number(r.y)},this.toparam.css={x:Number(c),y:Number(d)},s&&(this.fromparam.css.opacity=0,this.toparam.css.opacity=1),this.options.animation.pano_eid?this.obj=t.iview.$el.children(".Element"):this.obj=t.iview.$el[0],this.toparam.css.force3D=interaction_view.force3D}if(102==e&&(this.options.animation.pano_eid?this.obj=t.iview.$el.children(".Element"):this.obj=t.iview.$el.children(".Element")[0],a=this.options.animation.iDetail.direction||0,o={},r={},o.scale=0,this.param.css=o,this.fromparam.css={scale:0},this.toparam.css={scale:1},this.toparam.css.force3D=interaction_view.force3D,interaction_view.force3D&&_g.device.android()&&TweenLite.set(this.obj,{transformPerspective:2e3})),103==e&&(a=this.options.animation.iDetail.direction||0,o={},this.param.css={opacity:0},this.fromparam.css={opacity:0},this.toparam.css={opacity:1},this.options.animation.pano_eid?this.obj=t.iview.$el.children(".Element"):this.obj=t.iview.$el[0],this.toparam.css.force3D=interaction_view.force3D),104==e){this.options.animation.pano_eid?this.obj=t.iview.$el.children(".Element"):this.obj=t.iview.$el.children(".Element")[0];var f=Number(this.options.animation.iDetail.scale)||2,v=Number(this.options.animation.iDetail.opacity)||.5;o={},r={},o.scale=0,this.param.css=o,this.fromparam.css={scale:f,opacity:v},this.toparam.css={scale:1,opacity:1},this.toparam.css.force3D=interaction_view.force3D,interaction_view.force3D&&_g.device.android()&&TweenLite.set(this.obj,{transformPerspective:2e3})}},setdisappearparam:function(e){var t={},i=this.page.iOverlaylist.get(this.options.animation.overlay_id),n=i.iview;if(201==e){var a=this.options.animation.iDetail.direction||0;this.options.animation.pano_eid?this.obj=i.iview.$el.children(".Element"):this.obj=i.iview.$el[0];var r=this.options.animation.iDetail.pathlength||0,o=2*n.common.iWidth,s=2*n.common.iHeight,l=window.ScrollPage.getScrollPos();switch(a){case 0:t.y=r?n.y-r:-s;break;case 1:t.x=r?n.x+r:interaction_view.size.x+o,t.x+=l.x;break;case 2:t.y=r?n.y+r:interaction_view.size.y+s,t.y+=l.y;break;case 3:t.x=r?n.x-r:-o}this.param.css=t,r&&(this.param.css.opacity=0)}if(202==e&&(this.overlay_obj=i.iview.$el,this.obj=this.overlay_obj.children(".Element")[0],t.scale=0,this.param.css=t),203==e&&(this.param.css={opacity:0},this.obj=n.$el[0]),204==e){var c=Number(this.options.animation.iDetail.scale)||2,d=Number(this.options.animation.iDetail.opacity)||0;this.overlay_obj=i.iview.$el,this.obj=this.overlay_obj.children(".Element")[0],t.scale=c,t.opacity=d,this.param.css=t}this.stophide=!0},setstrongparam:function(e){var t=this.page.iOverlaylist.get(this.options.animation.overlay_id);if(this.obj=t.iview.$el[0],401==e){this.obj=t.iview.$el.children(".Element")[0];var i={};i.scale=_.isNumber(this.options.animation.iDetail.scale)?Number(this.options.animation.iDetail.scale):1,this.param.css=i}if(402==e){var n=this.options.animation.iDetail.opacity||0;this.options.animation.pano_eid?this.obj=t.iview.$el.children(".Element"):this.obj=t.iview.$el[0],this.param.css={opacity:n}}if(403==e){var a=this.page.iOverlaylist.get(this.options.animation.overlay_id);a.iview.wrap_el?this.obj=a.iview.wrap_el[0]:this.obj=a.iview.$el.children(".Element")[0];var r=_.isNumber(this.options.animation.iDetail.rotation)?Number(this.options.animation.iDetail.rotation):0,o=this.options.animation.iDetail.axial||0,s=this.options.animation.iDetail.transformOrigin||0,l="_cw",c="+";0>r&&(l="_ccw"),0>r&&(c="-");var i={};switch(0==o&&(i.rotation=c+"="+Math.abs(r)+l),1==o&&(i.rotationX=c+"="+Math.abs(r)+l),2==o&&(i.rotationY=c+"="+Math.abs(r)+l),this.param.css=i,s){case 0:this.param.css.transformOrigin="50% 50%";break;case 1:0==o?this.param.css.transformOrigin="0% 50%":this.param.css.transformOrigin="left";break;case 2:0==o?this.param.css.transformOrigin="100% 50%":this.param.css.transformOrigin="right";break;case 3:0==o?this.param.css.transformOrigin="50% 100%":this.param.css.transformOrigin="bottom center";break;case 4:0==o?this.param.css.transformOrigin="50% 0%":this.param.css.transformOrigin="top center";break;case 5:this.param.css.transformOrigin="0% 0%";break;case 6:this.param.css.transformOrigin="100% 0%";break;case 7:this.param.css.transformOrigin="0% 100%";break;case 8:this.param.css.transformOrigin="100% 100%";break;default:this.param.css.transformOrigin="50% 50%"}_g.device.android()&&TweenLite.set(this.obj,{transformPerspective:2e3})}this.param.css.force3D=interaction_view.force3D},settextparam:function(e){if(this.startshow=!0,601==e){var t=this.page.iOverlaylist.get(this.options.animation.overlay_id);if("Paragraph"==t.get("iType")){var i=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.children(".Element")[0];this.obj=$(i).find(".iText"),this.param.text=t.attributes.iDetail.iText,$(this.obj).html("")}}},setgroupparam:function(){this.param={},this.param.data=this.options.animation,this.param.onStartParams=["{self}"],this.param.onStart=this.onStart,this.param.onComplete=this.stop,this.param.onCompleteParams=["{self}"];var e=this.options.animation.iTiming.repeat||0;-1==e?this.param.repeat=-1:e&&-2!=e?this.param.repeat=e-1:-2==e&&(this.param.repeat=-1)},setsvgparam:function(e){var t=this;this.startshow=!0,this.fromparam={},this.toparam={},this.toparam.onStart=this.onStart,this.toparam.immediateRender=!1,this.toparam.onComplete=this.param.onComplete,this.toparam.delay=this.param.delay,this.toparam.repeat=this.param.repeat,this.toparam.ease=this.param.ease;var i=this.page.iOverlaylist.get(this.options.animation.overlay_id);if(701==e)this.obj=i.iview.$el.find("svg").find("rect, circle, ellipse, polyline, path, line, polygon").not("[data-attr=morphCloneElement]"),this.fromparam.drawSVG=this.param.data.iDetail.startx+" "+this.param.data.iDetail.starty,this.toparam.drawSVG=this.param.data.iDetail.endx+" "+this.param.data.iDetail.endy;else if(702==e){this.toparam.paths=[],this.toparam.otherPaths=[];var n=0;if(_.each(this.param.data.iDetail.pathIndex,function(e,t){null!=e.selected&&n++}),1>=n)return;this.toparam.obj=i.iview.$el.children(".Element").find("svg"),_.each(this.param.data.iDetail.pathIndex,function(e,i){null!=e.selected?t.toparam.paths.push({shapeIndex:e.selected,id:e.id}):t.toparam.otherPaths.push({id:e.id})})}},setparam:function(){this.param={},this.param.data=this.options.animation;var e=this.page.iOverlaylist.get(this.options.animation.overlay_id);this.overlaymodel=e,this.param.onStartParams=["{self}"],this.param.onStart=this.onStart,this.param.onUpdate=this.onUpdate,this.param.onComplete=this.stop,this.param.onCompleteParams=["{self}"],this.param.ease=this.EaseTypes[this.options.animation.iTiming.ease||0];var t=this.options.animation.iTiming.repeat||0;switch(-1==t?this.param.repeat=-1:t&&-2!=t?this.param.repeat=t-1:-2==t&&(this.param.repeat=-1),this.options.animation.iType){case 100:return"出现动画";case 101:this.setappearparam(101);break;case 102:this.setappearparam(102);break;case 103:this.setappearparam(103);break;case 104:this.setappearparam(104);break;case 200:return"消失动画";case 201:this.setdisappearparam(201);break;case 202:this.setdisappearparam(202);break;case 203:this.setdisappearparam(203);break;case 204:this.setdisappearparam(204);break;case 300:return"运动路径";case 301:this.setpathparam(301);break;case 302:this.setpathparam(302);break;case 400:return"强调动画";case 401:this.setstrongparam(401);break;case 402:this.setstrongparam(402);break;case 403:this.setstrongparam(403);break;case 500:return"媒体动画";case 501:this.setmedia(501);break;case 502:this.setmedia(502);break;case 503:this.setmedia(503);break;case 700:return"SVG动画";case 701:this.setsvgparam(701);break;case 702:this.setsvgparam(702);break;case 600:return"文字动画";case 601:this.settextparam(601)}this.param&&this.param.css&&(this.param.css.force3D=interaction_view.force3D,this.param.css.force3D&&this.obj&&_g.device.android())},setmedia:function(e){"Audio"==this.overlaymodel.get("iType")&&(this.isAudio=!0)},pathstop:function(e){var t=this.options.animation.iTiming.rewind||!1;t&&-1!=this.options.animation.iTiming.repeat&&-2!=this.options.animation.iTiming.repeat&&this.options.animation.iDetail.path&&this.options.animation.iDetail.path[0]&&e.pause(0)},animationstop:function(e){var t=this.options.animation.iTiming.rewind||!1;t&&e&&e.pause(0)},stop:function(e){this.stopshow&&this.showelement(),this.stophide&&this.hideelement(),this.animationstop(e),interaction_view.events.onAnimationEnd({overlay_id:this.options.animation.overlay_id,animation_id:this.options.animation.id,page_id:this.page.id,layer_id:this.options.collection.layerid})},forcestop:function(e){var t=this.options.animation.iTiming.rewind||!1;t?e.pause(0):e.pause(this.options.animation.iTiming.duration),this.options.collection.onComplete(this.options.animation.id)},addclickcontrol:function(){this.options.collection.addclickstop(this.options.animation.id)},onStart:function(e){this.startshow&&this.showelement(),interaction_view.events.onAnimationStart({overlay_id:this.options.animation.overlay_id,animation_id:this.options.animation.id,page_id:this.page.id,layer_id:this.options.collection.layerid})},onUpdate:function(e){},showelement:function(){var e=this.page.iOverlaylist.get(this.options.animation.overlay_id);e.iview.onBeforeShow&&e.iview.onBeforeShow(),e.iview.$el.removeClass("hide"),e.iview.onShow&&e.iview.onShow()},hideelement:function(){var e=this.page.iOverlaylist.get(this.options.animation.overlay_id);e.iview.onBeforeHide&&e.iview.onBeforeHide(),e.iview.$el.addClass("hide"),e.iview.onHide&&e.iview.onHide()}},window.animateTimeline={generateTimeline:function(e){if("undefined"!=typeof TimelineMax){var t=interaction_view.getVarsOp(e.iPage_id,[0,2]),i={paused:e.paused,onStart:e.onStart,onComplete:e.onComplete,onStartParams:e.onStartParams,onCompleteParams:e.onComplateParams};e.repeat&&(i.repeat=e.repeat);var n=new TimelineMax(i);n.elements=[],n.addLabel("Start");var a=0;if(e.ids){e.ids=_.filter(e.ids,function(t){page=t.page||interaction_view.getAnimationPage(t.page_id,e.page);var i=page.iAnimationlist.get(t.id);if(!i)return!1;var t=i.toJSON();return 0!=t.iKind||page.iOverlaylist.get(t.overlay_id)?!0:!1}),e.animations=[];for(var r=0;r<e.ids.length;r++){page=e.ids[r].page||interaction_view.getAnimationPage(e.ids[r].page_id,e.page);var o=page.iAnimationlist.get(e.ids[r].id);o.page=page,e.animations.push(o)}}if(0==e.animations.length)return!1;var s=interaction_view.filterAnimations(e.animations,e.page,e.group,e.foraction);return s=_.filter(s,function(t){if(0===t.attributes.iKind&&!t._animation&&!t._error)try{t._animation=new animation({collection:e.page.iAnimationlist,animation:t.toJSON()})}catch(i){}return t._animation}),_.each(s,function(i,r){function o(e){return L.obj.find("path#"+e.id)}function l(e){return L.obj.find("path#clone_"+e.id)}function c(){$(B).attr("d",$(B).attr("data-original")),$(B).css($(B).data("initStyle")),$(B).data("show",!1)}function d(e){var t=e.css("fill")||"white",i=parseFloat(e.css("fill-opacity"))>=0?parseFloat(e.css("fill-opacity")):1,n=e.css("stroke")||"black",a=parseFloat(e.css("stroke-opacity"))>=0?parseFloat(e.css("stroke-opacity")):1,r=parseFloat(e.css("stroke-width"))>=0?parseFloat(e.css("stroke-width")):1;return{fill:t,"fill-opacity":i,stroke:n,"stroke-opacity":a,"stroke-width":r}}function h(){$(B).show().css({"stroke-dasharray":"none","stroke-dashoffset":"none"}),$(B).data("show",!0);for(var e=1;e<L.paths.length;e++)o(L.paths[e]).hide();for(var e=0;e<L.otherPaths.length;e++){var t=o(L.otherPaths[e]);t.data("show")||t.hide()}}function u(){h(),L.onStart(),c()}function p(){L.onComplete(),i.attributes.iTiming.rewind?c():$(B).data("show",!1)}if(i){i._animation.refresh();var f=i.page?i.page.id:e.iPage_id,v=i.page?i.page:e.page,g=i.toJSON(),m=$.extend(!0,{},i._animation.param);if(g.iTiming){var w=t.var2val(g.iTiming.delay),y=t.var2val(g.iTiming.repeat),b=t.var2val(g.iTiming.duration);a+=w,b=b;var x=r;if(_.include([0,3,4,5,6,7],g.iTiming.start))switch(n.addLabel(i.id+"_start",a),g.iTiming.start){case 0:n.call(e.page.iAnimationlist.AddClickTween,[n,e.iPage_id,i,a],this,a-w);break;case 3:case 4:case 5:case 6:n.call(e.page.iAnimationlist.AddPageSwipeTween,[n,e.iPage_id,g.iTiming.start,i,a],this,a-w);break;case 7:n.call(e.page.iAnimationlist.AddPageShakeTween,[n,e.iPage_id,g.iTiming.start,i,a],this,a-w)}else if(2==g.iTiming.start)if(0!=x){var S=n.getLabelTime(s[x-1].id+"_start");n.addLabel(i.id+"_start",S+w),a=n.getLabelTime(i.id+"_start")}else n.addLabel(i.id+"_start",a);else n.addLabel(i.id+"_start",a)}if(1==g.iKind&&g.children){var C=[];_.each(g.children,function(e){C.push({id:e,page_id:f,page:v})});var T=animateTimeline.generateTimeline({page:v,ids:C,iPage_id:f,group:!0,paused:!1,repeat:m.repeat,onStart:m.onStart,onComplete:m.onComplete,onStartParams:m.onStartParams,onCompleteParams:m.onCompleteParams,foraction:!0});if(T){n.add(T,a);var k=T;b=T.duration(),T.elements&&T.elements.length&&(n.elements=n.elements.concat(T.elements))}else b=0}else{if(!_g.browserSupport({msie:9})&&!_.include([101,201,100,103,200,203,402,500,501,502,503],i.get("iType"))){var P,E=$(i._animation.obj);if(i._animation.toparam)P=i._animation.toparam.css;else if(i._animation.param)if(i._animation.param.css)P=i._animation.param.css;else if(i._animation.param.bezier){var D=i._animation.param.bezier.values;P=D[D.length-1]}return P&&P.x&&E.css("margin-left",P.x+"px"),P&&P.y&&E.css("margin-top",P.y+"px"),E.removeClass("hide").show(),E.parents(".iView:first").removeClass("hide").show(),!0}var I=i._animation.obj,O={onUpdate:interaction_view.events.onAnimationUpdate,onUpdateParams:[{animation_id:i.id,overlay_id:i.get("overlay_id"),page_id:i.get("page_id"),layer_id:i.get("layer_id")}]};if(i._animation.toparam?i._animation.toparam=$.extend({},i._animation.toparam,O):i._animation.param=$.extend({},i._animation.param,O),_.include([301,302],i.get("iType"))&&!m)return!1;if(_.include([501,502,503],i.get("iType"))){interaction_view.isIos&&i._animation.isAudio&&501==i.get("iType")&&(w||interaction_view.media.play(i._animation.overlaymodel));var A=e.page.iAnimationlist.getMediaTime(i);b=502==i.get("iType")||503==i.get("iType")?0:A,n.call(e.page.iAnimationlist.AddMediaTween,[i],this,a)}else if(_.include([102,103],i.get("iType")))n.add(TweenMax.fromTo(I,b,i._animation.fromparam,i._animation.toparam),a);else if(104==i.get("iType"))n.add(TweenMax.fromTo(I,.01,{opacity:0},i._animation.fromparam),a),n.add(TweenMax.fromTo(I,b-.01,i._animation.fromparam,i._animation.toparam),a+.01);else if(101==i.get("iType"))_g.browserSupport({msie:9})?n.add(TweenMax.fromTo(I,b,i._animation.fromparam,i._animation.toparam),a):n.add(TweenMax.fromTo(I,b,{"margin-left":i._animation.fromparam.css.x,"margin-top":i._animation.fromparam.css.y},{"margin-left":i._animation.toparam.css.x,"margin-top":i._animation.toparam.css.y,immediateRender:!1}),a);else if(201!=i.get("iType")||_g.browserSupport({msie:9}))if(701==i.get("iType")){var N=$.extend(!0,{},i._animation.toparam);N.onStart=null,n.add(TweenMax.fromTo(I,b-.001,i._animation.fromparam,N),a+.001)}else if(702==i.get("iType")){if(i._animation.toparam.paths.length>=2){var R,M=b/(i._animation.toparam.paths.length-1),L=$.extend(!0,{},i._animation.toparam),F=a,W={immediateRender:L.immediateRender,ease:L.ease,onUpdate:L.onUpdate,onUpdateParams:L.onUpdateParams},B=o(L.paths[0])[0];$(B).data("initStyle")||$(B).data("initStyle",d($(B)));var j=new TimelineMax({repeat:L.repeat,onStart:u,onComplete:p});F=0;for(var r=1;r<i._animation.toparam.paths.length;r++)R=$.extend(!0,{morphSVG:{shape:l(L.paths[r])[0],shapeIndex:L.paths[r-1].shapeIndex}},W),R=$.extend(!0,d(o(L.paths[r])),R),j.add(TweenMax.to(B,M,R),F),F+=M;n.add(j,a)}}else n.add(TweenMax.to(I,b,i._animation.param),a);else n.add(TweenMax.to(I,b,{"margin-left":i._animation.param.css.x,"margin-top":i._animation.param.css.y}),a);var k=n.getChildren()[n.getChildren().length-1];i._animation.actionNoClear&&(k.actionNoClear=!0)}i.get("iType")>200&&i.get("iType")<210&&n.elements.push(i._animation.overlay_obj||i._animation.obj),y&&y>0?b*=y:-2==y&&n.call(e.page.iAnimationlist.AddRepeatClickTween,[n,e.iPage_id,k,i],this,a),a+=b,n.addLabel(i.id+"_end",a)}}),n}}}}(window),define("_e/animate",function(){}),function(e,t){"use strict";var i="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,n=function(){for(var e,i,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"]],a=0,r=n.length,o={};r>a;a++)if(e=n[a],e&&e[1]in t){for(a=0,i=e.length;i>a;a++)o[n[0][a]]=e[a];return o}return!1}(),a={request:function(e){var a=n.requestFullscreen;e=e||t.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?e[a]():e[a](i&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){t[n.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(){},onerror:function(){},raw:n};return n?(Object.defineProperties(a,{isFullscreen:{get:function(){return!!t[n.fullscreenElement]}},element:{enumerable:!0,get:function(){return t[n.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!t[n.fullscreenEnabled]}}}),t.addEventListener(n.fullscreenchange,function(e){a.onchange.call(a,e)}),t.addEventListener(n.fullscreenerror,function(e){a.onerror.call(a,e)}),void(e.screenfull=a)):e.screenfull=!1}(window,document),define("screenfull",function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,i){var n=function(e){var t,i=[],n=e.length;for(t=0;t!==n;i.push(e[t++]));return i},a=function(e,t,i){var n,a,r=e.cycle;for(n in r)a=r[n],e[n]="function"==typeof a?a(i,t[i]):a[i%a.length];delete e.cycle},r=function(e,t,n){i.call(this,e,t,n),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=r.prototype.render},o=1e-10,s=i._internals,l=s.isSelector,c=s.isArray,d=r.prototype=i.to({},.1,{}),h=[];r.version="1.19.0",d.constructor=r,d.kill()._gc=!1,r.killTweensOf=r.killDelayedCallsTo=i.killTweensOf,r.getTweensOf=i.getTweensOf,r.lagSmoothing=i.lagSmoothing,r.ticker=i.ticker,r.render=i.render,d.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),i.prototype.invalidate.call(this)},d.updateTo=function(e,t){var n,a=this.ratio,r=this.vars.immediateRender||e.immediateRender;t&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(n in e)this.vars[n]=e[n];if(this._initted||r)if(t)this._initted=!1,r&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&i._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var o=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(o,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||r)for(var s,l=1/(1-a),c=this._firstPT;c;)s=c.s+c.c,c.c*=l,c.s=s-c.c,c=c._next;return this},d.render=function(e,t,i){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var n,a,r,l,c,d,h,u,p=this._dirty?this.totalDuration():this._totalDuration,f=this._time,v=this._totalTime,g=this._cycle,m=this._duration,w=this._rawPrevTime;if(e>=p-1e-7?(this._totalTime=p,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=m,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(n=!0,a="onComplete",i=i||this._timeline.autoRemoveChildren),0===m&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(e=0),(0>w||0>=e&&e>=-1e-7||w===o&&"isPause"!==this.data)&&w!==e&&(i=!0,w>o&&(a="onReverseComplete")),this._rawPrevTime=u=!t||e||w===e?e:o)):1e-7>e?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==v||0===m&&w>0)&&(a="onReverseComplete",n=this._reversed),0>e&&(this._active=!1,0===m&&(this._initted||!this.vars.lazy||i)&&(w>=0&&(i=!0),this._rawPrevTime=u=!t||e||w===e?e:o)),this._initted||(i=!0)):(this._totalTime=this._time=e,0!==this._repeat&&(l=m+this._repeatDelay,this._cycle=this._totalTime/l>>0,0!==this._cycle&&this._cycle===this._totalTime/l&&e>=v&&this._cycle--,this._time=this._totalTime-this._cycle*l,this._yoyo&&0!==(1&this._cycle)&&(this._time=m-this._time),this._time>m?this._time=m:this._time<0&&(this._time=0)),this._easeType?(c=this._time/m,d=this._easeType,h=this._easePower,(1===d||3===d&&c>=.5)&&(c=1-c),3===d&&(c*=2),1===h?c*=c:2===h?c*=c*c:3===h?c*=c*c*c:4===h&&(c*=c*c*c*c),1===d?this.ratio=1-c:2===d?this.ratio=c:this._time/m<.5?this.ratio=c/2:this.ratio=1-c/2):this.ratio=this._ease.getRatio(this._time/m)),f===this._time&&!i&&g===this._cycle)return void(v!==this._totalTime&&this._onUpdate&&(t||this._callback("onUpdate")));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=f,this._totalTime=v,this._rawPrevTime=w,this._cycle=g,s.lazyTweens.push(this),void(this._lazy=[e,t]);this._time&&!n?this.ratio=this._ease.getRatio(this._time/m):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==f&&e>=0&&(this._active=!0),0===v&&(2===this._initted&&e>0&&this._init(),this._startAt&&(e>=0?this._startAt.render(e,t,i):a||(a="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===m)&&(t||this._callback("onStart"))),r=this._firstPT;r;)r.f?r.t[r.p](r.c*this.ratio+r.s):r.t[r.p]=r.c*this.ratio+r.s,
r=r._next;this._onUpdate&&(0>e&&this._startAt&&this._startTime&&this._startAt.render(e,t,i),t||(this._totalTime!==v||a)&&this._callback("onUpdate")),this._cycle!==g&&(t||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),a&&(!this._gc||i)&&(0>e&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(e,t,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[a]&&this._callback(a),0===m&&this._rawPrevTime===o&&u!==o&&(this._rawPrevTime=0))},r.to=function(e,t,i){return new r(e,t,i)},r.from=function(e,t,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new r(e,t,i)},r.fromTo=function(e,t,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new r(e,t,n)},r.staggerTo=r.allTo=function(e,t,o,s,d,u,p){s=s||0;var f,v,g,m,w=0,_=[],y=function(){o.onComplete&&o.onComplete.apply(o.onCompleteScope||this,arguments),d.apply(p||o.callbackScope||this,u||h)},b=o.cycle,x=o.startAt&&o.startAt.cycle;for(c(e)||("string"==typeof e&&(e=i.selector(e)||e),l(e)&&(e=n(e))),e=e||[],0>s&&(e=n(e),e.reverse(),s*=-1),f=e.length-1,g=0;f>=g;g++){v={};for(m in o)v[m]=o[m];if(b&&(a(v,e,g),null!=v.duration&&(t=v.duration,delete v.duration)),x){x=v.startAt={};for(m in o.startAt)x[m]=o.startAt[m];a(v.startAt,e,g)}v.delay=w+(v.delay||0),g===f&&d&&(v.onComplete=y),_[g]=new r(e[g],t,v),w+=s}return _},r.staggerFrom=r.allFrom=function(e,t,i,n,a,o,s){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,r.staggerTo(e,t,i,n,a,o,s)},r.staggerFromTo=r.allFromTo=function(e,t,i,n,a,o,s,l){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,r.staggerTo(e,t,n,a,o,s,l)},r.delayedCall=function(e,t,i,n,a){return new r(t,0,{delay:e,onComplete:t,onCompleteParams:i,callbackScope:n,onReverseComplete:t,onReverseCompleteParams:i,immediateRender:!1,useFrames:a,overwrite:0})},r.set=function(e,t){return new r(e,0,t)},r.isTweening=function(e){return i.getTweensOf(e,!0).length>0};var u=function(e,t){for(var n=[],a=0,r=e._first;r;)r instanceof i?n[a++]=r:(t&&(n[a++]=r),n=n.concat(u(r,t)),a=n.length),r=r._next;return n},p=r.getAllTweens=function(t){return u(e._rootTimeline,t).concat(u(e._rootFramesTimeline,t))};r.killAll=function(e,i,n,a){null==i&&(i=!0),null==n&&(n=!0);var r,o,s,l=p(0!=a),c=l.length,d=i&&n&&a;for(s=0;c>s;s++)o=l[s],(d||o instanceof t||(r=o.target===o.vars.onComplete)&&n||i&&!r)&&(e?o.totalTime(o._reversed?0:o.totalDuration()):o._enabled(!1,!1))},r.killChildTweensOf=function(e,t){if(null!=e){var a,o,d,h,u,p=s.tweenLookup;if("string"==typeof e&&(e=i.selector(e)||e),l(e)&&(e=n(e)),c(e))for(h=e.length;--h>-1;)r.killChildTweensOf(e[h],t);else{a=[];for(d in p)for(o=p[d].target.parentNode;o;)o===e&&(a=a.concat(p[d].tweens)),o=o.parentNode;for(u=a.length,h=0;u>h;h++)t&&a[h].totalTime(a[h].totalDuration()),a[h]._enabled(!1,!1)}}};var f=function(e,i,n,a){i=i!==!1,n=n!==!1,a=a!==!1;for(var r,o,s=p(a),l=i&&n&&a,c=s.length;--c>-1;)o=s[c],(l||o instanceof t||(r=o.target===o.vars.onComplete)&&n||i&&!r)&&o.paused(e)};return r.pauseAll=function(e,t,i){f(!0,e,t,i)},r.resumeAll=function(e,t,i){f(!1,e,t,i)},r.globalTimeScale=function(t){var n=e._rootTimeline,a=i.ticker.time;return arguments.length?(t=t||o,n._startTime=a-(a-n._startTime)*n._timeScale/t,n=e._rootFramesTimeline,a=i.ticker.frame,n._startTime=a-(a-n._startTime)*n._timeScale/t,n._timeScale=e._rootTimeline._timeScale=t,t):n._timeScale},d.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),t):this._time/this.duration()},d.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this._totalTime/this.totalDuration()},d.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},d.duration=function(t){return arguments.length?e.prototype.duration.call(this,t):this._duration},d.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},d.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},d.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},d.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},r},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,i){var n=function(e){t.call(this,e),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var i,n,a=this.vars;for(n in a)i=a[n],l(i)&&-1!==i.join("").indexOf("{self}")&&(a[n]=this._swapSelfInParams(i));l(a.tweens)&&this.add(a.tweens,0,a.align,a.stagger)},a=1e-10,r=i._internals,o=n._internals={},s=r.isSelector,l=r.isArray,c=r.lazyTweens,d=r.lazyRender,h=_gsScope._gsDefine.globals,u=function(e){var t,i={};for(t in e)i[t]=e[t];return i},p=function(e,t,i){var n,a,r=e.cycle;for(n in r)a=r[n],e[n]="function"==typeof a?a.call(t[i],i):a[i%a.length];delete e.cycle},f=o.pauseCallback=function(){},v=function(e){var t,i=[],n=e.length;for(t=0;t!==n;i.push(e[t++]));return i},g=n.prototype=new t;return n.version="1.19.0",g.constructor=n,g.kill()._gc=g._forcingPlayhead=g._hasPause=!1,g.to=function(e,t,n,a){var r=n.repeat&&h.TweenMax||i;return t?this.add(new r(e,t,n),a):this.set(e,n,a)},g.from=function(e,t,n,a){return this.add((n.repeat&&h.TweenMax||i).from(e,t,n),a)},g.fromTo=function(e,t,n,a,r){var o=a.repeat&&h.TweenMax||i;return t?this.add(o.fromTo(e,t,n,a),r):this.set(e,a,r)},g.staggerTo=function(e,t,a,r,o,l,c,d){var h,f,g=new n({onComplete:l,onCompleteParams:c,callbackScope:d,smoothChildTiming:this.smoothChildTiming}),m=a.cycle;for("string"==typeof e&&(e=i.selector(e)||e),e=e||[],s(e)&&(e=v(e)),r=r||0,0>r&&(e=v(e),e.reverse(),r*=-1),f=0;f<e.length;f++)h=u(a),h.startAt&&(h.startAt=u(h.startAt),h.startAt.cycle&&p(h.startAt,e,f)),m&&(p(h,e,f),null!=h.duration&&(t=h.duration,delete h.duration)),g.to(e[f],t,h,f*r);return this.add(g,o)},g.staggerFrom=function(e,t,i,n,a,r,o,s){return i.immediateRender=0!=i.immediateRender,i.runBackwards=!0,this.staggerTo(e,t,i,n,a,r,o,s)},g.staggerFromTo=function(e,t,i,n,a,r,o,s,l){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,this.staggerTo(e,t,n,a,r,o,s,l)},g.call=function(e,t,n,a){return this.add(i.delayedCall(0,e,t,n),a)},g.set=function(e,t,n){return n=this._parseTimeOrLabel(n,0,!0),null==t.immediateRender&&(t.immediateRender=n===this._time&&!this._paused),this.add(new i(e,0,t),n)},n.exportRoot=function(e,t){e=e||{},null==e.smoothChildTiming&&(e.smoothChildTiming=!0);var a,r,o=new n(e),s=o._timeline;for(null==t&&(t=!0),s._remove(o,!0),o._startTime=0,o._rawPrevTime=o._time=o._totalTime=s._time,a=s._first;a;)r=a._next,t&&a instanceof i&&a.target===a.vars.onComplete||o.add(a,a._startTime-a._delay),a=r;return s.add(o,0),o},g.add=function(a,r,o,s){var c,d,h,u,p,f;if("number"!=typeof r&&(r=this._parseTimeOrLabel(r,0,!0,a)),!(a instanceof e)){if(a instanceof Array||a&&a.push&&l(a)){for(o=o||"normal",s=s||0,c=r,d=a.length,h=0;d>h;h++)l(u=a[h])&&(u=new n({tweens:u})),this.add(u,c),"string"!=typeof u&&"function"!=typeof u&&("sequence"===o?c=u._startTime+u.totalDuration()/u._timeScale:"start"===o&&(u._startTime-=u.delay())),c+=s;return this._uncache(!0)}if("string"==typeof a)return this.addLabel(a,r);if("function"!=typeof a)throw"Cannot add "+a+" into the timeline; it is not a tween, timeline, function, or string.";a=i.delayedCall(0,a)}if(t.prototype.add.call(this,a,r),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(p=this,f=p.rawTime()>a._startTime;p._timeline;)f&&p._timeline.smoothChildTiming?p.totalTime(p._totalTime,!0):p._gc&&p._enabled(!0,!1),p=p._timeline;return this},g.remove=function(t){if(t instanceof e){this._remove(t,!1);var i=t._timeline=t.vars.useFrames?e._rootFramesTimeline:e._rootTimeline;return t._startTime=(t._paused?t._pauseTime:i._time)-(t._reversed?t.totalDuration()-t._totalTime:t._totalTime)/t._timeScale,this}if(t instanceof Array||t&&t.push&&l(t)){for(var n=t.length;--n>-1;)this.remove(t[n]);return this}return"string"==typeof t?this.removeLabel(t):this.kill(null,t)},g._remove=function(e,i){t.prototype._remove.call(this,e,i);var n=this._last;return n?this._time>n._startTime+n._totalDuration/n._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},g.append=function(e,t){return this.add(e,this._parseTimeOrLabel(null,t,!0,e))},g.insert=g.insertMultiple=function(e,t,i,n){return this.add(e,t||0,i,n)},g.appendMultiple=function(e,t,i,n){return this.add(e,this._parseTimeOrLabel(null,t,!0,e),i,n)},g.addLabel=function(e,t){return this._labels[e]=this._parseTimeOrLabel(t),this},g.addPause=function(e,t,n,a){var r=i.delayedCall(0,f,n,a||this);return r.vars.onComplete=r.vars.onReverseComplete=t,r.data="isPause",this._hasPause=!0,this.add(r,e)},g.removeLabel=function(e){return delete this._labels[e],this},g.getLabelTime=function(e){return null!=this._labels[e]?this._labels[e]:-1},g._parseTimeOrLabel=function(t,i,n,a){var r;if(a instanceof e&&a.timeline===this)this.remove(a);else if(a&&(a instanceof Array||a.push&&l(a)))for(r=a.length;--r>-1;)a[r]instanceof e&&a[r].timeline===this&&this.remove(a[r]);if("string"==typeof i)return this._parseTimeOrLabel(i,n&&"number"==typeof t&&null==this._labels[i]?t-this.duration():0,n);if(i=i||0,"string"!=typeof t||!isNaN(t)&&null==this._labels[t])null==t&&(t=this.duration());else{if(r=t.indexOf("="),-1===r)return null==this._labels[t]?n?this._labels[t]=this.duration()+i:i:this._labels[t]+i;i=parseInt(t.charAt(r-1)+"1",10)*Number(t.substr(r+1)),t=r>1?this._parseTimeOrLabel(t.substr(0,r-1),0,n):this.duration()}return Number(t)+i},g.seek=function(e,t){return this.totalTime("number"==typeof e?e:this._parseTimeOrLabel(e),t!==!1)},g.stop=function(){return this.paused(!0)},g.gotoAndPlay=function(e,t){return this.play(e,t)},g.gotoAndStop=function(e,t){return this.pause(e,t)},g.render=function(e,t,i){this._gc&&this._enabled(!0,!1);var n,r,o,s,l,h,u,p=this._dirty?this.totalDuration():this._totalDuration,f=this._time,v=this._startTime,g=this._timeScale,m=this._paused;if(e>=p-1e-7)this._totalTime=this._time=p,this._reversed||this._hasPausedChild()||(r=!0,s="onComplete",l=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=e&&e>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===a)&&this._rawPrevTime!==e&&this._first&&(l=!0,this._rawPrevTime>a&&(s="onReverseComplete"))),this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,e=p+1e-4;else if(1e-7>e)if(this._totalTime=this._time=0,(0!==f||0===this._duration&&this._rawPrevTime!==a&&(this._rawPrevTime>0||0>e&&this._rawPrevTime>=0))&&(s="onReverseComplete",r=this._reversed),0>e)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(l=r=!0,s="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(l=!0),this._rawPrevTime=e;else{if(this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,0===e&&r)for(n=this._first;n&&0===n._startTime;)n._duration||(r=!1),n=n._next;e=0,this._initted||(l=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!t){if(e>=f)for(n=this._first;n&&n._startTime<=e&&!h;)n._duration||"isPause"!==n.data||n.ratio||0===n._startTime&&0===this._rawPrevTime||(h=n),n=n._next;else for(n=this._last;n&&n._startTime>=e&&!h;)n._duration||"isPause"===n.data&&n._rawPrevTime>0&&(h=n),n=n._prev;h&&(this._time=e=h._startTime,this._totalTime=e+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=e}if(this._time!==f&&this._first||i||l||h){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==f&&e>0&&(this._active=!0),0===f&&this.vars.onStart&&(0===this._time&&this._duration||t||this._callback("onStart")),u=this._time,u>=f)for(n=this._first;n&&(o=n._next,u===this._time&&(!this._paused||m));)(n._active||n._startTime<=u&&!n._paused&&!n._gc)&&(h===n&&this.pause(),n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)),n=o;else for(n=this._last;n&&(o=n._prev,u===this._time&&(!this._paused||m));){if(n._active||n._startTime<=f&&!n._paused&&!n._gc){if(h===n){for(h=n._prev;h&&h.endTime()>this._time;)h.render(h._reversed?h.totalDuration()-(e-h._startTime)*h._timeScale:(e-h._startTime)*h._timeScale,t,i),h=h._prev;h=null,this.pause()}n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)}n=o}this._onUpdate&&(t||(c.length&&d(),this._callback("onUpdate"))),s&&(this._gc||(v===this._startTime||g!==this._timeScale)&&(0===this._time||p>=this.totalDuration())&&(r&&(c.length&&d(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[s]&&this._callback(s)))}},g._hasPausedChild=function(){for(var e=this._first;e;){if(e._paused||e instanceof n&&e._hasPausedChild())return!0;e=e._next}return!1},g.getChildren=function(e,t,n,a){a=a||-9999999999;for(var r=[],o=this._first,s=0;o;)o._startTime<a||(o instanceof i?t!==!1&&(r[s++]=o):(n!==!1&&(r[s++]=o),e!==!1&&(r=r.concat(o.getChildren(!0,t,n)),s=r.length))),o=o._next;return r},g.getTweensOf=function(e,t){var n,a,r=this._gc,o=[],s=0;for(r&&this._enabled(!0,!0),n=i.getTweensOf(e),a=n.length;--a>-1;)(n[a].timeline===this||t&&this._contains(n[a]))&&(o[s++]=n[a]);return r&&this._enabled(!1,!0),o},g.recent=function(){return this._recent},g._contains=function(e){for(var t=e.timeline;t;){if(t===this)return!0;t=t.timeline}return!1},g.shiftChildren=function(e,t,i){i=i||0;for(var n,a=this._first,r=this._labels;a;)a._startTime>=i&&(a._startTime+=e),a=a._next;if(t)for(n in r)r[n]>=i&&(r[n]+=e);return this._uncache(!0)},g._kill=function(e,t){if(!e&&!t)return this._enabled(!1,!1);for(var i=t?this.getTweensOf(t):this.getChildren(!0,!0,!1),n=i.length,a=!1;--n>-1;)i[n]._kill(e,t)&&(a=!0);return a},g.clear=function(e){var t=this.getChildren(!1,!0,!0),i=t.length;for(this._time=this._totalTime=0;--i>-1;)t[i]._enabled(!1,!1);return e!==!1&&(this._labels={}),this._uncache(!0)},g.invalidate=function(){for(var t=this._first;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},g._enabled=function(e,i){if(e===this._gc)for(var n=this._first;n;)n._enabled(e,!0),n=n._next;return t.prototype._enabled.call(this,e,i)},g.totalTime=function(t,i,n){this._forcingPlayhead=!0;var a=e.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,a},g.duration=function(e){return arguments.length?(0!==this.duration()&&0!==e&&this.timeScale(this._duration/e),this):(this._dirty&&this.totalDuration(),this._duration)},g.totalDuration=function(e){if(!arguments.length){if(this._dirty){for(var t,i,n=0,a=this._last,r=999999999999;a;)t=a._prev,a._dirty&&a.totalDuration(),a._startTime>r&&this._sortChildren&&!a._paused?this.add(a,a._startTime-a._delay):r=a._startTime,a._startTime<0&&!a._paused&&(n-=a._startTime,this._timeline.smoothChildTiming&&(this._startTime+=a._startTime/this._timeScale),this.shiftChildren(-a._startTime,!1,-9999999999),r=0),i=a._startTime+a._totalDuration/a._timeScale,i>n&&(n=i),a=t;this._duration=this._totalDuration=n,this._dirty=!1}return this._totalDuration}return e&&this.totalDuration()?this.timeScale(this._totalDuration/e):this},g.paused=function(t){if(!t)for(var i=this._first,n=this._time;i;)i._startTime===n&&"isPause"===i.data&&(i._rawPrevTime=0),i=i._next;return e.prototype.paused.apply(this,arguments)},g.usesFrames=function(){for(var t=this._timeline;t._timeline;)t=t._timeline;return t===e._rootFramesTimeline},g.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},n},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(e,t,i){var n=function(t){e.call(this,t),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},a=1e-10,r=t._internals,o=r.lazyTweens,s=r.lazyRender,l=_gsScope._gsDefine.globals,c=new i(null,null,1,0),d=n.prototype=new e;return d.constructor=n,d.kill()._gc=!1,n.version="1.19.0",d.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),e.prototype.invalidate.call(this)},d.addCallback=function(e,i,n,a){return this.add(t.delayedCall(0,e,n,a),i)},d.removeCallback=function(e,t){if(e)if(null==t)this._kill(null,e);else for(var i=this.getTweensOf(e,!1),n=i.length,a=this._parseTimeOrLabel(t);--n>-1;)i[n]._startTime===a&&i[n]._enabled(!1,!1);return this},d.removePause=function(t){return this.removeCallback(e._internals.pauseCallback,t)},d.tweenTo=function(e,i){i=i||{};var n,a,r,o={ease:c,useFrames:this.usesFrames(),immediateRender:!1},s=i.repeat&&l.TweenMax||t;for(a in i)o[a]=i[a];return o.time=this._parseTimeOrLabel(e),n=Math.abs(Number(o.time)-this._time)/this._timeScale||.001,r=new s(this,n,o),o.onStart=function(){r.target.paused(!0),r.vars.time!==r.target.time()&&n===r.duration()&&r.duration(Math.abs(r.vars.time-r.target.time())/r.target._timeScale),i.onStart&&r._callback("onStart")},r},d.tweenFromTo=function(e,t,i){i=i||{},e=this._parseTimeOrLabel(e),i.startAt={onComplete:this.seek,onCompleteParams:[e],callbackScope:this},i.immediateRender=i.immediateRender!==!1;var n=this.tweenTo(t,i);return n.duration(Math.abs(n.vars.time-e)/this._timeScale||.001)},d.render=function(e,t,i){this._gc&&this._enabled(!0,!1);var n,r,l,c,d,h,u,p,f=this._dirty?this.totalDuration():this._totalDuration,v=this._duration,g=this._time,m=this._totalTime,w=this._startTime,_=this._timeScale,y=this._rawPrevTime,b=this._paused,x=this._cycle;if(e>=f-1e-7)this._locked||(this._totalTime=f,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(r=!0,c="onComplete",d=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=e&&e>=-1e-7||0>y||y===a)&&y!==e&&this._first&&(d=!0,y>a&&(c="onReverseComplete"))),this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,this._yoyo&&0!==(1&this._cycle)?this._time=e=0:(this._time=v,e=v+1e-4);else if(1e-7>e)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==g||0===v&&y!==a&&(y>0||0>e&&y>=0)&&!this._locked)&&(c="onReverseComplete",r=this._reversed),0>e)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(d=r=!0,c="onReverseComplete"):y>=0&&this._first&&(d=!0),this._rawPrevTime=e;else{if(this._rawPrevTime=v||!t||e||this._rawPrevTime===e?e:a,0===e&&r)for(n=this._first;n&&0===n._startTime;)n._duration||(r=!1),n=n._next;e=0,this._initted||(d=!0)}else if(0===v&&0>y&&(d=!0),this._time=this._rawPrevTime=e,this._locked||(this._totalTime=e,0!==this._repeat&&(h=v+this._repeatDelay,this._cycle=this._totalTime/h>>0,0!==this._cycle&&this._cycle===this._totalTime/h&&e>=m&&this._cycle--,this._time=this._totalTime-this._cycle*h,this._yoyo&&0!==(1&this._cycle)&&(this._time=v-this._time),this._time>v?(this._time=v,e=v+1e-4):this._time<0?this._time=e=0:e=this._time)),this._hasPause&&!this._forcingPlayhead&&!t){if(e=this._time,e>=g)for(n=this._first;n&&n._startTime<=e&&!u;)n._duration||"isPause"!==n.data||n.ratio||0===n._startTime&&0===this._rawPrevTime||(u=n),n=n._next;else for(n=this._last;n&&n._startTime>=e&&!u;)n._duration||"isPause"===n.data&&n._rawPrevTime>0&&(u=n),n=n._prev;u&&(this._time=e=u._startTime,this._totalTime=e+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==x&&!this._locked){var S=this._yoyo&&0!==(1&x),C=S===(this._yoyo&&0!==(1&this._cycle)),T=this._totalTime,k=this._cycle,P=this._rawPrevTime,E=this._time;if(this._totalTime=x*v,this._cycle<x?S=!S:this._totalTime+=v,this._time=g,this._rawPrevTime=0===v?y-1e-4:y,this._cycle=x,this._locked=!0,g=S?0:v,this.render(g,t,0===v),t||this._gc||this.vars.onRepeat&&this._callback("onRepeat"),g!==this._time)return;if(C&&(g=S?v+1e-4:-1e-4,this.render(g,!0,!1)),this._locked=!1,this._paused&&!b)return;this._time=E,this._totalTime=T,this._cycle=k,this._rawPrevTime=P}if(!(this._time!==g&&this._first||i||d||u))return void(m!==this._totalTime&&this._onUpdate&&(t||this._callback("onUpdate")));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==m&&e>0&&(this._active=!0),0===m&&this.vars.onStart&&(0===this._totalTime&&this._totalDuration||t||this._callback("onStart")),p=this._time,p>=g)for(n=this._first;n&&(l=n._next,p===this._time&&(!this._paused||b));)(n._active||n._startTime<=this._time&&!n._paused&&!n._gc)&&(u===n&&this.pause(),n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)),n=l;else for(n=this._last;n&&(l=n._prev,p===this._time&&(!this._paused||b));){if(n._active||n._startTime<=g&&!n._paused&&!n._gc){if(u===n){for(u=n._prev;u&&u.endTime()>this._time;)u.render(u._reversed?u.totalDuration()-(e-u._startTime)*u._timeScale:(e-u._startTime)*u._timeScale,t,i),u=u._prev;u=null,this.pause()}n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)}n=l}this._onUpdate&&(t||(o.length&&s(),this._callback("onUpdate"))),c&&(this._locked||this._gc||(w===this._startTime||_!==this._timeScale)&&(0===this._time||f>=this.totalDuration())&&(r&&(o.length&&s(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[c]&&this._callback(c)))},d.getActive=function(e,t,i){null==e&&(e=!0),null==t&&(t=!0),null==i&&(i=!1);var n,a,r=[],o=this.getChildren(e,t,i),s=0,l=o.length;for(n=0;l>n;n++)a=o[n],a.isActive()&&(r[s++]=a);return r},d.getLabelAfter=function(e){e||0!==e&&(e=this._time);var t,i=this.getLabelsArray(),n=i.length;for(t=0;n>t;t++)if(i[t].time>e)return i[t].name;return null},d.getLabelBefore=function(e){null==e&&(e=this._time);for(var t=this.getLabelsArray(),i=t.length;--i>-1;)if(t[i].time<e)return t[i].name;return null},d.getLabelsArray=function(){var e,t=[],i=0;for(e in this._labels)t[i++]={time:this._labels[e],name:e};return t.sort(function(e,t){return e.time-t.time}),t},d.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),t):this._time/this.duration()},d.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this._totalTime/this.totalDuration()},d.totalDuration=function(t){return arguments.length?-1!==this._repeat&&t?this.timeScale(this.totalDuration()/t):this:(this._dirty&&(e.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},d.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},d.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},d.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},d.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},d.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.getLabelBefore(this._time+1e-8)},n},!0),function(){var e=180/Math.PI,t=[],i=[],n=[],a={},r=_gsScope._gsDefine.globals,o=function(e,t,i,n){i===n&&(i=n-(n-t)/1e6),e===t&&(t=e+(i-e)/1e6),this.a=e,this.b=t,this.c=i,this.d=n,this.da=n-e,this.ca=i-e,this.ba=t-e},s=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",l=function(e,t,i,n){var a={a:e},r={},o={},s={c:n},l=(e+t)/2,c=(t+i)/2,d=(i+n)/2,h=(l+c)/2,u=(c+d)/2,p=(u-h)/8;return a.b=l+(e-l)/4,r.b=h+p,a.c=r.a=(a.b+r.b)/2,r.c=o.a=(h+u)/2,o.b=u-p,s.b=d+(n-d)/4,o.c=s.a=(o.b+s.b)/2,[a,r,o,s]},c=function(e,a,r,o,s){var c,d,h,u,p,f,v,g,m,w,_,y,b,x=e.length-1,S=0,C=e[0].a;for(c=0;x>c;c++)p=e[S],d=p.a,h=p.d,u=e[S+1].d,s?(_=t[c],y=i[c],b=(y+_)*a*.25/(o?.5:n[c]||.5),f=h-(h-d)*(o?.5*a:0!==_?b/_:0),v=h+(u-h)*(o?.5*a:0!==y?b/y:0),g=h-(f+((v-f)*(3*_/(_+y)+.5)/4||0))):(f=h-(h-d)*a*.5,v=h+(u-h)*a*.5,g=h-(f+v)/2),f+=g,v+=g,p.c=m=f,0!==c?p.b=C:p.b=C=p.a+.6*(p.c-p.a),p.da=h-d,p.ca=m-d,p.ba=C-d,r?(w=l(d,C,m,h),e.splice(S,1,w[0],w[1],w[2],w[3]),S+=4):S++,C=v;p=e[S],p.b=C,p.c=C+.4*(p.d-C),p.da=p.d-p.a,p.ca=p.c-p.a,p.ba=C-p.a,r&&(w=l(p.a,C,p.c,p.d),e.splice(S,1,w[0],w[1],w[2],w[3]))},d=function(e,n,a,r){var s,l,c,d,h,u,p=[];if(r)for(e=[r].concat(e),l=e.length;--l>-1;)"string"==typeof(u=e[l][n])&&"="===u.charAt(1)&&(e[l][n]=r[n]+Number(u.charAt(0)+u.substr(2)));if(s=e.length-2,0>s)return p[0]=new o(e[0][n],0,0,e[-1>s?0:1][n]),p;for(l=0;s>l;l++)c=e[l][n],d=e[l+1][n],p[l]=new o(c,0,0,d),a&&(h=e[l+2][n],t[l]=(t[l]||0)+(d-c)*(d-c),i[l]=(i[l]||0)+(h-d)*(h-d));return p[l]=new o(e[l][n],0,0,e[l+1][n]),p},h=function(e,r,o,l,h,u){var p,f,v,g,m,w,_,y,b={},x=[],S=u||e[0];h="string"==typeof h?","+h+",":s,null==r&&(r=1);for(f in e[0])x.push(f);if(e.length>1){for(y=e[e.length-1],_=!0,p=x.length;--p>-1;)if(f=x[p],Math.abs(S[f]-y[f])>.05){_=!1;break}_&&(e=e.concat(),u&&e.unshift(u),e.push(e[1]),u=e[e.length-3])}for(t.length=i.length=n.length=0,p=x.length;--p>-1;)f=x[p],a[f]=-1!==h.indexOf(","+f+","),b[f]=d(e,f,a[f],u);for(p=t.length;--p>-1;)t[p]=Math.sqrt(t[p]),i[p]=Math.sqrt(i[p]);if(!l){for(p=x.length;--p>-1;)if(a[f])for(v=b[x[p]],w=v.length-1,g=0;w>g;g++)m=v[g+1].da/i[g]+v[g].da/t[g]||0,n[g]=(n[g]||0)+m*m;for(p=n.length;--p>-1;)n[p]=Math.sqrt(n[p])}for(p=x.length,g=o?4:1;--p>-1;)f=x[p],v=b[f],c(v,r,o,l,a[f]),_&&(v.splice(0,g),v.splice(v.length-g,g));return b},u=function(e,t,i){t=t||"soft";var n,a,r,s,l,c,d,h,u,p,f,v={},g="cubic"===t?3:2,m="soft"===t,w=[];if(m&&i&&(e=[i].concat(e)),null==e||e.length<g+1)throw"invalid Bezier data";for(u in e[0])w.push(u);for(c=w.length;--c>-1;){for(u=w[c],v[u]=l=[],p=0,h=e.length,d=0;h>d;d++)n=null==i?e[d][u]:"string"==typeof(f=e[d][u])&&"="===f.charAt(1)?i[u]+Number(f.charAt(0)+f.substr(2)):Number(f),m&&d>1&&h-1>d&&(l[p++]=(n+l[p-2])/2),l[p++]=n;for(h=p-g+1,p=0,d=0;h>d;d+=g)n=l[d],a=l[d+1],r=l[d+2],s=2===g?0:l[d+3],l[p++]=f=3===g?new o(n,a,r,s):new o(n,(2*a+n)/3,(2*a+r)/3,r);l.length=p}return v},p=function(e,t,i){for(var n,a,r,o,s,l,c,d,h,u,p,f=1/i,v=e.length;--v>-1;)for(u=e[v],r=u.a,o=u.d-r,s=u.c-r,l=u.b-r,n=a=0,d=1;i>=d;d++)c=f*d,h=1-c,n=a-(a=(c*c*o+3*h*(c*s+h*l))*c),p=v*i+d-1,t[p]=(t[p]||0)+n*n},f=function(e,t){t=t>>0||6;var i,n,a,r,o=[],s=[],l=0,c=0,d=t-1,h=[],u=[];for(i in e)p(e[i],o,t);for(a=o.length,n=0;a>n;n++)l+=Math.sqrt(o[n]),r=n%t,u[r]=l,r===d&&(c+=l,r=n/t>>0,h[r]=u,s[r]=c,l=0,u=[]);return{length:c,lengths:s,segments:h}},v=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.7",API:2,global:!0,init:function(e,t,i){this._target=e,t instanceof Array&&(t={values:t}),this._func={},this._mod={},this._props=[],this._timeRes=null==t.timeResolution?6:parseInt(t.timeResolution,10);var n,a,r,o,s,l=t.values||[],c={},d=l[0],p=t.autoRotate||i.vars.orientToBezier;this._autoRotate=p?p instanceof Array?p:[["x","y","rotation",p===!0?0:Number(p)||0]]:null;for(n in d)this._props.push(n);for(r=this._props.length;--r>-1;)n=this._props[r],this._overwriteProps.push(n),a=this._func[n]="function"==typeof e[n],c[n]=a?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]():parseFloat(e[n]),s||c[n]!==l[0][n]&&(s=c);if(this._beziers="cubic"!==t.type&&"quadratic"!==t.type&&"soft"!==t.type?h(l,isNaN(t.curviness)?1:t.curviness,!1,"thruBasic"===t.type,t.correlate,s):u(l,t.type,c),this._segCount=this._beziers[n].length,this._timeRes){var v=f(this._beziers,this._timeRes);this._length=v.length,this._lengths=v.lengths,this._segments=v.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(p=this._autoRotate)for(this._initialRotations=[],p[0]instanceof Array||(this._autoRotate=p=[p]),r=p.length;--r>-1;){for(o=0;3>o;o++)n=p[r][o],this._func[n]="function"==typeof e[n]?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]:!1;n=p[r][2],this._initialRotations[r]=(this._func[n]?this._func[n].call(this._target):this._target[n])||0,this._overwriteProps.push(n)}return this._startRatio=i.vars.runBackwards?1:0,!0},set:function(t){var i,n,a,r,o,s,l,c,d,h,u=this._segCount,p=this._func,f=this._target,v=t!==this._startRatio;if(this._timeRes){if(d=this._lengths,h=this._curSeg,t*=this._length,a=this._li,t>this._l2&&u-1>a){for(c=u-1;c>a&&(this._l2=d[++a])<=t;);this._l1=d[a-1],this._li=a,this._curSeg=h=this._segments[a],this._s2=h[this._s1=this._si=0]}else if(t<this._l1&&a>0){for(;a>0&&(this._l1=d[--a])>=t;);0===a&&t<this._l1?this._l1=0:a++,this._l2=d[a],this._li=a,this._curSeg=h=this._segments[a],this._s1=h[(this._si=h.length-1)-1]||0,this._s2=h[this._si]}if(i=a,t-=this._l1,a=this._si,t>this._s2&&a<h.length-1){for(c=h.length-1;c>a&&(this._s2=h[++a])<=t;);this._s1=h[a-1],this._si=a}else if(t<this._s1&&a>0){for(;a>0&&(this._s1=h[--a])>=t;);0===a&&t<this._s1?this._s1=0:a++,this._s2=h[a],this._si=a}s=(a+(t-this._s1)/(this._s2-this._s1))*this._prec||0}else i=0>t?0:t>=1?u-1:u*t>>0,s=(t-i*(1/u))*u;for(n=1-s,a=this._props.length;--a>-1;)r=this._props[a],o=this._beziers[r][i],l=(s*s*o.da+3*n*(s*o.ca+n*o.ba))*s+o.a,this._mod[r]&&(l=this._mod[r](l,f)),p[r]?f[r](l):f[r]=l;if(this._autoRotate){var g,m,w,_,y,b,x,S=this._autoRotate;for(a=S.length;--a>-1;)r=S[a][2],b=S[a][3]||0,x=S[a][4]===!0?1:e,o=this._beziers[S[a][0]],g=this._beziers[S[a][1]],o&&g&&(o=o[i],g=g[i],m=o.a+(o.b-o.a)*s,_=o.b+(o.c-o.b)*s,m+=(_-m)*s,_+=(o.c+(o.d-o.c)*s-_)*s,w=g.a+(g.b-g.a)*s,y=g.b+(g.c-g.b)*s,w+=(y-w)*s,y+=(g.c+(g.d-g.c)*s-y)*s,l=v?Math.atan2(y-w,_-m)*x+b:this._initialRotations[a],this._mod[r]&&(l=this._mod[r](l,f)),p[r]?f[r](l):f[r]=l)}}}),g=v.prototype;v.bezierThrough=h,v.cubicToQuadratic=l,v._autoCSS=!0,v.quadraticToCubic=function(e,t,i){return new o(e,(2*t+e)/3,(2*t+i)/3,i)},v._cssRegister=function(){var e=r.CSSPlugin;if(e){var t=e._internals,i=t._parseToProxy,n=t._setPluginRatio,a=t.CSSPropTween;t._registerComplexSpecialProp("bezier",{parser:function(e,t,r,o,s,l){t instanceof Array&&(t={values:t}),l=new v;var c,d,h,u=t.values,p=u.length-1,f=[],g={};if(0>p)return s;for(c=0;p>=c;c++)h=i(e,u[c],o,s,l,p!==c),f[c]=h.end;for(d in t)g[d]=t[d];return g.values=f,s=new a(e,"bezier",0,0,h.pt,2),s.data=h,s.plugin=l,s.setRatio=n,0===g.autoRotate&&(g.autoRotate=!0),!g.autoRotate||g.autoRotate instanceof Array||(c=g.autoRotate===!0?0:Number(g.autoRotate),g.autoRotate=null!=h.end.left?[["left","top","rotation",c,!1]]:null!=h.end.x?[["x","y","rotation",c,!1]]:!1),g.autoRotate&&(o._transform||o._enableTransforms(!1),h.autoRotate=o._target._gsTransform,h.proxy.rotation=h.autoRotate.rotation||0,o._overwriteProps.push("rotation")),l._onInitTween(h.proxy,g,o._tween),s}})}},g._mod=function(e){for(var t,i=this._overwriteProps,n=i.length;--n>-1;)t=e[i[n]],t&&"function"==typeof t&&(this._mod[i[n]]=t)},g._kill=function(e){var t,i,n=this._props;for(t in this._beziers)if(t in e)for(delete this._beziers[t],delete this._func[t],i=n.length;--i>-1;)n[i]===t&&n.splice(i,1);if(n=this._autoRotate)for(i=n.length;--i>-1;)e[n[i][2]]&&n.splice(i,1);
return this._super._kill.call(this,e)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(e,t){var i,n,a,r,o=function(){e.call(this,"css"),this._overwriteProps.length=0,this.setRatio=o.prototype.setRatio},s=_gsScope._gsDefine.globals,l={},c=o.prototype=new e("css");c.constructor=o,o.version="1.19.0",o.API=2,o.defaultTransformPerspective=0,o.defaultSkewType="compensated",o.defaultSmoothOrigin=!0,c="px",o.suffixMap={top:c,right:c,bottom:c,left:c,width:c,height:c,fontSize:c,padding:c,margin:c,perspective:c,lineHeight:""};var d,h,u,p,f,v,g,m,w=/(?:\-|\.|\b)(\d|\.|e\-)+/g,_=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,y=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,b=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,x=/(?:\d|\-|\+|=|#|\.)*/g,S=/opacity *= *([^)]*)/i,C=/opacity:([^;]*)/i,T=/alpha\(opacity *=.+?\)/i,k=/^(rgb|hsl)/,P=/([A-Z])/g,E=/-([a-z])/gi,D=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,I=function(e,t){return t.toUpperCase()},$=/(?:Left|Right|Width)/i,O=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,A=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,N=/,(?=[^\)]*(?:\(|$))/gi,R=/[\s,\(]/i,M=Math.PI/180,L=180/Math.PI,F={},W=document,B=function(e){return W.createElementNS?W.createElementNS("http://www.w3.org/1999/xhtml",e):W.createElement(e)},j=B("div"),z=B("img"),U=o._internals={_specialProps:l},H=navigator.userAgent,V=function(){var e=H.indexOf("Android"),t=B("a");return u=-1!==H.indexOf("Safari")&&-1===H.indexOf("Chrome")&&(-1===e||Number(H.substr(e+8,1))>3),f=u&&Number(H.substr(H.indexOf("Version/")+8,1))<6,p=-1!==H.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(H)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(H))&&(v=parseFloat(RegExp.$1)),t?(t.style.cssText="top:1px;opacity:.55;",/^0.55/.test(t.style.opacity)):!1}(),Y=function(e){return S.test("string"==typeof e?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},X=function(e){window.console&&console.log(e)},q="",G="",J=function(e,t){t=t||j;var i,n,a=t.style;if(void 0!==a[e])return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),i=["O","Moz","ms","Ms","Webkit"],n=5;--n>-1&&void 0===a[i[n]+e];);return n>=0?(G=3===n?"ms":i[n],q="-"+G.toLowerCase()+"-",G+e):null},Q=W.defaultView?W.defaultView.getComputedStyle:function(){},K=o.getStyle=function(e,t,i,n,a){var r;return V||"opacity"!==t?(!n&&e.style[t]?r=e.style[t]:(i=i||Q(e))?r=i[t]||i.getPropertyValue(t)||i.getPropertyValue(t.replace(P,"-$1").toLowerCase()):e.currentStyle&&(r=e.currentStyle[t]),null==a||r&&"none"!==r&&"auto"!==r&&"auto auto"!==r?r:a):Y(e)},Z=U.convertToPixels=function(e,i,n,a,r){if("px"===a||!a)return n;if("auto"===a||!n)return 0;var s,l,c,d=$.test(i),h=e,u=j.style,p=0>n,f=1===n;if(p&&(n=-n),f&&(n*=100),"%"===a&&-1!==i.indexOf("border"))s=n/100*(d?e.clientWidth:e.clientHeight);else{if(u.cssText="border:0 solid red;position:"+K(e,"position")+";line-height:0;","%"!==a&&h.appendChild&&"v"!==a.charAt(0)&&"rem"!==a)u[d?"borderLeftWidth":"borderTopWidth"]=n+a;else{if(h=e.parentNode||W.body,l=h._gsCache,c=t.ticker.frame,l&&d&&l.time===c)return l.width*n/100;u[d?"width":"height"]=n+a}h.appendChild(j),s=parseFloat(j[d?"offsetWidth":"offsetHeight"]),h.removeChild(j),d&&"%"===a&&o.cacheWidths!==!1&&(l=h._gsCache=h._gsCache||{},l.time=c,l.width=s/n*100),0!==s||r||(s=Z(e,i,n,a,!0))}return f&&(s/=100),p?-s:s},ee=U.calculateOffset=function(e,t,i){if("absolute"!==K(e,"position",i))return 0;var n="left"===t?"Left":"Top",a=K(e,"margin"+n,i);return e["offset"+n]-(Z(e,t,parseFloat(a),a.replace(x,""))||0)},te=function(e,t){var i,n,a,r={};if(t=t||Q(e,null))if(i=t.length)for(;--i>-1;)a=t[i],(-1===a.indexOf("-transform")||Ee===a)&&(r[a.replace(E,I)]=t.getPropertyValue(a));else for(i in t)(-1===i.indexOf("Transform")||Pe===i)&&(r[i]=t[i]);else if(t=e.currentStyle||e.style)for(i in t)"string"==typeof i&&void 0===r[i]&&(r[i.replace(E,I)]=t[i]);return V||(r.opacity=Y(e)),n=je(e,t,!1),r.rotation=n.rotation,r.skewX=n.skewX,r.scaleX=n.scaleX,r.scaleY=n.scaleY,r.x=n.x,r.y=n.y,Ie&&(r.z=n.z,r.rotationX=n.rotationX,r.rotationY=n.rotationY,r.scaleZ=n.scaleZ),r.filters&&delete r.filters,r},ie=function(e,t,i,n,a){var r,o,s,l={},c=e.style;for(o in i)"cssText"!==o&&"length"!==o&&isNaN(o)&&(t[o]!==(r=i[o])||a&&a[o])&&-1===o.indexOf("Origin")&&("number"==typeof r||"string"==typeof r)&&(l[o]="auto"!==r||"left"!==o&&"top"!==o?""!==r&&"auto"!==r&&"none"!==r||"string"!=typeof t[o]||""===t[o].replace(b,"")?r:0:ee(e,o),void 0!==c[o]&&(s=new me(c,o,c[o],s)));if(n)for(o in n)"className"!==o&&(l[o]=n[o]);return{difs:l,firstMPT:s}},ne={width:["Left","Right"],height:["Top","Bottom"]},ae=["marginLeft","marginRight","marginTop","marginBottom"],re=function(e,t,i){if("svg"===(e.nodeName+"").toLowerCase())return(i||Q(e))[t]||0;if(e.getBBox&&Fe(e))return e.getBBox()[t]||0;var n=parseFloat("width"===t?e.offsetWidth:e.offsetHeight),a=ne[t],r=a.length;for(i=i||Q(e,null);--r>-1;)n-=parseFloat(K(e,"padding"+a[r],i,!0))||0,n-=parseFloat(K(e,"border"+a[r]+"Width",i,!0))||0;return n},oe=function(e,t){if("contain"===e||"auto"===e||"auto auto"===e)return e+" ";(null==e||""===e)&&(e="0 0");var i,n=e.split(" "),a=-1!==e.indexOf("left")?"0%":-1!==e.indexOf("right")?"100%":n[0],r=-1!==e.indexOf("top")?"0%":-1!==e.indexOf("bottom")?"100%":n[1];if(n.length>3&&!t){for(n=e.split(", ").join(",").split(","),e=[],i=0;i<n.length;i++)e.push(oe(n[i]));return e.join(",")}return null==r?r="center"===a?"50%":"0":"center"===r&&(r="50%"),("center"===a||isNaN(parseFloat(a))&&-1===(a+"").indexOf("="))&&(a="50%"),e=a+" "+r+(n.length>2?" "+n[2]:""),t&&(t.oxp=-1!==a.indexOf("%"),t.oyp=-1!==r.indexOf("%"),t.oxr="="===a.charAt(1),t.oyr="="===r.charAt(1),t.ox=parseFloat(a.replace(b,"")),t.oy=parseFloat(r.replace(b,"")),t.v=e),t||e},se=function(e,t){return"function"==typeof e&&(e=e(m,g)),"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)||0},le=function(e,t){return"function"==typeof e&&(e=e(m,g)),null==e?t:"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2))+t:parseFloat(e)||0},ce=function(e,t,i,n){var a,r,o,s,l,c=1e-6;return"function"==typeof e&&(e=e(m,g)),null==e?s=t:"number"==typeof e?s=e:(a=360,r=e.split("_"),l="="===e.charAt(1),o=(l?parseInt(e.charAt(0)+"1",10)*parseFloat(r[0].substr(2)):parseFloat(r[0]))*(-1===e.indexOf("rad")?1:L)-(l?0:t),r.length&&(n&&(n[i]=t+o),-1!==e.indexOf("short")&&(o%=a,o!==o%(a/2)&&(o=0>o?o+a:o-a)),-1!==e.indexOf("_cw")&&0>o?o=(o+9999999999*a)%a-(o/a|0)*a:-1!==e.indexOf("ccw")&&o>0&&(o=(o-9999999999*a)%a-(o/a|0)*a)),s=t+o),c>s&&s>-c&&(s=0),s},de={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},he=function(e,t,i){return e=0>e?e+1:e>1?e-1:e,255*(1>6*e?t+(i-t)*e*6:.5>e?i:2>3*e?t+(i-t)*(2/3-e)*6:t)+.5|0},ue=o.parseColor=function(e,t){var i,n,a,r,o,s,l,c,d,h,u;if(e)if("number"==typeof e)i=[e>>16,e>>8&255,255&e];else{if(","===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),de[e])i=de[e];else if("#"===e.charAt(0))4===e.length&&(n=e.charAt(1),a=e.charAt(2),r=e.charAt(3),e="#"+n+n+a+a+r+r),e=parseInt(e.substr(1),16),i=[e>>16,e>>8&255,255&e];else if("hsl"===e.substr(0,3))if(i=u=e.match(w),t){if(-1!==e.indexOf("="))return e.match(_)}else o=Number(i[0])%360/360,s=Number(i[1])/100,l=Number(i[2])/100,a=.5>=l?l*(s+1):l+s-l*s,n=2*l-a,i.length>3&&(i[3]=Number(e[3])),i[0]=he(o+1/3,n,a),i[1]=he(o,n,a),i[2]=he(o-1/3,n,a);else i=e.match(w)||de.transparent;i[0]=Number(i[0]),i[1]=Number(i[1]),i[2]=Number(i[2]),i.length>3&&(i[3]=Number(i[3]))}else i=de.black;return t&&!u&&(n=i[0]/255,a=i[1]/255,r=i[2]/255,c=Math.max(n,a,r),d=Math.min(n,a,r),l=(c+d)/2,c===d?o=s=0:(h=c-d,s=l>.5?h/(2-c-d):h/(c+d),o=c===n?(a-r)/h+(r>a?6:0):c===a?(r-n)/h+2:(n-a)/h+4,o*=60),i[0]=o+.5|0,i[1]=100*s+.5|0,i[2]=100*l+.5|0),i},pe=function(e,t){var i,n,a,r=e.match(fe)||[],o=0,s=r.length?"":e;for(i=0;i<r.length;i++)n=r[i],a=e.substr(o,e.indexOf(n,o)-o),o+=a.length+n.length,n=ue(n,t),3===n.length&&n.push(1),s+=a+(t?"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+n[3]:"rgba("+n.join(","))+")";return s+e.substr(o)},fe="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(c in de)fe+="|"+c+"\\b";fe=new RegExp(fe+")","gi"),o.colorStringFilter=function(e){var t,i=e[0]+e[1];fe.test(i)&&(t=-1!==i.indexOf("hsl(")||-1!==i.indexOf("hsla("),e[0]=pe(e[0],t),e[1]=pe(e[1],t)),fe.lastIndex=0},t.defaultStringFilter||(t.defaultStringFilter=o.colorStringFilter);var ve=function(e,t,i,n){if(null==e)return function(e){return e};var a,r=t?(e.match(fe)||[""])[0]:"",o=e.split(r).join("").match(y)||[],s=e.substr(0,e.indexOf(o[0])),l=")"===e.charAt(e.length-1)?")":"",c=-1!==e.indexOf(" ")?" ":",",d=o.length,h=d>0?o[0].replace(w,""):"";return d?a=t?function(e){var t,u,p,f;if("number"==typeof e)e+=h;else if(n&&N.test(e)){for(f=e.replace(N,"|").split("|"),p=0;p<f.length;p++)f[p]=a(f[p]);return f.join(",")}if(t=(e.match(fe)||[r])[0],u=e.split(t).join("").match(y)||[],p=u.length,d>p--)for(;++p<d;)u[p]=i?u[(p-1)/2|0]:o[p];return s+u.join(c)+c+t+l+(-1!==e.indexOf("inset")?" inset":"")}:function(e){var t,r,u;if("number"==typeof e)e+=h;else if(n&&N.test(e)){for(r=e.replace(N,"|").split("|"),u=0;u<r.length;u++)r[u]=a(r[u]);return r.join(",")}if(t=e.match(y)||[],u=t.length,d>u--)for(;++u<d;)t[u]=i?t[(u-1)/2|0]:o[u];return s+t.join(c)+l}:function(e){return e}},ge=function(e){return e=e.split(","),function(t,i,n,a,r,o,s){var l,c=(i+"").split(" ");for(s={},l=0;4>l;l++)s[e[l]]=c[l]=c[l]||c[(l-1)/2>>0];return a.parse(t,s,r,o)}},me=(U._setPluginRatio=function(e){this.plugin.setRatio(e);for(var t,i,n,a,r,o=this.data,s=o.proxy,l=o.firstMPT,c=1e-6;l;)t=s[l.v],l.r?t=Math.round(t):c>t&&t>-c&&(t=0),l.t[l.p]=t,l=l._next;if(o.autoRotate&&(o.autoRotate.rotation=o.mod?o.mod(s.rotation,this.t):s.rotation),1===e||0===e)for(l=o.firstMPT,r=1===e?"e":"b";l;){if(i=l.t,i.type){if(1===i.type){for(a=i.xs0+i.s+i.xs1,n=1;n<i.l;n++)a+=i["xn"+n]+i["xs"+(n+1)];i[r]=a}}else i[r]=i.s+i.xs0;l=l._next}},function(e,t,i,n,a){this.t=e,this.p=t,this.v=i,this.r=a,n&&(n._prev=this,this._next=n)}),we=(U._parseToProxy=function(e,t,i,n,a,r){var o,s,l,c,d,h=n,u={},p={},f=i._transform,v=F;for(i._transform=null,F=t,n=d=i.parse(e,t,n,a),F=v,r&&(i._transform=f,h&&(h._prev=null,h._prev&&(h._prev._next=null)));n&&n!==h;){if(n.type<=1&&(s=n.p,p[s]=n.s+n.c,u[s]=n.s,r||(c=new me(n,"s",s,c,n.r),n.c=0),1===n.type))for(o=n.l;--o>0;)l="xn"+o,s=n.p+"_"+l,p[s]=n.data[l],u[s]=n[l],r||(c=new me(n,l,s,c,n.rxp[l]));n=n._next}return{proxy:u,end:p,firstMPT:c,pt:d}},U.CSSPropTween=function(e,t,n,a,o,s,l,c,d,h,u){this.t=e,this.p=t,this.s=n,this.c=a,this.n=l||t,e instanceof we||r.push(this.n),this.r=c,this.type=s||0,d&&(this.pr=d,i=!0),this.b=void 0===h?n:h,this.e=void 0===u?n+a:u,o&&(this._next=o,o._prev=this)}),_e=function(e,t,i,n,a,r){var o=new we(e,t,i,n-i,a,-1,r);return o.b=i,o.e=o.xs0=n,o},ye=o.parseComplex=function(e,t,i,n,a,r,s,l,c,h){i=i||r||"","function"==typeof n&&(n=n(m,g)),s=new we(e,t,0,0,s,h?2:1,null,!1,l,i,n),n+="",a&&fe.test(n+i)&&(n=[i,n],o.colorStringFilter(n),i=n[0],n=n[1]);var u,p,f,v,y,b,x,S,C,T,k,P,E,D=i.split(", ").join(",").split(" "),I=n.split(", ").join(",").split(" "),$=D.length,O=d!==!1;for((-1!==n.indexOf(",")||-1!==i.indexOf(","))&&(D=D.join(" ").replace(N,", ").split(" "),I=I.join(" ").replace(N,", ").split(" "),$=D.length),$!==I.length&&(D=(r||"").split(" "),$=D.length),s.plugin=c,s.setRatio=h,fe.lastIndex=0,u=0;$>u;u++)if(v=D[u],y=I[u],S=parseFloat(v),S||0===S)s.appendXtra("",S,se(y,S),y.replace(_,""),O&&-1!==y.indexOf("px"),!0);else if(a&&fe.test(v))P=y.indexOf(")")+1,P=")"+(P?y.substr(P):""),E=-1!==y.indexOf("hsl")&&V,v=ue(v,E),y=ue(y,E),C=v.length+y.length>6,C&&!V&&0===y[3]?(s["xs"+s.l]+=s.l?" transparent":"transparent",s.e=s.e.split(I[u]).join("transparent")):(V||(C=!1),E?s.appendXtra(C?"hsla(":"hsl(",v[0],se(y[0],v[0]),",",!1,!0).appendXtra("",v[1],se(y[1],v[1]),"%,",!1).appendXtra("",v[2],se(y[2],v[2]),C?"%,":"%"+P,!1):s.appendXtra(C?"rgba(":"rgb(",v[0],y[0]-v[0],",",!0,!0).appendXtra("",v[1],y[1]-v[1],",",!0).appendXtra("",v[2],y[2]-v[2],C?",":P,!0),C&&(v=v.length<4?1:v[3],s.appendXtra("",v,(y.length<4?1:y[3])-v,P,!1))),fe.lastIndex=0;else if(b=v.match(w)){if(x=y.match(_),!x||x.length!==b.length)return s;for(f=0,p=0;p<b.length;p++)k=b[p],T=v.indexOf(k,f),s.appendXtra(v.substr(f,T-f),Number(k),se(x[p],k),"",O&&"px"===v.substr(T+k.length,2),0===p),f=T+k.length;s["xs"+s.l]+=v.substr(f)}else s["xs"+s.l]+=s.l||s["xs"+s.l]?" "+y:y;if(-1!==n.indexOf("=")&&s.data){for(P=s.xs0+s.data.s,u=1;u<s.l;u++)P+=s["xs"+u]+s.data["xn"+u];s.e=P+s["xs"+u]}return s.l||(s.type=-1,s.xs0=s.e),s.xfirst||s},be=9;for(c=we.prototype,c.l=c.pr=0;--be>0;)c["xn"+be]=0,c["xs"+be]="";c.xs0="",c._next=c._prev=c.xfirst=c.data=c.plugin=c.setRatio=c.rxp=null,c.appendXtra=function(e,t,i,n,a,r){var o=this,s=o.l;return o["xs"+s]+=r&&(s||o["xs"+s])?" "+e:e||"",i||0===s||o.plugin?(o.l++,o.type=o.setRatio?2:1,o["xs"+o.l]=n||"",s>0?(o.data["xn"+s]=t+i,o.rxp["xn"+s]=a,o["xn"+s]=t,o.plugin||(o.xfirst=new we(o,"xn"+s,t,i,o.xfirst||o,0,o.n,a,o.pr),o.xfirst.xs0=0),o):(o.data={s:t+i},o.rxp={},o.s=t,o.c=i,o.r=a,o)):(o["xs"+s]+=t+(n||""),o)};var xe=function(e,t){t=t||{},this.p=t.prefix?J(e)||e:e,l[e]=l[this.p]=this,this.format=t.formatter||ve(t.defaultValue,t.color,t.collapsible,t.multi),t.parser&&(this.parse=t.parser),this.clrs=t.color,this.multi=t.multi,this.keyword=t.keyword,this.dflt=t.defaultValue,this.pr=t.priority||0},Se=U._registerComplexSpecialProp=function(e,t,i){"object"!=typeof t&&(t={parser:i});var n,a,r=e.split(","),o=t.defaultValue;for(i=i||[o],n=0;n<r.length;n++)t.prefix=0===n&&t.prefix,t.defaultValue=i[n]||o,a=new xe(r[n],t)},Ce=U._registerPluginProp=function(e){if(!l[e]){var t=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";Se(e,{parser:function(e,i,n,a,r,o,c){var d=s.com.greensock.plugins[t];return d?(d._cssRegister(),l[n].parse(e,i,n,a,r,o,c)):(X("Error: "+t+" js file not loaded."),r)}})}};c=xe.prototype,c.parseComplex=function(e,t,i,n,a,r){var o,s,l,c,d,h,u=this.keyword;if(this.multi&&(N.test(i)||N.test(t)?(s=t.replace(N,"|").split("|"),l=i.replace(N,"|").split("|")):u&&(s=[t],l=[i])),l){for(c=l.length>s.length?l.length:s.length,o=0;c>o;o++)t=s[o]=s[o]||this.dflt,i=l[o]=l[o]||this.dflt,u&&(d=t.indexOf(u),h=i.indexOf(u),d!==h&&(-1===h?s[o]=s[o].split(u).join(""):-1===d&&(s[o]+=" "+u)));t=s.join(", "),i=l.join(", ")}return ye(e,this.p,t,i,this.clrs,this.dflt,n,this.pr,a,r)},c.parse=function(e,t,i,n,r,o,s){return this.parseComplex(e.style,this.format(K(e,this.p,a,!1,this.dflt)),this.format(t),r,o)},o.registerSpecialProp=function(e,t,i){Se(e,{parser:function(e,n,a,r,o,s,l){var c=new we(e,a,0,0,o,2,a,!1,i);return c.plugin=s,c.setRatio=t(e,n,r._tween,a),c},priority:i})},o.useSVGTransformAttr=u||p;var Te,ke="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),Pe=J("transform"),Ee=q+"transform",De=J("transformOrigin"),Ie=null!==J("perspective"),$e=U.Transform=function(){this.perspective=parseFloat(o.defaultTransformPerspective)||0,this.force3D=o.defaultForce3D!==!1&&Ie?o.defaultForce3D||"auto":!1},Oe=window.SVGElement,Ae=function(e,t,i){var n,a=W.createElementNS("http://www.w3.org/2000/svg",e),r=/([a-z])([A-Z])/g;for(n in i)a.setAttributeNS(null,n.replace(r,"$1-$2").toLowerCase(),i[n]);return t.appendChild(a),a},Ne=W.documentElement,Re=function(){var e,t,i,n=v||/Android/i.test(H)&&!window.chrome;return W.createElementNS&&!n&&(e=Ae("svg",Ne),t=Ae("rect",e,{width:100,height:50,x:100}),i=t.getBoundingClientRect().width,t.style[De]="50% 50%",t.style[Pe]="scaleX(0.5)",n=i===t.getBoundingClientRect().width&&!(p&&Ie),Ne.removeChild(e)),n}(),Me=function(e,t,i,n,a,r){var s,l,c,d,h,u,p,f,v,g,m,w,_,y,b=e._gsTransform,x=Be(e,!0);b&&(_=b.xOrigin,y=b.yOrigin),(!n||(s=n.split(" ")).length<2)&&(p=e.getBBox(),t=oe(t).split(" "),s=[(-1!==t[0].indexOf("%")?parseFloat(t[0])/100*p.width:parseFloat(t[0]))+p.x,(-1!==t[1].indexOf("%")?parseFloat(t[1])/100*p.height:parseFloat(t[1]))+p.y]),i.xOrigin=d=parseFloat(s[0]),i.yOrigin=h=parseFloat(s[1]),n&&x!==We&&(u=x[0],p=x[1],f=x[2],v=x[3],g=x[4],m=x[5],w=u*v-p*f,l=d*(v/w)+h*(-f/w)+(f*m-v*g)/w,c=d*(-p/w)+h*(u/w)-(u*m-p*g)/w,d=i.xOrigin=s[0]=l,h=i.yOrigin=s[1]=c),b&&(r&&(i.xOffset=b.xOffset,i.yOffset=b.yOffset,b=i),a||a!==!1&&o.defaultSmoothOrigin!==!1?(l=d-_,c=h-y,b.xOffset+=l*x[0]+c*x[2]-l,b.yOffset+=l*x[1]+c*x[3]-c):b.xOffset=b.yOffset=0),r||e.setAttribute("data-svg-origin",s.join(" "))},Le=function(e){try{return e.getBBox()}catch(e){}},Fe=function(e){return!!(Oe&&e.getBBox&&e.getCTM&&Le(e)&&(!e.parentNode||e.parentNode.getBBox&&e.parentNode.getCTM))},We=[1,0,0,1,0,0],Be=function(e,t){var i,n,a,r,o,s,l=e._gsTransform||new $e,c=1e5,d=e.style;if(Pe?n=K(e,Ee,null,!0):e.currentStyle&&(n=e.currentStyle.filter.match(O),n=n&&4===n.length?[n[0].substr(4),Number(n[2].substr(4)),Number(n[1].substr(4)),n[3].substr(4),l.x||0,l.y||0].join(","):""),i=!n||"none"===n||"matrix(1, 0, 0, 1, 0, 0)"===n,i&&Pe&&((s="none"===Q(e).display)||!e.parentNode)&&(s&&(r=d.display,d.display="block"),e.parentNode||(o=1,Ne.appendChild(e)),n=K(e,Ee,null,!0),i=!n||"none"===n||"matrix(1, 0, 0, 1, 0, 0)"===n,r?d.display=r:s&&Ve(d,"display"),o&&Ne.removeChild(e)),(l.svg||e.getBBox&&Fe(e))&&(i&&-1!==(d[Pe]+"").indexOf("matrix")&&(n=d[Pe],i=0),a=e.getAttribute("transform"),i&&a&&(-1!==a.indexOf("matrix")?(n=a,i=0):-1!==a.indexOf("translate")&&(n="matrix(1,0,0,1,"+a.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",i=0))),i)return We;for(a=(n||"").match(w)||[],be=a.length;--be>-1;)r=Number(a[be]),a[be]=(o=r-(r|=0))?(o*c+(0>o?-.5:.5)|0)/c+r:r;return t&&a.length>6?[a[0],a[1],a[4],a[5],a[12],a[13]]:a},je=U.getTransform=function(e,i,n,a){if(e._gsTransform&&n&&!a)return e._gsTransform;var r,s,l,c,d,h,u=n?e._gsTransform||new $e:new $e,p=u.scaleX<0,f=2e-5,v=1e5,g=Ie?parseFloat(K(e,De,i,!1,"0 0 0").split(" ")[2])||u.zOrigin||0:0,m=parseFloat(o.defaultTransformPerspective)||0;if(u.svg=!(!e.getBBox||!Fe(e)),u.svg&&(Me(e,K(e,De,i,!1,"50% 50%")+"",u,e.getAttribute("data-svg-origin")),Te=o.useSVGTransformAttr||Re),r=Be(e),r!==We){if(16===r.length){var w,_,y,b,x,S=r[0],C=r[1],T=r[2],k=r[3],P=r[4],E=r[5],D=r[6],I=r[7],$=r[8],O=r[9],A=r[10],N=r[12],R=r[13],M=r[14],F=r[11],W=Math.atan2(D,A);u.zOrigin&&(M=-u.zOrigin,N=$*M-r[12],R=O*M-r[13],M=A*M+u.zOrigin-r[14]),u.rotationX=W*L,W&&(b=Math.cos(-W),x=Math.sin(-W),w=P*b+$*x,_=E*b+O*x,y=D*b+A*x,$=P*-x+$*b,O=E*-x+O*b,A=D*-x+A*b,F=I*-x+F*b,P=w,E=_,D=y),W=Math.atan2(-T,A),u.rotationY=W*L,W&&(b=Math.cos(-W),x=Math.sin(-W),w=S*b-$*x,_=C*b-O*x,y=T*b-A*x,O=C*x+O*b,A=T*x+A*b,F=k*x+F*b,S=w,C=_,T=y),W=Math.atan2(C,S),u.rotation=W*L,W&&(b=Math.cos(-W),x=Math.sin(-W),S=S*b+P*x,_=C*b+E*x,E=C*-x+E*b,D=T*-x+D*b,C=_),u.rotationX&&Math.abs(u.rotationX)+Math.abs(u.rotation)>359.9&&(u.rotationX=u.rotation=0,u.rotationY=180-u.rotationY),u.scaleX=(Math.sqrt(S*S+C*C)*v+.5|0)/v,u.scaleY=(Math.sqrt(E*E+O*O)*v+.5|0)/v,u.scaleZ=(Math.sqrt(D*D+A*A)*v+.5|0)/v,u.rotationX||u.rotationY?u.skewX=0:(u.skewX=P||E?Math.atan2(P,E)*L+u.rotation:u.skewX||0,Math.abs(u.skewX)>90&&Math.abs(u.skewX)<270&&(p?(u.scaleX*=-1,u.skewX+=u.rotation<=0?180:-180,u.rotation+=u.rotation<=0?180:-180):(u.scaleY*=-1,u.skewX+=u.skewX<=0?180:-180))),u.perspective=F?1/(0>F?-F:F):0,u.x=N,u.y=R,u.z=M,u.svg&&(u.x-=u.xOrigin-(u.xOrigin*S-u.yOrigin*P),u.y-=u.yOrigin-(u.yOrigin*C-u.xOrigin*E))}else if(!Ie||a||!r.length||u.x!==r[4]||u.y!==r[5]||!u.rotationX&&!u.rotationY){var B=r.length>=6,j=B?r[0]:1,z=r[1]||0,U=r[2]||0,H=B?r[3]:1;u.x=r[4]||0,u.y=r[5]||0,l=Math.sqrt(j*j+z*z),c=Math.sqrt(H*H+U*U),d=j||z?Math.atan2(z,j)*L:u.rotation||0,h=U||H?Math.atan2(U,H)*L+d:u.skewX||0,Math.abs(h)>90&&Math.abs(h)<270&&(p?(l*=-1,h+=0>=d?180:-180,d+=0>=d?180:-180):(c*=-1,h+=0>=h?180:-180)),u.scaleX=l,u.scaleY=c,u.rotation=d,u.skewX=h,Ie&&(u.rotationX=u.rotationY=u.z=0,u.perspective=m,u.scaleZ=1),u.svg&&(u.x-=u.xOrigin-(u.xOrigin*j+u.yOrigin*U),u.y-=u.yOrigin-(u.xOrigin*z+u.yOrigin*H))}u.zOrigin=g;for(s in u)u[s]<f&&u[s]>-f&&(u[s]=0)}return n&&(e._gsTransform=u,u.svg&&(Te&&e.style[Pe]?t.delayedCall(.001,function(){Ve(e.style,Pe)}):!Te&&e.getAttribute("transform")&&t.delayedCall(.001,function(){e.removeAttribute("transform")}))),u},ze=function(e){var t,i,n=this.data,a=-n.rotation*M,r=a+n.skewX*M,o=1e5,s=(Math.cos(a)*n.scaleX*o|0)/o,l=(Math.sin(a)*n.scaleX*o|0)/o,c=(Math.sin(r)*-n.scaleY*o|0)/o,d=(Math.cos(r)*n.scaleY*o|0)/o,h=this.t.style,u=this.t.currentStyle;if(u){i=l,l=-c,c=-i,t=u.filter,h.filter="";var p,f,g=this.t.offsetWidth,m=this.t.offsetHeight,w="absolute"!==u.position,_="progid:DXImageTransform.Microsoft.Matrix(M11="+s+", M12="+l+", M21="+c+", M22="+d,y=n.x+g*n.xPercent/100,b=n.y+m*n.yPercent/100;if(null!=n.ox&&(p=(n.oxp?g*n.ox*.01:n.ox)-g/2,f=(n.oyp?m*n.oy*.01:n.oy)-m/2,y+=p-(p*s+f*l),b+=f-(p*c+f*d)),w?(p=g/2,f=m/2,_+=", Dx="+(p-(p*s+f*l)+y)+", Dy="+(f-(p*c+f*d)+b)+")"):_+=", sizingMethod='auto expand')",-1!==t.indexOf("DXImageTransform.Microsoft.Matrix(")?h.filter=t.replace(A,_):h.filter=_+" "+t,(0===e||1===e)&&1===s&&0===l&&0===c&&1===d&&(w&&-1===_.indexOf("Dx=0, Dy=0")||S.test(t)&&100!==parseFloat(RegExp.$1)||-1===t.indexOf(t.indexOf("Alpha"))&&h.removeAttribute("filter")),!w){var C,T,k,P=8>v?1:-1;for(p=n.ieOffsetX||0,f=n.ieOffsetY||0,n.ieOffsetX=Math.round((g-((0>s?-s:s)*g+(0>l?-l:l)*m))/2+y),n.ieOffsetY=Math.round((m-((0>d?-d:d)*m+(0>c?-c:c)*g))/2+b),be=0;4>be;be++)T=ae[be],C=u[T],i=-1!==C.indexOf("px")?parseFloat(C):Z(this.t,T,parseFloat(C),C.replace(x,""))||0,k=i!==n[T]?2>be?-n.ieOffsetX:-n.ieOffsetY:2>be?p-n.ieOffsetX:f-n.ieOffsetY,h[T]=(n[T]=Math.round(i-k*(0===be||2===be?1:P)))+"px"}}},Ue=U.set3DTransformRatio=U.setTransformRatio=function(e){var t,i,n,a,r,o,s,l,c,d,h,u,f,v,g,m,w,_,y,b,x,S,C,T=this.data,k=this.t.style,P=T.rotation,E=T.rotationX,D=T.rotationY,I=T.scaleX,$=T.scaleY,O=T.scaleZ,A=T.x,N=T.y,R=T.z,L=T.svg,F=T.perspective,W=T.force3D;if(((1===e||0===e)&&"auto"===W&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!W)&&!R&&!F&&!D&&!E&&1===O||Te&&L||!Ie)return void(P||T.skewX||L?(P*=M,S=T.skewX*M,C=1e5,t=Math.cos(P)*I,a=Math.sin(P)*I,i=Math.sin(P-S)*-$,r=Math.cos(P-S)*$,S&&"simple"===T.skewType&&(w=Math.tan(S-T.skewY*M),w=Math.sqrt(1+w*w),i*=w,r*=w,T.skewY&&(w=Math.tan(T.skewY*M),w=Math.sqrt(1+w*w),t*=w,a*=w)),L&&(A+=T.xOrigin-(T.xOrigin*t+T.yOrigin*i)+T.xOffset,N+=T.yOrigin-(T.xOrigin*a+T.yOrigin*r)+T.yOffset,Te&&(T.xPercent||T.yPercent)&&(v=this.t.getBBox(),A+=.01*T.xPercent*v.width,N+=.01*T.yPercent*v.height),v=1e-6,v>A&&A>-v&&(A=0),v>N&&N>-v&&(N=0)),y=(t*C|0)/C+","+(a*C|0)/C+","+(i*C|0)/C+","+(r*C|0)/C+","+A+","+N+")",L&&Te?this.t.setAttribute("transform","matrix("+y):k[Pe]=(T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) matrix(":"matrix(")+y):k[Pe]=(T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) matrix(":"matrix(")+I+",0,0,"+$+","+A+","+N+")");if(p&&(v=1e-4,v>I&&I>-v&&(I=O=2e-5),v>$&&$>-v&&($=O=2e-5),!F||T.z||T.rotationX||T.rotationY||(F=0)),P||T.skewX)P*=M,g=t=Math.cos(P),m=a=Math.sin(P),T.skewX&&(P-=T.skewX*M,g=Math.cos(P),m=Math.sin(P),"simple"===T.skewType&&(w=Math.tan((T.skewX-T.skewY)*M),w=Math.sqrt(1+w*w),g*=w,m*=w,T.skewY&&(w=Math.tan(T.skewY*M),w=Math.sqrt(1+w*w),t*=w,a*=w))),i=-m,r=g;else{if(!(D||E||1!==O||F||L))return void(k[Pe]=(T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) translate3d(":"translate3d(")+A+"px,"+N+"px,"+R+"px)"+(1!==I||1!==$?" scale("+I+","+$+")":""));t=r=1,i=a=0}c=1,n=o=s=l=d=h=0,u=F?-1/F:0,f=T.zOrigin,v=1e-6,b=",",x="0",P=D*M,P&&(g=Math.cos(P),m=Math.sin(P),s=-m,d=u*-m,n=t*m,o=a*m,c=g,u*=g,t*=g,a*=g),P=E*M,P&&(g=Math.cos(P),m=Math.sin(P),w=i*g+n*m,_=r*g+o*m,l=c*m,h=u*m,n=i*-m+n*g,o=r*-m+o*g,c*=g,u*=g,i=w,r=_),1!==O&&(n*=O,o*=O,c*=O,u*=O),1!==$&&(i*=$,r*=$,l*=$,h*=$),1!==I&&(t*=I,a*=I,s*=I,d*=I),(f||L)&&(f&&(A+=n*-f,N+=o*-f,R+=c*-f+f),L&&(A+=T.xOrigin-(T.xOrigin*t+T.yOrigin*i)+T.xOffset,N+=T.yOrigin-(T.xOrigin*a+T.yOrigin*r)+T.yOffset),v>A&&A>-v&&(A=x),v>N&&N>-v&&(N=x),v>R&&R>-v&&(R=0)),y=T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) matrix3d(":"matrix3d(",y+=(v>t&&t>-v?x:t)+b+(v>a&&a>-v?x:a)+b+(v>s&&s>-v?x:s),y+=b+(v>d&&d>-v?x:d)+b+(v>i&&i>-v?x:i)+b+(v>r&&r>-v?x:r),E||D||1!==O?(y+=b+(v>l&&l>-v?x:l)+b+(v>h&&h>-v?x:h)+b+(v>n&&n>-v?x:n),y+=b+(v>o&&o>-v?x:o)+b+(v>c&&c>-v?x:c)+b+(v>u&&u>-v?x:u)+b):y+=",0,0,0,0,1,0,",y+=A+b+N+b+R+b+(F?1+-R/F:1)+")",k[Pe]=y};c=$e.prototype,c.x=c.y=c.z=c.skewX=c.skewY=c.rotation=c.rotationX=c.rotationY=c.zOrigin=c.xPercent=c.yPercent=c.xOffset=c.yOffset=0,c.scaleX=c.scaleY=c.scaleZ=1,Se("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(e,t,i,n,r,s,l){if(n._lastParsedTransform===l)return r;n._lastParsedTransform=l;var c;"function"==typeof l[i]&&(c=l[i],l[i]=t);var d,h,u,p,f,v,w,_,y,b=e._gsTransform,x=e.style,S=1e-6,C=ke.length,T=l,k={},P="transformOrigin",E=je(e,a,!0,T.parseTransform),D=T.transform&&("function"==typeof T.transform?T.transform(m,g):T.transform);if(n._transform=E,D&&"string"==typeof D&&Pe)h=j.style,h[Pe]=D,h.display="block",h.position="absolute",W.body.appendChild(j),d=je(j,null,!1),E.svg&&(v=E.xOrigin,w=E.yOrigin,d.x-=E.xOffset,d.y-=E.yOffset,(T.transformOrigin||T.svgOrigin)&&(D={},Me(e,oe(T.transformOrigin),D,T.svgOrigin,T.smoothOrigin,!0),v=D.xOrigin,w=D.yOrigin,d.x-=D.xOffset-E.xOffset,d.y-=D.yOffset-E.yOffset),(v||w)&&(_=Be(j,!0),d.x-=v-(v*_[0]+w*_[2]),d.y-=w-(v*_[1]+w*_[3]))),W.body.removeChild(j),d.perspective||(d.perspective=E.perspective),null!=T.xPercent&&(d.xPercent=le(T.xPercent,E.xPercent)),null!=T.yPercent&&(d.yPercent=le(T.yPercent,E.yPercent));else if("object"==typeof T){if(d={scaleX:le(null!=T.scaleX?T.scaleX:T.scale,E.scaleX),scaleY:le(null!=T.scaleY?T.scaleY:T.scale,E.scaleY),scaleZ:le(T.scaleZ,E.scaleZ),x:le(T.x,E.x),y:le(T.y,E.y),z:le(T.z,E.z),xPercent:le(T.xPercent,E.xPercent),yPercent:le(T.yPercent,E.yPercent),perspective:le(T.transformPerspective,E.perspective)},f=T.directionalRotation,null!=f)if("object"==typeof f)for(h in f)T[h]=f[h];else T.rotation=f;"string"==typeof T.x&&-1!==T.x.indexOf("%")&&(d.x=0,d.xPercent=le(T.x,E.xPercent)),"string"==typeof T.y&&-1!==T.y.indexOf("%")&&(d.y=0,d.yPercent=le(T.y,E.yPercent)),d.rotation=ce("rotation"in T?T.rotation:"shortRotation"in T?T.shortRotation+"_short":"rotationZ"in T?T.rotationZ:E.rotation-E.skewY,E.rotation-E.skewY,"rotation",k),Ie&&(d.rotationX=ce("rotationX"in T?T.rotationX:"shortRotationX"in T?T.shortRotationX+"_short":E.rotationX||0,E.rotationX,"rotationX",k),d.rotationY=ce("rotationY"in T?T.rotationY:"shortRotationY"in T?T.shortRotationY+"_short":E.rotationY||0,E.rotationY,"rotationY",k)),d.skewX=ce(T.skewX,E.skewX-E.skewY),(d.skewY=ce(T.skewY,E.skewY))&&(d.skewX+=d.skewY,d.rotation+=d.skewY)}for(Ie&&null!=T.force3D&&(E.force3D=T.force3D,p=!0),E.skewType=T.skewType||E.skewType||o.defaultSkewType,u=E.force3D||E.z||E.rotationX||E.rotationY||d.z||d.rotationX||d.rotationY||d.perspective,u||null==T.scale||(d.scaleZ=1);--C>-1;)y=ke[C],D=d[y]-E[y],(D>S||-S>D||null!=T[y]||null!=F[y])&&(p=!0,r=new we(E,y,E[y],D,r),y in k&&(r.e=k[y]),r.xs0=0,r.plugin=s,n._overwriteProps.push(r.n));return D=T.transformOrigin,E.svg&&(D||T.svgOrigin)&&(v=E.xOffset,w=E.yOffset,Me(e,oe(D),d,T.svgOrigin,T.smoothOrigin),r=_e(E,"xOrigin",(b?E:d).xOrigin,d.xOrigin,r,P),r=_e(E,"yOrigin",(b?E:d).yOrigin,d.yOrigin,r,P),(v!==E.xOffset||w!==E.yOffset)&&(r=_e(E,"xOffset",b?v:E.xOffset,E.xOffset,r,P),r=_e(E,"yOffset",b?w:E.yOffset,E.yOffset,r,P)),D=Te?null:"0px 0px"),(D||Ie&&u&&E.zOrigin)&&(Pe?(p=!0,y=De,D=(D||K(e,y,a,!1,"50% 50%"))+"",r=new we(x,y,0,0,r,-1,P),r.b=x[y],r.plugin=s,Ie?(h=E.zOrigin,D=D.split(" "),E.zOrigin=(D.length>2&&(0===h||"0px"!==D[2])?parseFloat(D[2]):h)||0,r.xs0=r.e=D[0]+" "+(D[1]||"50%")+" 0px",r=new we(E,"zOrigin",0,0,r,-1,r.n),r.b=h,r.xs0=r.e=E.zOrigin):r.xs0=r.e=D):oe(D+"",E)),p&&(n._transformType=E.svg&&Te||!u&&3!==this._transformType?2:3),c&&(l[i]=c),r},prefix:!0}),Se("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),Se("borderRadius",{defaultValue:"0px",parser:function(e,t,i,r,o,s){t=this.format(t);var l,c,d,h,u,p,f,v,g,m,w,_,y,b,x,S,C=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],T=e.style;for(g=parseFloat(e.offsetWidth),m=parseFloat(e.offsetHeight),l=t.split(" "),c=0;c<C.length;c++)this.p.indexOf("border")&&(C[c]=J(C[c])),u=h=K(e,C[c],a,!1,"0px"),-1!==u.indexOf(" ")&&(h=u.split(" "),u=h[0],h=h[1]),p=d=l[c],f=parseFloat(u),_=u.substr((f+"").length),y="="===p.charAt(1),y?(v=parseInt(p.charAt(0)+"1",10),p=p.substr(2),v*=parseFloat(p),w=p.substr((v+"").length-(0>v?1:0))||""):(v=parseFloat(p),w=p.substr((v+"").length)),""===w&&(w=n[i]||_),w!==_&&(b=Z(e,"borderLeft",f,_),x=Z(e,"borderTop",f,_),"%"===w?(u=b/g*100+"%",h=x/m*100+"%"):"em"===w?(S=Z(e,"borderLeft",1,"em"),u=b/S+"em",h=x/S+"em"):(u=b+"px",h=x+"px"),y&&(p=parseFloat(u)+v+w,d=parseFloat(h)+v+w)),o=ye(T,C[c],u+" "+h,p+" "+d,!1,"0px",o);return o},prefix:!0,formatter:ve("0px 0px 0px 0px",!1,!0)}),Se("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(e,t,i,n,r,o){return ye(e.style,i,this.format(K(e,i,a,!1,"0px 0px")),this.format(t),!1,"0px",r)},prefix:!0,formatter:ve("0px 0px",!1,!0)}),Se("backgroundPosition",{defaultValue:"0 0",parser:function(e,t,i,n,r,o){var s,l,c,d,h,u,p="background-position",f=a||Q(e,null),g=this.format((f?v?f.getPropertyValue(p+"-x")+" "+f.getPropertyValue(p+"-y"):f.getPropertyValue(p):e.currentStyle.backgroundPositionX+" "+e.currentStyle.backgroundPositionY)||"0 0"),m=this.format(t);if(-1!==g.indexOf("%")!=(-1!==m.indexOf("%"))&&m.split(",").length<2&&(u=K(e,"backgroundImage").replace(D,""),u&&"none"!==u)){for(s=g.split(" "),l=m.split(" "),z.setAttribute("src",u),c=2;--c>-1;)g=s[c],d=-1!==g.indexOf("%"),d!==(-1!==l[c].indexOf("%"))&&(h=0===c?e.offsetWidth-z.width:e.offsetHeight-z.height,s[c]=d?parseFloat(g)/100*h+"px":parseFloat(g)/h*100+"%");g=s.join(" ")}return this.parseComplex(e.style,g,m,r,o)},formatter:oe}),Se("backgroundSize",{defaultValue:"0 0",formatter:function(e){return e+="",oe(-1===e.indexOf(" ")?e+" "+e:e)}}),Se("perspective",{defaultValue:"0px",prefix:!0}),Se("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),Se("transformStyle",{prefix:!0}),Se("backfaceVisibility",{prefix:!0}),Se("userSelect",{prefix:!0}),Se("margin",{parser:ge("marginTop,marginRight,marginBottom,marginLeft")}),Se("padding",{parser:ge("paddingTop,paddingRight,paddingBottom,paddingLeft")}),Se("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(e,t,i,n,r,o){var s,l,c;return 9>v?(l=e.currentStyle,c=8>v?" ":",",s="rect("+l.clipTop+c+l.clipRight+c+l.clipBottom+c+l.clipLeft+")",t=this.format(t).split(",").join(c)):(s=this.format(K(e,this.p,a,!1,this.dflt)),t=this.format(t)),this.parseComplex(e.style,s,t,r,o)}}),Se("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),Se("autoRound,strictUnits",{parser:function(e,t,i,n,a){return a}}),Se("border",{defaultValue:"0px solid #000",parser:function(e,t,i,n,r,o){var s=K(e,"borderTopWidth",a,!1,"0px"),l=this.format(t).split(" "),c=l[0].replace(x,"");return"px"!==c&&(s=parseFloat(s)/Z(e,"borderTopWidth",1,c)+c),this.parseComplex(e.style,this.format(s+" "+K(e,"borderTopStyle",a,!1,"solid")+" "+K(e,"borderTopColor",a,!1,"#000")),l.join(" "),r,o)},color:!0,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(fe)||["#000"])[0]}}),Se("borderWidth",{parser:ge("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),Se("float,cssFloat,styleFloat",{parser:function(e,t,i,n,a,r){
var o=e.style,s="cssFloat"in o?"cssFloat":"styleFloat";return new we(o,s,0,0,a,-1,i,!1,0,o[s],t)}});var He=function(e){var t,i=this.t,n=i.filter||K(this.data,"filter")||"",a=this.s+this.c*e|0;100===a&&(-1===n.indexOf("atrix(")&&-1===n.indexOf("radient(")&&-1===n.indexOf("oader(")?(i.removeAttribute("filter"),t=!K(this.data,"filter")):(i.filter=n.replace(T,""),t=!0)),t||(this.xn1&&(i.filter=n=n||"alpha(opacity="+a+")"),-1===n.indexOf("pacity")?0===a&&this.xn1||(i.filter=n+" alpha(opacity="+a+")"):i.filter=n.replace(S,"opacity="+a))};Se("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(e,t,i,n,r,o){var s=parseFloat(K(e,"opacity",a,!1,"1")),l=e.style,c="autoAlpha"===i;return"string"==typeof t&&"="===t.charAt(1)&&(t=("-"===t.charAt(0)?-1:1)*parseFloat(t.substr(2))+s),c&&1===s&&"hidden"===K(e,"visibility",a)&&0!==t&&(s=0),V?r=new we(l,"opacity",s,t-s,r):(r=new we(l,"opacity",100*s,100*(t-s),r),r.xn1=c?1:0,l.zoom=1,r.type=2,r.b="alpha(opacity="+r.s+")",r.e="alpha(opacity="+(r.s+r.c)+")",r.data=e,r.plugin=o,r.setRatio=He),c&&(r=new we(l,"visibility",0,0,r,-1,null,!1,0,0!==s?"inherit":"hidden",0===t?"hidden":"inherit"),r.xs0="inherit",n._overwriteProps.push(r.n),n._overwriteProps.push(i)),r}});var Ve=function(e,t){t&&(e.removeProperty?(("ms"===t.substr(0,2)||"webkit"===t.substr(0,6))&&(t="-"+t),e.removeProperty(t.replace(P,"-$1").toLowerCase())):e.removeAttribute(t))},Ye=function(e){if(this.t._gsClassPT=this,1===e||0===e){this.t.setAttribute("class",0===e?this.b:this.e);for(var t=this.data,i=this.t.style;t;)t.v?i[t.p]=t.v:Ve(i,t.p),t=t._next;1===e&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};Se("className",{parser:function(e,t,n,r,o,s,l){var c,d,h,u,p,f=e.getAttribute("class")||"",v=e.style.cssText;if(o=r._classNamePT=new we(e,n,0,0,o,2),o.setRatio=Ye,o.pr=-11,i=!0,o.b=f,d=te(e,a),h=e._gsClassPT){for(u={},p=h.data;p;)u[p.p]=1,p=p._next;h.setRatio(1)}return e._gsClassPT=o,o.e="="!==t.charAt(1)?t:f.replace(new RegExp("(?:\\s|^)"+t.substr(2)+"(?![\\w-])"),"")+("+"===t.charAt(0)?" "+t.substr(2):""),e.setAttribute("class",o.e),c=ie(e,d,te(e),l,u),e.setAttribute("class",f),o.data=c.firstMPT,e.style.cssText=v,o=o.xfirst=r.parse(e,c.difs,o,s)}});var Xe=function(e){if((1===e||0===e)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var t,i,n,a,r,o=this.t.style,s=l.transform.parse;if("all"===this.e)o.cssText="",a=!0;else for(t=this.e.split(" ").join("").split(","),n=t.length;--n>-1;)i=t[n],l[i]&&(l[i].parse===s?a=!0:i="transformOrigin"===i?De:l[i].p),Ve(o,i);a&&(Ve(o,Pe),r=this.t._gsTransform,r&&(r.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(Se("clearProps",{parser:function(e,t,n,a,r){return r=new we(e,n,0,0,r,2),r.setRatio=Xe,r.e=t,r.pr=-10,r.data=a._tween,i=!0,r}}),c="bezier,throwProps,physicsProps,physics2D".split(","),be=c.length;be--;)Ce(c[be]);c=o.prototype,c._firstPT=c._lastParsedTransform=c._transform=null,c._onInitTween=function(e,t,s,c){if(!e.nodeType)return!1;this._target=g=e,this._tween=s,this._vars=t,m=c,d=t.autoRound,i=!1,n=t.suffixMap||o.suffixMap,a=Q(e,""),r=this._overwriteProps;var p,v,w,_,y,b,x,S,T,k=e.style;if(h&&""===k.zIndex&&(p=K(e,"zIndex",a),("auto"===p||""===p)&&this._addLazySet(k,"zIndex",0)),"string"==typeof t&&(_=k.cssText,p=te(e,a),k.cssText=_+";"+t,p=ie(e,p,te(e)).difs,!V&&C.test(t)&&(p.opacity=parseFloat(RegExp.$1)),t=p,k.cssText=_),t.className?this._firstPT=v=l.className.parse(e,t.className,"className",this,null,null,t):this._firstPT=v=this.parse(e,t,null),this._transformType){for(T=3===this._transformType,Pe?u&&(h=!0,""===k.zIndex&&(x=K(e,"zIndex",a),("auto"===x||""===x)&&this._addLazySet(k,"zIndex",0)),f&&this._addLazySet(k,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(T?"visible":"hidden"))):k.zoom=1,w=v;w&&w._next;)w=w._next;S=new we(e,"transform",0,0,null,2),this._linkCSSP(S,null,w),S.setRatio=Pe?Ue:ze,S.data=this._transform||je(e,a,!0),S.tween=s,S.pr=-1,r.pop()}if(i){for(;v;){for(b=v._next,w=_;w&&w.pr>v.pr;)w=w._next;(v._prev=w?w._prev:y)?v._prev._next=v:_=v,(v._next=w)?w._prev=v:y=v,v=b}this._firstPT=_}return!0},c.parse=function(e,t,i,r){var o,s,c,h,u,p,f,v,w,_,y=e.style;for(o in t)p=t[o],"function"==typeof p&&(p=p(m,g)),s=l[o],s?i=s.parse(e,p,o,this,i,r,t):(u=K(e,o,a)+"",w="string"==typeof p,"color"===o||"fill"===o||"stroke"===o||-1!==o.indexOf("Color")||w&&k.test(p)?(w||(p=ue(p),p=(p.length>3?"rgba(":"rgb(")+p.join(",")+")"),i=ye(y,o,u,p,!0,"transparent",i,0,r)):w&&R.test(p)?i=ye(y,o,u,p,!0,null,i,0,r):(c=parseFloat(u),f=c||0===c?u.substr((c+"").length):"",(""===u||"auto"===u)&&("width"===o||"height"===o?(c=re(e,o,a),f="px"):"left"===o||"top"===o?(c=ee(e,o,a),f="px"):(c="opacity"!==o?0:1,f="")),_=w&&"="===p.charAt(1),_?(h=parseInt(p.charAt(0)+"1",10),p=p.substr(2),h*=parseFloat(p),v=p.replace(x,"")):(h=parseFloat(p),v=w?p.replace(x,""):""),""===v&&(v=o in n?n[o]:f),p=h||0===h?(_?h+c:h)+v:t[o],f!==v&&""!==v&&(h||0===h)&&c&&(c=Z(e,o,c,f),"%"===v?(c/=Z(e,o,100,"%")/100,t.strictUnits!==!0&&(u=c+"%")):"em"===v||"rem"===v||"vw"===v||"vh"===v?c/=Z(e,o,1,v):"px"!==v&&(h=Z(e,o,h,v),v="px"),_&&(h||0===h)&&(p=h+c+v)),_&&(h+=c),!c&&0!==c||!h&&0!==h?void 0!==y[o]&&(p||p+""!="NaN"&&null!=p)?(i=new we(y,o,h||c||0,0,i,-1,o,!1,0,u,p),i.xs0="none"!==p||"display"!==o&&-1===o.indexOf("Style")?p:u):X("invalid "+o+" tween value: "+t[o]):(i=new we(y,o,c,h-c,i,0,o,d!==!1&&("px"===v||"zIndex"===o),0,u,p),i.xs0=v))),r&&i&&!i.plugin&&(i.plugin=r);return i},c.setRatio=function(e){var t,i,n,a=this._firstPT,r=1e-6;if(1!==e||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(e||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;a;){if(t=a.c*e+a.s,a.r?t=Math.round(t):r>t&&t>-r&&(t=0),a.type)if(1===a.type)if(n=a.l,2===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2;else if(3===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2+a.xn2+a.xs3;else if(4===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2+a.xn2+a.xs3+a.xn3+a.xs4;else if(5===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2+a.xn2+a.xs3+a.xn3+a.xs4+a.xn4+a.xs5;else{for(i=a.xs0+t+a.xs1,n=1;n<a.l;n++)i+=a["xn"+n]+a["xs"+(n+1)];a.t[a.p]=i}else-1===a.type?a.t[a.p]=a.xs0:a.setRatio&&a.setRatio(e);else a.t[a.p]=t+a.xs0;a=a._next}else for(;a;)2!==a.type?a.t[a.p]=a.b:a.setRatio(e),a=a._next;else for(;a;){if(2!==a.type)if(a.r&&-1!==a.type)if(t=Math.round(a.s+a.c),a.type){if(1===a.type){for(n=a.l,i=a.xs0+t+a.xs1,n=1;n<a.l;n++)i+=a["xn"+n]+a["xs"+(n+1)];a.t[a.p]=i}}else a.t[a.p]=t+a.xs0;else a.t[a.p]=a.e;else a.setRatio(e);a=a._next}},c._enableTransforms=function(e){this._transform=this._transform||je(this._target,a,!0),this._transformType=this._transform.svg&&Te||!e&&3!==this._transformType?2:3};var qe=function(e){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};c._addLazySet=function(e,t,i){var n=this._firstPT=new we(e,t,0,0,this._firstPT,2);n.e=i,n.setRatio=qe,n.data=this},c._linkCSSP=function(e,t,i,n){return e&&(t&&(t._prev=e),e._next&&(e._next._prev=e._prev),e._prev?e._prev._next=e._next:this._firstPT===e&&(this._firstPT=e._next,n=!0),i?i._next=e:n||null!==this._firstPT||(this._firstPT=e),e._next=t,e._prev=i),e},c._mod=function(e){for(var t=this._firstPT;t;)"function"==typeof e[t.p]&&e[t.p]===Math.round&&(t.r=1),t=t._next},c._kill=function(t){var i,n,a,r=t;if(t.autoAlpha||t.alpha){r={};for(n in t)r[n]=t[n];r.opacity=1,r.autoAlpha&&(r.visibility=1)}for(t.className&&(i=this._classNamePT)&&(a=i.xfirst,a&&a._prev?this._linkCSSP(a._prev,i._next,a._prev._prev):a===this._firstPT&&(this._firstPT=i._next),i._next&&this._linkCSSP(i._next,i._next._next,a._prev),this._classNamePT=null),i=this._firstPT;i;)i.plugin&&i.plugin!==n&&i.plugin._kill&&(i.plugin._kill(t),n=i.plugin),i=i._next;return e.prototype._kill.call(this,r)};var Ge=function(e,t,i){var n,a,r,o;if(e.slice)for(a=e.length;--a>-1;)Ge(e[a],t,i);else for(n=e.childNodes,a=n.length;--a>-1;)r=n[a],o=r.type,r.style&&(t.push(te(r)),i&&i.push(r)),1!==o&&9!==o&&11!==o||!r.childNodes.length||Ge(r,t,i)};return o.cascadeTo=function(e,i,n){var a,r,o,s,l=t.to(e,i,n),c=[l],d=[],h=[],u=[],p=t._internals.reservedProps;for(e=l._targets||l.target,Ge(e,d,u),l.render(i,!0,!0),Ge(e,h),l.render(0,!0,!0),l._enabled(!0),a=u.length;--a>-1;)if(r=ie(u[a],d[a],h[a]),r.firstMPT){r=r.difs;for(o in n)p[o]&&(r[o]=n[o]);s={};for(o in r)s[o]=d[a][o];c.push(t.fromTo(u[a],i,s,r))}return c},e.activate([o]),o},!0),function(){var e=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.6.0",priority:-1,API:2,init:function(e,t,i){return this._tween=i,!0}}),t=function(e){for(;e;)e.f||e.blob||(e.m=Math.round),e=e._next},i=e.prototype;i._onInitAllProps=function(){for(var e,i,n,a=this._tween,r=a.vars.roundProps.join?a.vars.roundProps:a.vars.roundProps.split(","),o=r.length,s={},l=a._propLookup.roundProps;--o>-1;)s[r[o]]=Math.round;for(o=r.length;--o>-1;)for(e=r[o],i=a._firstPT;i;)n=i._next,i.pg?i.t._mod(s):i.n===e&&(2===i.f&&i.t?t(i.t._firstPT):(this._add(i.t,e,i.s,i.c),n&&(n._prev=i._prev),i._prev?i._prev._next=n:a._firstPT===i&&(a._firstPT=n),i._next=i._prev=null,a._propLookup[e]=l)),i=n;return!1},i._add=function(e,t,i,n){this._addTween(e,t,i,i+n,t,Math.round),this._overwriteProps.push(t)}}(),function(){_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.6.0",init:function(e,t,i,n){var a,r;if("function"!=typeof e.setAttribute)return!1;for(a in t)r=t[a],"function"==typeof r&&(r=r(n,e)),this._addTween(e,"setAttribute",e.getAttribute(a)+"",r+"",a,!1,a),this._overwriteProps.push(a);return!0}})}(),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.3.0",API:2,init:function(e,t,i,n){"object"!=typeof t&&(t={rotation:t}),this.finals={};var a,r,o,s,l,c,d=t.useRadians===!0?2*Math.PI:360,h=1e-6;for(a in t)"useRadians"!==a&&(s=t[a],"function"==typeof s&&(s=s(n,e)),c=(s+"").split("_"),r=c[0],o=parseFloat("function"!=typeof e[a]?e[a]:e[a.indexOf("set")||"function"!=typeof e["get"+a.substr(3)]?a:"get"+a.substr(3)]()),s=this.finals[a]="string"==typeof r&&"="===r.charAt(1)?o+parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)):Number(r)||0,l=s-o,c.length&&(r=c.join("_"),-1!==r.indexOf("short")&&(l%=d,l!==l%(d/2)&&(l=0>l?l+d:l-d)),-1!==r.indexOf("_cw")&&0>l?l=(l+9999999999*d)%d-(l/d|0)*d:-1!==r.indexOf("ccw")&&l>0&&(l=(l-9999999999*d)%d-(l/d|0)*d)),(l>h||-h>l)&&(this._addTween(e,a,o,o+l,a),this._overwriteProps.push(a)));return!0},set:function(e){var t;if(1!==e)this._super.setRatio.call(this,e);else for(t=this._firstPT;t;)t.f?t.t[t.p](this.finals[t.p]):t.t[t.p]=this.finals[t.p],t=t._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(e){var t,i,n,a=_gsScope.GreenSockGlobals||_gsScope,r=a.com.greensock,o=2*Math.PI,s=Math.PI/2,l=r._class,c=function(t,i){var n=l("easing."+t,function(){},!0),a=n.prototype=new e;return a.constructor=n,a.getRatio=i,n},d=e.register||function(){},h=function(e,t,i,n,a){var r=l("easing."+e,{easeOut:new t,easeIn:new i,easeInOut:new n},!0);return d(r,e),r},u=function(e,t,i){this.t=e,this.v=t,i&&(this.next=i,i.prev=this,this.c=i.v-t,this.gap=i.t-e)},p=function(t,i){var n=l("easing."+t,function(e){this._p1=e||0===e?e:1.70158,this._p2=1.525*this._p1},!0),a=n.prototype=new e;return a.constructor=n,a.getRatio=i,a.config=function(e){return new n(e)},n},f=h("Back",p("BackOut",function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1}),p("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),p("BackInOut",function(e){return(e*=2)<1?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),v=l("easing.SlowMo",function(e,t,i){t=t||0===t?t:.7,null==e?e=.7:e>1&&(e=1),this._p=1!==e?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),g=v.prototype=new e;return g.constructor=v,g.getRatio=function(e){var t=e+(.5-e)*this._p;return e<this._p1?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},v.ease=new v(.7,.7),g.config=v.config=function(e,t,i){return new v(e,t,i)},t=l("easing.SteppedEase",function(e){e=e||1,this._p1=1/e,this._p2=e+1},!0),g=t.prototype=new e,g.constructor=t,g.getRatio=function(e){return 0>e?e=0:e>=1&&(e=.999999999),(this._p2*e>>0)*this._p1},g.config=t.config=function(e){return new t(e)},i=l("easing.RoughEase",function(t){t=t||{};for(var i,n,a,r,o,s,l=t.taper||"none",c=[],d=0,h=0|(t.points||20),p=h,f=t.randomize!==!1,v=t.clamp===!0,g=t.template instanceof e?t.template:null,m="number"==typeof t.strength?.4*t.strength:.4;--p>-1;)i=f?Math.random():1/h*p,n=g?g.getRatio(i):i,"none"===l?a=m:"out"===l?(r=1-i,a=r*r*m):"in"===l?a=i*i*m:.5>i?(r=2*i,a=r*r*.5*m):(r=2*(1-i),a=r*r*.5*m),f?n+=Math.random()*a-.5*a:p%2?n+=.5*a:n-=.5*a,v&&(n>1?n=1:0>n&&(n=0)),c[d++]={x:i,y:n};for(c.sort(function(e,t){return e.x-t.x}),s=new u(1,1,null),p=h;--p>-1;)o=c[p],s=new u(o.x,o.y,s);this._prev=new u(0,0,0!==s.t?s:s.next)},!0),g=i.prototype=new e,g.constructor=i,g.getRatio=function(e){var t=this._prev;if(e>t.t){for(;t.next&&e>=t.t;)t=t.next;t=t.prev}else for(;t.prev&&e<=t.t;)t=t.prev;return this._prev=t,t.v+(e-t.t)/t.gap*t.c},g.config=function(e){return new i(e)},i.ease=new i,h("Bounce",c("BounceOut",function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}),c("BounceIn",function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:2/2.75>e?1-(7.5625*(e-=1.5/2.75)*e+.75):2.5/2.75>e?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}),c("BounceInOut",function(e){var t=.5>e;return e=t?1-2*e:2*e-1,e=1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5})),h("Circ",c("CircOut",function(e){return Math.sqrt(1-(e-=1)*e)}),c("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),c("CircInOut",function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)})),n=function(t,i,n){var a=l("easing."+t,function(e,t){this._p1=e>=1?e:1,this._p2=(t||n)/(1>e?e:1),this._p3=this._p2/o*(Math.asin(1/this._p1)||0),this._p2=o/this._p2},!0),r=a.prototype=new e;return r.constructor=a,r.getRatio=i,r.config=function(e,t){return new a(e,t)},a},h("Elastic",n("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*this._p2)+1},.3),n("ElasticIn",function(e){return-(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2))},.3),n("ElasticInOut",function(e){return(e*=2)<1?-.5*(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*this._p2)*.5+1},.45)),h("Expo",c("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),c("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),c("ExpoInOut",function(e){return(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))})),h("Sine",c("SineOut",function(e){return Math.sin(e*s)}),c("SineIn",function(e){return-Math.cos(e*s)+1}),c("SineInOut",function(e){return-.5*(Math.cos(Math.PI*e)-1)})),l("easing.EaseLookup",{find:function(t){return e.map[t]}},!0),d(a.SlowMo,"SlowMo","ease,"),d(i,"RoughEase","ease,"),d(t,"SteppedEase","ease,"),f},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(e,t){"use strict";var i={},n=e.GreenSockGlobals=e.GreenSockGlobals||e;if(!n.TweenLite){var a,r,o,s,l,c=function(e){var t,i=e.split("."),a=n;for(t=0;t<i.length;t++)a[i[t]]=a=a[i[t]]||{};return a},d=c("com.greensock"),h=1e-10,u=function(e){var t,i=[],n=e.length;for(t=0;t!==n;i.push(e[t++]));return i},p=function(){},f=function(){var e=Object.prototype.toString,t=e.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&e.call(i)===t)}}(),v={},g=function(a,r,o,s){this.sc=v[a]?v[a].sc:[],v[a]=this,this.gsClass=null,this.func=o;var l=[];this.check=function(d){for(var h,u,p,f,m,w=r.length,_=w;--w>-1;)(h=v[r[w]]||new g(r[w],[])).gsClass?(l[w]=h.gsClass,_--):d&&h.sc.push(this);if(0===_&&o){if(u=("com.greensock."+a).split("."),p=u.pop(),f=c(u.join("."))[p]=this.gsClass=o.apply(o,l),s)if(n[p]=i[p]=f,m="undefined"!=typeof module&&module.exports,!m&&"function"==typeof define&&define.amd)define((e.GreenSockAMDPath?e.GreenSockAMDPath+"/":"")+a.split(".").pop(),[],function(){return f});else if(m)if(a===t){module.exports=i[t]=f;for(w in i)f[w]=i[w]}else i[t]&&(i[t][p]=f);for(w=0;w<this.sc.length;w++)this.sc[w].check()}},this.check(!0)},m=e._gsDefine=function(e,t,i,n){return new g(e,t,i,n)},w=d._class=function(e,t,i){return t=t||function(){},m(e,[],function(){return t},i),t};m.globals=n;var _=[0,0,1,1],y=w("easing.Ease",function(e,t,i,n){this._func=e,this._type=i||0,this._power=n||0,this._params=t?_.concat(t):_},!0),b=y.map={},x=y.register=function(e,t,i,n){for(var a,r,o,s,l=t.split(","),c=l.length,h=(i||"easeIn,easeOut,easeInOut").split(",");--c>-1;)for(r=l[c],a=n?w("easing."+r,null,!0):d.easing[r]||{},o=h.length;--o>-1;)s=h[o],b[r+"."+s]=b[s+r]=a[s]=e.getRatio?e:e[s]||new e};for(o=y.prototype,o._calcEnd=!1,o.getRatio=function(e){if(this._func)return this._params[0]=e,this._func.apply(null,this._params);var t=this._type,i=this._power,n=1===t?1-e:2===t?e:.5>e?2*e:2*(1-e);return 1===i?n*=n:2===i?n*=n*n:3===i?n*=n*n*n:4===i&&(n*=n*n*n*n),1===t?1-n:2===t?n:.5>e?n/2:1-n/2},a=["Linear","Quad","Cubic","Quart","Quint,Strong"],r=a.length;--r>-1;)o=a[r]+",Power"+r,x(new y(null,null,1,r),o,"easeOut",!0),x(new y(null,null,2,r),o,"easeIn"+(0===r?",easeNone":"")),x(new y(null,null,3,r),o,"easeInOut");b.linear=d.easing.Linear.easeIn,b.swing=d.easing.Quad.easeInOut;var S=w("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this});o=S.prototype,o.addEventListener=function(e,t,i,n,a){a=a||0;var r,o,c=this._listeners[e],d=0;for(this!==s||l||s.wake(),null==c&&(this._listeners[e]=c=[]),o=c.length;--o>-1;)r=c[o],r.c===t&&r.s===i?c.splice(o,1):0===d&&r.pr<a&&(d=o+1);c.splice(d,0,{c:t,s:i,up:n,pr:a})},o.removeEventListener=function(e,t){var i,n=this._listeners[e];if(n)for(i=n.length;--i>-1;)if(n[i].c===t)return void n.splice(i,1)},o.dispatchEvent=function(e){var t,i,n,a=this._listeners[e];if(a)for(t=a.length,t>1&&(a=a.slice(0)),i=this._eventTarget;--t>-1;)n=a[t],n&&(n.up?n.c.call(n.s||i,{type:e,target:i}):n.c.call(n.s||i))};var C=e.requestAnimationFrame,T=e.cancelAnimationFrame,k=Date.now||function(){return(new Date).getTime()},P=k();for(a=["ms","moz","webkit","o"],r=a.length;--r>-1&&!C;)C=e[a[r]+"RequestAnimationFrame"],T=e[a[r]+"CancelAnimationFrame"]||e[a[r]+"CancelRequestAnimationFrame"];w("Ticker",function(e,t){var i,n,a,r,o,c=this,d=k(),u=t!==!1&&C?"auto":!1,f=500,v=33,g="tick",m=function(e){var t,s,l=k()-P;l>f&&(d+=l-v),P+=l,c.time=(P-d)/1e3,t=c.time-o,(!i||t>0||e===!0)&&(c.frame++,o+=t+(t>=r?.004:r-t),s=!0),e!==!0&&(a=n(m)),s&&c.dispatchEvent(g)};S.call(c),c.time=c.frame=0,c.tick=function(){m(!0)},c.lagSmoothing=function(e,t){f=e||1/h,v=Math.min(t,f,0)},c.sleep=function(){null!=a&&(u&&T?T(a):clearTimeout(a),n=p,a=null,c===s&&(l=!1))},c.wake=function(e){null!==a?c.sleep():e?d+=-P+(P=k()):c.frame>10&&(P=k()-f+5),n=0===i?p:u&&C?C:function(e){return setTimeout(e,1e3*(o-c.time)+1|0)},c===s&&(l=!0),m(2)},c.fps=function(e){return arguments.length?(i=e,r=1/(i||60),o=this.time+r,void c.wake()):i},c.useRAF=function(e){return arguments.length?(c.sleep(),u=e,void c.fps(i)):u},c.fps(e),setTimeout(function(){"auto"===u&&c.frame<5&&"hidden"!==document.visibilityState&&c.useRAF(!1)},1500)}),o=d.Ticker.prototype=new d.events.EventDispatcher,o.constructor=d.Ticker;var E=w("core.Animation",function(e,t){if(this.vars=t=t||{},this._duration=this._totalDuration=e||0,this._delay=Number(t.delay)||0,this._timeScale=1,this._active=t.immediateRender===!0,this.data=t.data,this._reversed=t.reversed===!0,X){l||s.wake();var i=this.vars.useFrames?Y:X;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});s=E.ticker=new d.Ticker,o=E.prototype,o._dirty=o._gc=o._initted=o._paused=!1,o._totalTime=o._time=0,o._rawPrevTime=-1,o._next=o._last=o._onUpdate=o._timeline=o.timeline=null,o._paused=!1;var D=function(){l&&k()-P>2e3&&s.wake(),setTimeout(D,2e3)};D(),o.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},o.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},o.resume=function(e,t){return null!=e&&this.seek(e,t),this.paused(!1)},o.seek=function(e,t){return this.totalTime(Number(e),t!==!1)},o.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,t!==!1,!0)},o.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},o.render=function(e,t,i){},o.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},o.isActive=function(){var e,t=this._timeline,i=this._startTime;return!t||!this._gc&&!this._paused&&t.isActive()&&(e=t.rawTime())>=i&&e<i+this.totalDuration()/this._timeScale},o._enabled=function(e,t){return l||s.wake(),this._gc=!e,this._active=this.isActive(),t!==!0&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},o._kill=function(e,t){return this._enabled(!1,!1)},o.kill=function(e,t){return this._kill(e,t),this},o._uncache=function(e){for(var t=e?this:this.timeline;t;)t._dirty=!0,t=t.timeline;return this},o._swapSelfInParams=function(e){for(var t=e.length,i=e.concat();--t>-1;)"{self}"===e[t]&&(i[t]=this);return i},o._callback=function(e){var t=this.vars,i=t[e],n=t[e+"Params"],a=t[e+"Scope"]||t.callbackScope||this,r=n?n.length:0;switch(r){case 0:i.call(a);break;case 1:i.call(a,n[0]);break;case 2:i.call(a,n[0],n[1]);break;default:i.apply(a,n)}},o.eventCallback=function(e,t,i,n){if("on"===(e||"").substr(0,2)){var a=this.vars;if(1===arguments.length)return a[e];null==t?delete a[e]:(a[e]=t,a[e+"Params"]=f(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,a[e+"Scope"]=n),"onUpdate"===e&&(this._onUpdate=t)}return this},o.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},o.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},o.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},o.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},o.totalTime=function(e,t,i){if(l||s.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>e&&!i&&(e+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var n=this._totalDuration,a=this._timeline;if(e>n&&!i&&(e=n),this._startTime=(this._paused?this._pauseTime:a._time)-(this._reversed?n-e:e)/this._timeScale,a._dirty||this._uncache(!1),a._timeline)for(;a._timeline;)a._timeline._time!==(a._startTime+a._totalTime)/a._timeScale&&a.totalTime(a._totalTime,!0),a=a._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==e||0===this._duration)&&(N.length&&G(),this.render(e,t,!1),N.length&&G())}return this},o.progress=o.totalProgress=function(e,t){var i=this.duration();return arguments.length?this.totalTime(i*e,t):i?this._time/i:this.ratio},o.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},o.endTime=function(e){return this._startTime+(0!=e?this.totalDuration():this.duration())/this._timeScale},o.timeScale=function(e){if(!arguments.length)return this._timeScale;if(e=e||h,this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime,i=t||0===t?t:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/e}return this._timeScale=e,this._uncache(!1)},o.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},o.paused=function(e){if(!arguments.length)return this._paused;var t,i,n=this._timeline;return e!=this._paused&&n&&(l||e||s.wake(),t=n.rawTime(),i=t-this._pauseTime,!e&&n.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=e?t:null,this._paused=e,this._active=this.isActive(),!e&&0!==i&&this._initted&&this.duration()&&(t=n.smoothChildTiming?this._totalTime:(t-this._startTime)/this._timeScale,this.render(t,t===this._totalTime,!0))),this._gc&&!e&&this._enabled(!0,!1),this};var I=w("core.SimpleTimeline",function(e){E.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0});o=I.prototype=new E,o.constructor=I,o.kill()._gc=!1,o._first=o._last=o._recent=null,o._sortChildren=!1,o.add=o.insert=function(e,t,i,n){var a,r;if(e._startTime=Number(t||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),a=this._last,this._sortChildren)for(r=e._startTime;a&&a._startTime>r;)a=a._prev;return a?(e._next=a._next,a._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=a,this._recent=e,this._timeline&&this._uncache(!0),this},o._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),e._next=e._prev=e.timeline=null,e===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},o.render=function(e,t,i){var n,a=this._first;for(this._totalTime=this._time=this._rawPrevTime=e;a;)n=a._next,(a._active||e>=a._startTime&&!a._paused)&&(a._reversed?a.render((a._dirty?a.totalDuration():a._totalDuration)-(e-a._startTime)*a._timeScale,t,i):a.render((e-a._startTime)*a._timeScale,t,i)),a=n},o.rawTime=function(){return l||s.wake(),this._totalTime};var $=w("TweenLite",function(t,i,n){if(E.call(this,i,n),this.render=$.prototype.render,null==t)throw"Cannot tween a null target.";this.target=t="string"!=typeof t?t:$.selector(t)||t;var a,r,o,s=t.jquery||t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType),l=this.vars.overwrite;if(this._overwrite=l=null==l?V[$.defaultOverwrite]:"number"==typeof l?l>>0:V[l],(s||t instanceof Array||t.push&&f(t))&&"number"!=typeof t[0])for(this._targets=o=u(t),this._propLookup=[],this._siblings=[],a=0;a<o.length;a++)r=o[a],r?"string"!=typeof r?r.length&&r!==e&&r[0]&&(r[0]===e||r[0].nodeType&&r[0].style&&!r.nodeType)?(o.splice(a--,1),this._targets=o=o.concat(u(r))):(this._siblings[a]=J(r,this,!1),1===l&&this._siblings[a].length>1&&K(r,this,null,1,this._siblings[a])):(r=o[a--]=$.selector(r),"string"==typeof r&&o.splice(a+1,1)):o.splice(a--,1);else this._propLookup={},this._siblings=J(t,this,!1),1===l&&this._siblings.length>1&&K(t,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-h,this.render(Math.min(0,-this._delay)))},!0),O=function(t){return t&&t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType)},A=function(e,t){var i,n={};for(i in e)H[i]||i in t&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!j[i]||j[i]&&j[i]._autoCSS)||(n[i]=e[i],delete e[i]);e.css=n};o=$.prototype=new E,o.constructor=$,o.kill()._gc=!1,o.ratio=0,o._firstPT=o._targets=o._overwrittenProps=o._startAt=null,o._notifyPluginsOfEnabled=o._lazy=!1,$.version="1.19.0",$.defaultEase=o._ease=new y(null,null,1,1),$.defaultOverwrite="auto",$.ticker=s,$.autoSleep=120,$.lagSmoothing=function(e,t){s.lagSmoothing(e,t)},$.selector=e.$||e.jQuery||function(t){var i=e.$||e.jQuery;return i?($.selector=i,i(t)):"undefined"==typeof document?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById("#"===t.charAt(0)?t.substr(1):t)};var N=[],R={},M=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,L=function(e){for(var t,i=this._firstPT,n=1e-6;i;)t=i.blob?e?this.join(""):this.start:i.c*e+i.s,i.m?t=i.m(t,this._target||i.t):n>t&&t>-n&&(t=0),i.f?i.fp?i.t[i.p](i.fp,t):i.t[i.p](t):i.t[i.p]=t,i=i._next},F=function(e,t,i,n){var a,r,o,s,l,c,d,h=[e,t],u=0,p="",f=0;for(h.start=e,i&&(i(h),e=h[0],t=h[1]),h.length=0,a=e.match(M)||[],r=t.match(M)||[],n&&(n._next=null,n.blob=1,h._firstPT=h._applyPT=n),l=r.length,s=0;l>s;s++)d=r[s],c=t.substr(u,t.indexOf(d,u)-u),p+=c||!s?c:",",u+=c.length,f?f=(f+1)%5:"rgba("===c.substr(-5)&&(f=1),d===a[s]||a.length<=s?p+=d:(p&&(h.push(p),p=""),o=parseFloat(a[s]),h.push(o),h._firstPT={_next:h._firstPT,t:h,p:h.length-1,s:o,c:("="===d.charAt(1)?parseInt(d.charAt(0)+"1",10)*parseFloat(d.substr(2)):parseFloat(d)-o)||0,f:0,m:f&&4>f?Math.round:0}),u+=d.length;return p+=t.substr(u),p&&h.push(p),h.setRatio=L,h},W=function(e,t,i,n,a,r,o,s,l){"function"==typeof n&&(n=n(l||0,e));var c,d,h="get"===i?e[t]:i,u=typeof e[t],p="string"==typeof n&&"="===n.charAt(1),f={t:e,p:t,s:h,f:"function"===u,pg:0,n:a||t,m:r?"function"==typeof r?r:Math.round:0,pr:0,c:p?parseInt(n.charAt(0)+"1",10)*parseFloat(n.substr(2)):parseFloat(n)-h||0};return"number"!==u&&("function"===u&&"get"===i&&(d=t.indexOf("set")||"function"!=typeof e["get"+t.substr(3)]?t:"get"+t.substr(3),f.s=h=o?e[d](o):e[d]()),"string"==typeof h&&(o||isNaN(h))?(f.fp=o,c=F(h,n,s||$.defaultStringFilter,f),f={t:c,p:"setRatio",s:0,c:1,f:2,pg:0,n:a||t,pr:0,m:0}):p||(f.s=parseFloat(h),f.c=parseFloat(n)-f.s||0)),f.c?((f._next=this._firstPT)&&(f._next._prev=f),this._firstPT=f,f):void 0},B=$._internals={isArray:f,isSelector:O,lazyTweens:N,blobDif:F},j=$._plugins={},z=B.tweenLookup={},U=0,H=B.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1},V={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},Y=E._rootFramesTimeline=new I,X=E._rootTimeline=new I,q=30,G=B.lazyRender=function(){var e,t=N.length;for(R={};--t>-1;)e=N[t],e&&e._lazy!==!1&&(e.render(e._lazy[0],e._lazy[1],!0),e._lazy=!1);N.length=0};X._startTime=s.time,Y._startTime=s.frame,X._active=Y._active=!0,setTimeout(G,1),E._updateRoot=$.render=function(){var e,t,i;if(N.length&&G(),X.render((s.time-X._startTime)*X._timeScale,!1,!1),Y.render((s.frame-Y._startTime)*Y._timeScale,!1,!1),N.length&&G(),s.frame>=q){q=s.frame+(parseInt($.autoSleep,10)||120);for(i in z){for(t=z[i].tweens,e=t.length;--e>-1;)t[e]._gc&&t.splice(e,1);0===t.length&&delete z[i]}if(i=X._first,(!i||i._paused)&&$.autoSleep&&!Y._first&&1===s._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||s.sleep()}}},s.addEventListener("tick",E._updateRoot);var J=function(e,t,i){var n,a,r=e._gsTweenID;if(z[r||(e._gsTweenID=r="t"+U++)]||(z[r]={target:e,tweens:[]}),t&&(n=z[r].tweens,n[a=n.length]=t,i))for(;--a>-1;)n[a]===t&&n.splice(a,1);return z[r].tweens},Q=function(e,t,i,n){var a,r,o=e.vars.onOverwrite;return o&&(a=o(e,t,i,n)),o=$.onOverwrite,o&&(r=o(e,t,i,n)),a!==!1&&r!==!1},K=function(e,t,i,n,a){var r,o,s,l;if(1===n||n>=4){for(l=a.length,r=0;l>r;r++)if((s=a[r])!==t)s._gc||s._kill(null,e,t)&&(o=!0);else if(5===n)break;return o}var c,d=t._startTime+h,u=[],p=0,f=0===t._duration;for(r=a.length;--r>-1;)(s=a[r])===t||s._gc||s._paused||(s._timeline!==t._timeline?(c=c||Z(t,0,f),0===Z(s,c,f)&&(u[p++]=s)):s._startTime<=d&&s._startTime+s.totalDuration()/s._timeScale>d&&((f||!s._initted)&&d-s._startTime<=2e-10||(u[p++]=s)));
for(r=p;--r>-1;)if(s=u[r],2===n&&s._kill(i,e,t)&&(o=!0),2!==n||!s._firstPT&&s._initted){if(2!==n&&!Q(s,t))continue;s._enabled(!1,!1)&&(o=!0)}return o},Z=function(e,t,i){for(var n=e._timeline,a=n._timeScale,r=e._startTime;n._timeline;){if(r+=n._startTime,a*=n._timeScale,n._paused)return-100;n=n._timeline}return r/=a,r>t?r-t:i&&r===t||!e._initted&&2*h>r-t?h:(r+=e.totalDuration()/e._timeScale/a)>t+h?0:r-t-h};o._init=function(){var e,t,i,n,a,r,o=this.vars,s=this._overwrittenProps,l=this._duration,c=!!o.immediateRender,d=o.ease;if(o.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),a={};for(n in o.startAt)a[n]=o.startAt[n];if(a.overwrite=!1,a.immediateRender=!0,a.lazy=c&&o.lazy!==!1,a.startAt=a.delay=null,this._startAt=$.to(this.target,0,a),c)if(this._time>0)this._startAt=null;else if(0!==l)return}else if(o.runBackwards&&0!==l)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(c=!1),i={};for(n in o)H[n]&&"autoCSS"!==n||(i[n]=o[n]);if(i.overwrite=0,i.data="isFromStart",i.lazy=c&&o.lazy!==!1,i.immediateRender=c,this._startAt=$.to(this.target,0,i),c){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=d=d?d instanceof y?d:"function"==typeof d?new y(d,o.easeParams):b[d]||$.defaultEase:$.defaultEase,o.easeParams instanceof Array&&d.config&&(this._ease=d.config.apply(d,o.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(r=this._targets.length,e=0;r>e;e++)this._initProps(this._targets[e],this._propLookup[e]={},this._siblings[e],s?s[e]:null,e)&&(t=!0);else t=this._initProps(this.target,this._propLookup,this._siblings,s,0);if(t&&$._onPluginEvent("_onInitAllProps",this),s&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),o.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=o.onUpdate,this._initted=!0},o._initProps=function(t,i,n,a,r){var o,s,l,c,d,h;if(null==t)return!1;R[t._gsTweenID]&&G(),this.vars.css||t.style&&t!==e&&t.nodeType&&j.css&&this.vars.autoCSS!==!1&&A(this.vars,t);for(o in this.vars)if(h=this.vars[o],H[o])h&&(h instanceof Array||h.push&&f(h))&&-1!==h.join("").indexOf("{self}")&&(this.vars[o]=h=this._swapSelfInParams(h,this));else if(j[o]&&(c=new j[o])._onInitTween(t,this.vars[o],this,r)){for(this._firstPT=d={_next:this._firstPT,t:c,p:"setRatio",s:0,c:1,f:1,n:o,pg:1,pr:c._priority,m:0},s=c._overwriteProps.length;--s>-1;)i[c._overwriteProps[s]]=this._firstPT;(c._priority||c._onInitAllProps)&&(l=!0),(c._onDisable||c._onEnable)&&(this._notifyPluginsOfEnabled=!0),d._next&&(d._next._prev=d)}else i[o]=W.call(this,t,o,"get",h,o,0,null,this.vars.stringFilter,r);return a&&this._kill(a,t)?this._initProps(t,i,n,a,r):this._overwrite>1&&this._firstPT&&n.length>1&&K(t,this,i,this._overwrite,n)?(this._kill(i,t),this._initProps(t,i,n,a,r)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(R[t._gsTweenID]=!0),l)},o.render=function(e,t,i){var n,a,r,o,s=this._time,l=this._duration,c=this._rawPrevTime;if(e>=l-1e-7)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(n=!0,a="onComplete",i=i||this._timeline.autoRemoveChildren),0===l&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(e=0),(0>c||0>=e&&e>=-1e-7||c===h&&"isPause"!==this.data)&&c!==e&&(i=!0,c>h&&(a="onReverseComplete")),this._rawPrevTime=o=!t||e||c===e?e:h);else if(1e-7>e)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===l&&c>0)&&(a="onReverseComplete",n=this._reversed),0>e&&(this._active=!1,0===l&&(this._initted||!this.vars.lazy||i)&&(c>=0&&(c!==h||"isPause"!==this.data)&&(i=!0),this._rawPrevTime=o=!t||e||c===e?e:h)),this._initted||(i=!0);else if(this._totalTime=this._time=e,this._easeType){var d=e/l,u=this._easeType,p=this._easePower;(1===u||3===u&&d>=.5)&&(d=1-d),3===u&&(d*=2),1===p?d*=d:2===p?d*=d*d:3===p?d*=d*d*d:4===p&&(d*=d*d*d*d),1===u?this.ratio=1-d:2===u?this.ratio=d:.5>e/l?this.ratio=d/2:this.ratio=1-d/2}else this.ratio=this._ease.getRatio(e/l);if(this._time!==s||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=s,this._rawPrevTime=c,N.push(this),void(this._lazy=[e,t]);this._time&&!n?this.ratio=this._ease.getRatio(this._time/l):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==s&&e>=0&&(this._active=!0),0===s&&(this._startAt&&(e>=0?this._startAt.render(e,t,i):a||(a="_dummyGS")),this.vars.onStart&&(0!==this._time||0===l)&&(t||this._callback("onStart"))),r=this._firstPT;r;)r.f?r.t[r.p](r.c*this.ratio+r.s):r.t[r.p]=r.c*this.ratio+r.s,r=r._next;this._onUpdate&&(0>e&&this._startAt&&e!==-1e-4&&this._startAt.render(e,t,i),t||(this._time!==s||n||i)&&this._callback("onUpdate")),a&&(!this._gc||i)&&(0>e&&this._startAt&&!this._onUpdate&&e!==-1e-4&&this._startAt.render(e,t,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[a]&&this._callback(a),0===l&&this._rawPrevTime===h&&o!==h&&(this._rawPrevTime=0))}},o._kill=function(e,t,i){if("all"===e&&(e=null),null==e&&(null==t||t===this.target))return this._lazy=!1,this._enabled(!1,!1);t="string"!=typeof t?t||this._targets||this.target:$.selector(t)||t;var n,a,r,o,s,l,c,d,h,u=i&&this._time&&i._startTime===this._startTime&&this._timeline===i._timeline;if((f(t)||O(t))&&"number"!=typeof t[0])for(n=t.length;--n>-1;)this._kill(e,t[n],i)&&(l=!0);else{if(this._targets){for(n=this._targets.length;--n>-1;)if(t===this._targets[n]){s=this._propLookup[n]||{},this._overwrittenProps=this._overwrittenProps||[],a=this._overwrittenProps[n]=e?this._overwrittenProps[n]||{}:"all";break}}else{if(t!==this.target)return!1;s=this._propLookup,a=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(s){if(c=e||s,d=e!==a&&"all"!==a&&e!==s&&("object"!=typeof e||!e._tempKill),i&&($.onOverwrite||this.vars.onOverwrite)){for(r in c)s[r]&&(h||(h=[]),h.push(r));if((h||!e)&&!Q(this,i,t,h))return!1}for(r in c)(o=s[r])&&(u&&(o.f?o.t[o.p](o.s):o.t[o.p]=o.s,l=!0),o.pg&&o.t._kill(c)&&(l=!0),o.pg&&0!==o.t._overwriteProps.length||(o._prev?o._prev._next=o._next:o===this._firstPT&&(this._firstPT=o._next),o._next&&(o._next._prev=o._prev),o._next=o._prev=null),delete s[r]),d&&(a[r]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},o.invalidate=function(){return this._notifyPluginsOfEnabled&&$._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],E.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-h,this.render(Math.min(0,-this._delay))),this},o._enabled=function(e,t){if(l||s.wake(),e&&this._gc){var i,n=this._targets;if(n)for(i=n.length;--i>-1;)this._siblings[i]=J(n[i],this,!0);else this._siblings=J(this.target,this,!0)}return E.prototype._enabled.call(this,e,t),this._notifyPluginsOfEnabled&&this._firstPT?$._onPluginEvent(e?"_onEnable":"_onDisable",this):!1},$.to=function(e,t,i){return new $(e,t,i)},$.from=function(e,t,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new $(e,t,i)},$.fromTo=function(e,t,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new $(e,t,n)},$.delayedCall=function(e,t,i,n,a){return new $(t,0,{delay:e,onComplete:t,onCompleteParams:i,callbackScope:n,onReverseComplete:t,onReverseCompleteParams:i,immediateRender:!1,lazy:!1,useFrames:a,overwrite:0})},$.set=function(e,t){return new $(e,0,t)},$.getTweensOf=function(e,t){if(null==e)return[];e="string"!=typeof e?e:$.selector(e)||e;var i,n,a,r;if((f(e)||O(e))&&"number"!=typeof e[0]){for(i=e.length,n=[];--i>-1;)n=n.concat($.getTweensOf(e[i],t));for(i=n.length;--i>-1;)for(r=n[i],a=i;--a>-1;)r===n[a]&&n.splice(i,1)}else for(n=J(e).concat(),i=n.length;--i>-1;)(n[i]._gc||t&&!n[i].isActive())&&n.splice(i,1);return n},$.killTweensOf=$.killDelayedCallsTo=function(e,t,i){"object"==typeof t&&(i=t,t=!1);for(var n=$.getTweensOf(e,t),a=n.length;--a>-1;)n[a]._kill(i,e)};var ee=w("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=ee.prototype},!0);if(o=ee.prototype,ee.version="1.19.0",ee.API=2,o._firstPT=null,o._addTween=W,o.setRatio=L,o._kill=function(e){var t,i=this._overwriteProps,n=this._firstPT;if(null!=e[this._propName])this._overwriteProps=[];else for(t=i.length;--t>-1;)null!=e[i[t]]&&i.splice(t,1);for(;n;)null!=e[n.n]&&(n._next&&(n._next._prev=n._prev),n._prev?(n._prev._next=n._next,n._prev=null):this._firstPT===n&&(this._firstPT=n._next)),n=n._next;return!1},o._mod=o._roundProps=function(e){for(var t,i=this._firstPT;i;)t=e[this._propName]||null!=i.n&&e[i.n.split(this._propName+"_").join("")],t&&"function"==typeof t&&(2===i.f?i.t._applyPT.m=t:i.m=t),i=i._next},$._onPluginEvent=function(e,t){var i,n,a,r,o,s=t._firstPT;if("_onInitAllProps"===e){for(;s;){for(o=s._next,n=a;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:a=s,(s._next=n)?n._prev=s:r=s,s=o}s=t._firstPT=a}for(;s;)s.pg&&"function"==typeof s.t[e]&&s.t[e]()&&(i=!0),s=s._next;return i},ee.activate=function(e){for(var t=e.length;--t>-1;)e[t].API===ee.API&&(j[(new e[t])._propName]=e[t]);return!0},m.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var t,i=e.propName,n=e.priority||0,a=e.overwriteProps,r={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},o=w("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){ee.call(this,i,n),this._overwriteProps=a||[]},e.global===!0),s=o.prototype=new ee(i);s.constructor=o,o.API=e.API;for(t in r)"function"==typeof e[t]&&(s[r[t]]=e[t]);return o.version=e.version,ee.activate([o]),o},a=e._gsQueue){for(r=0;r<a.length;r++)a[r]();for(o in v)v[o].func||e.console.log("GSAP encountered missing dependency: "+o)}l=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax"),define("greensock/TweenMax",function(){}),function(){function e(e,t){var i={"margin-left":-(t.deltaX||0),"margin-top":-(t.deltaY||0)};e.iOverlaylist.each(function(e){e.isPositionAdapt&&e.iview&&e.iview.$el&&e.iview.$el.css(i)})}function t(){n(!0)}function i(e){n(!1,e)}function n(e,t){var i=$(".reveal"),n=" enableMouseWheelX enableDragX",a=" enableMouseWheelY enableDragY",r=" disableMouseWheelX disableDragX",o=" disableMouseWheelY disableDragY";if(e)i.removeClass(r+o).addClass(n+a);else{var s="",l="";s+=t.x?r:n,s+=t.y?o:a,l+=t.x?n:r,l+=t.y?a:o,i.removeClass(l).addClass(s)}}var a={x:0,y:0},r={};window.ScrollPage={getScrollPos:function(){return a},getExtendInfo:function(e){e=e||interaction_view.currentPage;var t=r[e];return t||(t=r[e]=getExtendInfo(e)),t},getCurrentScroll:function(){var e=interaction_view.getCurrentPageModel().iview;return e.scrollview?e.scrollview.iScroll:null},fixGestureState:function(){var e=this.getCurrentScroll();e&&(e.initiated=void 0)},bindScrollPage:function(n){function o(e){var t="get"+e[0].toUpperCase()+e.substr(1).toLowerCase();if(Reveal[t]()){w=!0;var i={left:{axis:"x",indexWhich:"indexh",step:-1},up:{axis:"y",indexWhich:"indexv",step:-1},right:{axis:"x",indexWhich:"indexh",step:1},down:{axis:"y",indexWhich:"indexv",step:1}}[e];Reveal.wheelLock=!0,Reveal.originh=Reveal.indexh,Reveal.originv=Reveal.indexv,Reveal[i.indexWhich]+=i.step,Reveal.transition.autostart(Reveal.options.transition,i.axis,-i.step)}}if(a={x:0,y:0},"string"==typeof n)var s=interaction_view.ipagelist.getPage(n),l=$("section#"+n).children();else var s=n,l=n.iview.$el;var c=1==s.get("prevent_slide"),d=l,h=d.children(),u={width:interaction_view.doc.get("width"),height:interaction_view.doc.get("height")};"config"==s.attributes.type&&(u.width=375,u.height=603);var p={width:s.get("width")||u.width,height:s.get("height")||u.height},f={x:p.width-u.width,y:p.height-u.height},v={x:f.x>0,y:f.y>0};r[s.id]=v;var g=s.get("is_scrollPage")&&(v.x||v.y),m=interaction_view.events.scrollEvents.filter(function(e){return e.page_id==interaction_view.currentPage});if(g?i(v):t(),g&&!d.data("is_scrollPage")){d.data("is_scrollPage",!0);var w=!1,_={},y={x:0,y:0},b=50;d.css({"-webkit-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"}),h.css({width:p.width,height:p.height,"-webkit-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"}),s.iview.scrollview=new _g.scrollview({containment:d,contentel:h,mask_width:u.width,mask_height:u.height,content_width:p.width,content_height:p.height,content_x:0,content_y:0,touchSpeed:1/$.zoom,bounce:!1,onScrollStart:function(){var e=s.iview.scrollview._getCurrentPosition();e.x=-(e.x||0),e.y=-(e.y||0),a=y=e,_={left:e.x<=0,up:e.y<=0,right:e.x>=f.x,down:e.y>=f.y}},onScrolling:function(t){var i={x:-(t.deltaX||0),y:-(t.deltaY||0)},n=y;a=y=i,m.forEach(function(e){e.overlaymodel.iview.onAnchorTrigger(e,n,i)}),e(s,t),c||w||(_.left&&i.x<0-b?o("left"):_.up&&i.y<0-b?o("up"):_.right&&i.x>f.x+b?o("right"):_.down&&i.y>f.y+b&&o("down"))},onScrollend:function(t){w=!1,e(s,t)}}),d.css({overflow:"visible"});var x=s.iview.$el.data("swipeActionSet")||{};(v.x&&(x.onSwipeLeft||x.onSwipeRight)||v.y&&(x.onSwipeUp||x.onSwipeDown))&&s.iview.scrollview.iScroll.disable()}return g},reset:function(e){e.iview&&e.iview.scrollview&&e.iview.scrollview.iScroll.scrollTo(0,0)},isScrollPage:function(e){var t=this.extendInfo(e);return pageModel.get("is_scrollPage")&&(t.x||t.y)},getExtendInfo:function(e){var t=e?interaction_view.ipagelist.getPage(e):interaction_view.getCurrentPageModel(),i={width:interaction_view.doc.get("width"),height:interaction_view.doc.get("height")},n={width:t.get("width")||i.width,height:t.get("height")||i.height},a={x:n.width-i.width,y:n.height-i.height},r={x:a.x>0,y:a.y>0};return r}}}(window),define("_e/scrollpage",function(){}),!function(e){var t=function(t,i){this.$element=e(t),this.options=i,this.init()};t.prototype={init:function(){_.bindAll(this)},_animate_loading:function(){return this.loading.is(":visible")?(e("div",this.loading).css("top",-40*this.loadingFrame+"px"),void(this.loadingFrame=(this.loadingFrame+1)%12)):void clearInterval(this.loadingTimer)},load:function(t){this.$element.children("#jswait-loading").remove(),this.$element.children("#jswait-overlay").remove(),this.loadingTimer=this.loadingFrame=1,this.options=t,this.$element.append(this.loading=e('<div id="jswait-loading"><div></div></div>'),this.overlay=e('<div id="jswait-overlay" class="mask hide"></div>')),this.options.modal&&this.overlay.removeClass("hide"),this.options.simple?(this.loading.css({background:"#000000","line-height":40,"text-align":"center"}),this.loading.html('<img src="//v1static.epub360.com/thirdparty/jswait/jswait.gif">'),this.loading.show()):(clearInterval(this.loadingTimer),this.loading.show(),this.loadingTimer=setInterval(this._animate_loading,66)),this.waited=!0},close:function(){this.waited&&(this.loading.remove(),this.overlay.remove(),this.$element.children("#jswait-loading").remove(),this.$element.children("#jswait-overlay").remove(),this.loadingFrame=1,clearInterval(this.loadingTimer),this.waited=!1)}},e.fn.jswait=function(i){return this.each(function(){var n=e(this),a=n.data("jswait"),r=e.extend({},e.fn.jswait.defaults,"object"==typeof i&&i),o="string"==typeof i?i:null;a||n.data("jswait",a=new t(this,r)),o?a[o]():a.load(r)})},e.fn.jswait.defaults={modal:!1},e.fn.jswait.Constructor=t}(window.jQuery),define("jswait",["jquery"],function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";function e(e,t,i,n){return i=parseFloat(i)-parseFloat(e),n=parseFloat(n)-parseFloat(t),Math.sqrt(i*i+n*n)}function t(e){return"string"!=typeof e&&e.nodeType||(e=_gsScope.TweenLite.selector(e),e.length&&(e=e[0])),e}function i(e,t,i){var n,a,r=e.indexOf(" ");return-1===r?(n=void 0!==i?i+"":e,a=e):(n=e.substr(0,r),a=e.substr(r+1)),n=-1!==n.indexOf("%")?parseFloat(n)/100*t:parseFloat(n),a=-1!==a.indexOf("%")?parseFloat(a)/100*t:parseFloat(a),n>a?[a,n]:[n,a]}function n(i){if(!i)return 0;i=t(i);var n,a,r,o,s,l,c,d,h=i.tagName.toLowerCase();if("path"===h)n=i.getTotalLength()||0;else if("rect"===h)a=i.getBBox(),n=2*(a.width+a.height);else if("circle"===h)n=2*Math.PI*parseFloat(i.getAttribute("r"));else if("line"===h)n=e(i.getAttribute("x1"),i.getAttribute("y1"),i.getAttribute("x2"),i.getAttribute("y2"));else if("polyline"===h||"polygon"===h)for(r=i.getAttribute("points").split(" "),n=0,s=r[0].split(","),"polygon"===h&&(r.push(r[0]),-1===r[0].indexOf(",")&&r.push(r[1])),l=1;l<r.length;l++)o=r[l].split(","),1===o.length&&(o[1]=r[l++]),2===o.length&&(n+=e(s[0],s[1],o[0],o[1])||0,s=o);else"ellipse"===h&&(c=parseFloat(i.getAttribute("rx")),d=parseFloat(i.getAttribute("ry")),n=Math.PI*(3*(c+d)-Math.sqrt((3*c+d)*(c+3*d))));return n||0}function a(e,i){if(!e)return[0,0];e=t(e),i=i||n(e)+1;var a=o(e),r=a.strokeDasharray||"",s=parseFloat(a.strokeDashoffset);return r=-1===r.indexOf(" ")?i:parseFloat(r.split(" ")[0])||1e-5,r>i&&(r=i),[Math.max(0,-s),r-s]}var r,o=document.defaultView?document.defaultView.getComputedStyle:function(){};r=_gsScope._gsDefine.plugin({propName:"drawSVG",API:2,version:"0.0.4",global:!0,overwriteProps:["drawSVG"],init:function(e,t,r){if(!e.getBBox)return!1;var o,s,l,c=n(e)+1;return this._style=e.style,t===!0||"true"===t?t="0 100%":t?-1===(t+"").indexOf(" ")&&(t="0 "+t):t="0 0",o=a(e,c),s=i(t,c,o[0]),this._length=c+10,0===o[0]&&0===s[0]?(l=Math.max(1e-5,s[1]-c),this._dash=c+l,this._offset=c-o[1]+l,this._addTween(this,"_offset",this._offset,c-s[1]+l,"drawSVG")):(this._dash=o[1]-o[0]||1e-6,this._offset=-o[0],this._addTween(this,"_dash",this._dash,s[1]-s[0]||1e-5,"drawSVG"),this._addTween(this,"_offset",this._offset,-s[0],"drawSVG")),!0},set:function(e){this._firstPT&&(this._super.setRatio.call(this,e),this._style.strokeDashoffset=this._offset,this._style.strokeDasharray=this._dash+" "+this._length)}}),r.getLength=n,r.getPosition=a}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),define("greensock/plugins/DrawSVGPlugin",function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";var e=Math.PI/180,t=180/Math.PI,i=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,n=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,a=/[achlmqstvz]/gi,r=_gsScope.TweenLite,o=function(e){window.console&&console.log(e)},s=function(t,i){var n,a,r,o,s,l,c=Math.ceil(Math.abs(i)/90),d=0,h=[];for(t*=e,i*=e,n=i/c,a=4/3*Math.sin(n/2)/(1+Math.cos(n/2)),l=0;c>l;l++)r=t+l*n,o=Math.cos(r),s=Math.sin(r),h[d++]=o-a*s,h[d++]=s+a*o,r+=n,o=Math.cos(r),s=Math.sin(r),h[d++]=o+a*s,h[d++]=s-a*o,h[d++]=o,h[d++]=s;return h},l=function(i,n,a,r,o,l,c,d,h){if(i!==d||n!==h){a=Math.abs(a),r=Math.abs(r);var u=o%360*e,p=Math.cos(u),f=Math.sin(u),v=(i-d)/2,g=(n-h)/2,m=p*v+f*g,w=-f*v+p*g,_=a*a,y=r*r,b=m*m,x=w*w,S=b/_+x/y;S>1&&(a=Math.sqrt(S)*a,r=Math.sqrt(S)*r,_=a*a,y=r*r);var C=l===c?-1:1,T=(_*y-_*x-y*b)/(_*x+y*b);0>T&&(T=0);var k=C*Math.sqrt(T),P=k*(a*w/r),E=k*-(r*m/a),D=(i+d)/2,I=(n+h)/2,$=D+(p*P-f*E),O=I+(f*P+p*E),A=(m-P)/a,N=(w-E)/r,R=(-m-P)/a,M=(-w-E)/r,L=Math.sqrt(A*A+N*N),F=A;C=0>N?-1:1;var W=C*Math.acos(F/L)*t;L=Math.sqrt((A*A+N*N)*(R*R+M*M)),F=A*R+N*M,C=0>A*M-N*R?-1:1;var B=C*Math.acos(F/L)*t;!c&&B>0?B-=360:c&&0>B&&(B+=360),B%=360,W%=360;var j,z,U,H=s(W,B),V=p*a,Y=f*a,X=f*-r,q=p*r,G=H.length-2;for(j=0;G>j;j+=2)z=H[j],U=H[j+1],H[j]=z*V+U*X+$,H[j+1]=z*Y+U*q+O;return H[H.length-2]=d,H[H.length-1]=h,H}},c=function(e){var t,n,a,r,s,c,d,h,u,p,f,v,g,m=(e+"").match(i)||[],w=[],_=0,y=0,b=m.length,x=2,S=0;if(!e||!isNaN(m[0])||isNaN(m[1]))return o("ERROR: malformed path data: "+e),w;for(t=0;b>t;t++)if(g=s,isNaN(m[t])?(s=m[t].toUpperCase(),c=s!==m[t]):t--,a=+m[t+1],r=+m[t+2],c&&(a+=_,r+=y),0===t&&(h=a,u=r),"M"===s)d&&d.length<8&&(w.length-=1,x=0),_=h=a,y=u=r,d=[a,r],S+=x,x=2,w.push(d),t+=2,s="L";else if("C"===s)d||(d=[0,0]),d[x++]=a,d[x++]=r,c||(_=y=0),d[x++]=_+1*m[t+3],d[x++]=y+1*m[t+4],d[x++]=_+=1*m[t+5],d[x++]=y+=1*m[t+6],t+=6;else if("S"===s)"C"===g||"S"===g?(p=_-d[x-4],f=y-d[x-3],d[x++]=_+p,d[x++]=y+f):(d[x++]=_,d[x++]=y),d[x++]=a,d[x++]=r,c||(_=y=0),d[x++]=_+=1*m[t+3],d[x++]=y+=1*m[t+4],t+=4;else if("Q"===s)p=a-_,f=r-y,d[x++]=_+2*p/3,d[x++]=y+2*f/3,c||(_=y=0),_+=1*m[t+3],y+=1*m[t+4],p=a-_,f=r-y,d[x++]=_+2*p/3,d[x++]=y+2*f/3,d[x++]=_,d[x++]=y,t+=4;else if("T"===s)p=_-d[x-4],f=y-d[x-3],d[x++]=_+p,d[x++]=y+f,p=_+1.5*p-a,f=y+1.5*f-r,d[x++]=a+2*p/3,d[x++]=r+2*f/3,d[x++]=_=a,d[x++]=y=r,t+=2;else if("H"===s)r=y,d[x++]=_+(a-_)/3,d[x++]=y+(r-y)/3,d[x++]=_+2*(a-_)/3,d[x++]=y+2*(r-y)/3,d[x++]=_=a,d[x++]=r,t+=1;else if("V"===s)r=a,a=_,c&&(r+=y-_),d[x++]=a,d[x++]=y+(r-y)/3,d[x++]=a,d[x++]=y+2*(r-y)/3,d[x++]=a,d[x++]=y=r,t+=1;else if("L"===s||"Z"===s)"Z"===s&&(a=h,r=u,d.closed=!0),("L"===s||Math.abs(_-a)>.5||Math.abs(y-r)>.5)&&(d[x++]=_+(a-_)/3,d[x++]=y+(r-y)/3,d[x++]=_+2*(a-_)/3,d[x++]=y+2*(r-y)/3,d[x++]=a,d[x++]=r,"L"===s&&(t+=2)),_=a,y=r;else if("A"===s){for(v=l(_,y,1*m[t+1],1*m[t+2],1*m[t+3],1*m[t+4],1*m[t+5],(c?_:0)+1*m[t+6],(c?y:0)+1*m[t+7]),n=0;n<v.length;n++)d[x++]=v[n];_=d[x-2],y=d[x-1],t+=7}else o("Error: malformed path data: "+e);return w.totalPoints=S+x,w},d=function(e,t){var i,n,a,r,o,s,l,c,d,h,u,p,f,v,g=0,m=.999999,w=e.length,_=t/((w-2)/6);for(f=2;w>f;f+=6)for(g+=_;g>m;)i=e[f-2],n=e[f-1],a=e[f],r=e[f+1],o=e[f+2],s=e[f+3],l=e[f+4],c=e[f+5],v=1/(Math.floor(g)+1),d=i+(a-i)*v,u=a+(o-a)*v,d+=(u-d)*v,u+=(o+(l-o)*v-u)*v,h=n+(r-n)*v,p=r+(s-r)*v,h+=(p-h)*v,p+=(s+(c-s)*v-p)*v,e.splice(f,4,i+(a-i)*v,n+(r-n)*v,d,h,d+(u-d)*v,h+(p-h)*v,u,p,o+(l-o)*v,s+(c-s)*v),f+=6,w+=6,g--;return e},h=function(e){var t,i,n,a,r="",o=e.length,s=100;for(i=0;o>i;i++){for(a=e[i],r+="M"+a[0]+","+a[1]+" C",t=a.length,n=2;t>n;n++)r+=(a[n++]*s|0)/s+","+(a[n++]*s|0)/s+" "+(a[n++]*s|0)/s+","+(a[n++]*s|0)/s+" "+(a[n++]*s|0)/s+","+(a[n]*s|0)/s+" ";a.closed&&(r+="z")}return r},u=function(e){for(var t=[],i=e.length-1,n=0;--i>-1;)t[n++]=e[i],t[n++]=e[i+1],i--;for(i=0;n>i;i++)e[i]=t[i];e.reversed=e.reversed?!1:!0},p=function(e){var t,i=e.length,n=0,a=0;for(t=0;i>t;t++)n+=e[t++],a+=e[t];return[n/(i/2),a/(i/2)]},f=function(e){var t,i,n,a=e.length,r=e[0],o=r,s=e[1],l=s;for(n=6;a>n;n+=6)t=e[n],i=e[n+1],t>r?r=t:o>t&&(o=t),i>s?s=i:l>i&&(l=i);return e.centerX=(r+o)/2,e.centerY=(s+l)/2,e.size=(r-o)*(s-l)},v=function(e){for(var t,i,n,a,r,o=e.length,s=e[0][0],l=s,c=e[0][1],d=c;--o>-1;)for(r=e[o],t=r.length,a=6;t>a;a+=6)i=r[a],n=r[a+1],i>s?s=i:l>i&&(l=i),n>c?c=n:d>n&&(d=n);return e.centerX=(s+l)/2,e.centerY=(c+d)/2,e.size=(s-l)*(c-d)},g=function(e,t){return t.length-e.length},m=function(e,t){var i=e.size||f(e),n=t.size||f(t);return Math.abs(n-i)<(i+n)/20?t.centerX-e.centerX||t.centerY-e.centerY:n-i},w=function(e,t){var i,n,a=e.slice(0),r=e.length,o=r-2;for(t=0|t,i=0;r>i;i++)n=(i+t)%o,e[i++]=a[n],e[i]=a[n+1]},_=function(e,t,i,n,a){var r,o,s,l,c=e.length,d=0,h=c-2;for(i*=6,o=0;c>o;o+=6)r=(o+i)%h,l=e[r]-(t[o]-n),s=e[r+1]-(t[o+1]-a),d+=Math.sqrt(s*s+l*l);return d},y=function(e,t,i){var n,a,r,o=e.length,s=p(e),l=p(t),c=l[0]-s[0],d=l[1]-s[1],h=_(e,t,0,c,d),f=0;for(r=6;o>r;r+=6)a=_(e,t,r/6,c,d),h>a&&(h=a,f=r);if(i)for(n=e.slice(0),u(n),r=6;o>r;r+=6)a=_(n,t,r/6,c,d),h>a&&(h=a,f=-r);return f/6},b=function(e,t,i){for(var n,a,r,o,s,l,c=e.length,d=99999999999,h=0,u=0;--c>-1;)for(n=e[c],l=n.length,s=0;l>s;s+=6)a=n[s]-t,r=n[s+1]-i,o=Math.sqrt(a*a+r*r),d>o&&(d=o,h=n[s],u=n[s+1]);return[h,u]},x=function(e,t,i,n,a,r){var o,s,l,c,d,h=t.length,u=0,p=Math.min(e.size||f(e),t[i].size||f(t[i]))*n,v=999999999999,g=e.centerX+a,m=e.centerY+r;for(s=i;h>s&&(o=t[s].size||f(t[s]),!(p>o));s++)l=t[s].centerX-g,c=t[s].centerY-m,d=Math.sqrt(l*l+c*c),v>d&&(u=s,v=d);return d=t[u],t.splice(u,1),d},S=function(e,t,i,n){var a,r,s,l,c,h,p,_=t.length-e.length,S=_>0?t:e,C=_>0?e:t,T=0,k="complexity"===n?g:m,P="position"===n?0:"number"==typeof n?n:.8,E=C.length,D="object"==typeof i&&i.push?i.slice(0):[i],I="reverse"===D[0]||D[0]<0,$="log"===i;if(C[0]){if(S.length>1&&(e.sort(k),t.sort(k),h=S.size||v(S),h=C.size||v(C),h=S.centerX-C.centerX,p=S.centerY-C.centerY,k===m))for(E=0;E<C.length;E++)S.splice(E,0,x(C[E],S,E,P,h,p));if(_)for(0>_&&(_=-_),S[0].length>C[0].length&&d(C[0],(S[0].length-C[0].length)/6|0),E=C.length;_>T;)l=S[E].size||f(S[E]),s=b(C,S[E].centerX,S[E].centerY),l=s[0],c=s[1],C[E++]=[l,c,l,c,l,c,l,c],C.totalPoints+=8,T++;for(E=0;E<e.length;E++)a=t[E],r=e[E],_=a.length-r.length,0>_?d(a,-_/6|0):_>0&&d(r,_/6|0),I&&!r.reversed&&u(r),i=D[E]||0===D[E]?D[E]:"auto",i&&(r.closed||Math.abs(r[0]-r[r.length-2])<.5&&Math.abs(r[1]-r[r.length-1])<.5?"auto"===i||"log"===i?(D[E]=i=y(r,a,0===E),0>i&&(I=!0,u(r),i=-i),w(r,6*i)):"reverse"!==i&&(E&&0>i&&u(r),w(r,6*(0>i?-i:i))):!I&&("auto"===i&&Math.abs(a[0]-r[0])+Math.abs(a[1]-r[1])+Math.abs(a[a.length-2]-r[r.length-2])+Math.abs(a[a.length-1]-r[r.length-1])>Math.abs(a[0]-r[r.length-2])+Math.abs(a[1]-r[r.length-1])+Math.abs(a[a.length-2]-r[0])+Math.abs(a[a.length-1]-r[1])||i%2)?(u(r),D[E]=-1,I=!0):"auto"===i?D[E]=0:"reverse"===i&&(D[E]=-1),r.closed!==a.closed&&(r.closed=a.closed=!1));return $&&o("shapeIndex:["+D.join(",")+"]"),D}},C=function(e,t,i,n){var a=c(e[0]),r=c(e[1]);S(a,r,t||0===t?t:"auto",i)&&(e[0]=h(a),e[1]=h(r),("log"===n||n===!0)&&o('precompile:["'+e[0]+'","'+e[1]+'"]'))},T=function(e,t,i){return t||i||e||0===e?function(n){C(n,e,t,i)}:C},k=function(e,t){if(!t)return e;var i,a,r,o=e.match(n)||[],s=o.length,l="";for("reverse"===t?(a=s-1,i=-2):(a=(2*(parseInt(t,10)||0)+1+100*s)%s,i=2),r=0;s>r;r+=2)l+=o[a-1]+","+o[a]+" ",a=(a+i)%s;return l},P=function(e,t){var i,n,a,r,o,s,l,c=0,d=parseFloat(e[0]),h=parseFloat(e[1]),u=d+","+h+" ",p=.999999;for(a=e.length,i=.5*t/(.5*a-1),n=0;a-2>n;n+=2){if(c+=i,s=parseFloat(e[n+2]),l=parseFloat(e[n+3]),c>p)for(o=1/(Math.floor(c)+1),r=1;c>p;)u+=(d+(s-d)*o*r).toFixed(2)+","+(h+(l-h)*o*r).toFixed(2)+" ",c--,r++;u+=s+","+l+" ",d=s,h=l}return u},E=function(e){var t=e[0].match(n)||[],i=e[1].match(n)||[],a=i.length-t.length;a>0?e[0]=P(t,a):e[1]=P(i,-a)},D=function(e){return isNaN(e)?E:function(t){E(t),t[1]=k(t[1],parseInt(e,10))}},I=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","path"),n=Array.prototype.slice.call(e.attributes),a=n.length;for(t=","+t+",";--a>-1;)-1===t.indexOf(","+n[a].nodeName+",")&&i.setAttributeNS(null,n[a].nodeName,n[a].nodeValue);return i},$=function(e,t){var i,a,r,o,s,l,c,d,h,u,p,f,v,g,m,w,_,y,b,x,S,C=e.tagName.toLowerCase(),T=.552284749831;return"path"!==C&&e.getBBox?(l=I(e,"x,y,width,height,cx,cy,rx,ry,r,x1,x2,y1,y2,points"),"rect"===C?(o=+e.getAttribute("rx")||0,s=+e.getAttribute("ry")||0,a=+e.getAttribute("x")||0,r=+e.getAttribute("y")||0,u=(+e.getAttribute("width")||0)-2*o,p=(+e.getAttribute("height")||0)-2*s,o||s?(f=a+o*(1-T),v=a+o,g=v+u,m=g+o*T,w=g+o,_=r+s*(1-T),y=r+s,b=y+p,x=b+s*T,S=b+s,i="M"+w+","+y+" V"+b+" C"+[w,x,m,S,g,S,g-(g-v)/3,S,v+(g-v)/3,S,v,S,f,S,a,x,a,b,a,b-(b-y)/3,a,y+(b-y)/3,a,y,a,_,f,r,v,r,v+(g-v)/3,r,g-(g-v)/3,r,g,r,m,r,w,_,w,y].join(",")+"z"):i="M"+(a+u)+","+r+" v"+p+" h"+-u+" v"+-p+" h"+u+"z"):"circle"===C||"ellipse"===C?("circle"===C?(o=s=+e.getAttribute("r")||0,d=o*T):(o=+e.getAttribute("rx")||0,s=+e.getAttribute("ry")||0,d=s*T),a=+e.getAttribute("cx")||0,r=+e.getAttribute("cy")||0,c=o*T,i="M"+(a+o)+","+r+" C"+[a+o,r+d,a+c,r+s,a,r+s,a-c,r+s,a-o,r+d,a-o,r,a-o,r-d,a-c,r-s,a,r-s,a+c,r-s,a+o,r-d,a+o,r].join(",")+"z"):"line"===C?i="M"+e.getAttribute("x1")+","+e.getAttribute("y1")+" L"+e.getAttribute("x2")+","+e.getAttribute("y2"):("polyline"===C||"polygon"===C)&&(h=(e.getAttribute("points")+"").match(n)||[],a=h.shift(),r=h.shift(),i="M"+a+","+r+" L"+h.join(","),"polygon"===C&&(i+=","+a+","+r+"z")),l.setAttribute("d",i),t&&e.parentNode&&(e.parentNode.insertBefore(l,e),e.parentNode.removeChild(e)),l):e},O=function(e,t,i){var a,s,l="string"==typeof e;return(!l||(e.match(n)||[]).length<3)&&(a=l?r.selector(e):[e],a&&a[0]?(a=a[0],s=a.nodeName.toUpperCase(),t&&"PATH"!==s&&(a=$(a,!1),s="PATH"),e=a.getAttribute("PATH"===s?"d":"points")||"",a===i&&(e=a.getAttributeNS(null,"data-original")||e)):(o("WARNING: invalid morph to: "+e),e=!1)),e},A="Use MorphSVGPlugin.convertToPath(elementOrSelectorText) to convert to a path before morphing.",N=_gsScope._gsDefine.plugin({propName:"morphSVG",API:2,global:!0,version:"0.8.1",init:function(e,t,i){var n,r,s,l,c;return"function"!=typeof e.setAttribute?!1:(n=e.nodeName.toUpperCase(),c="POLYLINE"===n||"POLYGON"===n,"PATH"===n||c?(r="PATH"===n?"d":"points",("string"==typeof t||t.getBBox||t[0])&&(t={shape:t}),l=O(t.shape||t.d||t.points||"","d"===r,e),c&&a.test(l)?(o("WARNING: a <"+n+"> cannot accept path data. "+A),!1):(l&&(this._target=e,e.getAttributeNS(null,"data-original")||e.setAttributeNS(null,"data-original",e.getAttribute(r)),s=this._addTween(e,"setAttribute",e.getAttribute(r)+"",l+"","morphSVG",!1,r,"object"==typeof t.precompile?function(e){e[0]=t.precompile[0],e[1]=t.precompile[1]}:"d"===r?T(t.shapeIndex,t.map||N.defaultMap,t.precompile):D(t.shapeIndex)),s&&(this._overwriteProps.push("morphSVG"),s.end=l,s.endProp=r)),!0)):(o("WARNING: cannot morph a <"+n+"> SVG element. "+A),!1))},set:function(e){var t;if(this._super.setRatio.call(this,e),1===e)for(t=this._firstPT;t;)t.end&&this._target.setAttribute(t.endProp,t.end),t=t._next}});N.pathFilter=C,N.pointsFilter=E,N.subdivideRawBezier=d,N.defaultMap="size",N.pathDataToRawBezier=function(e){return c(O(e,!0))},N.equalizeSegmentQuantity=S,N.convertToPath=function(e,t){"string"==typeof e&&(e=r.selector(e));for(var i=e&&0!==e.length?e.length&&e[0]&&e[0].nodeType?Array.prototype.slice.call(e,0):[e]:[],n=i.length;--n>-1;)i[n]=$(i[n],t!==!1);return i},N.pathDataToBezier=function(e,t){var i,n,a,o,s,l,d,h,u=c(O(e,!0))[0]||[],p=0;if(t=t||{},h=t.align||t.relative,o=t.matrix||[1,0,0,1,0,0],s=t.offsetX||0,l=t.offsetY||0,"relative"===h||h===!0?(s-=u[0]*o[0]+u[1]*o[2],l-=u[0]*o[1]+u[1]*o[3],p="+="):(s+=o[4],l+=o[5],h&&(h="string"==typeof h?r.selector(h):[h],h&&h[0]&&(d=h[0].getBBox()||{x:0,y:0},s-=d.x,l-=d.y))),i=[],a=u.length,o)for(n=0;a>n;n+=2)i.push({x:p+(u[n]*o[0]+u[n+1]*o[2]+s),y:p+(u[n]*o[1]+u[n+1]*o[3]+l)});else for(n=0;a>n;n+=2)i.push({x:p+(u[n]+s),y:p+(u[n+1]+l)});return i}}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),define("greensock/plugins/MorphSVGPlugin",function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";var e=function(t){var i=t.nodeType,n="";if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=e(t)}else if(3===i||4===i)return t.nodeValue;return n},t=_gsScope._gsDefine.plugin({propName:"text",API:2,version:"0.5.1",init:function(t,i,n){var a,r;if(!("innerHTML"in t))return!1;if(this._target=t,"object"!=typeof i&&(i={value:i}),void 0===i.value)return this._text=this._original=[""],!0;if(this._delimiter=i.delimiter||"",this._original=e(t).replace(/\s+/g," ").split(this._delimiter),this._delimiter)this._text=i.value.replace(/\s+/g," ").split(this._delimiter);else{var o=i.value.replace(/\s+/g," ");this._text=[];for(var s=0;o.length;){var l=o.indexOf("<div>"),c=o.indexOf("</div>");o.indexOf("<br>");if(-1!=l||-1!=c){if(-1==l&&(l=99999),-1==c&&(c=99999),c>l)var d=!0;else var d=!1;if(d){var h=o.slice(s,l);if(h)for(var u=h.split(""),p=0;p<u.length;p++)"<"==u[p]&&"b"==u[p+1]&&"r"==u[p+2]&&">"==u[p+3]?(this._text.push("<br>"),p+=3):this._text.push(u[p]);this._text.push("<div>"),o=o.slice(l+5)}else{var h=o.slice(s,c);if(h)for(var u=h.split(""),p=0;p<u.length;p++)"<"==u[p]&&"b"==u[p+1]&&"r"==u[p+2]&&">"==u[p+3]?(this._text.push("<br>"),
p+=3):this._text.push(u[p]);this._text.push("</div>"),o=o.slice(c+6)}}else{if(o)for(var u=o.split(""),p=0;p<u.length;p++)this._text.push(u[p]);o=""}}}for(this._runBackwards=n.vars.runBackwards===!0,this._runBackwards&&(a=this._original,this._original=this._text,this._text=a),"string"==typeof i.newClass&&(this._newClass=i.newClass,this._hasClass=!0),"string"==typeof i.oldClass&&(this._oldClass=i.oldClass,this._hasClass=!0),a=this._original.length-this._text.length,r=0>a?this._original:this._text,this._fillChar=i.fillChar||(i.padSpace?"&nbsp;":""),0>a&&(a=-a);--a>-1;)r.push(this._fillChar);return!0},set:function(e){e>1?e=1:0>e&&(e=0),this._runBackwards&&(e=1-e);var t,i,n,a=this._text.length,r=e*a+.5|0;this._hasClass?(t=this._newClass&&0!==r,i=this._oldClass&&r!==a,n=(t?"<span class='"+this._newClass+"'>":"")+this._text.slice(0,r).join(this._delimiter)+(t?"</span>":"")+(i?"<span class='"+this._oldClass+"'>":"")+this._delimiter+this._original.slice(r).join(this._delimiter)+(i?"</span>":"")):n=this._text.slice(0,r).join(this._delimiter)+this._delimiter+this._original.slice(r).join(this._delimiter),this._target.innerHTML="&nbsp;"===this._fillChar&&-1!==n.indexOf("  ")?n.split("  ").join("&nbsp;&nbsp;"):n}}),i=t.prototype;i._newClass=i._oldClass=i._delimiter=""}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),define("greensock/plugins/TextPlugin",function(){}),function(e,t,i){function n(e,i){this.wrapper="string"==typeof e?t.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,touchSpeed:1,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var n in i)this.options[n]=i[n];this.translateZ=this.options.HWCompositing&&d.hasPerspective?" translateZ(0)":"",this.options.useTransition=d.hasTransition&&this.options.useTransition,this.options.useTransform=d.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?d.ease[this.options.bounceEasing]||d.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function a(e,i,n){var a=t.createElement("div"),r=t.createElement("div");return n===!0&&(a.style.cssText="position:absolute;z-index:9999",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),r.className="iScrollIndicator","h"==e?(n===!0&&(a.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",r.style.height="100%"),a.className="iScrollHorizontalScrollbar"):(n===!0&&(a.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",r.style.width="100%"),a.className="iScrollVerticalScrollbar"),a.style.cssText+=";overflow:hidden",i||(a.style.pointerEvents="none"),a.appendChild(r),a}function r(i,n){this.wrapper="string"==typeof n.el?t.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=i,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var a in n)this.options[a]=n[a];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(d.addEvent(this.indicator,"touchstart",this),d.addEvent(e,"touchend",this)),this.options.disablePointer||(d.addEvent(this.indicator,"MSPointerDown",this),d.addEvent(e,"MSPointerUp",this)),this.options.disableMouse||(d.addEvent(this.indicator,"mousedown",this),d.addEvent(e,"mouseup",this))),this.options.fade&&(this.wrapperStyle[d.style.transform]=this.scroller.translateZ,this.wrapperStyle[d.style.transitionDuration]=d.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var o=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},s=!1;try{var l=Object.defineProperty({},"passive",{get:function(){s=!0}});e.addEventListener("testPassive",null,l),e.removeEventListener("testPassive",null,l)}catch(c){}var d=function(){function n(e){return o===!1?!1:""===o?e:o+e.charAt(0).toUpperCase()+e.substr(1)}var a={},r=t.createElement("div").style,o=function(){for(var e,t=["t","webkitT","MozT","msT","OT"],i=0,n=t.length;n>i;i++)if(e=t[i]+"ransform",e in r)return t[i].substr(0,t[i].length-1);return!1}();a.getTime=Date.now||function(){return(new Date).getTime()},a.extend=function(e,t){for(var i in t)e[i]=t[i]},a.addEvent=function(e,t,i,n){var a=!!n;n||(a=s?{passive:!1}:!1),e.addEventListener?e.addEventListener(t,i,a):e.attachEvent(t,i)},a.removeEvent=function(e,t,i,n){e.removeEventListener?e.removeEventListener(t,i,!!n):e.detachEvent(t,i)},a.momentum=function(e,t,n,a,r,o){var s,l,c=e-t,d=i.abs(c)/n;return o=void 0===o?6e-4:o,s=e+d*d/(2*o)*(0>c?-1:1),l=d/o,a>s?(s=r?a-r/2.5*(d/8):a,c=i.abs(s-e),l=c/d):s>0&&(s=r?r/2.5*(d/8):0,c=i.abs(e)+s,l=c/d),{destination:i.round(s),duration:l}};var l=n("transform");return a.extend(a,{hasTransform:l!==!1,hasPerspective:n("perspective")in r,hasTouch:"ontouchstart"in e,hasPointer:navigator.msPointerEnabled,hasTransition:n("transition")in r}),a.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion),a.extend(a.style={},{transform:l,transitionTimingFunction:n("transitionTimingFunction"),transitionDuration:n("transitionDuration"),transitionDelay:n("transitionDelay"),transformOrigin:n("transformOrigin")}),a.hasClass=function(e,t){var i=new RegExp("(^|\\s)"+t+"(\\s|$)");return i.test(e.className)},a.addClass=function(e,t){if(!a.hasClass(e,t)){var i=e.className.split(" ");i.push(t),e.className=i.join(" ")}},a.removeClass=function(e,t){if(a.hasClass(e,t)){var i=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")}},a.offset=function(e){for(var t=-e.offsetLeft,i=-e.offsetTop;e=e.offsetParent;)t-=e.offsetLeft,i-=e.offsetTop;return{left:t,top:i}},a.preventDefaultException=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},a.extend(a.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),a.extend(a.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return i.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e-=1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){var t=.22,n=.4;return 0===e?0:1==e?1:n*i.pow(2,-10*e)*i.sin((e-t/4)*(2*i.PI)/t)+1}}}),a.tap=function(e,i){var n=t.createEvent("Event");n.initEvent(i,!0,!0),n.pageX=e.pageX,n.pageY=e.pageY,e.target.dispatchEvent(n)},a.click=function(e){var i,n=e.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||(i=t.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,e.view,1,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i._constructed=!0,n.dispatchEvent(i))},a}();n.prototype={version:"5.1.1",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(e){if((1==d.eventType[e.type]||0===e.button)&&!(!this.enabled||e.target.className&&e.target.className.indexOf&&-1!=e.target.className.indexOf("noScroll")||this.initiated&&d.eventType[e.type]!==this.initiated)){!this.options.preventDefault||d.isBadAndroid||d.preventDefaultException(e.target,this.options.preventDefaultException)||e.preventDefault();var t,n=e.touches?e.touches[0]:e;this.initiated=d.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=d.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,t=this.getComputedPosition(),this._translate(i.round(t.x),i.round(t.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=n.pageX,this.pointY=n.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(!(!this.enabled||t.target.className&&t.target.className.indexOf&&-1!=t.target.className.indexOf("noScroll")||d.eventType[t.type]!==this.initiated)){this.options.preventDefault&&t.preventDefault();var n,a,r,o,s=t.touches?t.touches[0]:t,l=(s.pageX-this.pointX)*this.options.touchSpeed,c=(s.pageY-this.pointY)*this.options.touchSpeed,h=d.getTime();if(e.emulateLandscape){var u=e.emulateLandscape.emulateDelta(l,c);l=u[0],c=u[1]}if(this.pointX=s.pageX,this.pointY=s.pageY,this.distX+=l,this.distY+=c,r=i.abs(this.distX),o=i.abs(this.distY),!(h-this.endTime>300&&10>r&&10>o)){if(this.directionLocked||this.options.freeScroll||(r>o+this.options.directionLockThreshold?this.directionLocked="h":o>=r+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}l=this.hasHorizontalScroll?l:0,c=this.hasVerticalScroll?c:0,(this.options.scrollX&&l||this.options.scrollY&&c)&&t.stopPropagation(),n=this.x+l,a=this.y+c,(n>0||n<this.maxScrollX)&&(n=this.options.bounce?this.x+l/3:n>0?0:this.maxScrollX),(a>0||a<this.maxScrollY)&&(a=this.options.bounce?this.y+c/3:a>0?0:this.maxScrollY),this.directionX=l>0?-1:0>l?1:0,this.directionY=c>0?-1:0>c?1:0,this.moved||this._execEvent("scrollStart"),this.enabled&&(this.moved=!0,this._translate(n,a),h-this.startTime>300&&(this.startTime=h,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll"))}}},_end:function(e){if(!(!this.enabled||e.target.className&&e.target.className.indexOf&&-1!=e.target.className.indexOf("noScroll")||d.eventType[e.type]!==this.initiated)){this.options.preventDefault&&!d.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var t,n,a=(e.changedTouches?e.changedTouches[0]:e,d.getTime()-this.startTime),r=i.round(this.x),o=i.round(this.y),s=i.abs(r-this.startX),l=i.abs(o-this.startY),c=0,h="";if(this.isInTransition=0,this.initiated=0,this.endTime=d.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(r,o),!this.moved)return this.options.tap&&d.tap(e,this.options.tap),this.options.click&&d.click(e),void this._execEvent("scrollCancel");if(this._events.flick&&200>a&&100>s&&100>l)return void this._execEvent("flick");if(this.options.momentum&&300>a&&(t=this.hasHorizontalScroll?d.momentum(this.x,this.startX,a,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:r,duration:0},n=this.hasVerticalScroll?d.momentum(this.y,this.startY,a,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:o,duration:0},r=t.destination,o=n.destination,c=i.max(t.duration,n.duration),this.isInTransition=1),this.options.snap){var u=this._nearestSnap(r,o);this.currentPage=u,c=this.options.snapSpeed||i.max(i.max(i.min(i.abs(r-u.x),1e3),i.min(i.abs(o-u.y),1e3)),300),r=u.x,o=u.y,this.directionX=0,this.directionY=0,h=this.options.bounceEasing}return r!=this.x||o!=this.y?((r>0||r<this.maxScrollX||o>0||o<this.maxScrollY)&&(h=d.ease.quadratic),void this.scrollTo(r,o,c,h)):void this._execEvent("scrollEnd")}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),t==this.x&&i==this.y?!1:(this.scrollTo(t,i,e,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.options.scrollerHeight||this.wrapper.offsetHeight;this.wrapperWidth=this.options.wrapperWidth||this.wrapper.clientWidth,this.wrapperHeight=this.options.wrapperHeight||this.wrapper.clientHeight,this.scrollerWidth=this.options.scrollerWidth||this.scroller.offsetWidth,this.scrollerHeight=this.options.scrollerHeight||this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=d.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},off:function(e,t){if(this._events[e]){var i=this._events[e].indexOf(t);i>-1&&this._events[e].splice(i,1)}},_execEvent:function(e){if(this._events[e]){var t=0,i=this._events[e].length;if(i)for(;i>t;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,n){e=this.x+e,t=this.y+t,i=i||0,this.scrollTo(e,t,i,n)},scrollTo:function(e,t,i,n){n=n||d.ease.circular,this.isInTransition=this.options.useTransition&&i>0,!i||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(i),this._translate(e,t)):this._animate(e,t,i,n.fn)},scrollToElement:function(e,t,n,a,r){if(e=e.nodeType?e:this.scroller.querySelector(e)){var o=d.offset(e);o.left-=this.wrapperOffset.left,o.top-=this.wrapperOffset.top,n===!0&&(n=i.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)),a===!0&&(a=i.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)),o.left-=n||0,o.top-=a||0,o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left,o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top,t=void 0===t||null===t||"auto"===t?i.max(i.abs(this.x-o.left),i.abs(this.y-o.top)):t,this.scrollTo(o.left,o.top,t,r)}},_transitionTime:function(e){if(e=e||0,this.scrollerStyle[d.style.transitionDuration]=e+"ms",!e&&d.isBadAndroid&&(this.scrollerStyle[d.style.transitionDuration]="0.001s"),this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTime(e)},_transitionTimingFunction:function(e){if(this.scrollerStyle[d.style.transitionTimingFunction]=e,this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTimingFunction(e)},_translate:function(e,t){if(this.options.useTransform?this.scrollerStyle[d.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ:(e=i.round(e),t=i.round(t),this.scrollerStyle.left=e+"px",this.scrollerStyle.top=t+"px"),this.x=e,this.y=t,this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].updatePosition()},_initEvents:function(t){var i=t?d.removeEvent:d.addEvent,n=this.options.bindToWrapper?this.wrapper:e;i(e,"orientationchange",this),i(e,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(n,"mousemove",this),i(n,"mousecancel",this),i(n,"mouseup",this)),d.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,"MSPointerDown",this),i(n,"MSPointerMove",this),i(n,"MSPointerCancel",this),i(n,"MSPointerUp",this)),d.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(n,"touchmove",this),i(n,"touchcancel",this),i(n,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t,i,n=e.getComputedStyle(this.scroller,null);return this.options.useTransform?(n=n[d.style.transform].split(")")[0].split(", "),t=+(n[12]||n[4]),i=+(n[13]||n[5])):(t=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:t,y:i}},_initIndicators:function(){function e(e){for(var t=s.indicators.length;t--;)e.call(s.indicators[t])}var t,i=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,o=[],s=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(t={el:a("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(t.el),o.push(t)),this.options.scrollX&&(t={el:a("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(t.el),o.push(t))),this.options.indicators&&(o=o.concat(this.options.indicators));for(var l=o.length;l--;)this.indicators.push(new r(this,o[l]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){e(function(){this.fade()})}),this.on("scrollCancel",function(){e(function(){this.fade()})}),this.on("scrollStart",function(){e(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){e(function(){this.fade(1,!0)})})),this.on("refresh",function(){e(function(){this.refresh()})}),this.on("destroy",function(){e(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){d.addEvent(this.wrapper,"wheel",this),d.addEvent(this.wrapper,"mousewheel",this),d.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){d.removeEvent(this.wrapper,"wheel",this),d.removeEvent(this.wrapper,"mousewheel",this),d.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(!(!this.enabled||e.target.className&&e.target.className.indexOf&&-1!=e.target.className.indexOf("noScroll"))){var t,n,a,r,o=this;if("deltaX"in e?(t=-e.deltaX,n=-e.deltaY):"wheelDeltaX"in e?(t=e.wheelDeltaX/120*this.options.mouseWheelSpeed,n=e.wheelDeltaY/120*this.options.mouseWheelSpeed):t=n="wheelDelta"in e?e.wheelDelta/120*this.options.mouseWheelSpeed:"detail"in e?-e.detail/3*this.options.mouseWheelSpeed:void 0,(!t||this.options.scrollX||this.wheelTimeout)&&(!n||this.options.scrollY||this.wheelTimeout)&&(e.preventDefault(),e.stopPropagation(),void 0===this.wheelTimeout&&o._execEvent("scrollStart"),this.enabled&&(clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){o._execEvent("scrollEnd"),o.wheelTimeout=void 0},400),void 0!=t||void 0!=n))){if(t*=this.options.invertWheelDirection,n*=this.options.invertWheelDirection,this.hasVerticalScroll||(n=0),this.hasHorizontalScroll||(t=0),this.options.snap)return a=this.currentPage.pageX,r=this.currentPage.pageY,t>0?a--:0>t&&a++,n>0?r--:0>n&&r++,void this.goToPage(a,r);a=this.x+i.round(this.hasHorizontalScroll?t:0),r=this.y+i.round(this.hasVerticalScroll?n:0),a>0?a=0:a<this.maxScrollX&&(a=this.maxScrollX),r>0?r=0:r<this.maxScrollY&&(r=this.maxScrollY),this.scrollTo(a,r,0),this.options.probeType>1&&this._execEvent("scroll")}}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var e,t,n,a,r,o,s=0,l=0,c=0,d=this.options.snapStepX||this.wrapperWidth,h=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(n=i.round(d/2),a=i.round(h/2);c>-this.scrollerWidth;){for(this.pages[s]=[],e=0,r=0;r>-this.scrollerHeight;)this.pages[s][e]={x:i.max(c,this.maxScrollX),y:i.max(r,this.maxScrollY),width:d,height:h,cx:c-n,cy:r-a},r-=h,e++;c-=d,s++}else for(o=this.options.snap,e=o.length,t=-1;e>s;s++)(0===s||o[s].offsetLeft<=o[s-1].offsetLeft)&&(l=0,t++),this.pages[l]||(this.pages[l]=[]),c=i.max(-o[s].offsetLeft,this.maxScrollX),r=i.max(-o[s].offsetTop,this.maxScrollY),n=c-i.round(o[s].offsetWidth/2),a=r-i.round(o[s].offsetHeight/2),this.pages[l][t]={x:c,y:r,width:o[s].offsetWidth,height:o[s].offsetHeight,cx:n,cy:a},c>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var e=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.x-this.startX),1e3),i.min(i.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var n=0,a=this.pages.length,r=0;if(i.abs(e-this.absStartX)<this.snapThresholdX&&i.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;for(e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),t>0?t=0:t<this.maxScrollY&&(t=this.maxScrollY);a>n;n++)if(e>=this.pages[n][0].cx){e=this.pages[n][0].x;break}for(a=this.pages[n].length;a>r;r++)if(t>=this.pages[0][r].cy){t=this.pages[0][r].y;break}return n==this.currentPage.pageX&&(n+=this.directionX,0>n?n=0:n>=this.pages.length&&(n=this.pages.length-1),e=this.pages[n][0].x),r==this.currentPage.pageY&&(r+=this.directionY,0>r?r=0:r>=this.pages[0].length&&(r=this.pages[0].length-1),t=this.pages[0][r].y),{x:e,y:t,pageX:n,pageY:r}},goToPage:function(e,t,n,a){a=a||this.options.bounceEasing,e>=this.pages.length?e=this.pages.length-1:0>e&&(e=0),t>=this.pages[e].length?t=this.pages[e].length-1:0>t&&(t=0);var r=this.pages[e][t].x,o=this.pages[e][t].y;n=void 0===n?this.options.snapSpeed||i.max(i.max(i.min(i.abs(r-this.x),1e3),i.min(i.abs(o-this.y),1e3)),300):n,this.currentPage={x:r,y:o,pageX:e,pageY:t},this.scrollTo(r,o,n,a)},next:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,e,t)},prev:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--,0>i&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,e,t)},_initKeys:function(t){var i,n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in n)this.options.keyBindings[i]=this.options.keyBindings[i]||n[i];d.addEvent(e,"keydown",this),this.on("destroy",function(){d.removeEvent(e,"keydown",this)})},_key:function(e){if(this.enabled){var t,n=this.options.snap,a=n?this.currentPage.pageX:this.x,r=n?this.currentPage.pageY:this.y,o=d.getTime(),s=this.keyTime||0,l=.25;switch(this.options.useTransition&&this.isInTransition&&(t=this.getComputedPosition(),this._translate(i.round(t.x),i.round(t.y)),this.isInTransition=!1),this.keyAcceleration=200>o-s?i.min(this.keyAcceleration+l,50):0,e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?a+=n?1:this.wrapperWidth:r+=n?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?a-=n?1:this.wrapperWidth:r-=n?1:this.wrapperHeight;break;case this.options.keyBindings.end:a=n?this.pages.length-1:this.maxScrollX,r=n?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:a=0,r=0;break;case this.options.keyBindings.left:a+=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:r+=n?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:a-=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:r-=n?1:5+this.keyAcceleration>>0;break;default:return}if(n)return void this.goToPage(a,r);a>0?(a=0,this.keyAcceleration=0):a<this.maxScrollX&&(a=this.maxScrollX,this.keyAcceleration=0),r>0?(r=0,this.keyAcceleration=0):r<this.maxScrollY&&(r=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(a,r,0),this.keyTime=o}},_animate:function(e,t,i,n){function a(){var u,p,f,v=d.getTime();return v>=h?(r.isAnimating=!1,r._translate(e,t),void(r.resetPosition(r.options.bounceTime)||r._execEvent("scrollEnd"))):(v=(v-c)/i,f=n(v),u=(e-s)*f+s,p=(t-l)*f+l,r._translate(u,p),r.isAnimating&&o(a),void(3==r.options.probeType&&r._execEvent("scroll")))}var r=this,s=this.x,l=this.y,c=d.getTime(),h=c+i;this.isAnimating=!0,a()},handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||d.preventDefaultException(e.target,this.options.preventDefaultException)||(e.preventDefault(),e.stopPropagation())}}},r.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(d.removeEvent(this.indicator,"touchstart",this),d.removeEvent(this.indicator,"MSPointerDown",this),d.removeEvent(this.indicator,"mousedown",this),d.removeEvent(e,"touchmove",this),d.removeEvent(e,"MSPointerMove",this),d.removeEvent(e,"mousemove",this),d.removeEvent(e,"touchend",this),d.removeEvent(e,"MSPointerUp",this),d.removeEvent(e,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(t){var i=t.touches?t.touches[0]:t;t.preventDefault(),t.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=d.getTime(),this.options.disableTouch||d.addEvent(e,"touchmove",this),this.options.disablePointer||d.addEvent(e,"MSPointerMove",this),this.options.disableMouse||d.addEvent(e,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var t,i,n,a,r=e.touches?e.touches[0]:e,o=d.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.enabled&&(this.moved=!0,t=(r.pageX-this.lastPointX)*this.options.touchSpeed,this.lastPointX=r.pageX,i=(r.pageY-this.lastPointY)*this.options.touchSpeed,this.lastPointY=r.pageY,n=this.x+t,a=this.y+i,this._pos(n,a),1==this.scroller.options.probeType&&o-this.startTime>300?(this.startTime=o,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),e.preventDefault(),e.stopPropagation())},_end:function(t){if(this.initiated){if(this.initiated=!1,t.preventDefault(),t.stopPropagation(),d.removeEvent(e,"touchmove",this),d.removeEvent(e,"MSPointerMove",this),d.removeEvent(e,"mousemove",this),this.scroller.options.snap){var n=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),a=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.scroller.x-n.x),1e3),i.min(i.abs(this.scroller.y-n.y),1e3)),300);(this.scroller.x!=n.x||this.scroller.y!=n.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=n,this.scroller.scrollTo(n.x,n.y,a,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(e){e=e||0,this.indicatorStyle[d.style.transitionDuration]=e+"ms",!e&&d.isBadAndroid&&(this.indicatorStyle[d.style.transitionDuration]="0.001s")},transitionTimingFunction:function(e){this.indicatorStyle[d.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(d.addClass(this.wrapper,"iScrollBothScrollbars"),d.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(d.removeClass(this.wrapper,"iScrollBothScrollbars"),d.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.options.wrapperWidth||this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=i.max(i.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.options.wrapperHeight||this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=i.max(i.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,
this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var e=this.options.listenX&&i.round(this.sizeRatioX*this.scroller.x)||0,t=this.options.listenY&&i.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(e<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=i.max(this.indicatorWidth+e,8),this.indicatorStyle.width=this.width+"px"),e=this.minBoundaryX):e>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=i.max(this.indicatorWidth-(e-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",e=this.maxPosX+this.indicatorWidth-this.width):e=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),t<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=i.max(this.indicatorHeight+3*t,8),this.indicatorStyle.height=this.height+"px"),t=this.minBoundaryY):t>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=i.max(this.indicatorHeight-3*(t-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",t=this.maxPosY+this.indicatorHeight-this.height):t=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=e,this.y=t,this.scroller.options.useTransform?this.indicatorStyle[d.style.transform]="translate("+e+"px,"+t+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=e+"px",this.indicatorStyle.top=t+"px")},_pos:function(e,t){0>e?e=0:e>this.maxPosX&&(e=this.maxPosX),0>t?t=0:t>this.maxPosY&&(t=this.maxPosY),e=this.options.listenX?i.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?i.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)},fade:function(e,t){if(!t||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=e?250:500,n=e?0:300;e=e?"1":"0",this.wrapperStyle[d.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,e),n)}}},n.utils=d,"undefined"!=typeof module&&module.exports?module.exports=n:e.IScroll=n}(window,document,Math),define("iScroll",function(){}),function(){var e=function(e){this.init(e)};e.prototype={init:function(e){var t={containment:".mask",contentel:".layer-content",mask_width:200,mask_height:100,content_width:1024,content_height:768,content_x:0,content_y:0,throw_enabled:!0,scrollX:!0,scrollY:!0,onScrollStart:null,onScrolling:null,onScrollEnd:null,HWCompositing:!0};return this.options=e?$.extend(!0,{},t,e):t,_.bindAll(this),this._initVaribles(),this._initScrollItems(),this.iScroll},_initVaribles:function(){this.dragged=!1,this.dragstart=!1,this.dragging=!1,this.sliding=!1},_initScrollItems:function(){var e=this;this.containment=this.mask=$(this.options.containment),this.content=$(this.options.contentel),this.containment.css({width:this.options.mask_width,height:this.options.mask_height,overflow:"hidden"}),this.content.css({width:this.options.content_width,height:this.options.content_height}),this.iScroll=new IScroll(this.containment[0],{mouseWheel:!0,probeType:3,click:!0,scrollX:this.options.scrollX,scrollY:this.options.scrollY,wrapperWidth:this.options.mask_width,wrapperHeight:this.options.mask_height,scrollerWidth:this.options.content_width,scrollerHeight:this.options.content_height,HWCompositing:!0,touchSpeed:this.options.touchSpeed||1,mouseWheelSpeed:this.options.mouseWheelSpeed||20,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/,className:/(^|\s)iScrollPrevent(\s|$)/}}),this.iScroll.scrollTo(this.options.content_x,this.options.content_y),this.iScroll.on("beforeScrollStart",function(){}),this.iScroll.on("scrollStart",function(){document.activeElement&&"INPUT"==document.activeElement.tagName&&interaction_view.isAndroid&&document.activeElement.blur(),e.options.onScrollStart&&e.options.onScrollStart()}),this.iScroll.on("scroll",function(){var t=!1;e.dragstart&&(t=!0),e.options.onScrolling&&e.options.onScrolling({deltaX:this.x,deltaY:this.y,controller:t})}),this.iScroll.on("scrollEnd",function(){e.options.onScrollend&&e.options.onScrollend&&(this.y=parseFloat(this.y),e.options.onScrollend({deltaX:this.x,deltaY:this.y}))})},_checkX:function(e){return e-this.options.mask_width<-this.options.content_width&&(e=this.options.mask_width-this.options.content_width),e>0&&(e=0),e},_checkY:function(e){return e-this.options.mask_height<-this.options.content_height&&(e=this.options.mask_height-this.options.content_height),e>0&&(e=0),e},_getCurrentPosition:function(){var e={x:0,y:0};return e.x=this.iScroll.x,e.y=this.iScroll.y,e},_scrollTo:function(e,t,i,n){this.iScroll.scrollTo(e,t,1e3,n)},_scrollToEl:function(e,t,i,n,a){this.iScroll.scrollToElement(e,t,i,n,a)}},"undefined"==typeof require?(window._g||(window._g={}),window._g.scrollview=e):define("interaction_view/ui/scrollview",["_g/base","jquery.hammer","underscore","jquery.transit","iScroll"],function(){return window._g.scrollview=e,window._g.scrollview})}(window);var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";var e=document.documentElement,t=window,i=function(i,n){var a="x"===n?"Width":"Height",r="scroll"+a,o="client"+a,s=document.body;return i===t||i===e||i===s?Math.max(e[r],s[r])-(t["inner"+a]||Math.max(e[o],s[o])):i[r]-i["offset"+a]},n=_gsScope._gsDefine.plugin({propName:"scrollTo",API:2,version:"1.7.4",init:function(e,n,a){return this._wdw=e===t,this._target=e,this._tween=a,"object"!=typeof n&&(n={y:n}),this.vars=n,this._autoKill=n.autoKill!==!1,this.x=this.xPrev=this.getX(),this.y=this.yPrev=this.getY(),null!=n.x?(this._addTween(this,"x",this.x,"max"===n.x?i(e,"x"):n.x,"scrollTo_x",!0),this._overwriteProps.push("scrollTo_x")):this.skipX=!0,null!=n.y?(this._addTween(this,"y",this.y,"max"===n.y?i(e,"y"):n.y,"scrollTo_y",!0),this._overwriteProps.push("scrollTo_y")):this.skipY=!0,!0},set:function(e){this._super.setRatio.call(this,e);var n=this._wdw||!this.skipX?this.getX():this.xPrev,a=this._wdw||!this.skipY?this.getY():this.yPrev,r=a-this.yPrev,o=n-this.xPrev;this._autoKill&&(!this.skipX&&(o>7||-7>o)&&n<i(this._target,"x")&&(this.skipX=!0),!this.skipY&&(r>7||-7>r)&&a<i(this._target,"y")&&(this.skipY=!0),this.skipX&&this.skipY&&(this._tween.kill(),this.vars.onAutoKill&&this.vars.onAutoKill.apply(this.vars.onAutoKillScope||this._tween,this.vars.onAutoKillParams||[]))),this._wdw?t.scrollTo(this.skipX?n:this.x,this.skipY?a:this.y):(this.skipY||(this._target.scrollTop=this.y),this.skipX||(this._target.scrollLeft=this.x)),this.xPrev=this.x,this.yPrev=this.y}}),a=n.prototype;n.max=i,a.getX=function(){return this._wdw?null!=t.pageXOffset?t.pageXOffset:null!=e.scrollLeft?e.scrollLeft:document.body.scrollLeft:this._target.scrollLeft},a.getY=function(){return this._wdw?null!=t.pageYOffset?t.pageYOffset:null!=e.scrollTop?e.scrollTop:document.body.scrollTop:this._target.scrollTop},a._kill=function(e){return e.scrollTo_x&&(this.skipX=!0),e.scrollTo_y&&(this.skipY=!0),this._super._kill.call(this,e)}}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),define("greensock/plugins/ScrollToPlugin",function(){}),function(){var e=function(e){this.init(e)};e.prototype={percent:0,init:function(e){var t={containment:".g-slider",handle:".g-slider-handle",range:".g-slider-range"};return this.options=e?$.extend(!0,{},t,e):t,_.bindAll(this),this.handle=$(this.options.containment).find(this.options.handle).first(),this.range=$(this.options.containment).find(this.options.range).first(),this._bindControl(),this},_bindControl:function(){var e=this;this.handle.hammer().on("dragstart",function(t){e.dragstart=!0,e.startleft=parseInt(e.handle.css("left"),10)}),this.handle.hammer().on("drag",function(t){return console.log("dragleft"),e.dragstart=!0,e._doDragingEvent(t),t.gesture.preventDefault(),!1}),this.handle.hammer().on("dragend",function(t){return e.dragstart?(e.dragstart=!1,e._doDragEndEvent(t),t.gesture.preventDefault(),!1):void 0})},_doDragingEvent:function(e){console.log(e);var t=this.startleft,i=this.handle.parent().width(),n=$.zoom||1;t+=e.gesture.deltaX/n,0>t&&(t=0),t>i&&(t=i),this.percent=100*_g.number.decimal(t/i,2),this.handle.css("left",this.percent+"%"),this.range.css("width",this.percent+"%")},_doDragEndEvent:function(e){this.options.onChange&&this.options.onChange(this.percent)},change:function(e){this.dragstart||(this.handle.css("left",e+"%"),this.range.css("width",e+"%"))}},"undefined"==typeof require?(window._g||(window._g={}),window._g.slider=e):define("_g/slider",["_g/base","_g/event","jquery.hammer"],function(){return window._g.slider=e,window._g.slider})}(window),function(){var e={sendBinary:function(e){if(!e||!e.dataUrl&&!e.blob||!e.url)return!1;if(e.blob)var t=e.blob;else{e.b64Data=e.dataUrl.split(",")[1];var t=_g.fileapi.b64toBlob(e)}var i=new FormData;i.append(e.filekey||"file",t),i.append("Filename",e.filename||"blob"),e.upload_type&&i.append("type",e.upload_type),e.width&&i.append("width",e.width),e.height&&i.append("height",e.height),$.ajax({url:e.url,type:"POST",data:i,processData:!1,contentType:!1}).done(function(t){e.callback&&e.callback(t)}).fail(function(t){e.onFail&&e.onFail(t)})},b64toBlob:function(e){contentType=e.type||"image/png",sliceSize=e.sliceSize||512;for(var t=atob(e.b64Data),i=[],n=0;n<t.length;n+=sliceSize){for(var a=t.slice(n,n+sliceSize),r=new Array(a.length),o=0;o<a.length;o++)r[o]=a.charCodeAt(o);var s=new Uint8Array(r);i.push(s)}var l=new Blob(i,{type:contentType});return l},blobtoUrl:function(e){var t=self.URL||self.webkitURL||self,i=t.createObjectURL(e);return i},base64urltoBase64:function(e){return e.split(",")[1]},blobtoBase64:function(e,t){var i=new FileReader;i.onload=function(e){var i="undefined"!=typeof event?event.target.result:e.originalTarget.result;t&&t(i)},i.readAsDataURL(e)},fileUrltoBlob:function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(e){if(200==this.status){var i=this.response;t.onSuccess&&t.onSuccess(i)}else t.onFail&&t.onFail(i)},i.send()},imageUrltoBlob:function(e,t){var i=document.createElement("canvas"),n=i.getContext("2d"),a=(self.URL||self.webkitURL||self,new Image);a.onload=function(){i.width=a.width,i.height=a.height,n.drawImage(a,0,0);var e=i.toDataURL("image/png");t.callback&&t.callback(e)},a.setAttribute("crossOrigin","anonymous"),a.src=e}};"undefined"==typeof require?(window._g||(window._g={}),window._g.fileapi=e):define("_g/file",["_g/base"],function(){return window._g.fileapi=e,window._g.fileapi})}(window),function(){var e=["Image","ImageBlock","CycleImage","Slide","Gallery","Pip"],t={init:function(){interaction_view.preloadpageactions=new interaction_view.collection.Action},renderActions:function(e,t){for(var i=0;i<e.length;i++){var n=$.extend(!0,{},e[i]),a=new interaction_view.model.Action(n);a.iview.render(),function(e){var i={preload_hash:t,func:function(){e.iview.executeAction(e.iview)}};interaction_view.events.preloadPageEvents.push(i)}(a)}},preload:function(i,n){for(var a=[],r=function(){if(!a.length){var e=_.filter(interaction_view.events.preloadPageEvents,function(e){return e.preload_hash==n});e.length>0&&_.each(e,function(e){e.func()})}},o=0;o<i.length;o++){var s=i[o],l=interaction_view.ipagelist.getPage(s)||interaction_view.imasterlist.get(s)||interaction_view.ibackgroundlist.get(s);if(l){for(var c=l.get("overlays"),d=[],h=0;h<c.length;h++){var u=c[h];if(_.include(["LayerRef","LayerSlide","LayerLongTake","LayerRound","LayerPano"],u.iType)){var p=u.iDetail.layer_ids||[];d=_.union(d,p)}else if(_.include(e,u.iType)){var f=t.getPreloadImgs(u);a=_.union(a,f)}if(_.include(["LayerPano"],u.iType)){var v=interaction_view.view.LayerPano.prototype.bgClipper;u.iDetail.background.forEach(function(e){var t=v(e.url,e.size[0]);a=_.union(a,t,e.url)})}}if(d.length)for(var g=0;g<d.length;g++){var m=d[g],w=interaction_view.ilayerlist.get(m);if(w)for(var c=w.get("overlays"),h=0;h<c.length;h++){var u=c[h],f=t.getPreloadImgs(u);a=_.union(a,f)}}}}if(a.length)for(var o=0;o<a.length;o++)_e.preloadpage.loadImg(a[o],function(e,t,i){i&&(interaction_view.iImgs[e]=t),a=_.reject(a,function(t){return t==e}),r()});else r()},getPreloadImgs:function(t){var i=[];if(_.include(e,t.iType)){var n,a=t.iDetail.iImg;if(n=t.iDetail.setPrec?"?"+t.iDetail.setPrec:"",a&&a.length)for(var r=0;r<a.length;r++)interaction_view.iImgs[a[r].picture]||i.push(a[r].picture+n)}return i},loadImg:function(e,t){var i=new Image;i.onload=function(){t(e,i,!0)},i.onerror=function(){t(e,i,!1)},i.src=e}};"undefined"==typeof require?(window._e||(window._e={}),window._e.preloadpage=t):define("_e/preloadpage",[],function(){return window._e||(window._e={}),window._e.preloadpage=t,window._e.preloadpage})}(window),function(){var _init_api=function(){window.e_api=function(){var e={custom:{}};return e}(),window.e_Debug||(window.e_Debug=[]),function(api){api.variables={start_page:""},api._initialize=function(apis){for(var i=0;i<apis.length;i++){var apidata=apis[i];if(apidata&&apidata.name&&apidata.data){var data=unescape(apidata.data);if(data){data="function(){"+data+"}";try{api.custom[apidata.name]=eval("("+data+")")}catch(e){console.log(e);var log="[自定义JS初始化报错] "+e;e_Debug.push(log)}}}}},api.doc={goToPage:function(e,t){return void 0===t&&(t=9),presentation.gotopagebyargs(e,t)},getPageLength:function(){return interaction_view.ipagelist.getPages().length},getCurrentPageTitle:function(){return interaction_view.ipagelist.getPage(interaction_view.currentPage).toJSON().title},pause:function(e){interaction_view.statemanage.pause(),interaction_view.pausePlay(e)},continuePlay:function(e){interaction_view.statemanage.continuePlay(),interaction_view.continuePlay(e)},replay:function(e){interaction_view.statemanage.resetPlay(),interaction_view.play(e)}},api.exec=function(v){var result;try{result=eval(v)}catch(e){}return result},api.elm={getAttributes:function(e,t,i){var n;try{n=window[e][t]}catch(a){}return n},getProperty:function(){}},api.animation={},api.action={},api.weixin={},api.console={log:function(e){e_Debug.push(e)},req:function(e,t,i,n){return"undefined"!=typeof DB?DB.util.log(e,t,i,n):null}};var eventBus=Object.create(Backbone.Events);if(eventBus._state={already:{}},eventBus.triggerReady=function(e){var t=[].slice.call(arguments,1);return eventBus._state.already[e]=t,eventBus.trigger.apply(this,arguments)},eventBus._on=eventBus.on,eventBus.on=function(e,t){var i=eventBus._state.already[e];return i&&t.apply(this,i),eventBus._on.apply(this,arguments)},api.event=eventBus,"object"==typeof epub360&&epub360.api){if(epub360.api.EVENTS&&epub360.api.EVENTS.length)for(var i=0;i<epub360.api.EVENTS.length;i++)api.event.on(epub360.api.EVENTS[i].name,epub360.api.EVENTS[i].callback);epub360.api.variables&&"object"==typeof epub360.api.variables&&(e_api.variables=_.extend({},e_api.variables,epub360.api.variables)),epub360.api=_.extend({},api,epub360.api)}$(window).on("unload",function(){api.event.trigger("unload")}),$(window).on("beforeunload",function(){api.event.trigger("beforeunload")})}(e_api),"undefined"!=typeof Epub&&Epub||(window.Epub={Player:{},PlayerSDK:{},MessageEvents:[]},window.addEventListener("message",function(e){console.log(e);var t=e.data;if(t&&t.indexOf&&-1!=t.indexOf("_epub360_2016_player_oauth_"))try{var i=JSON.parse(t),n=i.event;if(Epub.MessageEvents.length)for(var a=0;a<Epub.MessageEvents.length;a++){var r=Epub.MessageEvents[a];r.event==n&&r.func(i.data)}}catch(e){console.log(e)}}),Epub.PlayerSDK.sendMessage=function(e,t){for(var i={oauth:"_epub360_2016_player_oauth_",data:t,event:e||"message"},n=document.getElementsByTagName("IFRAME"),a=JSON.stringify(i),r=0;r<n.length;r++)n[r].contentWindow.postMessage(a,"*")},Epub.PlayerSDK.onMessage=function(e,t){e||(e="message"),Epub.MessageEvents.push({event:e,func:t})},Epub.PlayerSDK.offMessage=function(e,t){if(e){for(var i=[],n=0;n<Epub.MessageEvents.length;n++){var a=Epub.MessageEvents[n];t?a.event==e&&t==a.func||i.push(a):a.event==e||i.push(a)}Epub.MessageEvents=i}},Epub.PlayerSDK.onMessage("CCFire",function(e){var t=interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.where({iType:"CC"});if(t&&t.length){var i=_.filter(t[0].CCFireEvents,function(t){return t.condition==e});_.each(i,function(e,t){e.func()})}}),Epub.PlayerSDK.onMessage("gotopage",function(e){var t=e.value;e_api.doc.goToPage(t,0)}),Epub.PlayerSDK.onMessage("totemplate",function(e){console.log(e);var t=interaction_view.getPage(interaction_view.currentPage).iOverlaylist.where({iType:"clist"});if(t&&t.length){var i=t[0].get("iDetail").linkpage;if(i){var n=interaction_view.getPage(i).iOverlaylist.where({iType:"ctemplate"});if(n&&n.length){var a=n[0].get("iDetail");a.iUrl=e.url,n[0].set("iDetail",a)}presentation.gotopage(i,0)}}}))};define("_e/api",["backbone"],function(){_init_api()})}(window),function(){function e(e,t){this.queue=e,this._callbacks=[];t&&(t.done=this.done,this.func=t)}function t(t){function i(e){return function(){r+=1,a[e]=Array.prototype.slice.call(arguments),r===o&&n.done(a)}}var n=new e,a=[];if(!t||!t.length)return n.done(a),n;for(var r=0,o=t.length,s=0;o>s;s++)t[s].then(i(s));return n}function i(t,n){var a=new e;return 0===t.length?a.done.apply(a,n):t[0].apply(null,n).then(function(){t.splice(0,1),i(t,arguments).then(function(){a.done.apply(a,arguments)})}),a}function n(e){if(this.options={continuous:!0},"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.init()}e.prototype.then=function(t,i){var n;return this._isdone?n=t.apply(i,this.result):(n=new e,this._callbacks.push(function(){var e=t.apply(i,arguments);e&&"function"==typeof e.then&&e.then(n.done,n)})),n},e.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var e=0;e<this._callbacks.length;e++)this._callbacks[e].apply(null,arguments);this._callbacks=[],this.queue&&this.queue.next.apply(this.queue,arguments)},n.prototype.init=function(){this.queues=[],this.pointer=null},n.prototype.add=function(t,i,n){if(n||(n={}),!(this.queues.length>1e3)){var a=new e(this,t);return this.queues.push({func:a,type:1,args:i,opts:n}),this.options.continuous&&this._exec(),a}},n.prototype.immediate=function(e,t,i){i||(i={}),this.queues.length>1e3||(this.queues.push({type:0,func:e,args:t,opts:i}),this.options.continuous&&this._exec())},n.prototype.length=function(){return this.queues.length},n.prototype.next=function(e,t){e?this.error(e):(interaction_view.queue.current=null,this.pointer=null,this._exec())},n.prototype._exec=function(){!this.pointer&&this.queues.length?(interaction_view.DEBUG&&(interaction_view.queue.current=this.queues[0].opts),this.queues.length&&(this.pointer=this.queues.shift()),0===this.pointer.type?(this.pointer.func(this.pointer.args),this.pointer=null,interaction_view.queue.current=null,this._exec()):this.pointer.func.func(this.pointer.args)):this.queues.length||this.options.onComplete&&this.options.onComplete()},n.prototype.error=function(e){console.log(e),this.queues=[],this.pointer=null,this.options.onError&&this.options.onError()},n.prototype.clear=function(){this.queues=[],this.pointer=null},window.Queue=n,window.promise={Promise:e,join:t,chain:i,ENOXHR:1,ETIMEOUT:2}}(window),define("_e/queue",function(){});var CryptoJS=CryptoJS||function(e,t){var i=Object.create||function(){function e(){}return function(t){var i;return e.prototype=t,i=new e,e.prototype=null,i}}(),n={},a=n.lib={},r=a.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=a.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes,a=e.sigBytes;if(this.clamp(),n%4)for(var r=0;a>r;r++){var o=i[r>>>2]>>>24-r%4*8&255;t[n+r>>>2]|=o<<24-(n+r)%4*8}else for(r=0;a>r;r+=4)t[n+r>>>2]=i[r>>>2];return this.sigBytes+=a,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i,n=[],a=function(t){t=t;var i=987654321,n=4294967295;return function(){var a=((i=36969*(65535&i)+(i>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return a/=4294967296,(a+=.5)*(.5<e.random()?1:-1)}},r=0;t>r;r+=4){var s=a(4294967296*(i||e.random()));i=987654071*s(),n.push(4294967296*s()|0)}return new o.init(n,t)}}),s=n.enc={},l=s.Hex={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],a=0;i>a;a++){var r=t[a>>>2]>>>24-a%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;t>n;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new o.init(i,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],a=0;i>a;a++){var r=t[a>>>2]>>>24-a%4*8&255;n.push(String.fromCharCode(r))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;t>n;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new o.init(i,t)}},d=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},h=a.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,n=i.words,a=i.sigBytes,r=this.blockSize,s=a/(4*r),l=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*r,c=e.min(4*l,a);if(l){for(var d=0;l>d;d+=r)this._doProcessBlock(n,d);var h=n.splice(0,l);i.sigBytes-=c}return new o.init(h,c)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),u=(a.Hasher=h.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new u.HMAC.init(e,i).finalize(t)}}}),n.algo={});return n}(Math);!function(){var e=CryptoJS,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp();for(var a=[],r=0;i>r;r+=3)for(var o=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,s=0;4>s&&i>r+.75*s;s++)a.push(n.charAt(o>>>6*(3-s)&63));var l=n.charAt(64);if(l)for(;a.length%4;)a.push(l);return a.join("")},parse:function(e){var i=e.length,n=this._map,a=this._reverseMap;if(!a){a=this._reverseMap=[];for(var r=0;r<n.length;r++)a[n.charCodeAt(r)]=r}var o=n.charAt(64);if(o){var s=e.indexOf(o);-1!==s&&(i=s)}return function(e,i,n){for(var a=[],r=0,o=0;i>o;o++)if(o%4){var s=n[e.charCodeAt(o-1)]<<o%4*2,l=n[e.charCodeAt(o)]>>>6-o%4*2;a[r>>>2]|=(s|l)<<24-r%4*8,r++}return t.create(a,r)}(e,i,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),CryptoJS.lib.Cipher||function(e){var t=CryptoJS,i=t.lib,n=i.Base,a=i.WordArray,r=i.BufferedBlockAlgorithm,o=t.enc,s=(o.Utf8,o.Base64),l=t.algo.EvpKDF,c=i.Cipher=r.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,i){this.cfg=this.cfg.extend(i),this._xformMode=e,this._key=t,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:g}return function(t){return{encrypt:function(i,n,a){return e(n).encrypt(t,i,n,a)},decrypt:function(i,n,a){return e(n).decrypt(t,i,n,a)}}}}()}),d=(i.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),h=i.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),u=d.CBC=function(){function e(e,t,i){var n=this._iv;if(n){var a=n;this._iv=void 0}else a=this._prevBlock;for(var r=0;i>r;r++)e[t+r]^=a[r]}var t=h.extend();return t.Encryptor=t.extend({processBlock:function(t,i){var n=this._cipher,a=n.blockSize;e.call(this,t,i,a),n.encryptBlock(t,i),this._prevBlock=t.slice(i,i+a)}}),t.Decryptor=t.extend({processBlock:function(t,i){var n=this._cipher,a=n.blockSize,r=t.slice(i,i+a);n.decryptBlock(t,i),e.call(this,t,i,a),this._prevBlock=r}}),t}(),p=(t.pad={}).Pkcs7={pad:function(e,t){for(var i=4*t,n=i-e.sigBytes%i,r=n<<24|n<<16|n<<8|n,o=[],s=0;n>s;s+=4)o.push(r);var l=a.create(o,n);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},f=(i.BlockCipher=c.extend({cfg:c.cfg.extend({mode:u,padding:p}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,i=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=i.createEncryptor;else n=i.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(i,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),i.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,i=e.salt;if(i)var n=a.create([1398893684,1701076831]).concat(i).concat(t);else n=t;return n.toString(s)},parse:function(e){var t=s.parse(e),i=t.words;if(1398893684==i[0]&&1701076831==i[1]){var n=a.create(i.slice(2,4));i.splice(0,4),t.sigBytes-=16}return f.create({ciphertext:t,salt:n})}},g=i.SerializableCipher=n.extend({cfg:n.extend({format:v}),encrypt:function(e,t,i,n){n=this.cfg.extend(n);var a=e.createEncryptor(i,n),r=a.finalize(t),o=a.cfg;return f.create({ciphertext:r,key:i,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,i,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(i,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),m=(t.kdf={}).OpenSSL={execute:function(e,t,i,n){n||(n=a.random(8));var r=l.create({keySize:t+i}).compute(e,n),o=a.create(r.words.slice(t),4*i);return r.sigBytes=4*t,f.create({key:r,iv:o,salt:n})}},w=i.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:m}),encrypt:function(e,t,i,n){var a=(n=this.cfg.extend(n)).kdf.execute(i,e.keySize,e.ivSize);n.iv=a.iv;var r=g.encrypt.call(this,e,t,a.key,n);return r.mixIn(a),r},decrypt:function(e,t,i,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var a=n.kdf.execute(i,e.keySize,e.ivSize,t.salt);return n.iv=a.iv,g.decrypt.call(this,e,t,a.key,n)}})}(),function(){var e=CryptoJS,t=e.lib.BlockCipher,i=e.algo,n=[],a=[],r=[],o=[],s=[],l=[],c=[],d=[],h=[],u=[];!function(){for(var e=[],t=0;256>t;t++)e[t]=128>t?t<<1:t<<1^283;var i=0,p=0;for(t=0;256>t;t++){var f=p^p<<1^p<<2^p<<3^p<<4;f=f>>>8^255&f^99,n[i]=f;var v=e[a[f]=i],g=e[v],m=e[g],w=257*e[f]^16843008*f;r[i]=w<<24|w>>>8,o[i]=w<<16|w>>>16,s[i]=w<<8|w>>>24,l[i]=w,w=16843009*m^65537*g^257*v^16843008*i,c[f]=w<<24|w>>>8,d[f]=w<<16|w>>>16,h[f]=w<<8|w>>>24,u[f]=w,i?(i=v^e[e[e[m^v]]],p^=e[e[p]]):i=p=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],f=i.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,i=e.sigBytes/4,a=4*((this._nRounds=i+6)+1),r=this._keySchedule=[],o=0;a>o;o++)if(i>o)r[o]=t[o];else{var s=r[o-1];o%i?i>6&&o%i==4&&(s=n[s>>>24]<<24|n[s>>>16&255]<<16|n[s>>>8&255]<<8|n[255&s]):(s=n[(s=s<<8|s>>>24)>>>24]<<24|n[s>>>16&255]<<16|n[s>>>8&255]<<8|n[255&s],s^=p[o/i|0]<<24),r[o]=r[o-i]^s}for(var l=this._invKeySchedule=[],f=0;a>f;f++)o=a-f,s=f%4?r[o]:r[o-4],l[f]=4>f||4>=o?s:c[n[s>>>24]]^d[n[s>>>16&255]]^h[n[s>>>8&255]]^u[n[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,r,o,s,l,n)},decryptBlock:function(e,t){var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i,this._doCryptBlock(e,t,this._invKeySchedule,c,d,h,u,a),i=e[t+1],e[t+1]=e[t+3],e[t+3]=i},_doCryptBlock:function(e,t,i,n,a,r,o,s){for(var l=this._nRounds,c=e[t]^i[0],d=e[t+1]^i[1],h=e[t+2]^i[2],u=e[t+3]^i[3],p=4,f=1;l>f;f++){var v=n[c>>>24]^a[d>>>16&255]^r[h>>>8&255]^o[255&u]^i[p++],g=n[d>>>24]^a[h>>>16&255]^r[u>>>8&255]^o[255&c]^i[p++],m=n[h>>>24]^a[u>>>16&255]^r[c>>>8&255]^o[255&d]^i[p++],w=n[u>>>24]^a[c>>>16&255]^r[d>>>8&255]^o[255&h]^i[p++];c=v,d=g,h=m,u=w}v=(s[c>>>24]<<24|s[d>>>16&255]<<16|s[h>>>8&255]<<8|s[255&u])^i[p++],g=(s[d>>>24]<<24|s[h>>>16&255]<<16|s[u>>>8&255]<<8|s[255&c])^i[p++],m=(s[h>>>24]<<24|s[u>>>16&255]<<16|s[c>>>8&255]<<8|s[255&d])^i[p++],w=(s[u>>>24]<<24|s[c>>>16&255]<<16|s[d>>>8&255]<<8|s[255&h])^i[p++],e[t]=v,e[t+1]=g,e[t+2]=m,e[t+3]=w},keySize:8});e.AES=t._createHelper(f)}(),define("thirdparty/crypto-js/CryptoEpubCustom.min",function(){}),define("_e/crypter/CrypterAES",["require","thirdparty/crypto-js/CryptoEpubCustom.min"],function(e){function t(e,t){function i(e){return{key:CryptoJS.enc.Utf8.parse(e.key),AEScfg:{iv:CryptoJS.enc.Utf8.parse(e.iv),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}}}var n={key:"1111111111111111",iv:"0000000000000000",mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7,encryptedFormat:"Hex",decryptedFormat:"Utf8"};this.currentCfg=i(n),this.keyHandler=t||function(e){return(""+e).slice(0,16).padEnd(16)},this.encrypt=function(e){return this.AES_Encrypt(e,this.currentCfg)},this.decrypt=function(e){return this.AES_Decrypt(e||"",this.currentCfg)},e&&this.updateKey(e)}return e("thirdparty/crypto-js/CryptoEpubCustom.min"),t.prototype={updateKeyHandler:function(e){this.keyHandler=e},updateKey:function(e){e=this.keyHandler(e),this._key=e,this.currentCfg.key=CryptoJS.enc.Utf8.parse(e)},getKey:function(){return this._key},AES_Encrypt:function(e,t){var i=e;"string"!=typeof i&&(i=JSON.stringify(i));var n=CryptoJS.enc.Utf8.parse(i),a=CryptoJS.AES.encrypt(n,t.key,t.AEScfg),r=a.ciphertext.toString().toUpperCase();return r},AES_Decrypt:function(e,t){var i=CryptoJS.enc.Hex.parse(e),n=CryptoJS.enc.Base64.stringify(i),a=CryptoJS.AES.decrypt(n,t.key,t.AEScfg),r=a.toString(CryptoJS.enc.Utf8);try{r=JSON.parse(r)}catch(o){}return r}},t}),function(e){var t=window.DB={};t.OptionBase={},t.Sync={},t.DBObject={},t.Utils={},t.DB=t,t.Logs={},t.Debug=!1,t.instants={},t.Cache={},t.config={errorcallback:function(e){setTimeout(function(){e.msg&&(void 0!=typeof interaction_view?(interaction_view.errorAlert(e.msg),interaction_view.queue.clear()):global.message("error",e.msg))},300)}};var i=t.DBObject=function(e){var i=this;i.baseUrl="/v2/api",i.className=e,t.instants[e]=i};i.prototype={extend:function(e){return d.extend(this,e,!0)},saveTable:function(e,t,i){var n=this;void 0==e&&(e=!0),
n.post(n.baseUrl+"/tables/",e?JSON.stringify(n):n,t,i)},getTableObject:function(e){var t=this,n=new i(e);return t.options(t.baseUrl+"/tables/"+e+"/",{},function(e,t){"200"==e.code&&d.extend(n,e.data.results,!1)},function(e){n=null},!1),n},convert2Table:function(e){var i=new t.DBObject(e.className);return d.extend(i,e,!1),i},getTableFields:function(e,t,i){var n=this;n.options(n.baseUrl+"/tables/"+e+"/",{},t,i)},updateTable:function(e,t,i,n,a){var r=this;void 0==e&&(e=!0),r.put(r.baseUrl+"/tables/"+t+"/",e?JSON.stringify(i):i,n,a)},deleteTable:function(e,t,i){var n=this;n["delete"](n.baseUrl+"/tables/"+e+"/",{},t,i)},getTableRules:function(e){var t=this,i={};return t.get(t.baseUrl+"/tables/"+e+"/info/",{tableId:e,data:"info"},function(e,t){if(e){var n=e.data.results[0].user_info,a=e.data.results[0].table_rule;d.extend(i,n,!1),d.extend(i,a,!1)}},function(){i={}},!1),i},flushRecord:function(e,t,i,n,a){var r=this;r.post(r.baseUrl+"/tables/"+t+"/objects/",e?JSON.stringify(i):i,n)},updateRecord:function(e,i,n,a,r,o,s){var l=this;n?l.put(l.baseUrl+"/tables/"+i+"/objects/"+n+"/"+(r.data?"?data="+encodeURI(r.data):""),e?JSON.stringify(a):a,o):t.config.errorcallback()},deleteRecord:function(e,t,i,n){var a=this;a["delete"](a.baseUrl+"/tables/"+e+"/objects/"+t+"/",{},i)},deleteRecords:function(e,t,i,n){var a=this;a["delete"](a.baseUrl+"/tables/"+e+"/objects/",{ids:t},i,n)},saveOrUpdateRecord:function(e,t,i,n,a){var r=this;r.post(r.baseUrl+"/tables/"+t+"/objects/",e?JSON.stringify(i):i,n,a)}};var n=t.DBConfig=function(e){this.hit=e||0,this.start=0};n.prototype={setStart:function(e){var t=this;return this.start=e,t},setPage:function(e){var t=this;return t.start=t.hit*e,t},getPage:function(){return this.start/this.hit},nextPage:function(){var e=this;return e.start+=e.hit,e},prevPage:function(){var e=this;return e.start-=e.hit,e.start<0&&(e.start=0),e},setCount:function(e){var t=this;return t.hit=e,this},getCount:function(){return this.hit}};var a=t.DBAggregate=function(e){d.setOpt(this,"group_key",e)};a.prototype={sum:function(e){var t=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==t?"sum("+e+")":t+"#sum("+e+")"),this},max:function(e){var t=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==t?"max("+e+")":t+"#max("+e+")"),this},min:function(e){var t=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==t?"min("+e+")":t+"#min("+e+")"),this},random:function(e){var t=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==t?"random("+e+")":t+"#random("+e+")"),this},count:function(){var e=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==e?"count()":e+"#count()"),this},setRange:function(e,t){return d.setOpt(this,"range",e+"~"+t),this},setFilter:function(e){return d.setOpt(this,"agg_filter",e),this},setSamplerThreshold:function(e,t){return d.setOpt(this,"agg_sampler_threshold",e),d.setOpt(this,"agg_sampler_step",t),this},setMaxGroup:function(e){return d.setOpt(this,"max_group",e),this}};var r=t.DBLimit=function(){};r.prototype={equalTo:function(e,t){return t?(d.setOpt(this,"key",e),d.setOpt(this,"value",t),this):this},and:function(e){var t={opt:"AND",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new r;return i.statement=t,i},or:function(e){var t={opt:"OR",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new r;return i.statement=t,i},and_not:function(e){var t={opt:"ANDNOT",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new r;return i.statement=t,i},rank:function(e){var t={opt:"RANK",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new r;return i.statement=t,i}};var o=t.DBFilter=function(e){if(e&&e.key){var t=this.analysz(e.value);this.key=e.key,d.extend(this,t,!1)}};o.prototype={analysz:function(e){var t={option:"=",value:""};e+="";var i=d.trim(e,"g"),n=["<","<=",">",">=","=","!=","in","notin"],a=0;return i&&(d.each(n,function(e){0==i.indexOf(e)&&(a=1,t.option=e,t.value=i.substr(e.length))}),0==a&&(t.option="=",t.value=e)),t},and:function(e){var t={opt:"AND",values:[]},i=this;t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var n=0;if(d.each(t.values,function(e){e.value&&(n=1)}),0==n)return i;var a=new o;return a.statement=t,a},or:function(e){var t={opt:"OR",values:[]},i=this;t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var n=0;if(d.each(t.values,function(e){e.value&&(n=1)}),0==n)return i;var a=new o;return a.statement=t,a},and_not:function(e){var t={opt:"ANDNOT",values:[]},i=this;t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var n=0;if(d.each(t.values,function(e){e.value&&(n=1)}),0==n)return i;var a=new o;return a.statement=t,a},equalTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","="),this},notEqualTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","!="),this},lessThan:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","<"),this},lessThanOrEqualTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","<="),this},greaterThan:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option",">"),this},greaterThanOrEqualTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option",">="),this}};var s=t.DBQuery=function(){var e=this;e.aggregate=[],e.baseUrl="/v2/api"};s.prototype={addAggregate:function(e){var t=this;return e&&t.aggregate.push(e),this},addLimit:function(e){var t=this;return e&&e&&(t.query=e),this},addFilter:function(e){var t=this;return e&&(t.filter=e),this},addSort:function(e,t){if(!e||!t)return this;this.sort||(this.sort=[]);var i="ASC"==t.toUpperCase()?"+":"-";return this.sort.push(i+e),this},addConfig:function(e){var t=this;return e&&(t.config=e),this},addSQL:function(e){var t=this;return t.execSQL=e,t},addFields:function(e){var t=this;return t.fetch_fields||(t.fetch_fields=[]),d.isArray(e)&&d.each(e,function(e){t.fetch_fields.push(e)}),t},addScope:function(e){var t=this;return t.scope=e,t},addJoin:function(e,t,i){var n=this;return n.join||(n.join={}),n.join={table_id:e,join_field:t,fetch_fields:i},n},Query:function(e,t,i,n,a,r){var o=this,s={};t||(t=1),i||(i=20),s=d.clone(o,s),r&&d.isObject(r)&&null!=r.start&&void 0!=r.start&&(s.config||(s.config={}),s.config.start=r.start,s.config.hit=1);var l,c=o.baseUrl+"/tables/"+e,h={data:JSON.stringify(s),tableId:e};r.id&&null!=r.id&&void 0!=r.id?(l=c+"/objects/"+r.id+"/",h.id=r.id):r.israndom?l=c+"/objects/random/":r.random?(l=c+"/objects/",h=Object.assign(h,{random:r.random,random_size:i})):(l=c+"/objects/",h=Object.assign(h,{page:t,size:i})),o.send("get",l,h,n,a)},JSON2Str:function(e){return e?e+"/data/?data="+encodeURIComponent(JSON.stringify(this))+"&page=1&size=20":null}};var l=t.Sync=function(){};l.prototype={send:function(i,n,a,r,o,s){var l,c,d=a.tableId,h=!1;if(delete a.tableId,a.id&&(l=a.id,delete a.id),a&&"info"==a.data&&(h=!0,delete a.data),null!=i&&(i=i.toUpperCase()),n){if(void 0==s&&(s=!0),"POST"!=i&&"PUT"!=i&&"GET"!=i&&"DELETE"!=i&&"OPTIONS"!=i)return void console.log("对不起,请求的方法不正确!");if(t.Debug){var u=t.Utils.uuid(2),p=n+" ("+i+")";t.Utils.log(u,p,a)}"GET"==i&&(c=t.Cache.check&&t.Cache.check(d,a,l,h)),c&&c.v?(r&&r(c.v),t.Debug&&t.Utils.log(u," Success(from cache)",c.v,!0)):c&&c.state?t.Cache.addToStack({dbid:d,sendData:a,singleId:l,datainfo:h},r,o):e.ajax({type:i,url:n,data:a,async:s,contentType:"application/json",xhrFields:{withCredentials:!0},dataType:"json",crossDomain:!0,beforeSend:function(){t.Cache.changeState(d,a,l,h,!0)},success:function(e,n,o){"GET"!=i||_.isEmpty(t.Cache.switches)||(t.Cache.add(d,a,e,l,h),t.Cache.execStack(d,a,e,l,h),t.Cache.changeState(d,a,l,h,!1)),200==e.code?r&&r(e,o):t.config.errorcallback(e,o),t.Debug&&t.Utils.log(u," Success",e,!0)},error:function(e,n,r){t.config.errorcallback(e,r),t.Debug&&t.Utils.log(u," Fail",e,!0),"GET"!=i||_.isEmpty(t.Cache.switches)||(t.Cache.execStack(d,a,e,l,h),t.Cache.changeState(d,a,l,h,!1))}})}},post:function(e,t,i,n){this.send("POST",e,t,i)},get:function(e,t,i,n,a){this.send("GET",e,t,i,n,a)},put:function(e,t,i,n,a){this.send("PUT",e,t,i,n)},"delete":function(e,t,i,n){this.send("delete",e,t,i)},options:function(e,t,i,n,a){this.send("options",e,t,i,n)}};var c=t.OptionBase=function(){};c.prototype={addField:function(e){var t=this;return t.fields||(t.fields=[]),null!=e&&(d.isObject(e)&&t.fields.push(e),d.isArray(e)&&d.each(e,function(e){t.fields.push(e)})),this},addTitle:function(e){return d.setOpt(this,"title",e),this},addStartDate:function(e){return d.setOpt(this,"startTime",e),this},addEndDate:function(e){return d.setOpt(this,"endTime",e),this},addRule:function(e){return d.setOpt(this,"rule",e),this},addShowWeixinInfo:function(e){return d.setOpt(this,"show_weixin_info",e),this},addShowContactInfo:function(e){return d.setOpt(this,"show_contact_info",e),this},addOpt:function(e,t){return d.setOpt(this,e,t),this},addAppId:function(e){return d.setOpt(this,"app_id",e),this},updateField:function(e,t,i){var n=this,a=n.fields;return d.each(a,function(n){n.cid==e&&(n[t]=i)}),this},getField:function(e,t){var i;return d.each(this.fields,function(n){return n[e]==t?(i=n,!1):void 0}),i},getFields:function(){return this.fields},removeField:function(e,t){var i=this,n=i.fields;return d.each(n,function(i,a){return i[e]==t?(n.splice(a,1),!1):void 0}),i},removeAll:function(){this.fields=[]}};var d=t.Utils={trim:function(e,t){var i;return d.isString(e)?(i=e.replace(/(^\s+)|(\s+$)/g,""),"g"==t.toLowerCase()&&(i=i.replace(/\s/g,""))):i=e,i},each:function(e,t,i){if(null!=e)if(e.length===+e.length){for(var n=0,a=e.length;a>n;n++)if(t.call(i,e[n],n,e)===!1)return!1}else for(var r in e)if(e.hasOwnProperty(r)&&t.call(i,e[r],r,e)===!1)return!1},setOpt:function(e,t,i){var n={};d.isString(t)?n[t]=i:n=t,d.extend(e,n,!1)},getOpt:function(e,t){return e[t]},contains:function(e,t){for(var i=e.length;i--;)if(e[i]===t)return!0;return!1},clone:function(e,t){var i;t=t||{};for(var n in e)e.hasOwnProperty(n)&&(i=e[n],"object"==typeof i?(t[n]=d.isArray(i)?[]:{},d.clone(e[n],t[n])):t[n]=i);return t},inherits:function(e,t){var i=e.prototype,n=d.makeInstance(t.prototype);return d.extend(n,i,!0),e.prototype=n,n.constructor=e},extend:function(e,t,i){if(t)for(var n in t)i&&e.hasOwnProperty(n)||(e[n]=t[n]);return e},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},delArray:function(e,t){return 0>t?this:e.slice(0,t).concat(e.slice(t+1,e.length))},uuid:function(e){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}if(e){for(var i="";e--;)i+=t();return i}return t()+t()+t()+t()+t()+t()+t()+t()},log:function(e,i,n,a){if(e||(e=String((new Date).getTime())),i||(i="request"),"object"==typeof n&&(n=JSON.stringify(n)),t.Debug)if(a){var r='<span style="margin-left:10px">'+(new Date).toLocaleTimeString()+i+"</span> <pre>"+n+"</pre>";t.Logs[e]&&(t.Logs[e].res=r)}else{var r=(new Date).toLocaleTimeString()+"</br/>"+i+" <pre>"+n+"</pre>";t.Logs[e]={},t.Logs[e].req=r}}};d.each(["String","Function","Array","Number","RegExp","Object","Date"],function(e){t.Utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});t.Cache={cache:{},switches:{},stack:{},add:function(e,t,i,n,a){if(200==i.code){t=a?"info":this._parseData(t);var r=this.cache;t&&(r[e]||(r[e]={}),void 0!=n?(r[e].singleData||(r[e].singleData={}),r[e].singleData[n]||(r[e].singleData[n]={}),r[e].singleData[n][t]||(r[e].singleData[n][t]={}),r[e].singleData[n][t].v=i):(r[e][t]||(r[e][t]={}),r[e][t].v=i))}},addSwitch:function(e){this.switches[e]||(this.switches[e]="open")},check:function(e,i,n,a){var r;if(r=a?"info":this._parseData(i),this.cache[e]&&r&&!_.isEmpty(t.Cache.switches)){var o=this.cache[e];if(void 0!=n){if(o.singleData&&o.singleData[n]){var s=o.singleData[n][r];if(s)return{v:s.v,state:s.onCom}}}else if(o[r])return{v:o[r].v,state:o[r].onCom}}return!1},_parseData:function(e){function t(e){if(e){var t="string"==typeof e?JSON.parse(e):e,i=t.aggregate&&t.aggregate[0];if(i&&i.agg_fun&&-1!=i.agg_fun.indexOf("random"))return!0}return!1}var i="";return e&&e.data?t(e.data)||e.random?"":(void 0!=e.data&&(i="data="+e.data),void 0!=e.page&&(i+="&page="+e.page),void 0!=e.size&&(i+="&size="+e.size),i):"info"},clear:function(){this.cache&&(this.cache={})},closeSwitch:function(e){this.switches[e]&&(this.switches[e]="close");var t=_.find(this.switches,function(e){return"open"==e});t||(this.cache={},this.switches={})},close:function(e){var t=this.cache;t&&t[e]&&t[e].open&&(t[e].open=!1)},changeState:function(e,t,i,n,a){var r;if(r=n?"info":this._parseData(t),this.cache[e]||(this.cache[e]={}),r){var o=this.cache[e];void 0!=i?(o.singleData||(o.singleData={}),o.singleData[i]||(o.singleData[i]={}),o.singleData[i][r]||(o.singleData[i][r]={}),o.singleData[i][r].onCom=a):(o[r]||(o[r]={}),o[r].onCom=a)}},addToStack:function(e,t,i){var n,a=e.singleId;if(n=e.datainfo?"info":this._parseData(e.sendData)){this.stack[e.dbid]||(this.stack[e.dbid]={});var r=this.stack[e.dbid];void 0!=a?(r.singleData||(r.singleData={}),r.singleData[a]||(r.singleData[a]={}),r.singleData[a][n]||(r.singleData[a][n]=[]),r.singleData[a][n].push({success:t,error:i})):(r[n]||(r[n]=[]),r[n].push({success:t,error:i}))}},execStack:function(e,t,i,n,a){var r={dbid:e,key:t,data:i,singleId:n,datainfo:a};200!=i.code?this.searchStack(r,!1):this.searchStack(r,!0)},searchStack:function(e,t){if(e.datainfo)var i="info";else var i=this._parseData(e.key);var n,a=this.stack,r=e.dbid,o=e.singleId;i&&a[r]&&(void 0!=o?a[r].singleData&&a[r].singleData[o]&&(n=a[r].singleData[o][i],delete a[r].singleData[o][i]):a[r][i]&&(n=a[r][i],delete a[r][i]),n&&this.exec(n,t,e.data))},exec:function(e,t,i){for(var n=0;n<e.length;n++)t?e[n].success&&e[n].success(i):e[n].error&&e[n].error(i)}};d.inherits(i,c),d.inherits(i,l),d.inherits(i,s),d.inherits(s,l)}(window.jQuery),define("thirdparty/dataEngine/dataEngine",["jquery"],function(){}),define("_e/crypter/dbCryptHandler",["require","./CrypterAES","thirdparty/dataEngine/dataEngine"],function(e){function t(e,t,i,o,c,d){var u=i,p=o||h;if(r||s(),a){["POST","PUT"].includes(e.toUpperCase())&&(u=JSON.stringify({encryptdata:n.encrypt(u)}));var p=function(e,t,i){try{var a=e.data.encryptdata,r="";a&&(r=n.decrypt(a),""!==r&&(e.data=r))}catch(s){e_api.console.log("解码出错:"+s)}o(e,t,i)}}else e_api.console.log("weixin_config 出错：无法获取key");l._send.call(this,e,t,u,p,c,d)}var i=e("./CrypterAES");e("thirdparty/dataEngine/dataEngine");var n=new i;window.dbCrypter=n,n.updateKeyHandler(function(e){var t=Array(16).fill(" ").join("");return(""+e+t).slice(0,16)});var a=!1,r=!1,o="",s=function(){r=!0,o=window.wx_config&&window.wx_config.nonceStr,o&&(n.updateKey(o),a=!0)};window.weixin_config_ready&&s();var l=window.DB.Sync.prototype,c=window.DB.DBObject.prototype,d=window.DB.DBQuery.prototype;l._send=l.send,l.send=c.send=d.send=t;var h=function(){}}),define("_e/dboperate",["require","./crypter/dbCryptHandler"],function(e){e("./crypter/dbCryptHandler"),window.dboperate=function(e){this.defaults={db_id:"",query:[],fields:[]},this.options=e,this.options=$.extend(!0,{},this.defaults,"object"==typeof e&&e)},window.dboperate.prototype={init:function(e){var t=this.options.operation,i=this.options.datalistid,n=this.options.db_select;if(null!=i){if(this.options.datalistid=i.match(/\$[^\$]+\$/g)[0],this.db_id=this.options.datalistid.split(".")[0].split("$d_")[1],0==interaction_view.dblist.length||_.isUndefined(interaction_view.dblist.get(this.db_id)))return console.log("数据表组件 "+this.db_id+" 不存在"),void(e&&e(""));this.tableid=interaction_view.dblist.get(this.db_id).attributes.sheet_id,this.queryid=this.options.datalistid.split(".")[1].split("$")[0],this.db=new DB.DBObject(this.tableid),_.bindAll(this),"add"==t?this.addValue(e):"del"==t||"upd"==t?this.changeValue(t,e):"ref"==t||("req"==t?this.requestValue(e):this.requestRank(e))}null!=n&&"query"==t&&this.queryText(this.options,e),"cacheload"==t&&this.loadCachelist(e)},query:function(){var e=this;epub360.dbs={};for(var t=0;t<interaction_view.dblist.models.length;t++){var i=interaction_view.dblist.models[t],n=i.get("querys"),a=i.get("sheet_id"),r=i.get("id");DB.Utils.setOpt(epub360.dbs,r,{}),epub360.dbs[r].query={};for(var o=0;o<n.length;o++)"1"==n[o].type&&n[o].autoload&&e.uploadQuery({value:n[o],table_id:a,db_id:r,type:n[o].type,cache:!0})}},uploadQuery:function(e,t){e||(e={});var i=e.value,n=e.table_id,a=e.db_id;if(!i)return void(t&&t([]));var r=i.id,o=this,s=new DB.DBQuery;if(e.page||(e.page=""),e.size||(e.size=""),i.random&&(e.random=1),e.type)var l=e.type;e.israndom||(e.israndom=!1),s=this.formatQuery(i,s,e),s.Query(n,e.page,e.size,function(i){var n=i.data.results;if(e.cache&&(_.isUndefined(epub360.dbs[a].query[r])&&DB.Utils.setOpt(epub360.dbs[a].query,r,{}),o.queryValue(epub360.dbs[a].query[r],n),l&&(epub360.dbs[a].query[r].type=l)),e.getcache)return e.isfind=!0,void o.getCache(e,t,r);if(t){var s=o.getSpecial(e.option,i,e.field,e.join,e.israndom);t(s)}},function(e){t&&t(e)},{start:e.start,id:e.id,israndom:e.israndom,random:e.random})},formatQuery:function(e,t,i){var n,a=interaction_view.expression.id2values(e.filter[0].value,function(e){return e},{}),r=interaction_view.expression.id2values(e.filter[1].value,function(e){return e},{}),o=new DB.DBFilter({key:e.filter[0].key,value:a}),s=new DB.DBFilter({key:e.filter[1].key,value:r});if(i||(i={}),e.fetch_fields&&t.addFields(e.fetch_fields),e.sorts)for(var l in e.sorts){var c=e.sorts[l];t.addSort(c.field,1==c.order?"ASC":"DESC")}else e.sort&&t.addSort(e.sort.field,1==e.sort.order?"ASC":"DESC");if(e.scope&&t.addScope(e.scope),e.op&&(n="0"==e.op?o.and(s):o.or(s)),t.addFilter(n),i.query){try{i.query.query.value=interaction_view.expression.id2values(i.query.query.value)}catch(d){}var h=new DB.DBLimit;h.equalTo(i.query.query.key,i.query.query.value),t.addLimit(h)}if(i&&i.agg&&t.addAggregate(i.agg),e.join_table&&"undefined"!=e.join&&e.join.data_list&&interaction_view.dblist&&interaction_view.dblist.get(e.join.data_list)){var u=interaction_view.dblist.get(e.join.data_list).get("sheet_id");u&&e.join.join_field&&0!=e.join.fetch_fields.length&&t.addJoin(u,e.join.join_field,e.join.fetch_fields)}return t},queryValue:function(e,t){var i=Backbone.Model.extend({}),n=Backbone.Collection.extend({model:i});_.isUndefined(e.list)?e.list=new n:e.list.reset(),e.list.add(t)},getqueryValue:function(e,t,i,n,a,r){var o,s;if(r||(r={}),0==interaction_view.dblist.length||!interaction_view.dblist.get(e))return console.log("数据表组件 "+e+" 不存在"),void(a&&a(""));this.size=n;for(var l=interaction_view.dblist.get(e).get("sheet_id"),c=0;c<interaction_view.dblist.get(e).get("querys").length;c++){var d=interaction_view.dblist.get(e).get("querys")[c];t==d.id&&(o=d)}s={value:o,table_id:l,db_id:e,page:i,size:n,query:r},"0"==o.type&&this.uploadQuery(s,a),"1"==o.type&&(s.cache=!0,this.getCache(s,a,t))},getCache:function(e,t,i){var n=e.page,a=e.size,r=epub360.dbs[e.db_id].query[i];if(!_.isUndefined(r)&&r.list&&r.list.at((n-1)*a))if(r.list.at(n*a-1)||!r.list.at(n*a-1)&&e.isfind){for(var o=[],s=0;a>s;s++)o.push(r.list.at((n-1)*a+s)?r.list.at((n-1)*a+s).attributes:"");t&&t(o)}else e.getcache=!0,this.uploadQuery(e,t);else e.getcache=!0,this.uploadQuery(e,t)},getSpecial:function(e,t,i,n,a){var r;if(e){if(("MAX"==e||"MIN"==e||"SUM"==e||"RANDOM"==e&&!a)&&t.data.facet[0])switch(e){case"MAX":r=_.isUndefined(t.data.facet[0].items[0])?NaN:t.data.facet[0].items[0].max;break;case"MIN":r=_.isUndefined(t.data.facet[0].items[0])?NaN:t.data.facet[0].items[0].min;break;case"SUM":r=_.isUndefined(t.data.facet[0].items[0])?NaN:t.data.facet[0].items[0].sum;break;case"RANDOM":r=_.isUndefined(t.data.facet[0].items[0])?NaN:t.data.facet[0].items[0].random}if("COUNT"===e&&(r=_.isUndefined(t.data.sum)?NaN:t.data.sum),-1!==e.indexOf("LINENUMBER")||-1!==e.indexOf("ID"))if(_.isUndefined(t.data.results[0])||_.isNull(t.data.results[0]))r=NaN,0==t.data.sum;else if(n){var o=interaction_view.dblist.get(n.split("|")[0]).attributes.sheet_id;r=t.data.results[0][o+"."+n.split("|")[1]]}else r=t.data.results[0][i];else a&&"RANDOM"==e&&(r=t)}else r=t;return r=_.isUndefined(r)?NaN:r},setFields:function(){for(var e=0;e<interaction_view.dblist.models.length;e++){var t=interaction_view.dblist.models[e],i=t.get("fields"),n=t.get("id");epub360.dbs[n].fields=i}},saveLocal:function(e,t){e=e.replace(/\$/g,"");var i=e.substr(2),n=i.match(this.Regs[0]);if(null!=n)for(var a=0;a<n.length;a++){var r=this.id2value(n[a],function(e){return e});i=i.replace(n[a],r)}i.split(this.Spliter)},addValue:function(e){var t=[],i=this;for(var n in this.options.fields)t.push(n);for(var a=0;a<t.length;a++){var r=t[a],o=interaction_view.expression.id2values(i.options.fields[r],function(e){return e},{});0!==o&&""==o?delete i.options.fields[r]:i.options.fields[r]=o}this.db.flushRecord(!0,this.tableid,this.options.fields,function(t){i.returnData(t),e&&e()})},changeValue:function(e,t){var i,n,a,r=this.options.chooseposition,o=this.options.choosepositionname,s=this,l=[],c=null;if("line"==r)a?i=a.id:c=o-1;else if("random"==r)n=!0;else if(i=o,i=interaction_view.expression.id2values(i,function(e){return e},{}),!i)return;if("del"==e&&this.db.deleteRecord(this.tableid,i,function(){t&&t()}),"upd"==e){for(var d in this.options.fields)l.push(d);for(var h=0;h<l.length;h++){var u=l[h],p=interaction_view.expression.id2values(s.options.fields[u],function(e){return e},{});0!==p&&""==p?delete s.options.fields[u]:s.options.fields[u]=p}if(i||null==c){var f,v={};if(n){for(var h=0;h<interaction_view.dblist.get(s.db_id).get("querys").length;h++){var u=interaction_view.dblist.get(s.db_id).get("querys")[h];if(s.queryid==u.id){f=u;break}}var g=new DB.DBQuery;v.data=JSON.stringify(s.formatQuery(f,g)),i="random"}this.db.updateRecord(!0,this.tableid,i,this.options.fields,v,function(e){s.returnData(e),t&&t()})}else;}},requestValue:function(e){for(var t,i=this.options.choosepositionname,n=this,a=0;a<interaction_view.dblist.get(n.db_id).get("querys").length;a++){var r=interaction_view.dblist.get(n.db_id).get("querys")[a];if(n.queryid==r.id){t=r;break}}if("random"==this.options.chooseposition){var o=new DB.DBAggregate("table_id");o.random("id");var s={value:t,table_id:n.tableid,db_id:n.db_id,israndom:!0,agg:o,option:"RANDOM"}}else var l=interaction_view.expression.id2values(i,function(e){return e},{no_compute:!0}),s={value:t,table_id:n.tableid,db_id:n.db_id,id:l};n.uploadQuery(s,function(t){n.returnData(t),e&&e()})},requestRank:function(e){var t=this,i=function(i){t.returnData(i),e&&e()},n=this.db.baseUrl+"/tables/"+this.tableid+"/rank/",a=this.options.choosepositionname,r=interaction_view.expression.id2values(a,function(e){return e},{no_compute:!0}),o={filter:{statement:{opt:"AND",values:[{key:"id",option:"=",value:r},{}]}}},s={data:JSON.stringify(o)};DB.DBObject.prototype.get(n,s,i,i)},loadCachelist:function(e){for(var t=0;t<interaction_view.dblist.models.length;t++)for(var i=interaction_view.dblist.models[t],n=i.get("querys"),a=i.get("sheet_id"),r=i.get("id"),o=0;o<n.length;o++)_.include(this.options.cachelist,n[o].id)&&this.uploadQuery({value:n[o],table_id:a,db_id:r,type:n[o].type,size:n[o].size,cache:!0},e)},refresh:function(e){for(var t=this,i=interaction_view.dblist.get(t.db_id).get("querys"),n=0;n<i.length;n++){var a=i[n];if(t.queryid==a.id){var r={value:a,table_id:t.tableid,db_id:t.db_id};t.uploadQuery(r,e)}}},returnData:function(e){var t=this,i=e.data.results[0]&&e.data.results[0].id||"";if(t.options.return_data&&"on"==t.options.return_data[0]){var n=t.options.transferid,a=t.options.returnfield;if(n&&interaction_view.expression.transferId(n,i),t.options.rankno&&(a||(a={}),a.rankno=t.options.rankno),a)for(var r in a)interaction_view.expression.setAssignment(a[r],r,e.data)}},queryText:function(e,t){var i=(e.db_select,e.bind_item),n=e.bind_item_type,a=e.bind_page_id,r=e.field_item,o=e.express_id,s=e.db_db_id,l=e.db_query_id;_.find(interaction_view.dblist.models,function(e){return e.attributes.id==s});if(i){var c=null;switch(n){case"page":c=interaction_view.ipagelist.getPage(a);break;case"master":c=interaction_view.imasterlist.models[0];break;case"background":c=interaction_view.ibackgroundlist.models[0]}var d=c.iOverlaylist.get(i);return d.iview.renderQuery(s,l,{key:r,value:o},function(){t&&t()}),void(d.attributes.iDetail.query={key:r,value:o})}t&&t()}}}),function(e){e.connector={dragcontroller:function(e,t,i,n){if(e.data("dragArgs"))var a=e.data("dragArgs");else{var a=new connector.controller({dom:e,funcs:i});e.data("dragArgs",a)}a.handle(t,n)},getDragArgs:function(e){for(var t={0:{funcs:[],start:0,end:0,range:0,_current:0,_delta:0},1:{funcs:[],start:0,end:0,range:0,_current:0,_delta:0}},i=0;i<e.length;i++){var n=(1==e[i].axis||3==e[i].axis)&&1||0;t[n].funcs.push(e[i])}return t},clearDragController:function(e){var t=e.data("dragArgs");t&&t.clear()},removeDragController:function(e){e.removeClass("is_exceededY").removeClass("is_exceededX"),e.data("dragArgs",null),e.data("dragfuncs",null)}},connector.controller=function(e){if(this.options={dom:null,funcs:null},"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.init()},connector.controller.prototype.init=function(){this.args=connector.getDragArgs(this.options.funcs),this.dom=this.options.dom},connector.controller.prototype.handle=function(t,i){var n=this.args,a={0:0,1:0};if("dragend"!=t.type){this.inertiaTimer&&e.clearInterval(this.inertiaTimer);var r=1===i?"Y":"X";a[i]=t.gesture["delta"+r];for(var o={0:{max:0,min:0},1:{max:0,min:0}},s=0;s<n[i].funcs.length;s++){var l=n[i].funcs[s].func(t,a[i]);l&&0>l&&o[i].min>l&&(o[i].min=l),l&&l>0&&o[i].max<l&&(o[i].max=l)}i&&o[i].min<-30&&this.dom.attr("data-up")?this.dom.addClass("is_exceededY"):i&&o[i].max>30&&this.dom.attr("data-down")?this.dom.addClass("is_exceededY"):!i&&o[i].min<-30&&this.dom.attr("data-left")?this.dom.addClass("is_exceededX"):!i&&o[i].max>30&&this.dom.attr("data-right")&&this.dom.addClass("is_exceededX")}else{for(j=0;j<2;j++)for(var s=0;s<n[j].funcs.length;s++)n[j].funcs[s].func(t);this.inertia(t)}},connector.controller.prototype.clear=function(){this.inertiaTimer&&e.clearInterval(this.inertiaTimer),this.dom.removeClass("is_exceededY").removeClass("is_exceededX")},connector.controller.prototype.inertia=function(t){var i=3*t.gesture.velocityX,n=3*t.gesture.velocityY,a=this,r=this.args,o=0;this.inertiaTimer&&e.clearInterval(this.inertiaTimer),this.inertiaTimer=e.setInterval(function(){var s={0:0,1:0};if(n>0&&(s[1]=t.gesture.deltaY/Math.abs(t.gesture.deltaY)*n),i>0&&(s[0]=t.gesture.deltaX/Math.abs(t.gesture.deltaX)*i),i>0)for(var l=0,c=0;c<r[l].funcs.length;c++)r[l].funcs[c].func(t,s[0],!0);if(n>0)for(var l=1,c=0;c<r[l].funcs.length;c++)r[l].funcs[c].func(t,s[1],!0);n-=1e-5*o*o,i-=1e-5*o*o,0>=i&&0>=n&&e.clearInterval(a.inertiaTimer),o+=1},1)},connector.controller.prototype.excceeded=function(e,t){},connector.controller.prototype.end=function(e,t){}}(window),define("_e/connector",function(){}),function(){window.stategroup=function(e){this.defaults={},this.options=e,this.options=$.extend(!0,{},this.defaults,"object"==typeof e&&e)},window.stategroup.prototype={render:function(){var e=this;if(this.detail=this.options.group?this.options.group.toJSON().iDetail:this.options.toJSON().iDetail,this.els=this.detail.chooseElement,this.getPageOverlay(interaction_view.currentPage,{type:"iOverlaylist"})){var t,i=this.getPageOverlay(interaction_view.currentPage,{type:"iOverlaylist"});this.options.page.isLayer&&(i=i.concat(this.options.page.iOverlaylist.models)),e.ioverlaylist=i,t=_.map(i,function(e){return e.id});for(var n=_.map(this.els,function(e){return e.id}),a=0;a<n.length;a++){var r=_.find(t,function(e){return e==n[a]});_.isUndefined(r)&&(this.els[a]="")}this.els=_.compact(this.els);for(var o=0;o<e.detail.states.length;o++){var s=e.detail.states[o];if(s.element)for(key in s.element)_.include(n,s.element[key].id)||delete s.element[key]}}var l=this.detail.loop?this.detail.loop:!1;l&&(this.repeat=!0),this.els&&this.els.length&&this.changeState()},changeState:function(){var e=this,t=this.detail.states,i=e.getPageOverlay(interaction_view.currentPage,{type:"iActionlist"});if(e.options.page.isLayer&&(i=i.concat(e.options.page.iActionlist.models)),this.detail.autoplay&&!this.options.config){this.duration=0;var n=this.detail.loop?this.detail.loop:!1;if(n)var a=-1;else a=0;this.detail.timeLine=new TimelineMax({repeat:a,paused:!0});var r=1;for(r;r<t.length;){var o=e.parseData(t[r]),s=e.createStateTimeline(i,t[r],!1);s.addLabel("state",0),1==r?(this.detail.timeLine.addLabel("timeInterval"+r,"0"),this.duration+=parseInt(t[r].duration)):t[r-1]&&t[r-1].duration&&(this.detail.timeLine.addLabel("timeInterval"+r,this.duration),this.duration+=parseInt(t[r].duration)),this.stateplay(o,{label:"timeInterval"+r,state:t[r],stateLine:s,stateLabel:"state"}),r++}if(this.repeat){var l=this.getPageOverlay(this.els[0].page_id,{type:"iOverlaylist"});this.options.page.isLayer&&(l=l.concat(this.options.page.iOverlaylist.models)),t=this.addFirstel(l,t);var o=e.parseData(t[0]);this.detail.timeLine.addLabel("timeInterval0",this.duration);var c=e.createStateTimeline(i,t[0],!1);c.addLabel("repeatstate",0),this.stateplay(o,{label:"timeInterval0",state:t[0],stateLine:c,stateLabel:"repeatstate"})}this.detail.timeLine.play()}else if(this.options.config){var d,h=this.options.config,u=h.ope,t=this.options.group.get("iDetail").states;t=this.addFirstel(this.options.page.iOverlaylist.models,t),this.killOverlayTweenmax(this.els),this.detail.timeLine&&this.detail.timeLine.kill();var p=this.detail.currentTargetState?this.detail.currentTargetState:this.detail.currentState;switch(u){case"first":d=t[0];break;case"last":d=t[t.length-1];break;case"pre":this.repeat?(_.isUndefined(p)?_.isUndefined(p)&&(d=t[t.indexOf(p)-1]):d=t[t.indexOf(p)-1],d||(d=t[t.length-1])):_.isUndefined(p)||(d=t[t.indexOf(p)-1]);break;case"next":this.repeat?(d=_.isUndefined(p)?t[1]:t[t.indexOf(p)+1],d||(d=t[0])):d=_.isUndefined(p)?t[1]:t[t.indexOf(p)+1];break;case"to":_.isUndefined(h.startTo)||(d=t[h.startTo])}if(d){this.detail.timeLine=e.createStateTimeline(i,d,!0),this.detail.timeLine.addLabel("timeduration",0);var o=this.parseData(d,!0);this.detail.currentTargetState=d,this.stateplay(o,{state:d,label:"timeduration"}),this.detail.timeLine.play()}}},pause:function(){this.detail.timeLine&&this.detail.timeLine.pause()},continuePlay:function(){this.detail.timeLine&&this.detail.timeLine.resume()},replay:function(){this.detail.timeLine&&this.detail.timeLine.restart()},resetPlay:function(){this.detail.timeLine&&this.detail.timeLine.pause(0)},stateplay:function(e,t){var i=this;if(e&&e.objs&&e.objs.length)for(var n=0;n<e.objs.length;n++){var a={obj:e.objs[n],opt:e,others:t,length:e.objs.length,size:n},r=e.objs[n].wrap.length?e.objs[n].wrap[0]:e.objs[n].element.length?e.objs[n].element[0]:e.objs[n].el[0];if(r){a.css=e.objs[n].css;var o=i.createTween(r,a)}if(e.objs[n].el.length){a.css=$.extend(!0,{},e.objs[n].EL);var s=i.createTween(e.objs[n].el[0],a)}if(e.objs[n].element.length){a.css=e.objs[n].size;var l=i.createTween(e.objs[n].element[0],a)}i.detail.timeLine&&(t.stateLine?(o&&t.stateLine.add(o,t.stateLabel),s&&t.stateLine.add(s,t.stateLabel),l&&t.stateLine.add(l,t.stateLabel),i.detail.timeLine.add(t.stateLine,t.label)):(o&&i.detail.timeLine.add(o,t.label),s&&i.detail.timeLine.add(s,t.label),l&&i.detail.timeLine.add(l,t.label)))}},parseData:function(e,t){var i,a=interaction_view.currentPage;a!=this.els[0].page_id&&(i=interaction_view.imasterlist.models[0].id==this.els[0].page_id?interaction_view.imasterlist.models[0]:interaction_view.ibackgroundlist.models[0]);var r=this.options.page?this.options.page:i?i:a,o=[];for(key in e.element){
var s,l,c={},d={},h={},u=r.iOverlaylist.get(key);if(u){var p=u.iview.$el;if(u.iview.$el.find(".el_wrap")&&(s=u.iview.$el.find(".el_wrap")),"CycleImage"==u.get("iType")&&(s=u.iview.$el.find(".slidecontent")),u.iview.$el.find(".Element")&&(l=u.iview.$el.find(".Element")),e.element[key].iDetail&&(_.isUndefined(e.element[key].iDetail.init_opacity)||(d.opacity=e.element[key].iDetail.init_opacity),_.isUndefined(e.element[key].iDetail.init_rotation)||(c.rotation=isNaN(e.element[key].iDetail.init_rotation)?0:e.element[key].iDetail.init_rotation,c.rotationX=e.element[key].iDetail.rotationX||0,c.rotationY=e.element[key].iDetail.rotationY||0,c.skewX=e.element[key].iDetail.skewX||0,c.skewY=e.element[key].iDetail.skewY||0,c.transformOrigin=(_.isUndefined(e.element[key].iDetail.originX)&&"50"||e.element[key].iDetail.originX)+"% "+(_.isUndefined(e.element[key].iDetail.originY)&&"50"||e.element[key].iDetail.originY)+"% 0px"),e.element[key].iDetail.iStyle&&(c=$.extend(!0,{},c,this.css2json(e.element[key].iDetail.iStyle)),_.isUndefined(c)||(c["border-width"]&&delete c["border-width"],c["border-style"]&&delete c["border-style"],c["border-color"]&&delete c["border-color"],c["border-radius"]&&delete c["border-radius"]),c=this.parseStyle(c))),d.perspective=600,e.element[key].iCommon){if(_.isUndefined(e.element[key].iCommon.iWidth)||(h.width=e.element[key].iCommon.iWidth,h.left=-h.width/2),_.isUndefined(e.element[key].iCommon.iHeight)||(h.height=e.element[key].iCommon.iHeight,h.top=-h.height/2),!_.isUndefined(e.element[key].iCommon.iStartx)){var f=_.isUndefined(e.element[key].iCommon.iWidth)?u.get("iCommon")[iPageDirection].iWidth:e.element[key].iCommon.iWidth;d.x=e.element[key].iCommon.iStartx+f/2}if(!_.isUndefined(e.element[key].iCommon.iStarty)){var v=_.isUndefined(e.element[key].iCommon.iHeight)?u.get("iCommon")[iPageDirection].iHeight:e.element[key].iCommon.iHeight;d.y=e.element[key].iCommon.iStarty+v/2}}if(this.detail.state){if(this.detail.state.css[key])for(k in this.detail.state.css[key])_.isUndefined(c[k])&&("rotation"!=k&&"backgroundColor"!=k&&(c[k]=""),"transformOrigin"==k&&(c[k]="50% 50% 0px"),"backgroundColor"==k&&(c[k]="transparent"));if(this.detail.state.el[key])for(n in this.detail.state.el[key])_.isUndefined(d[n])&&("opacity"==n&&(d[n]=1),t||("x"==n&&(d[n]=u.get("iCommon")[iPageDirection].iWidth/2),"y"==n&&(d[n]=u.get("iCommon")[iPageDirection].iHeight/2)));if(this.detail.state.size[key])for(m in this.detail.state.size[key])_.isUndefined(h[m])&&("width"==m&&(h[m]=u.get("iCommon")[iPageDirection].iWidth),"height"==m&&(h[m]=u.get("iCommon")[iPageDirection].iHeight),"left"==m&&(h[m]=-u.get("iCommon")[iPageDirection].iWidth/2),"top"==m&&(h[m]=-u.get("iCommon")[iPageDirection].iHeight/2))}this.detail.state||(this.detail.state={}),this.detail.state.css||(this.detail.state.css={}),this.detail.state.el||(this.detail.state.el={}),this.detail.state.size||(this.detail.state.size={}),this.detail.state.css[key]=c,this.detail.state.el[key]=d,this.detail.state.size[key]=h,this.options.group?this.options.group.set("iDetail",this.detail):this.options.set("iDetail",this.detail);var g={el:p,wrap:s,element:l,css:c,EL:d,size:h,elementdata:{id:u.id,page_id:u.iPageId,layer_id:u.layer_id}};o.push(g)}}var w={id:e.id,objs:o,delay:e.duration,ease:e.animate,state:e.id};return w},parseStyle:function(e){var t={};for(attr in e){var i=/\b(\w)|\s(\w)/g,n=e[attr];-1!=attr.indexOf("-webkit")&&(attr=attr.substr(1));for(var a=attr.split("-"),r=1;r<a.length;r++)a[r]=a[r].toLowerCase(),a[r]=a[r].replace(i,function(e){return e.toUpperCase()});attr=a.join(""),t[attr]=n}return t},addFirstel:function(e,t){t[0].element={};var i=_.map(e,function(e){return e.id});return _.each(this.els,function(n){if(_.include(i,n.id)){var a=_.find(e,function(e){return e.id==n.id});t[0].element[n.id]={iCommon:a.get("iCommon").landscape,iDetail:{iStyle:a.get("iDetail").iStyle,init_rotation:a.get("iDetail").init_rotation,init_opacity:a.get("iDetail").init_opacity,rotationX:a.get("iDetail").rotationX,rotationY:a.get("iDetail").rotationY,skewX:a.get("iDetail").skewX,skewY:a.get("iDetail").skewY},id:n.id}}}),this.parseData(t[0]),t},css2json:function(e){var t={};if(!e)return t;if("object"==typeof e)for(var i in e)e[i].toLowerCase&&(t[e[i].toLowerCase()]=e[e[i]]);else if("string"==typeof e){e=e.split("; "),e.length&&(e[e.length-1]=e[e.length-1].replace(";",""));for(var i in e){var n=e[i].split(": ");t[n[0].toLowerCase()]=n[1]}}return t},createTween:function(e,t){var i=TweenMax.to(e,t.opt.delay,{css:t.css,ease:animation.prototype.EaseTypes[t.opt.ease],immediateRender:!1,x:t.x,y:t.y,onUpdate:interaction_view.events.onStateGroupUpdate,onUpdateParams:[{overlay_id:t.obj.elementdata.id,page_id:t.obj.elementdata.page_id,layer_id:t.obj.elementdata.layer_id}]});return i},createStateTimeline:function(e,t,i){var n=this,a=new TimelineMax({repeat:0,paused:i,onStart:function(t){_.each(e,function(e){var i=e.get("condition");i==t.id&&"statestart"==e.attributes.iDetail.customType&&e.iview.executeAction(e.iview)})},onComplete:function(t){_.each(e,function(e){var i=e.get("condition");i==t.id&&"stateend"==e.attributes.iDetail.customType&&e.iview.executeAction(e.iview)}),n.detail.currentState=t,n.detail.currentTargetState&&delete n.detail.currentTargetState,n.options.group?n.options.group.set("iDetail",n.detail):n.options.set("iDetail",n.detail)},onStartParams:[t],onCompleteParams:[t]});return a},getPageOverlay:function(e,t){if(e){var i=interaction_view.ipagelist.getPage(e);if(i)var n=i[t.type].models}if(n||(n=[]),interaction_view.imasterlist.length){var a=interaction_view.imasterlist.models[0][t.type].models;n=n.concat(a)}if(interaction_view.ibackgroundlist.length){var r=interaction_view.ibackgroundlist.models[0][t.type].models;n=n.concat(r)}return n},killOverlayTweenmax:function(e){var t=this;_.each(e,function(e){var i=t.getPageOverlay(e.page_id,{type:"iOverlaylist"});t.options.page.isLayer&&(i=i.concat(t.options.page.iOverlaylist.models)),_.each(i,function(t){t.id==e.id&&(TweenMax.killTweensOf(t.iview.$el),t.iview.$el.find(".el_wrap")&&TweenMax.killTweensOf(t.iview.$el.find(".el_wrap")),t.iview.$el.find(".Element")&&TweenMax.killTweensOf(t.iview.$el.find(".Element")))})})}}}(window),define("_e/stategroup",function(){}),function(){var e=1,t={init:function(){_e.orientation.orientationSupport&&window.addEventListener("deviceorientation",_e.orientation.onDeviceOrientation),_e.orientation.deltaX=0,_e.orientation.deltaY=0,_e.orientation.event={},_e.orientation.x=0,_e.orientation.y=0,_e.orientation.z=0,_.extend(_e.orientation.event,Backbone.Events)},orientationSupport:function(){return!!window.DeviceOrientationEvent},onDeviceOrientation:function(){var t,i,n,a;if(null!==event.beta&&null!==event.gamma){this.orientationStatus=1;var r=(event.beta-30||0)/e,o=(event.gamma-30||0)/e,s=window.innerHeight>window.innerWidth;s?(t=o+30,i=r,n=180,a=90):(t=-(r+30),i=o,n=90,a=180),_.each(_e.orientation.orientationEvents,function(e){var r=t,o=i;e.scrollX||(r=0),e.scrollY||(o=0),e.func&&e.func(-r*e.speed,-o*e.speed,n,a)})}_e.orientation.x=event.beta,_e.orientation.y=event.gamma,_e.orientation.z=event.alpha,_e.orientation.event.trigger("orientation",event)},orientationEvents:[]};"undefined"==typeof require?(window._e||(window._e={}),window._e.orientation=t):define("_e/orientation",["jquery"],function(){return window._e||(window._e={}),window._e.orientation=t,window._e.orientation})}(window),function(){var e={support:function(){},init:function(){$(document).on("keydown",function(e){console.log("keydown"+e)}),$(document).on("keyup",function(e){console.log("keyup"+e)}),$(document).on("keypress",function(e){console.log("keypress"+e)})}};"undefined"==typeof require?(window._g||(window._g={}),window._g.keyboard=e):define("_g/keyboard",["_g/base","_g/event"],function(){return window._g.keyboard=e,window._g.keyboard})}(window),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("thirdparty/clipboard/clipboard",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Clipboard=e()}}(function(){return function e(t,i,n){function a(o,s){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(r)return r(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[o]={exports:{}};t[o][0].call(d.exports,function(e){var i=t[o][1][e];return a(i?i:e)},d,d.exports,e,t,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,i){function n(e,t){for(;e&&e.nodeType!==a;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}var a=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}t.exports=n},{}],2:[function(e,t,i){function n(e,t,i,n,r){var o=a.apply(this,arguments);return e.addEventListener(i,o,r),{destroy:function(){e.removeEventListener(i,o,r)}}}function a(e,t,i,n){return function(i){i.delegateTarget=r(i.target,t),i.delegateTarget&&n.call(e,i)}}var r=e("./closest");t.exports=n},{"./closest":1}],3:[function(e,t,i){i.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},i.nodeList=function(e){var t=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===t||"[object HTMLCollection]"===t)&&"length"in e&&(0===e.length||i.node(e[0]))},i.string=function(e){return"string"==typeof e||e instanceof String},i.fn=function(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t}},{}],4:[function(e,t,i){function n(e,t,i){if(!e&&!t&&!i)throw new Error("Missing required arguments");if(!s.string(t))throw new TypeError("Second argument must be a String");if(!s.fn(i))throw new TypeError("Third argument must be a Function");if(s.node(e))return a(e,t,i);if(s.nodeList(e))return r(e,t,i);if(s.string(e))return o(e,t,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function a(e,t,i){return e.addEventListener(t,i),{destroy:function(){e.removeEventListener(t,i)}}}function r(e,t,i){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,i)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,i)})}}}function o(e,t,i){return l(document.body,e,t,i)}var s=e("./is"),l=e("delegate");t.exports=n},{"./is":3,delegate:2}],5:[function(e,t,i){function n(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var i=e.hasAttribute("readonly");i||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),i||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var n=window.getSelection(),a=document.createRange();a.selectNodeContents(e),n.removeAllRanges(),n.addRange(a),t=n.toString()}return t}t.exports=n},{}],6:[function(e,t,i){function n(){}n.prototype={on:function(e,t,i){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){function n(){a.off(e,n),t.apply(i,arguments)}var a=this;return n._=t,this.on(e,n,i)},emit:function(e){var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),n=0,a=i.length;for(n;a>n;n++)i[n].fn.apply(i[n].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),n=i[e],a=[];if(n&&t)for(var r=0,o=n.length;o>r;r++)n[r].fn!==t&&n[r].fn._!==t&&a.push(n[r]);return a.length?i[e]=a:delete i[e],this}},t.exports=n},{}],7:[function(e,t,i){!function(n,a){if("undefined"!=typeof i)a(t,e("select"));else{var r={exports:{}};a(r,n.select),n.clipboardAction=r.exports}}(this,function(e,t){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=i(t),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(){function e(t){n(this,e),this.resolveOptions(t),this.initSelection()}return o(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,a["default"])(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,a["default"])(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==("undefined"==typeof e?"undefined":r(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=s})},{select:5}],8:[function(e,t,i){!function(n,a){if("undefined"!=typeof i)a(t,e("./clipboard-action"),e("tiny-emitter"),e("good-listener"));else{var r={exports:{}};a(r,n.clipboardAction,n.tinyEmitter,n.goodListener),n.clipboard=r.exports}}(this,function(e,t,i,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){var i="data-clipboard-"+e;if(t.hasAttribute(i))return t.getAttribute(i)}var c=a(t),d=a(i),h=a(n),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),f=function(e){function t(e,i){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.resolveOptions(i),n.listenClick(e),n}return s(t,e),p(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===u(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,h["default"])(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new c["default"]({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return l("action",e)}},{key:"defaultTarget",value:function(e){var t=l("target",e);return t?document.querySelector(t):void 0}},{key:"defaultText",value:function(e){return l("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,i=!!document.queryCommandSupported;return t.forEach(function(e){i=i&&!!document.queryCommandSupported(e)}),i}}]),t}(d["default"]);e.exports=f})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)}),function(e,t,i){function n(e,t,i){return e.addEventListener?void e.addEventListener(t,i,!1):void e.attachEvent("on"+t,i)}function a(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return m[e.which]?m[e.which]:w[e.which]?w[e.which]:String.fromCharCode(e.which).toLowerCase()}function r(e,t){return e.sort().join(",")===t.sort().join(",")}function o(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function s(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function l(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function c(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function d(){if(!g){g={};for(var e in m)e>95&&112>e||m.hasOwnProperty(e)&&(g[m[e]]=e)}return g}function h(e,t,i){return i||(i=d()[e]?"keydown":"keypress"),"keypress"==i&&t.length&&(i="keydown"),i}function u(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function p(e,t){var i,n,a,r=[];for(i=u(e),a=0;a<i.length;++a)n=i[a],y[n]&&(n=y[n]),t&&"keypress"!=t&&_[n]&&(n=_[n],r.push("shift")),c(n)&&r.push(n);return t=h(n,r,t),{key:n,modifiers:r,action:t}}function f(e,i){return null===e||e===t?!1:e===i?!0:f(e.parentNode,i)}function v(e){function i(e){e=e||{};var t,i=!1;for(t in y)e[t]?i=!0:y[t]=0;i||(S=!1)}function d(e,t,i,n,a,o){var s,l,d=[],h=i.type;if(!w._callbacks[e])return[];for("keyup"==h&&c(e)&&(t=[e]),s=0;s<w._callbacks[e].length;++s)if(l=w._callbacks[e][s],(n||!l.seq||y[l.seq]==l.level)&&h==l.action&&("keypress"==h&&!i.metaKey&&!i.ctrlKey||r(t,l.modifiers))){var u=!n&&l.combo==a,p=n&&l.seq==n&&l.level==o;(u||p)&&w._callbacks[e].splice(s,1),d.push(l)}return d}function h(e,t,i,n){w.stopCallback(t,t.target||t.srcElement,i,n)||e(t,i)===!1&&(s(t),l(t))}function u(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=a(e);if(t)return"keyup"==e.type&&b===t?void(b=!1):void w.handleKey(t,o(e),e)}function f(){clearTimeout(_),_=setTimeout(i,1e3)}function g(e,t,n,r){function o(t){return function(){S=t,++y[e],f()}}function s(t){h(n,t,e),"keyup"!==r&&(b=a(t)),setTimeout(i,10)}y[e]=0;for(var l=0;l<t.length;++l){var c=l+1===t.length,d=c?s:o(r||p(t[l+1]).action);m(t[l],d,r,e,l)}}function m(e,t,i,n,a){w._directMap[e+":"+i]=t,e=e.replace(/\s+/g," ");var r,o=e.split(" ");return o.length>1?void g(e,o,t,i):(r=p(e,i),w._callbacks[r.key]=w._callbacks[r.key]||[],d(r.key,r.modifiers,{type:r.action},n,e,a),void w._callbacks[r.key][n?"unshift":"push"]({callback:t,modifiers:r.modifiers,action:r.action,seq:n,level:a,combo:e}))}var w=this;if(e=e||t,!(w instanceof v))return new v(e);w.target=e,w._callbacks={},w._directMap={};var _,y={},b=!1,x=!1,S=!1;w._handleKey=function(e,t,n){var a,r=d(e,t,n),o={},s=0,l=!1;for(a=0;a<r.length;++a)r[a].seq&&(s=Math.max(s,r[a].level));for(a=0;a<r.length;++a)if(r[a].seq){if(r[a].level!=s)continue;l=!0,o[r[a].seq]=1,h(r[a].callback,n,r[a].combo,r[a].seq)}else l||h(r[a].callback,n,r[a].combo);var u="keypress"==n.type&&x;n.type!=S||c(e)||u||i(o),x=l&&"keydown"==n.type},w._bindMultiple=function(e,t,i){for(var n=0;n<e.length;++n)m(e[n],t,i)},n(e,"keypress",u),n(e,"keydown",u),n(e,"keyup",u)}if(e){for(var g,m={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},w={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},_={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},y={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},b=1;20>b;++b)m[111+b]="f"+b;for(b=0;9>=b;++b)m[b+96]=b.toString();v.prototype.bind=function(e,t,i){var n=this;return e=e instanceof Array?e:[e],n._bindMultiple.call(n,e,t,i),n},v.prototype.unbind=function(e,t){var i=this;return i.bind.call(i,e,function(){},t)},v.prototype.trigger=function(e,t){var i=this;return i._directMap[e+":"+t]&&i._directMap[e+":"+t]({},e),i},v.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},v.prototype.stopCallback=function(e,t){var i=this;return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:f(t,i.target)?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},v.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},v.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(m[t]=e[t]);g=null},v.init=function(){var e=v(t);for(var i in e)"_"!==i.charAt(0)&&(v[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i))},v.init(),e.Mousetrap=v,"undefined"!=typeof module&&module.exports&&(module.exports=v),"function"==typeof define&&define.amd&&define("thirdparty/mousetrap/mousetrap",[],function(){return v})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null),function(){function e(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function t(e,t){return e.x*t.x+e.y*t.y}function i(i,n){var a=e(i)*e(n);if(0===a)return 0;var r=t(i,n)/a;return r>1&&(r=1),Math.acos(r)}function n(e,t){return e.x*t.y-t.x*e.y}function a(e,t){var a=i(e,t);return n(e,t)>0&&(a*=-1),180*a/Math.PI}function r(e,t){var i=new c(e);return i.add(t),i}var o=!1;try{var s=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassive",null,s),window.removeEventListener("testPassive",null,s)}catch(l){}var c=function(e){this.handlers=[],this.el=e};c.prototype.add=function(e){this.handlers.push(e)},c.prototype.del=function(e){e||(this.handlers=[]);for(var t=this.handlers.length;t>=0;t--)this.handlers[t]===e&&this.handlers.splice(t,1)},c.prototype.dispatch=function(){for(var e=0,t=this.handlers.length;t>e;e++){var i=this.handlers[e];"function"==typeof i&&i.apply(this.el,arguments)}};var d=function(e,t){this.element="string"==typeof e?document.querySelector(e):e,this.start=this.start.bind(this),this.move=this.move.bind(this),this.end=this.end.bind(this),this.cancel=this.cancel.bind(this);var i=o?{passive:!1}:!1;this.element.addEventListener("touchstart",this.start,i),this.element.addEventListener("touchmove",this.move,i),this.element.addEventListener("touchend",this.end,i),this.element.addEventListener("touchcancel",this.cancel,i),0==interaction_view.isAndroid&&0==interaction_view.isIos&&(this.mouseStart=this.mouseStart.bind(this),this.mouseMove=this.mouseMove.bind(this),this.mouseEnd=this.mouseEnd.bind(this),this.element.addEventListener("mousedown",this.mouseStart,i)),this.preV={x:null,y:null},this.pinchStartLen=null,this.zoom=1,this.isDoubleTap=!1;var n=function(){};this.rotate=r(this.element,t.rotate||n),this.touchStart=r(this.element,t.touchStart||n),this.multipointStart=r(this.element,t.multipointStart||n),this.multipointEnd=r(this.element,t.multipointEnd||n),this.pinch=r(this.element,t.pinch||n),this.swipe=r(this.element,t.swipe||n),this.tap=r(this.element,t.tap||n),this.doubleTap=r(this.element,t.doubleTap||n),this.longTap=r(this.element,t.longTap||n),this.singleTap=r(this.element,t.singleTap||n),this.pressMove=r(this.element,t.pressMove||n),this.twoFingerPressMove=r(this.element,t.twoFingerPressMove||n),this.touchMove=r(this.element,t.touchMove||n),this.touchEnd=r(this.element,t.touchEnd||n),this.touchCancel=r(this.element,t.touchCancel||n),this._cancelAllHandler=this.cancelAll.bind(this),window.removeEventListener("scroll",this._cancelAllHandler),window.addEventListener("scroll",this._cancelAllHandler),this.delta=null,this.last=null,this.now=null,this.tapTimeout=null,this.singleTapTimeout=null,this.longTapTimeout=null,this.swipeTimeout=null,this.x1=this.x2=this.y1=this.y2=null,this.preTapPosition={x:null,y:null}};d.prototype={mouseStart:function(e){if(!this._preventMouse){var t=o?{passive:!1}:!1;window.addEventListener("mousemove",this.mouseMove,t),window.addEventListener("mouseup",this.mouseEnd,t),e.touches=[e],this.start(e)}},mouseMove:function(e){e.touches=[e],this.move(e)},mouseEnd:function(e){e.changedTouches=[e],e.touches=[],this.end(e),window.removeEventListener("mousemove",this.mouseMove),window.removeEventListener("mouseup",this.mouseEnd)},start:function(t){if(t.touches){this._preventMouse&&1==t.touches.length&&clearTimeout(this.preventMouseTimeout),!this._preventMouse&&/^touch/.test(t.type)&&(this._preventMouse=!0),this.now=Date.now(),this.x1=t.touches[0].pageX,this.y1=t.touches[0].pageY,this.delta=this.now-(this.last||this.now),this.touchStart.dispatch(t,this.element),null!==this.preTapPosition.x&&(this.isDoubleTap=this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now;var i=this.preV,n=t.touches.length;if(n>1){this._cancelLongTap(),this._cancelSingleTap();var a={x:t.touches[1].pageX-this.x1,y:t.touches[1].pageY-this.y1};i.x=a.x,i.y=a.y,this.pinchStartLen=e(i),this.multipointStart.dispatch(t,this.element)}this._preventTap=!1,this.longTapTimeout=setTimeout(function(){this.longTap.dispatch(t,this.element),this._preventTap=!0}.bind(this),750)}},move:function(t){if(t.touches){var i=this.preV,n=t.touches.length,r=t.touches[0].pageX,o=t.touches[0].pageY;if(this.isDoubleTap=!1,n>1){var s=t.touches[1].pageX,l=t.touches[1].pageY,c={x:t.touches[1].pageX-r,y:t.touches[1].pageY-o};null!==i.x&&(this.pinchStartLen>0&&(t.zoom=e(c)/this.pinchStartLen,this.pinch.dispatch(t,this.element)),t.angle=a(c,i),this.rotate.dispatch(t,this.element)),i.x=c.x,i.y=c.y,null!==this.x2&&null!==this.sx2?(t.deltaX=(r-this.x2+s-this.sx2)/2,t.deltaY=(o-this.y2+l-this.sy2)/2):(t.deltaX=0,t.deltaY=0),this.twoFingerPressMove.dispatch(t,this.element),this.sx2=s,this.sy2=l}else null!==this.x2?(t.deltaX=r-this.x2,t.deltaY=o-this.y2):(t.deltaX=0,t.deltaY=0),this.pressMove.dispatch(t,this.element);this.touchMove.dispatch(t,this.element),this._cancelLongTap(),this.x2=r,this.y2=o,n>1&&t.preventDefault()}},end:function(e){if(!e.touches.length&&this._preventMouse&&(this.preventMouseTimeout=setTimeout(function(){this._preventMouse=!1}.bind(this),50)),e.changedTouches){this._cancelLongTap();var t=this;e.touches.length<2&&(this.multipointEnd.dispatch(e,this.element),this.sx2=this.sy2=null),this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.y1-this.y2)>30?(e.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),this.swipeTimeout=setTimeout(function(){t.swipe.dispatch(e,t.element)},0)):(this.tapTimeout=setTimeout(function(){t._preventTap||t.tap.dispatch(e,t.element),t.isDoubleTap&&(t.doubleTap.dispatch(e,t.element),clearTimeout(t.singleTapTimeout),t.isDoubleTap=!1)},0),t.isDoubleTap||(t.singleTapTimeout=setTimeout(function(){t.singleTap.dispatch(e,t.element)},250))),this.touchEnd.dispatch(e,this.element),this.preV.x=0,this.preV.y=0,this.zoom=1,this.pinchStartLen=null,this.x1=this.x2=this.y1=this.y2=null}},cancelAll:function(){this._preventTap=!0,clearTimeout(this.singleTapTimeout),clearTimeout(this.tapTimeout),clearTimeout(this.longTapTimeout),clearTimeout(this.swipeTimeout),this._preventMouse=!1,clearTimeout(this.preventMouseTimeout)},cancel:function(e){this.cancelAll(),this.touchCancel.dispatch(e,this.element)},_cancelLongTap:function(){clearTimeout(this.longTapTimeout)},_cancelSingleTap:function(){clearTimeout(this.singleTapTimeout)},_swipeDirection:function(e,t,i,n){return Math.abs(e-t)>=Math.abs(i-n)?e-t>0?"Left":"Right":i-n>0?"Up":"Down"},on:function(e,t){this[e]&&this[e].add(t)},off:function(e,t){this[e]&&this[e].del(t)},destroy:function(){return this.cancelAll(),this.element.removeEventListener("touchstart",this.start),this.element.removeEventListener("touchmove",this.move),this.element.removeEventListener("touchend",this.end),this.element.removeEventListener("touchcancel",this.cancel),this.element.removeEventListener("mousedown",this.mouseStart),window.removeEventListener("mousemove",this.mouseMove),window.removeEventListener("mouseup",this.mouseEnd),this.rotate.del(),this.touchStart.del(),this.multipointStart.del(),this.multipointEnd.del(),this.pinch.del(),this.swipe.del(),this.tap.del(),this.doubleTap.del(),this.longTap.del(),this.singleTap.del(),this.pressMove.del(),this.twoFingerPressMove.del(),this.touchMove.del(),this.touchEnd.del(),this.touchCancel.del(),this.preV=this.pinchStartLen=this.zoom=this.isDoubleTap=this.delta=this.last=this.now=this.tapTimeout=this.singleTapTimeout=this.longTapTimeout=this.swipeTimeout=this.x1=this.x2=this.y1=this.y2=this.preTapPosition=this.rotate=this.touchStart=this.multipointStart=this.multipointEnd=this.pinch=this.swipe=this.tap=this.doubleTap=this.longTap=this.singleTap=this.pressMove=this.touchMove=this.touchEnd=this.touchCancel=this.twoFingerPressMove=null,window.removeEventListener("scroll",this._cancelAllHandler),this._preventTap=this._preventMouse=null,null}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=d:window.AlloyFinger=d}(),define("thirdparty/AlloyFinger/alloy_finger",function(e){return function(){var t;return t||e.AlloyFinger}}(this)),function(){var e=Date.now,t=function(){this.start()};t.prototype={start:function(){return this._startT||(this._startT=e(),this._deltaP0=0,this._pausedT=null),this},end:function(){return this._startT=this._deltaP0=this._pausedT=null,
this},restart:function(){return this.end().start()},get value(){return e()-this._startT-this._deltaP0-this._deltaP1},get _deltaP1(){return this._pausedT?e()-this._pausedT:0},pause:function(){return this._pausedT||(this._pausedT=e()),this},play:function(){return this._pausedT&&(this._deltaP0+=this._deltaP1,this._pausedT=null),this},forward:function(e){return this._startT-=e||0,this},backward:function(e){return this._startT+=e||0,this},setTo:function(e){return this._startT+=void 0===e?this.value-e:0,this},valueOf:function(){return this.value},toString:function(){return this.value}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=t:window.TimerSensor=t}(),define("thirdparty/TimerSensor/timer_sensor",function(){}),function(){function e(e){return!!e.exifdata}function t(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var i=atob(e),n=i.length,a=new ArrayBuffer(n),r=new Uint8Array(a),o=0;n>o;o++)r[o]=i.charCodeAt(o);return a}function i(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(e){(200==this.status||0===this.status)&&t(this.response)},i.send()}function a(e,n){function a(t){var i=r(t);e.exifdata=i||{};var a=o(t);if(e.iptcdata=a||{},_.isXmpEnabled){var s=f(t);e.xmpdata=s||{}}n&&n.call(e)}if(e.src)if(/^data\:/i.test(e.src)){var s=t(e.src);a(s)}else if(/^blob\:/i.test(e.src)){var l=new FileReader;l.onload=function(e){a(e.target.result)},i(e.src,function(e){l.readAsArrayBuffer(e)})}else{var c=new XMLHttpRequest;c.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";a(c.response),c=null},c.open("GET",e.src,!0),c.responseType="arraybuffer",c.send(null)}else if(self.FileReader&&(e instanceof self.Blob||e instanceof self.File)){var l=new FileReader;l.onload=function(e){m&&console.log("Got file of length "+e.target.result.byteLength),a(e.target.result)},l.readAsArrayBuffer(e)}}function r(e){var t=new DataView(e);if(m&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return m&&console.log("Not a valid JPEG"),!1;for(var i,n=2,a=e.byteLength;a>n;){if(255!=t.getUint8(n))return m&&console.log("Not a valid marker at offset "+n+", found: "+t.getUint8(n)),!1;if(i=t.getUint8(n+1),m&&console.log(i),225==i)return m&&console.log("Found 0xFFE1 marker"),p(t,n+4,t.getUint16(n+2)-2);n+=2+t.getUint16(n+2)}}function o(e){var t=new DataView(e);if(m&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return m&&console.log("Not a valid JPEG"),!1;for(var i=2,n=e.byteLength,a=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};n>i;){if(a(t,i)){var r=t.getUint8(i+7);r%2!==0&&(r+=1),0===r&&(r=4);var o=i+8+r,l=t.getUint16(i+6+r);return s(e,o,l)}i++}}function s(e,t,i){for(var n,a,r,o,s,l=new DataView(e),c={},d=t;t+i>d;)28===l.getUint8(d)&&2===l.getUint8(d+1)&&(o=l.getUint8(d+2),o in T&&(r=l.getInt16(d+3),s=r+5,a=T[o],n=u(l,d+5,r),c.hasOwnProperty(a)?c[a]instanceof Array?c[a].push(n):c[a]=[c[a],n]:c[a]=n)),d++;return c}function l(e,t,i,n,a){var r,o,s,l=e.getUint16(i,!a),d={};for(s=0;l>s;s++)r=i+12*s+2,o=n[e.getUint16(r,!a)],!o&&m&&console.log("Unknown tag: "+e.getUint16(r,!a)),d[o]=c(e,r,t,i,a);return d}function c(e,t,i,n,a){var r,o,s,l,c,d,h=e.getUint16(t+2,!a),p=e.getUint32(t+4,!a),f=e.getUint32(t+8,!a)+i;switch(h){case 1:case 7:if(1==p)return e.getUint8(t+8,!a);for(r=p>4?f:t+8,o=[],l=0;p>l;l++)o[l]=e.getUint8(r+l);return o;case 2:return r=p>4?f:t+8,u(e,r,p-1);case 3:if(1==p)return e.getUint16(t+8,!a);for(r=p>2?f:t+8,o=[],l=0;p>l;l++)o[l]=e.getUint16(r+2*l,!a);return o;case 4:if(1==p)return e.getUint32(t+8,!a);for(o=[],l=0;p>l;l++)o[l]=e.getUint32(f+4*l,!a);return o;case 5:if(1==p)return c=e.getUint32(f,!a),d=e.getUint32(f+4,!a),s=new Number(c/d),s.numerator=c,s.denominator=d,s;for(o=[],l=0;p>l;l++)c=e.getUint32(f+8*l,!a),d=e.getUint32(f+4+8*l,!a),o[l]=new Number(c/d),o[l].numerator=c,o[l].denominator=d;return o;case 9:if(1==p)return e.getInt32(t+8,!a);for(o=[],l=0;p>l;l++)o[l]=e.getInt32(f+4*l,!a);return o;case 10:if(1==p)return e.getInt32(f,!a)/e.getInt32(f+4,!a);for(o=[],l=0;p>l;l++)o[l]=e.getInt32(f+8*l,!a)/e.getInt32(f+4+8*l,!a);return o}}function d(e,t,i){var n=e.getUint16(t,!i);return e.getUint32(t+2+12*n,!i)}function h(e,t,i,n){var a=d(e,t+i,n);if(!a)return{};if(a>e.byteLength)return{};var r=l(e,t,t+a,S,n);if(r.Compression)switch(r.Compression){case 6:if(r.JpegIFOffset&&r.JpegIFByteCount){var o=t+r.JpegIFOffset,s=r.JpegIFByteCount;r.blob=new Blob([new Uint8Array(e.buffer,o,s)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",r.Compression)}else 2==r.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return r}function u(e,t,i){var a="";for(n=t;n<t+i;n++)a+=String.fromCharCode(e.getUint8(n));return a}function p(e,t){if("Exif"!=u(e,t,4))return m&&console.log("Not valid EXIF data! "+u(e,t,4)),!1;var i,n,a,r,o,s=t+6;if(18761==e.getUint16(s))i=!1;else{if(19789!=e.getUint16(s))return m&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;i=!0}if(42!=e.getUint16(s+2,!i))return m&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var c=e.getUint32(s+4,!i);if(8>c)return m&&console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(s+4,!i)),!1;if(n=l(e,s,s+c,b,i),n.ExifIFDPointer){r=l(e,s,s+n.ExifIFDPointer,y,i);for(a in r){switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":r[a]=C[a][r[a]];break;case"ExifVersion":case"FlashpixVersion":r[a]=String.fromCharCode(r[a][0],r[a][1],r[a][2],r[a][3]);break;case"ComponentsConfiguration":r[a]=C.Components[r[a][0]]+C.Components[r[a][1]]+C.Components[r[a][2]]+C.Components[r[a][3]]}n[a]=r[a]}}if(n.GPSInfoIFDPointer){o=l(e,s,s+n.GPSInfoIFDPointer,x,i);for(a in o){switch(a){case"GPSVersionID":o[a]=o[a][0]+"."+o[a][1]+"."+o[a][2]+"."+o[a][3]}n[a]=o[a]}}return n.thumbnail=h(e,s,c,i),n}function f(e){if("DOMParser"in self){var t=new DataView(e);if(m&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return m&&console.log("Not a valid JPEG"),!1;for(var i=2,n=e.byteLength,a=new DOMParser;n-4>i;){if("http"==u(t,i,4)){var r=i-1,o=t.getUint16(i-2)-1,s=u(t,r,o),l=s.indexOf("xmpmeta>")+8;s=s.substring(s.indexOf("<x:xmpmeta"),l);var c=s.indexOf("x:xmpmeta")+10;s=s.slice(0,c)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+s.slice(c);var d=a.parseFromString(s,"text/xml");return g(d)}i++}}}function v(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var i=0;i<e.attributes.length;i++){var n=e.attributes.item(i);t["@attributes"][n.nodeName]=n.nodeValue}}}else if(3==e.nodeType)return e.nodeValue;if(e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++){var r=e.childNodes.item(a),o=r.nodeName;if(null==t[o])t[o]=v(r);else{if(null==t[o].push){var s=t[o];t[o]=[],t[o].push(s)}t[o].push(v(r))}}return t}function g(e){try{var t={};if(e.children.length>0)for(var i=0;i<e.children.length;i++){var n=e.children.item(i),a=n.attributes;for(var r in a){var o=a[r],s=o.nodeName,l=o.nodeValue;void 0!==s&&(t[s]=l)}var c=n.nodeName;if("undefined"==typeof t[c])t[c]=v(n);else{if("undefined"==typeof t[c].push){var d=t[c];t[c]=[],t[c].push(d)}t[c].push(v(n))}}else t=e.textContent;return t}catch(h){console.log(h.message)}}var m=!1,w=this,_=function(e){return e instanceof _?e:this instanceof _?void(this.EXIFwrapped=e):new _(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports.EXIF=_):w.EXIF=_;var y=_.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},b=_.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},x=_.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},S=_.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},C=_.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},T={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};_.enableXmp=function(){_.isXmpEnabled=!0},_.disableXmp=function(){_.isXmpEnabled=!1},_.getData=function(t,i){return(self.Image&&t instanceof self.Image||self.HTMLImageElement&&t instanceof self.HTMLImageElement)&&!t.complete?!1:(e(t)?i&&i.call(t):a(t,i),!0)},_.getTag=function(t,i){return e(t)?t.exifdata[i]:void 0},_.getIptcTag=function(t,i){return e(t)?t.iptcdata[i]:void 0},_.getAllTags=function(t){if(!e(t))return{};var i,n=t.exifdata,a={};for(i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);return a},_.getAllIptcTags=function(t){if(!e(t))return{};var i,n=t.iptcdata,a={};for(i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);return a},_.pretty=function(t){if(!e(t))return"";var i,n=t.exifdata,a="";for(i in n)n.hasOwnProperty(i)&&(a+="object"==typeof n[i]?n[i]instanceof Number?i+" : "+n[i]+" ["+n[i].numerator+"/"+n[i].denominator+"]\r\n":i+" : ["+n[i].length+" values]\r\n":i+" : "+n[i]+"\r\n");return a},_.readFromBinaryFile=function(e){return r(e)},"function"==typeof define&&define.amd&&define("exif-js",[],function(){return _})}.call(this),define("thirdparty/exif/exif",function(){}),function(){function e(e,i,n,a){return new t(e,i,n,a)}function t(e,t,n,a){this.options=a||{},this.options.adapters=this.options.adapters||{},this.obj=e,this.keypath=t,this.callback=n,this.objectPath=[],this.parse(),i(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function i(e){return"object"==typeof e&&null!==e}function n(e){throw new Error("[sightglass] "+e)}e.adapters={},t.tokenize=function(e,t,i){var n,a,r=[],o={i:i,path:""};for(n=0;n<e.length;n++)a=e.charAt(n),~t.indexOf(a)?(r.push(o),o={i:a,path:""}):o.path+=a;return r.push(o),r},t.prototype.parse=function(){var i,a,r=this.interfaces();r.length||n("Must define at least one adapter interface."),~r.indexOf(this.keypath[0])?(i=this.keypath[0],a=this.keypath.substr(1)):("undefined"==typeof(i=this.options.root||e.root)&&n("Must define a default root adapter."),a=this.keypath),this.tokens=t.tokenize(a,r,i),this.key=this.tokens.pop()},t.prototype.realize=function(){var e,t=this.obj,n=!1;return this.tokens.forEach(function(a,r){i(t)?("undefined"!=typeof this.objectPath[r]?t!==(e=this.objectPath[r])&&(this.set(!1,a,e,this.update.bind(this)),this.set(!0,a,t,this.update.bind(this)),this.objectPath[r]=t):(this.set(!0,a,t,this.update.bind(this)),this.objectPath[r]=t),t=this.get(a,t)):(n===!1&&(n=r),(e=this.objectPath[r])&&this.set(!1,a,e,this.update.bind(this)))},this),n!==!1&&this.objectPath.splice(n),t},t.prototype.update=function(){var e,t;(e=this.realize())!==this.target&&(i(this.target)&&this.set(!1,this.key,this.target,this.callback),i(e)&&this.set(!0,this.key,e,this.callback),t=this.value(),this.target=e,this.value()!==t&&this.callback())},t.prototype.value=function(){return i(this.target)?this.get(this.key,this.target):void 0},t.prototype.setValue=function(e){i(this.target)&&this.adapter(this.key).set(this.target,this.key.path,e)},t.prototype.get=function(e,t){return this.adapter(e).get(t,e.path)},t.prototype.set=function(e,t,i,n){var a=e?"observe":"unobserve";this.adapter(t)[a](i,t.path,n)},t.prototype.interfaces=function(){var t=Object.keys(this.options.adapters);return Object.keys(e.adapters).forEach(function(e){~t.indexOf(e)||t.push(e)}),t},t.prototype.adapter=function(t){return this.options.adapters[t.i]||e.adapters[t.i]},t.prototype.unobserve=function(){var e;this.tokens.forEach(function(t,i){(e=this.objectPath[i])&&this.set(!1,t,e,this.update.bind(this))},this),i(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define("sightglass",[],function(){return this.sightglass=e}):this.sightglass=e}.call(this),function(){var e,t,i,n,a=function(e,t){return function(){return e.apply(t,arguments)}},r=[].slice,o={}.hasOwnProperty,s=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},l=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};e={options:["prefix","templateDelimiters","rootInterface","preloadData","handler","executeFunctions"],extensions:["binders","formatters","components","adapters"],"public":{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,executeFunctions:!1,iterationAlias:function(e){return"%"+e+"%"},handler:function(e,t,i){return this.call(e,t,i.view.models)},configure:function(t){var i,n,a,r;null==t&&(t={});for(a in t)if(r=t[a],"binders"===a||"components"===a||"formatters"===a||"adapters"===a)for(n in r)i=r[n],e[a][n]=i;else e["public"][a]=r},bind:function(t,i,n){var a;return null==i&&(i={}),null==n&&(n={}),a=new e.View(t,i,n),a.bind(),a},init:function(t,i,n){var a,r,o;if(null==n&&(n={}),null==i&&(i=document.createElement("div")),t=e["public"].components[t],r=t.template.call(this,i),r instanceof HTMLElement){for(;i.firstChild;)i.removeChild(i.firstChild);i.appendChild(r)}else i.innerHTML=r;return a=t.initialize.call(this,i,n),o=new e.View(i,a),o.bind(),o}}},window.jQuery||window.$?(n="on"in jQuery.prototype?["on","off"]:["bind","unbind"],t=n[0],i=n[1],e.Util={bindEvent:function(e,i,n){return jQuery(e)[t](i,n)},unbindEvent:function(e,t,n){return jQuery(e)[i](t,n)},getInputValue:function(e){var t;return t=jQuery(e),"checkbox"===t.attr("type")?t.is(":checked"):t.val()}}):e.Util={bindEvent:function(){return"addEventListener"in window?function(e,t,i){return e.addEventListener(t,i,!1)}:function(e,t,i){return e.attachEvent("on"+t,i)}}(),unbindEvent:function(){return"removeEventListener"in window?function(e,t,i){return e.removeEventListener(t,i,!1)}:function(e,t,i){return e.detachEvent("on"+t,i)}}(),getInputValue:function(e){var t,i,n,a;if("checkbox"===e.type)return e.checked;if("select-multiple"===e.type){for(a=[],i=0,n=e.length;n>i;i++)t=e[i],t.selected&&a.push(t.value);return a}return e.value}},e.TypeParser=function(){function e(){}return e.types={primitive:0,keypath:1},e.parse=function(e){return/^'.*'$|^".*"$/.test(e)?{type:this.types.primitive,value:e.slice(1,-1)}:"true"===e?{type:this.types.primitive,value:!0}:"false"===e?{type:this.types.primitive,value:!1}:"null"===e?{type:this.types.primitive,value:null}:"undefined"===e?{type:this.types.primitive,value:void 0}:""===e?{type:this.types.primitive,value:void 0}:isNaN(Number(e))===!1?{type:this.types.primitive,value:Number(e)}:{type:this.types.keypath,value:e}},e}(),e.TextTemplateParser=function(){function e(){}return e.types={text:0,binding:1},e.parse=function(e,t){var i,n,a,r,o,s,l;for(s=[],r=e.length,i=0,n=0;r>n;){if(i=e.indexOf(t[0],n),0>i){s.push({type:this.types.text,value:e.slice(n)});break}if(i>0&&i>n&&s.push({type:this.types.text,value:e.slice(n,i)}),n=i+t[0].length,i=e.indexOf(t[1],n),0>i){o=e.slice(n-t[1].length),a=s[s.length-1],(null!=a?a.type:void 0)===this.types.text?a.value+=o:s.push({type:this.types.text,value:o});break}l=e.slice(n,i).trim(),s.push({type:this.types.binding,value:l}),n=i+t[1].length}return s},e}(),e.View=function(){function t(t,i,n){var r,o,s,l,c,d,h,u,p,f,v,g,m;for(this.els=t,this.models=i,null==n&&(n={}),this.update=a(this.update,this),this.publish=a(this.publish,this),this.sync=a(this.sync,this),this.unbind=a(this.unbind,this),this.bind=a(this.bind,this),this.select=a(this.select,this),this.traverse=a(this.traverse,this),this.build=a(this.build,this),this.buildBinding=a(this.buildBinding,this),this.bindingRegExp=a(this.bindingRegExp,this),this.options=a(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),p=e.extensions,c=0,h=p.length;h>c;c++){if(o=p[c],this[o]={},n[o]){f=n[o];for(r in f)s=f[r],this[o][r]=s}v=e["public"][o];for(r in v)s=v[r],null==(l=this[o])[r]&&(l[r]=s)}for(g=e.options,d=0,u=g.length;u>d;d++)o=g[d],this[o]=null!=(m=n[o])?m:e["public"][o];this.build()}return t.prototype.options=function(){var t,i,n,a,r;for(i={},r=e.extensions.concat(e.options),n=0,a=r.length;a>n;n++)t=r[n],i[t]=this[t];return i},t.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},t.prototype.buildBinding=function(t,i,n,a){var r,o,s,l,c,d,h;return c={},h=function(){var e,t,i,n;for(i=a.match(/((?:'[^']*')*(?:(?:[^\|']+(?:'[^']*')*[^\|']*)+|[^\|]+))|^$/g),n=[],e=0,t=i.length;t>e;e++)d=i[e],n.push(d.trim());return n}(),r=function(){var e,t,i,n;for(i=h.shift().split("<"),n=[],e=0,t=i.length;t>e;e++)o=i[e],n.push(o.trim());return n}(),l=r.shift(),c.formatters=h,(s=r.shift())&&(c.dependencies=s.split(/\s+/)),this.bindings.push(new e[t](this,i,n,l,c))},t.prototype.build=function(){var t,i,n,a,r;for(this.bindings=[],i=function(t){return function(n){var a,r,o,s,l,c,d,h,u,p,f,v,g;if(3===n.nodeType){if(l=e.TextTemplateParser,(o=t.templateDelimiters)&&(h=l.parse(n.data,o)).length&&(1!==h.length||h[0].type!==l.types.text)){for(u=0,f=h.length;f>u;u++)d=h[u],c=document.createTextNode(d.value),n.parentNode.insertBefore(c,n),1===d.type&&t.buildBinding("TextBinding",c,null,d.value);n.parentNode.removeChild(n)}}else 1===n.nodeType&&(a=t.traverse(n));if(!a)for(g=function(){var e,t,i,a;for(i=n.childNodes,a=[],e=0,t=i.length;t>e;e++)s=i[e],a.push(s);return a}(),p=0,v=g.length;v>p;p++)r=g[p],i(r)}}(this),r=this.els,n=0,a=r.length;a>n;n++)t=r[n],i(t);this.bindings.sort(function(e,t){var i,n;return((null!=(i=t.binder)?i.priority:void 0)||0)-((null!=(n=e.binder)?n.priority:void 0)||0)})},t.prototype.traverse=function(t){var i,n,a,r,o,s,l,c,d,h,u,p,f,v,g,m;for(r=this.bindingRegExp(),o="SCRIPT"===t.nodeName||"STYLE"===t.nodeName,v=t.attributes,h=0,p=v.length;p>h;h++)if(i=v[h],r.test(i.name)){if(c=i.name.replace(r,""),!(a=this.binders[c])){g=this.binders;for(s in g)d=g[s],"*"!==s&&-1!==s.indexOf("*")&&(l=new RegExp("^"+s.replace(/\*/g,".+")+"$"),l.test(c)&&(a=d))}a||(a=this.binders["*"]),a.block&&(o=!0,n=[i])}for(m=n||t.attributes,u=0,f=m.length;f>u;u++)i=m[u],r.test(i.name)&&(c=i.name.replace(r,""),this.buildBinding("Binding",t,c,i.value));return o||(c=t.nodeName.toLowerCase(),this.components[c]&&!t._bound&&(this.bindings.push(new e.ComponentBinding(this,t,c)),o=!0)),o},t.prototype.select=function(e){var t,i,n,a,r;for(a=this.bindings,r=[],i=0,n=a.length;n>i;i++)t=a[i],e(t)&&r.push(t);return r},t.prototype.bind=function(){var e,t,i,n;for(n=this.bindings,t=0,i=n.length;i>t;t++)e=n[t],e.bind()},t.prototype.unbind=function(){var e,t,i,n;for(n=this.bindings,t=0,i=n.length;i>t;t++)e=n[t],e.unbind()},t.prototype.sync=function(){var e,t,i,n;for(n=this.bindings,t=0,i=n.length;i>t;t++)e=n[t],"function"==typeof e.sync&&e.sync()},t.prototype.publish=function(){var e,t,i,n;for(n=this.select(function(e){var t;return null!=(t=e.binder)?t.publishes:void 0}),t=0,i=n.length;i>t;t++)e=n[t],e.publish()},t.prototype.update=function(e){var t,i,n,a,r,o;null==e&&(e={});for(i in e)n=e[i],this.models[i]=n;for(o=this.bindings,a=0,r=o.length;r>a;a++)t=o[a],"function"==typeof t.update&&t.update(e)},t}(),e.Binding=function(){function t(e,t,i,n,r){this.view=e,this.el=t,this.type=i,this.keypath=n,this.options=null!=r?r:{},this.getValue=a(this.getValue,this),this.update=a(this.update,this),this.unbind=a(this.unbind,this),this.bind=a(this.bind,this),this.publish=a(this.publish,this),this.sync=a(this.sync,this),this.set=a(this.set,this),this.eventHandler=a(this.eventHandler,this),this.formattedValue=a(this.formattedValue,this),this.parseTarget=a(this.parseTarget,this),this.observe=a(this.observe,this),this.setBinder=a(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}return t.prototype.setBinder=function(){var e,t,i,n;if(!(this.binder=this.view.binders[this.type])){n=this.view.binders;for(e in n)i=n[e],"*"!==e&&-1!==e.indexOf("*")&&(t=new RegExp("^"+e.replace(/\*/g,".+")+"$"),t.test(this.type)&&(this.binder=i,this.args=new RegExp("^"+e.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift()))}return this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function?this.binder={routine:this.binder}:void 0},t.prototype.observe=function(t,i,n){return e.sightglass(t,i,n,{root:this.view.rootInterface,adapters:this.view.adapters})},t.prototype.parseTarget=function(){var t;return t=e.TypeParser.parse(this.keypath),0===t.type?this.value=t.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},t.prototype.formattedValue=function(t){var i,n,a,o,s,l,c,d,h,u,p,f,v,g,m;for(g=this.formatters,o=u=0,f=g.length;f>u;o=++u){for(s=g[o],a=s.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g),l=a.shift(),s=this.view.formatters[l],a=function(){var t,i,r;for(r=[],t=0,i=a.length;i>t;t++)n=a[t],r.push(e.TypeParser.parse(n));return r}(),d=[],i=p=0,v=a.length;v>p;i=++p)n=a[i],d.push(0===n.type?n.value:((h=this.formatterObservers)[o]||(h[o]={}),(c=this.formatterObservers[o][i])?void 0:(c=this.observe(this.view.models,n.value,this.sync),this.formatterObservers[o][i]=c),c.value()));(null!=s?s.read:void 0)instanceof Function?t=(m=s.read).call.apply(m,[this.model,t].concat(r.call(d))):s instanceof Function&&(t=s.call.apply(s,[this.model,t].concat(r.call(d))))}return t},t.prototype.eventHandler=function(e){var t,i;return i=(t=this).view.handler,function(n){return i.call(e,this,n,t)}},t.prototype.set=function(t){var i;return t=t instanceof Function&&!this.binder["function"]&&e["public"].executeFunctions?this.formattedValue(t.call(this.model)):this.formattedValue(t),null!=(i=this.binder.routine)?i.call(this,this.el,t):void 0},t.prototype.sync=function(){var e,t;return this.set(function(){var i,n,a,r,o,s,l;if(this.observer){if(this.model!==this.observer.target){for(o=this.dependencies,i=0,a=o.length;a>i;i++)t=o[i],t.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(s=this.options.dependencies)?s.length:void 0))for(l=this.options.dependencies,n=0,r=l.length;r>n;n++)e=l[n],t=this.observe(this.model,e,this.sync),this.dependencies.push(t)}return this.observer.value()}return this.value}.call(this))},t.prototype.publish=function(){var e,t,i,n,a,o,s,l,c;if(this.observer){for(n=this.getValue(this.el),s=this.formatters.slice(0).reverse(),a=0,o=s.length;o>a;a++)t=s[a],e=t.split(/\s+/),i=e.shift(),(null!=(l=this.view.formatters[i])?l.publish:void 0)&&(n=(c=this.view.formatters[i]).publish.apply(c,[n].concat(r.call(e))));return this.observer.setValue(n)}},t.prototype.bind=function(){var e,t,i,n,a,r,o;if(this.parseTarget(),null!=(a=this.binder.bind)&&a.call(this,this.el),null!=this.model&&(null!=(r=this.options.dependencies)?r.length:void 0))for(o=this.options.dependencies,i=0,n=o.length;n>i;i++)e=o[i],t=this.observe(this.model,e,this.sync),this.dependencies.push(t);return this.view.preloadData?this.sync():void 0},t.prototype.unbind=function(){var e,t,i,n,a,r,o,s,l,c;for(null!=(o=this.binder.unbind)&&o.call(this,this.el),null!=(s=this.observer)&&s.unobserve(),l=this.dependencies,a=0,r=l.length;r>a;a++)n=l[a],n.unobserve();this.dependencies=[],c=this.formatterObservers;for(i in c){t=c[i];for(e in t)n=t[e],n.unobserve()}return this.formatterObservers={}},t.prototype.update=function(e){var t,i;return null==e&&(e={}),this.model=null!=(t=this.observer)?t.target:void 0,null!=(i=this.binder.update)?i.call(this,e):void 0},t.prototype.getValue=function(t){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,t):e.Util.getInputValue(t)},t}(),e.ComponentBinding=function(t){function i(t,i,n){var r,o,s,c,d,h,u,p;for(this.view=t,this.el=i,this.type=n,this.unbind=a(this.unbind,this),this.bind=a(this.bind,this),this.locals=a(this.locals,this),this.component=this.view.components[this.type],this["static"]={},this.observers={},this.upstreamObservers={},o=t.bindingRegExp(),u=this.el.attributes||[],d=0,h=u.length;h>d;d++)r=u[d],o.test(r.name)||(s=this.camelCase(r.name),c=e.TypeParser.parse(r.value),l.call(null!=(p=this.component["static"])?p:[],s)>=0?this["static"][s]=r.value:0===c.type?this["static"][s]=c.value:this.observers[s]=r.value)}return s(i,t),i.prototype.sync=function(){},i.prototype.update=function(){},i.prototype.publish=function(){},i.prototype.locals=function(){var e,t,i,n,a,r;i={},a=this["static"];for(e in a)n=a[e],i[e]=n;r=this.observers;for(e in r)t=r[e],i[e]=t.value();return i},i.prototype.camelCase=function(e){return e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})},i.prototype.bind=function(){var t,i,n,a,r,o,s,l,c,d,h,u,p,f,v,g,m,w,_,y;if(!this.bound){f=this.observers;for(i in f)n=f[i],this.observers[i]=this.observe(this.view.models,n,function(e){return function(t){return function(){return e.componentView.models[t]=e.observers[t].value()}}}(this).call(this,i));this.bound=!0}if(null!=this.componentView)this.componentView.bind();else{for(this.el.innerHTML=this.component.template.call(this),s=this.component.initialize.call(this,this.el,this.locals()),this.el._bound=!0,o={},v=e.extensions,d=0,u=v.length;u>d;d++){if(r=v[d],o[r]={},this.component[r]){g=this.component[r];for(t in g)l=g[t],o[r][t]=l}m=this.view[r];for(t in m)l=m[t],null==(c=o[r])[t]&&(c[t]=l)}for(w=e.options,h=0,p=w.length;p>h;h++)r=w[h],o[r]=null!=(_=this.component[r])?_:this.view[r];this.componentView=new e.View(Array.prototype.slice.call(this.el.childNodes),s,o),this.componentView.bind(),y=this.observers;for(i in y)a=y[i],this.upstreamObservers[i]=this.observe(this.componentView.models,i,function(e){
return function(t,i){return function(){return i.setValue(e.componentView.models[t])}}}(this).call(this,i,a))}},i.prototype.unbind=function(){var e,t,i,n,a;i=this.upstreamObservers;for(e in i)t=i[e],t.unobserve();n=this.observers;for(e in n)t=n[e],t.unobserve();return null!=(a=this.componentView)?a.unbind.call(this):void 0},i}(e.Binding),e.TextBinding=function(e){function t(e,t,i,n,r){this.view=e,this.el=t,this.type=i,this.keypath=n,this.options=null!=r?r:{},this.sync=a(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}return s(t,e),t.prototype.binder={routine:function(e,t){return e.data=null!=t?t:""}},t.prototype.sync=function(){return t.__super__.sync.apply(this,arguments)},t}(e.Binding),e["public"].binders.text=function(e,t){return null!=e.textContent?e.textContent=null!=t?t:"":e.innerText=null!=t?t:""},e["public"].binders.html=function(e,t){return e.innerHTML=null!=t?t:""},e["public"].binders.show=function(e,t){return e.style.display=t?"":"none"},e["public"].binders.hide=function(e,t){return e.style.display=t?"none":""},e["public"].binders.enabled=function(e,t){return e.disabled=!t},e["public"].binders.disabled=function(e,t){return e.disabled=!!t},e["public"].binders.checked={publishes:!0,priority:2e3,bind:function(t){return e.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return e.Util.unbindEvent(t,"change",this.publish)},routine:function(e,t){var i;return e.checked="radio"===e.type?(null!=(i=e.value)?i.toString():void 0)===(null!=t?t.toString():void 0):!!t}},e["public"].binders.unchecked={publishes:!0,priority:2e3,bind:function(t){return e.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return e.Util.unbindEvent(t,"change",this.publish)},routine:function(e,t){var i;return e.checked="radio"===e.type?(null!=(i=e.value)?i.toString():void 0)!==(null!=t?t.toString():void 0):!t}},e["public"].binders.value={publishes:!0,priority:3e3,bind:function(t){return"INPUT"!==t.tagName||"radio"!==t.type?(this.event="SELECT"===t.tagName?"change":"input",e.Util.bindEvent(t,this.event,this.publish)):void 0},unbind:function(t){return"INPUT"!==t.tagName||"radio"!==t.type?e.Util.unbindEvent(t,this.event,this.publish):void 0},routine:function(e,t){var i,n,a,r,o,s,c;if("INPUT"===e.tagName&&"radio"===e.type)return e.setAttribute("value",t);if(null!=window.jQuery){if(e=jQuery(e),(null!=t?t.toString():void 0)!==(null!=(r=e.val())?r.toString():void 0))return e.val(null!=t?t:"")}else if("select-multiple"===e.type){if(null!=t){for(c=[],n=0,a=e.length;a>n;n++)i=e[n],c.push(i.selected=(o=i.value,l.call(t,o)>=0));return c}}else if((null!=t?t.toString():void 0)!==(null!=(s=e.value)?s.toString():void 0))return e.value=null!=t?t:""}},e["public"].binders["if"]={block:!0,priority:4e3,bind:function(e){var t,i;return null==this.marker?(t=[this.view.prefix,this.type].join("-").replace("--","-"),i=e.getAttribute(t),this.marker=document.createComment(" rivets: "+this.type+" "+i+" "),this.bound=!1,e.removeAttribute(t),e.parentNode.insertBefore(this.marker,e),e.parentNode.removeChild(e)):void 0},unbind:function(){return this.nested?(this.nested.unbind(),this.bound=!1):void 0},routine:function(t,i){var n,a,r,o;if(!!i==!this.bound){if(i){r={},o=this.view.models;for(n in o)a=o[n],r[n]=a;return(this.nested||(this.nested=new e.View(t,r,this.view.options()))).bind(),this.marker.parentNode.insertBefore(t,this.marker.nextSibling),this.bound=!0}return t.parentNode.removeChild(t),this.nested.unbind(),this.bound=!1}},update:function(e){var t;return null!=(t=this.nested)?t.update(e):void 0}},e["public"].binders.unless={block:!0,priority:4e3,bind:function(t){return e["public"].binders["if"].bind.call(this,t)},unbind:function(){return e["public"].binders["if"].unbind.call(this)},routine:function(t,i){return e["public"].binders["if"].routine.call(this,t,!i)},update:function(t){return e["public"].binders["if"].update.call(this,t)}},e["public"].binders["on-*"]={"function":!0,priority:1e3,unbind:function(t){return this.handler?e.Util.unbindEvent(t,this.args[0],this.handler):void 0},routine:function(t,i){return this.handler&&e.Util.unbindEvent(t,this.args[0],this.handler),e.Util.bindEvent(t,this.args[0],this.handler=this.eventHandler(i))}},e["public"].binders["each-*"]={block:!0,priority:4e3,bind:function(e){var t,i,n,a,r;if(null==this.marker)t=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],e.removeAttribute(t),e.parentNode.insertBefore(this.marker,e),e.parentNode.removeChild(e);else for(r=this.iterated,n=0,a=r.length;a>n;n++)i=r[n],i.bind()},unbind:function(){var e,t,i,n;if(null!=this.iterated)for(n=this.iterated,t=0,i=n.length;i>t;t++)e=n[t],e.unbind()},routine:function(t,i){var n,a,r,o,s,l,c,d,h,u,p,f,v,g,m,w,_,y,b,x;if(c=this.args[0],i=i||[],this.iterated.length>i.length)for(y=Array(this.iterated.length-i.length),f=0,m=y.length;m>f;f++)r=y[f],p=this.iterated.pop(),p.unbind(),this.marker.parentNode.removeChild(p.els[0]);for(o=v=0,w=i.length;w>v;o=++v)if(l=i[o],a={index:o},a[e["public"].iterationAlias(c)]=o,a[c]=l,null==this.iterated[o]){b=this.view.models;for(s in b)l=b[s],null==a[s]&&(a[s]=l);h=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,d=this.view.options(),d.preloadData=!0,u=t.cloneNode(!0),p=new e.View(u,a,d),p.bind(),this.iterated.push(p),this.marker.parentNode.insertBefore(u,h.nextSibling)}else this.iterated[o].models[c]!==l&&this.iterated[o].update(a);if("OPTION"===t.nodeName)for(x=this.view.bindings,g=0,_=x.length;_>g;g++)n=x[g],n.el===this.marker.parentNode&&"value"===n.type&&n.sync()},update:function(e){var t,i,n,a,r,o,s;t={};for(i in e)n=e[i],i!==this.args[0]&&(t[i]=n);for(s=this.iterated,r=0,o=s.length;o>r;r++)a=s[r],a.update(t)}},e["public"].binders["class-*"]=function(e,t){var i;return i=" "+e.className+" ",!t==(-1!==i.indexOf(" "+this.args[0]+" "))?e.className=t?""+e.className+" "+this.args[0]:i.replace(" "+this.args[0]+" "," ").trim():void 0},e["public"].binders["*"]=function(e,t){return null!=t?e.setAttribute(this.type,t):e.removeAttribute(this.type)},e["public"].formatters.call=function(){var e,t;return t=arguments[0],e=2<=arguments.length?r.call(arguments,1):[],t.call.apply(t,[this].concat(r.call(e)))},e["public"].adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(e){var t,i,n;return e.hasOwnProperty(this.id)||(t=this.counter++,Object.defineProperty(e,this.id,{value:t})),(i=this.weakmap)[n=e[this.id]]||(i[n]={callbacks:{}})},cleanupWeakReference:function(e,t){return Object.keys(e.callbacks).length||e.pointers&&Object.keys(e.pointers).length?void 0:delete this.weakmap[t]},stubFunction:function(e,t){var i,n,a;return n=e[t],i=this.weakReference(e),a=this.weakmap,e[t]=function(){var t,r,o,s,l,c,d,h,u,p;s=n.apply(e,arguments),d=i.pointers;for(o in d)for(r=d[o],p=null!=(h=null!=(u=a[o])?u.callbacks[r]:void 0)?h:[],l=0,c=p.length;c>l;l++)(t=p[l])();return s}},observeMutations:function(e,t,i){var n,a,r,o,s,c;if(Array.isArray(e)){if(r=this.weakReference(e),null==r.pointers)for(r.pointers={},a=["push","pop","shift","unshift","sort","reverse","splice"],s=0,c=a.length;c>s;s++)n=a[s],this.stubFunction(e,n);if(null==(o=r.pointers)[t]&&(o[t]=[]),l.call(r.pointers[t],i)<0)return r.pointers[t].push(i)}},unobserveMutations:function(e,t,i){var n,a,r;return Array.isArray(e)&&null!=e[this.id]&&(a=this.weakmap[e[this.id]])&&(r=a.pointers[t])?((n=r.indexOf(i))>=0&&r.splice(n,1),r.length||delete a.pointers[t],this.cleanupWeakReference(a,e[this.id])):void 0},observe:function(e,t,i){var n,a,r;return n=this.weakReference(e).callbacks,null==n[t]&&(n[t]=[],a=Object.getOwnPropertyDescriptor(e,t),(null!=a?a.get:void 0)||(null!=a?a.set:void 0)||(r=e[t],Object.defineProperty(e,t,{enumerable:!0,get:function(){return r},set:function(i){return function(a){var o,s,l,c,d;if(a!==r&&(i.unobserveMutations(r,e[i.id],t),r=a,s=i.weakmap[e[i.id]])){if(n=s.callbacks,n[t])for(d=n[t],l=0,c=d.length;c>l;l++)(o=d[l])();return i.observeMutations(a,e[i.id],t)}}}(this)}))),l.call(n[t],i)<0&&n[t].push(i),this.observeMutations(e[t],e[this.id],t)},unobserve:function(e,t,i){var n,a,r;return(r=this.weakmap[e[this.id]])&&(n=r.callbacks[t])?((a=n.indexOf(i))>=0&&(n.splice(a,1),n.length||delete r.callbacks[t]),this.unobserveMutations(e[t],e[this.id],t),this.cleanupWeakReference(r,e[this.id])):void 0},get:function(e,t){return e[t]},set:function(e,t,i){return e[t]=i}},e.factory=function(t){return e.sightglass=t,e["public"]._=e,e["public"]},"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=e.factory(require("sightglass")):"function"==typeof define&&define.amd?define("thirdparty/rivets/rivets.min",["sightglass"],function(t){return this.rivets=e.factory(t)}):this.rivets=e.factory(sightglass)}.call(this),jQuery.handleError=function(e,t,i,n){e.error&&e.error.call(e.context||e,t,i,n),e.global&&(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,n])},jQuery.extend({createUploadIframe:function(e,t){var i="jUploadFrame"+e,n='<iframe id="'+i+'" name="'+i+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof t?n+=' src="javascript:false"':"string"==typeof t&&(n+=' src="'+t+'"')),n+=" />",jQuery(n).appendTo(document.body),jQuery("#"+i).get(0)},createUploadForm:function(e,t,i){var n="jUploadForm"+e,a="jUploadFile"+e,r=jQuery('<form  action="" method="POST" name="'+n+'" id="'+n+'" enctype="multipart/form-data"></form>');if(i)for(var o in i)jQuery('<input type="hidden" name="'+o+'" value="'+i[o]+'" />').appendTo(r);var s=jQuery("#"+t),l=jQuery(s).clone();return jQuery(s).attr("id",a),jQuery(s).before(l),jQuery(s).appendTo(r),jQuery(r).css("position","absolute"),jQuery(r).css("top","-1200px"),jQuery(r).css("left","-1200px"),jQuery(r).appendTo("body"),r},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime(),i=jQuery.createUploadForm(t,e.fileElementId,"undefined"==typeof e.data?!1:e.data),n=(jQuery.createUploadIframe(t,e.secureuri),"jUploadFrame"+t),a="jUploadForm"+t;e.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var r=!1,o={};e.global&&jQuery.event.trigger("ajaxSend",[o,e]);var s=function(t){var a=document.getElementById(n);try{a.contentWindow?(o.responseText=a.contentWindow.document.body?a.contentWindow.document.body.innerHTML:null,o.responseXML=a.contentWindow.document.XMLDocument?a.contentWindow.document.XMLDocument:a.contentWindow.document):a.contentDocument&&(o.responseText=a.contentDocument.document.body?a.contentDocument.document.body.innerHTML:null,o.responseXML=a.contentDocument.document.XMLDocument?a.contentDocument.document.XMLDocument:a.contentDocument.document)}catch(s){jQuery.handleError(e,o,null,s)}if(o||"timeout"==t){r=!0;var l;try{if(l="timeout"!=t?"success":"error","error"!=l){var c=jQuery.uploadHttpData(o,e.dataType);e.success&&e.success(c,l),e.global&&jQuery.event.trigger("ajaxSuccess",[o,e])}else jQuery.handleError(e,o,l)}catch(s){l="error",jQuery.handleError(e,o,l,s)}e.global&&jQuery.event.trigger("ajaxComplete",[o,e]),e.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),e.complete&&e.complete(o,l),jQuery(a).unbind(),setTimeout(function(){try{jQuery(a).remove(),jQuery(i).remove()}catch(t){jQuery.handleError(e,o,null,t)}},100),o=null}};e.timeout>0&&setTimeout(function(){r||s("timeout")},e.timeout);try{var i=jQuery("#"+a);jQuery(i).attr("action",e.url),jQuery(i).attr("method","POST"),jQuery(i).attr("target",n),i.encoding?jQuery(i).attr("encoding","multipart/form-data"):jQuery(i).attr("enctype","multipart/form-data"),jQuery(i).submit()}catch(l){jQuery.handleError(e,o,null,l)}return jQuery("#"+n).load(s),{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type&&eval("data = "+data),"html"==type&&jQuery("<div>").html(data).evalScripts(),data}}),define("ajaxfile",["jquery"],function(){}),window._file_change_simple=function($file,exts,url,callback,opts){opts||(opts={});var f=$file.clone(),img_path=$file[0].value;if(""!=$.trim(img_path)){var legal=!1;if(0==exts.length?legal=!0:$.each(exts,function(e,t){img_path.toLowerCase().lastIndexOf("."+t)==img_path.length-t.length-1&&(legal=!0)}),!legal)return void global.message("error","上传文件格式： "+exts.toString());$.ajaxFileUpload({url:url,secureuri:!1,fileElementId:$file.attr("id"),dataType:"json",beforeSend:opts.beforeSend,data:opts.data,complete:function(server_data){try{var data=server_data;if(server_data.data||(data=eval("("+$(server_data.responseText).html()+")")),opts.callback)return void opts.callback(data);if(200==data.code)return void(callback&&callback(data.data));200!=data.code&&global.message("error",data.msg)}catch(e){global.message("error","服务器错误响应")}}}),$("input[type='file']#"+f.attr("id")).unbind("change").change(function(){_file_change_simple($("#"+f.attr("id")),exts,url,callback)})}},window._file_change=function($file,exts,url,before,call_ok,call_error,after,opts){opts||(opts={});var f=$file.clone(),img_path=$file[0].value;if(""!=$.trim(img_path)){var legal=!1;if(0==exts.length?legal=!0:$.each(exts,function(e,t){img_path.toLowerCase().lastIndexOf("."+t)==img_path.length-t.length-1&&(legal=!0)}),!legal)return void global.message("error","上传文件格式： "+exts.toString());var $bck=$($("input[type='file']#"+f.attr("id")).parent().parent().find("img").parent()[0]),w=$bck.width(),h=$bck.height(),old_html=$bck.html();$bck.html('<div style="padding-top: '+(h-32)/2+"px; padding-left: "+(w-32)/2+"px; height: "+(h-(h-32)/2)+'px; background-color: #fff;"><div style="width:32px; height:32px; background:url(//v1static.epub360.com/admin-epub360/img/loading.gif) no-repeat 50% 50%;"></div></div>'),before&&before($bck),$.ajaxFileUpload({url:url,secureuri:!1,fileElementId:$file.attr("id"),dataType:"json",beforeSend:opts.beforeSend,complete:function(server_data){try{var data=server_data;if(server_data.data||(data=eval("("+$(server_data.responseText).html()+")")),200==data.code)return void(call_ok?call_ok(data.data,old_html,$bck):$("<img/>").attr("src",data.data.url).on("load",function(){$bck.html($(this)),$bck.find("img").hide().fadeIn(function(){global.message("success","成功替换图片")}),data.data.data&&$(this).attr("data",data.data.data),after&&after($(this))}).error(function(){$bck.html(old_html),global.message("error","服务器错误响应"),call_error&&call_error($bck)}));200!=data.code&&($bck.html(old_html),call_error&&call_error($bck),global.message("error",data.msg))}catch(e){$bck.html(old_html),call_error&&call_error($bck),global.message("error","服务器错误响应")}}}),$("input[type='file']#"+f.attr("id")).unbind("change").change(function(){_file_change($("#"+f.attr("id")),exts,url,before,call_ok,call_error,after)})}},window._file_change_for_edit=function($file,exts,url,before,callback,opts){opts||(opts={});var f=$file.clone(),img_path=$file[0].value;if(""!=$.trim(img_path)){var legal=!1;if(0==exts.length?legal=!0:$.each(exts,function(e,t){img_path.toLowerCase().lastIndexOf("."+t)==img_path.length-t.length-1&&(legal=!0)}),!legal)return void global.message("error","上传文件格式： "+exts.toString());var $bck=$($("input[type='file']#"+f.attr("id")).parent().parent().find("img").parent()[0]),w=$bck.width(),h=$bck.height(),old_html=$bck.html();$bck.html('<div style="padding-top: '+(h-32)/2+"px; padding-left: "+(w-32)/2+"px; height: "+(h-(h-32)/2)+'px; background-color: #fff;"><div style="width:32px; height:32px; background:url(//v1static.epub360.com/admin-epub360/img/loading.gif) no-repeat 50% 50%;"></div></div>'),before&&before(),$.ajaxFileUpload({url:url,secureuri:!1,fileElementId:$file.attr("id"),dataType:"json",beforeSend:opts.beforeSend,complete:function(server_data){try{var data=server_data;server_data.data||(data=eval("("+$(server_data.responseText).html()+")")),200==data.code?$("<img/>").attr("src",data.data.data).on("load",function(){$bck.html($(this)),$(this).attr("data",data.data.url),global.message("success","成功替换图片"),callback&&callback($(this))}):200!=data.code&&($bck.html(old_html),global.message("error",data.msg))}catch(e){$bck.html(old_html),global.message("error","服务器错误响应")}}}),$("input[type='file']#"+f.attr("id")).unbind("change").change(function(){_file_change_for_edit($("#"+f.attr("id")),exts,url,before,callback)})}},define("ajaximage",["ajaxfile"],function(){}),function(e){e.configpage={page:null,el:null,init:function(e){interaction_view.foredit&&"config"==interaction.doc.mode||e.data.configpages&&e.data.configpages.length&&(configpage.initMVC(),interaction_view.iconfiglist=_g.mvc.createTreeByData({collection:configpage.configpagecollection,data:e.data.configpages}),configpage.page=interaction_view.iconfiglist.at(0),configpage.actions=[])},initMVC:function(){var e=require("interaction_view/view/page");configpage.configpageview=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!0,position:1,parseData:null,isConfig:!0,render:function(e,t){this.setElement(configpage.el)}});var t=require("interaction_view/model/page"),i=t.extend({defaults:{iType:"Config",position:0,description:"",title:"untitled",picture:null,thumbnail:null,width:null,height:null,bg_color:"#FFFFFF",bg_opacity:1,pageno_horizontal:{show:!1,x:500,y:20},pageno_vertical:{show:!1,x:20,y:300}}}),n=require("interaction_view/collection/page");configpage.configpagecollection=n.extend({model:i})},renderView:function(){if(interaction_view.foredit&&"config"==interaction.doc.mode)return configpage.page=interaction_view.ipagelist.getPages()[0],void(configpage.actions=[]);if(configpage.page){$(".reveal").append('<div class="config_wrap" style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px; z-index: 3000; transform: translateZ(50px); overflow: hidden;"><div class="interaction-area typo"><div class="interaction-view" style="overflow:visible"></div></div></div>'),configpage.el=$(".config_wrap").children(),$(".config_wrap").addClass("disableDragY iMouseWheel disableMouseWheelY"),"undefined"!=typeof config_player&&config_player||$(".config_wrap").hide(),interaction_view.iconfiglist.length&&interaction_view.iconfiglist.at(0).addView("iview",configpage.configpageview);var e=configpage.page.get("bg_color"),t=configpage.page.get("bg_opacity"),i=-1==e.indexOf("rgba")?_g.getRGBA(e,t):e;configpage.page.iview.$el.css({"background-color":i,"margin-left":Reveal.marginLeft,"margin-top":Reveal.marginTop}),ScrollPage.bindScrollPage(configpage.page)}},saveConfig:function(){var e=context_url+"config/",t=configpage.page.iOverlaylist.models,i={};_.each(t,function(e,t){if(e.attributes.iDetail.isConfigOverlay)return!0;var n=e.id,a=configpage.page.iOverlaylist.get(n),r=a&&a.attributes.iDetail,o=e.attributes.iType,s=interaction_view.expression.getOverlayValue(configpage.page,n,{raw:!0}),l=[];switch(o){case"Input":r.initial=s,i[n]=r;break;case"Textarea":r.initial=s,i[n]=r;break;case"Variable":r.initial=s,i[n]=r;break;case"Paragraph":r.iText=s,i[n]=r;break;case"Image":case"ImageBlock":r.iImg[0].picture=s,i[n]=r;break;case"Select":r.initial=parseInt(s),i[n]=r;break;case"DataBinder":l.push(n)}for(var c=0;c<l.length;c++){var d=configpage.page.iOverlaylist.get(l[c]);if(d){var h=d.attributes.iDetail.dataBinder;_.each(h,function(e){var t=interaction_view.expression,n=t.getPagePath(e.id),a=e.expression_id,r=/\$d_(\w+)\..*\$/,o=a.match(r)[1];a=a.replace(o,interaction_view.dblist.get(o).get("sheet_id"));var s=configpage.page.iOverlaylist.get(n.element_id);s.attributes.iDetail.binding=a,i[n.element_id]=s.attributes.iDetail})}}}),$.ajax({type:"POST",url:e,data:JSON.stringify(i),contentType:"application/json",dataType:"json",success:function(e,t,i){if(200==e.code){interaction_view.errorAlert("保存成功");for(var n=0;n<configpage.actions.length;n++)configpage.actions[n].func()}else interaction_view.errorAlert(e.msg)},error:function(e,t,i){interaction_view.errorAlert("保存失败")}})}}}(window),define("_e/configpage",function(){});var _tmpDIV=document.createElement("DIV"),PropPrefix="transform";e=_tmpDIV,p="transform";var s=e.style,a,i;if(void 0!==s[PropPrefix]);else{for(a=["O","Moz","ms","Ms","Webkit"],i=5;--i>-1&&void 0===s[a[i]+p];);i>=0&&(_prefix=3===i?"ms":a[i],_prefixCSS="-"+_prefix.toLowerCase()+"-",PropPrefix=_prefix+PropPrefix)}"undefined"==typeof WebKitCSSMatrix&&(WebKitCSSMatrix=MSCSSMatrix),"undefined"!=typeof WebKitCSSMatrix&&(WebKitCSSMatrix.prototype.toString3D=function(){for(var e=this.m11.toFixed(6),t=1;16>t;t++)e+=","+this["m"+((t/4|0)+1)+(t%4+1)].toFixed(6);return"matrix3d("+e+")"},WebKitCSSMatrix.prototype.__clone__=function(){var e=new WebKitCSSMatrix;e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.e=this.e,e.f=this.f;for(var t=0;16>t;t++)e["m"+((t/4|0)+1)+(t%4+1)]=this["m"+((t/4|0)+1)+(t%4+1)];return e});var CSSMatrix={PID180:Math.PI/180,_set:function(e,t){-1==e.style[PropPrefix].indexOf("matrix3d")?e.style[PropPrefix]=t.toString():e.style[PropPrefix]=t.toString3D()},setTranslate:function(e,t,i,n){if(e=e[0]?e[0]:e){if(!interaction_view.ismobile)return void TweenMax.set(e,{x:t,y:i,z:n});var a=new WebKitCSSMatrix(e.style[PropPrefix]);(0===t||t)&&(e._gsTransform&&(e._gsTransform.x=t),a.e=t,a.m41=t),(0===i||i)&&(e._gsTransform&&(e._gsTransform.y=i),a.f=i,a.m42=i),(0===n||n)&&(e._gsTransform&&(e._gsTransform.z=n),a.m43=n),CSSMatrix._set(e,a)}},setRotation:function(e,t,i,n){TweenMax.set(e,{rotationX:t,rotationY:i,rotation:n})},setSkew:function(e,t,i){TweenMax.set(e,{skewX:t,skewY:i})},setPerspective:function(e,t){TweenMax.set(e,{transformPerspective:t})},getTranslate:function(e){if(!interaction_view.ismobile)return e=e[0]?e[0]:e,e._gsTransform?{x:e._gsTransform.x,y:e._gsTransform.y,z:e._gsTransform.z}:{x:0,y:0,z:0};var t=CSSMatrix.getTransform(e);return{x:t.x,y:t.y,z:t.z}},getTransform:function(e){if(e){if(e=e[0]?e[0]:e,!interaction_view.ismobile||e._gsTransform)return e._gsTransform;if(e._csTransform)return e._csTransform;var t=new WebKitCSSMatrix(e.style[PropPrefix]);return e._csTransform={x:t.m41,y:t.m42,z:t.m43,rotation:0,rotationX:0,rotationY:0,skewX:0,skewY:0,perspective:0},e._csTransform}},setTransform:function(e,t,i){i||(i={}),t&&(t.force3D=i.force3D);var n=!1;e._gsTransform||0!==t.rotationX||0!==t.rotationY||0!==t.skewX||0!==t.skewY?t.transformStyle="preserve-3d":(delete t.rotationX,delete t.rotationY,delete t.skewX,delete t.skewY,delete t.transformPerspective,n=!0),TweenMax.set(e,t)}};define("_e/cssmatrix",function(){}),function(){var e={start:function(t){jQuery.ajax({url:t,type:"GET"}).done(function(t,i,n){console.log("HTTP Request Succeeded: "+n.status),console.log(t),e.render(t)}).fail(function(e,t,i){console.log("HTTP Request Failed")}).always(function(){})},render:function(e){e.dom;$(".reveal").addClass("reveal_origin").removeClass("reveal"),$("body").append(e.dom),interaction_view.events.clearAll(),presentation.isFirstPageLoading=!1,interaction_view.preloadended=!1,interaction_view.playstatus="wait",interaction_view.queue=new Queue,epub360_book_data=e.data,interaction_view.currentScreenSize=null,interaction_view.init()}};window.switchDoc=e}(window),define("_e/switchdoc",function(){}),function(){var e={toPage:function(e,t){var i,n=e.page;if(void 0!==e.type||e.type.length){var a=$.extend(!0,{},e);switch(i=interaction_view.expression.id2values(e.value,function(e){},{noDb:!0}),e.type){case"0":a.type="ctemplate",a.suffix=i;break;case"1":a.type="clist",a.suffix="tags!!"+encodeURIComponent(i);break;case"2":a.type="clist",a.suffix="keywords!!"+encodeURIComponent(i)}var r=this.setCMSComp(a);t!==n?presentation.gotopage(n,0):this.refreshComp(r,n)}},setCMSComp:function(e){var t,i=interaction_view.getPage(e.page),n=this,a=[];return i?(t=i.iOverlaylist.where({iType:e.type}),_.each(t,function(t){var i=t.get("iDetail"),r=n.parseUrl(i.iUrl,e.suffix);r&&i.iUrl!==r&&(i.iUrl=r,t.set("iDetail",i),a.push(t.id),delete t.iview.result)}),a):void 0},parseUrl:function(e,t){if(e){var i,n,a=e,r="",o=-1!==e.indexOf("www.coolsite360.com")?!0:!1;if(o){var s=Number(e.indexOf("sites/"))+6;if(6>s)return;var l=Number(e.indexOf("?"));return-1!==l?(n=e.slice(s,l).split("/"),r=e.slice(l)):n=e.slice(s).split("/"),n.splice(2,1,t),i=n.join("/"),i&&(a=["www.coolsite360.com/","sites/",i,r].join("")),a}var c=e.split("/");return i=c[1],-1!==i.indexOf(".html")&&(i=i.split(".html")[0]),a=[c[0],i,t].join("/")}},refreshComp:function(e,t){if(null!=e)for(var i=interaction_view.getPage(t),n=i.iOverlaylist.models,a=0;a<n.length;a++)-1!==e.indexOf(n[a].id)&&n[a].iview.renderWebContent()}};this.CMS=e}(window),define("_e/cms",function(){}),function(){function e(e,t){var i=t.indexOf(e);$("body").append('<div id="previewimage" data-idx="'+i+'" style="z-index: 99999;position:fixed;width:100%;height:100%;left:0;top:0;background:#000;"><div id="slider" style="height:100%;"></div></div>');var n=$("#previewimage").width(),a=$("#previewimage").height(),r=[];if(t.length)for(var o=0;o<t.length;o++){var s=$("#slider").height()/$("#slider").width();$("#slider").append('<div class="img_wrap" data-num="'+o+'" style="position: absolute;overflow:hidden;"><img style="width:100%;height:100%;" src="'+t[o].replace(/["']/g,"")+'"/></div>');var l=$(".img_wrap").eq(o).height()/$(".img_wrap").eq(o).width();if(l>=s){var c=($("#slider").width()-$("#slider").height()/l)/2;$(".img_wrap").eq(o).css({height:$("#slider").height(),width:$("#slider").height()/l,left:n*o+c,top:0}),r.push({left:n*o+c,top:0})}else{var d=($("#slider").height()-$("#slider").width()*l)/2;$(".img_wrap").eq(o).css({width:$("#slider").width(),height:$("#slider").width()*l,left:n*o,top:d}),r.push({left:n*o,top:d})}}$("#slider").css({transform:"translateX(-"+n*i+"px)"});var h=document.getElementById("previewimage"),u=1;new AlloyFinger(h,{singleTap:function(e){e.preventDefault(),1!=u?($(".img_wrap").eq(i).css({left:r[i].left,top:r[i].top,transform:"none"}),u=1):$("#previewimage").remove()},doubleTap:function(e){var t=-(e.changedTouches[0].pageX-n/2),o=-(e.changedTouches[0].pageY-a/2);e.preventDefault();var s=2,l=$(".img_wrap").eq(i);l.css("transition-duration","300ms"),l.css("transform")&&"none"==l.css("transform")?(l.css("transform","translate("+t+","+o+") scale("+s+")"),u=2):(l.css({left:r[i].left,top:r[i].top,transform:"none"}),u=1)},pinch:function(e){e.preventDefault(),console.log(e.scale);var t=e.scale,n=$(".img_wrap").eq(i);u=t,n.css({"transition-duration":"",transform:"scale("+t+")"})},pressMove:function(e){if(1==u)return void e.preventDefault();console.log(e.deltaX),console.log(e.deltaY);var t=$(".img_wrap").eq(i);t.css("transition-duration","");var n=t.css("left").replace&&Number(t.css("left").replace("px","")),a=t.css("top").replace&&Number(t.css("top").replace("px",""));1==u?t.css({left:n+e.deltaX}):t.css({left:n+e.deltaX,top:a+e.deltaY}),e.preventDefault()},swipe:function(e){if(e.preventDefault(),$("#slider").css({"transition-duration":"300ms"}),console.log("swipe"+e.direction),i=e.target==document.getElementById("previewimage")?Number($(e.target).attr("data-idx")):Number($(e.target).parents("#previewimage").attr("data-idx")),"Left"==e.direction){if(i+1>=$("#slider").children().length)return;$("#slider").css({transform:"translateX(-"+n*(i+1)+"px)"}),e.target==document.getElementById("previewimage")?(i++,$(e.target).attr("data-idx",i)):(i++,$(e.target).parents("#previewimage").attr("data-idx",i))}else{if(0>=i)return;$("#slider").css({transform:"translateX(-"+n*(i-1)+"px)"}),e.target==document.getElementById("previewimage")?(i--,$(e.target).attr("data-idx",i)):(i--,$(e.target).parents("#previewimage").attr("data-idx",i))}for(var t=0;t<$(".img_wrap").length;t++)$(".img_wrap").eq(t).css({left:r[t].left,top:r[t].top,transform:"none"})}})}window.epubsdk={previewImage:function(t,i){interaction_view.isWeixin&&"undefined"!=typeof wx_permissions&&wx_permissions.previewImage?interaction_view.weixin.previewImage(t,i):e(t,i)}}}(window),define("_e/epubsdk",function(){}),define("text!_e/scorm/scorm_player/components/taskbar/taskbar.tpl",[],function(){return'<div class="c-div div_c6H0RS">\n	<div class="c-div div_QN1QbQ2">\n		<a class="c-linkblock linkblock_gxXkND task_exit" href="#">\n			<i class="fa fa-sign-out c-icon icon_ivAzUs"></i>\n			<p class="c-paragraph paragraph_GpN89n">退出</p>\n		</a>\n		<a class="c-linkblock linkblock_gxXkND task_cata" href="#">\n			<i class="fa fa-bars c-icon icon_ivAzUs"></i>\n		</a>\n	</div>\n	<div class="c-div div_QN1QbQ">\n		<a class="c-linkblock linkblock_gxXkND task_prev" href="#">\n			<i class="fa fa-chevron-left c-icon icon_ivAzUs"></i>\n		</a>\n		<a class="c-linkblock linkblock_gxXkND task_pause" href="#">\n			<i class="fa fa-pause c-icon icon_ivAzUs"></i>\n		</a>\n		<a class="c-linkblock linkblock_gxXkND task_replay" href="#">\n			<i class="fa fa-undo c-icon icon_ivAzUs"></i>\n		</a>\n		<a class="c-linkblock linkblock_gxXkND task_next" href="#">\n			<i class="fa fa-chevron-right c-icon icon_ivAzUs"></i>\n		</a>\n	</div>\n	<div class="c-div div_QN1QbQ3">\n		<p class="c-paragraph paragraph_GpN82 task_page-title">P02-APU自动停车</p>\n		<p class="c-paragraph paragraph_GpN82 task_pagination">8/20</p>\n		<a class="c-linkblock linkblock_gxXkND task_fullscreen" href="#">\n			<i class="fa fa-expand c-icon icon_ivAzUs"></i>\n		</a>\n	</div>\n</div>'}),define("_e/scorm/scorm_player/components/taskbar/taskbar",["require","text!./taskbar.tpl"],function(e){var t=e("text!./taskbar.tpl"),i=function(){},n=function(e){this.scormPlayer=e.scormPlayer,this.eventBus=this.scormPlayer.eventBus,this.$parent=this.scormPlayer.$root,this.scormState=this.scormPlayer.state,this.taskState={iconStatus:{}},this.init()};return n.prototype={init:function(){this.renderTo(this.$parent),this.bindBusEvent(),this.bindUserEvent()},renderTo:function(e){var i=this.$root=$(t);i.addClass("scorm_taskbar"),i.appendTo(e),this.domMap={$prevBtn:i.find(".task_prev"),$nextBtn:i.find(".task_next"),$pasueIcon:i.find(".task_pause").find("i.fa"),$fullscreenIcon:i.find(".task_fullscreen").find("i.fa"),$pageTitle:i.find(".task_page-title"),$pagination:i.find(".task_pagination")}},bindBusEvent:function(){var e=this,t={firstLoad:function(e){this.loadCurrentPageData(e.currentPageData)},gotoPage:function(e){this.loadCurrentPageData(e)},switchPlay:this.switchPlayIcon,switchFullscreen:this.switchFullscreenIcon};Object.keys(t).forEach(function(i){e.eventBus.on(i,t[i].bind(e))})},bindUserEvent:function(){var e=this.$root,t=this.scormPlayer,n={".task_exit":function(){t.switchCatapage(!0)},".task_cata":t.switchCatalog,".task_pause":t.switchPlay,".task_replay":t.replayCurrentPage,".task_fullscreen":t.switchFullscreen,".task_prev":function(){t.gotoPage("prev")},".task_next":function(){t.gotoPage("next")}};Object.keys(n).forEach(function(t){e.on("click",t,n[t]||i)})},loadCurrentPageData:function(e){this.setTitle(e),this.setPagination(e),this.navIconChanged(e)},switchPlayIcon:function(e){var t=this.domMap.$pasueIcon;e?t.removeClass("fa-play").addClass("fa-pause"):t.removeClass("fa-pause").addClass("fa-play")},switchFullscreenIcon:function(e){var t=this.domMap.$fullscreenIcon;e?t.removeClass("fa-expand").addClass("fa-compress"):t.removeClass("fa-compress").addClass("fa-expand")},setTitle:function(e){this.domMap.$pageTitle.text(e.title)},setPagination:function(e){var t=""+(e.indexInGroup+1)+"/"+e.lengthInGroup;this.domMap.$pagination.text(t)},navIconChanged:function(e){var t=e.indexInTotal,i=e.lengthInTotal,n=this.taskState.iconStatus,a={prev:0!=t,next:t!=i-1},r={prev:a.prev!==n.prev,next:a.next!==n.next};this.taskState.iconStatus=a;for(var o in r)this.switchNavIcon(o,a[o])},switchNavIcon:function(e,t){var i={prev:this.domMap.$prevBtn,next:this.domMap.$nextBtn}[e];i&&(t?i.removeClass("disabled"):i.addClass("disabled"))}},n}),define("text!_e/scorm/scorm_player/components/catalog/cata_main.tpl",[],function(){return'<div class="c-div div_8m5DUv">\n	<div class="c-div div_s67Fhk">\n		<i class="fa fa-bars c-icon icon_06FtFw"></i>\n		<p class="c-paragraph paragraph_4fZVjJ">Navigation Map</p>\n		<a class="c-linkblock linkblock_lkfQ9Q cata_close" href="#">\n			<i class="fa fa-remove c-icon icon_06FtFw"></i>\n		</a>\n	</div>\n	<div class="c-div div_mSGwtA">\n		<ul class="c-list list_xWM2Jl">\n\n		</ul>\n	</div>\n</div>';
}),define("text!_e/scorm/scorm_player/components/catalog/cata_group.tpl",[],function(){return'<li class="c-listitem listitem_25Entj cata_group-item">\n	<div class="c-div div_i5lp6e">\n		<i class="fa fa-bookmark-o c-icon icon_tTbhEe"></i>\n		<p class="c-paragraph paragraph_x6NDQJ cata_group-title">系统简介</p>\n	</div>\n	<ul class="c-list list_xWM2Jl">\n\n	</ul>\n</li>'}),define("text!_e/scorm/scorm_player/components/catalog/cata_page.tpl",[],function(){return'<li class="c-listitem listitem_25Entj cata_page-item">\n	<div class="c-div div_i5lp6e">\n		<i class="fa fa-square-o c-icon icon_tTbhEe"></i>\n		<a class="c-textlink textlink_m26kRd cata_page-title" href="#">系统简介</a>\n	</div>\n</li>'}),define("_e/scorm/scorm_player/components/catalog/catalog",["require","text!./cata_main.tpl","text!./cata_group.tpl","text!./cata_page.tpl"],function(e){var t=e("text!./cata_main.tpl"),i=e("text!./cata_group.tpl"),n=e("text!./cata_page.tpl"),a=function(){},r=function(e){this.scormPlayer=e.scormPlayer,this.eventBus=this.scormPlayer.eventBus,this.$parent=this.scormPlayer.$root,this.scormState=this.scormPlayer.state,this.cataState={},this.init(this.scormState)};return r.prototype={init:function(e){this.renderTo(this.$parent),this.switchSelfShow(e.isCataShow),this.bindBusEvent(),this.bindUserEvent()},renderTo:function(e){var i=this.$root=$("<div/>").addClass("scorm_catalog-wrapper"),n=this.$catalog=$(t);n.addClass("scorm_catalog").addClass("hidden").appendTo(i),i.appendTo(e)},bindBusEvent:function(){var e=this,t={firstLoad:function(e){this.loadCataTree(e.organization),this.loadProgress(e.scormData),this.loadCurrentPageData(e.currentPageData)},gotoPage:function(e){this.loadCurrentPageData(e)},switchCatalog:this.switchSelfShow,switchPageProgress:this.switchPageProgress};Object.keys(t).forEach(function(i){e.eventBus.on(i,t[i].bind(e))})},bindUserEvent:function(){var e=this.$catalog,t=this.scormPlayer,i={".cata_close":t.switchCatalog,".cata_page-item":function(){var e=$(this).data("pageId");t.gotoPage(e)}};Object.keys(i).forEach(function(t){e.on("click",t,i[t]||a)})},loadCataTree:function(e){if(e&&e.children){var t=this.$root,a=t.find("ul"),r=this.pageElMap={};e.children.forEach(function(e){var t=$(i);t.data("groupId",e.id).find(".cata_group-title").text(e.title);var o=t.find("ul");e.children.forEach(function(e){var t=$(n);t.data("pageId",e.id).find(".cata_page-title").text(e.title),r[e.id]=t,t.appendTo(o)}),t.appendTo(a)})}},loadProgress:function(e){var t=this,i=e.pageFinishedMap;Object.keys(i).forEach(function(e){t.switchPageProgress(e,i[e])})},getPageEl:function(e){return this.pageElMap[e]||$()},loadCurrentPageData:function(e){this.setCurrentActive(e)},setCurrentActive:function(e){var t=this.getPageEl(e.id);this.currentPageItem&&this.currentPageItem.removeClass("active"),t.addClass("active"),this.currentPageItem=t},switchPageProgress:function(e,t){var i=this.getPageEl(e),n=i.find(".fa");t?n.removeClass("fa-square-o").addClass("fa-check-square"):n.removeClass("fa-check-square").addClass("fa-square-o")},switchSelfShow:function(e){var t=this.$catalog;e?t.removeClass("hidden"):t.addClass("hidden")}},r}),define("text!_e/scorm/scorm_player/components/catapage/cp_main.tpl",[],function(){return'<div class="c-div div_lWqIo4">\n	<div class="c-div div_NYu0sH">\n		<img class="c-image image_ZCNR57" src="http://qty83k.creatby.com/materials/2/origin/58f84813c53debdafe8106234dd5b779_origin.png">\n		<div class="c-div div_QvZwHa">\n			<h3 class="c-heading heading_J54jFV cp_doc-title">F-A49U01 辅助动力装置</h3>\n		</div>\n	</div>\n	<div class="c-div div_UlMSYy">\n		<ul class="c-list list_uryn8A">\n			\n		</ul>\n	</div>\n	<div class="c-div div_kXLcEF">\n		<p class="c-paragraph paragraph_IQBpvg">CBT Training Course</p>\n		<p class="c-paragraph paragraph_IQBpvg">中国商飞</p>\n		<a class="c-linkblock linkblock_gxXkND2" href="#">\n			<p class="c-paragraph paragraph_GpN89n2 cp_exit">退出</p>\n		</a>\n	</div>\n</div>'}),define("text!_e/scorm/scorm_player/components/catapage/cp_item.tpl",[],function(){return'<li class="c-listitem listitem_3WI9QY cp_page-item">\n	<a class="c-linkblock linkblock_3zUTOk" href="#">\n		<i class="fa fa-square-o c-icon icon_YMlomQ"></i>\n		<p class="c-paragraph paragraph_Egqo5k cp_page-title">CoolSite360，采用标准的html及css规范</p>\n	</a>\n</li>'}),define("_e/scorm/scorm_player/components/catapage/catapage",["require","text!./cp_main.tpl","text!./cp_item.tpl"],function(e){var t=e("text!./cp_main.tpl"),i=e("text!./cp_item.tpl"),n=function(){},a=function(e){this.scormPlayer=e.scormPlayer,this.eventBus=this.scormPlayer.eventBus,this.$parent=this.scormPlayer.$root,this.scormState=this.scormPlayer.state,this.init(this.scormState)};return a.prototype={init:function(e){this.renderTo(this.$parent),this.switchSelfShow(e.isCPShow),this.bindBusEvent(),this.bindUserEvent()},renderTo:function(e){var i=this.$root=$(t);i.addClass("scorm_catapage").addClass("hidden"),i.appendTo(e)},bindBusEvent:function(){var e=this,t={firstLoad:function(e){this.loadCataTree(e.pageIndexMap),this.loadProgress(e.scormData)},switchCatapage:this.switchSelfShow,switchPageProgress:this.switchPageProgress};Object.keys(t).forEach(function(i){e.eventBus.on(i,t[i].bind(e))})},bindUserEvent:function(){var e=this.$root,t=this.scormPlayer,i={".cp_page-item":function(){var e=$(this).data("pageId");t.gotoPage(e,!0),t.switchCatapage(!1)}};Object.keys(i).forEach(function(t){e.on("click",t,i[t]||n)})},loadCataTree:function(e){var t=this.$root,n=t.find("ul"),a=this.pageElMap={};for(var r in e){var o=e[r],s=$(i);s.data("pageId",o.id).find(".cp_page-title").text(o.title),a[o.id]=s,s.appendTo(n)}},loadProgress:function(e){var t=this,i=e.pageFinishedMap;Object.keys(i).forEach(function(e){t.switchPageProgress(e,i[e])})},getPageEl:function(e){return this.pageElMap[e]||$()},switchPageProgress:function(e,t){var i=this.getPageEl(e),n=i.find(".fa");setTimeout(function(){t?n.removeClass("fa-square-o").addClass("fa-check-square"):n.removeClass("fa-check-square").addClass("fa-square-o")},500)},switchSelfShow:function(e){var t=this.$root;e?t.removeClass("hidden"):t.addClass("hidden")}},a}),define("_e/scorm/scorm_player/core/event_bus",["require","backbone"],function(e){e("backbone");var t=function(){return Object.create(Backbone.Events)};return new t}),define("_e/scorm/scorm_player/core/state",["require"],function(e){var t=function(){};return t.prototype={set:function(e){return Object.assign(this,e),this},get:function(e){return this[e]}},new t}),define("_e/scorm/scorm_player/controller/player_api",["require","../core/event_bus","../core/state"],function(e){function t(e){var t={},i={},n={},a=0;e.children.forEach(function(e,n,r){t[e.id]={id:e.id,title:e.title,index:n,length:r.length,data:e},e.children.forEach(function(t,n,r){i[t.id]={id:t.id,title:t.title,indexInGroup:n,indexInTotal:a,lengthInGroup:r.length,data:t,group:e},a+=1})});for(var r in i){var o=i[r];o.lengthInTotal=a,n[o.indexInTotal]=o}return{pageDataMap:i,groupDataMap:t,pageIndexMap:n}}var i=window.e_api,n=e("../core/event_bus"),a=e("../core/state"),r=function(e){interaction_view.util.mixDispatch(e)},o={pageFinishedMap:{},lastPageId:""},s=function(){};window.destoryFakeData=function(){};var l={firstLoad:function(){var e=epub360_book_data.data.organization;scormPlayer.setState({organization:epub360_book_data.data.organization});var i=t(e);scormPlayer.setState(i),scormData={pageFinishedMap:o.pageFinishedMap};var r=a.pageDataMap[o.lastPageId]||a.pageIndexMap[0];scormPlayer.setState({currentPageData:r,scormData:scormData}),n.trigger("firstLoad",a),this.switchCatapage(a.isCPShow),window.scormPlayer.initStopPlay=!0;scormPlayer.setState({stopAutoPlay:!0})},exitPlayer:function(){n.trigger("exitPlayer")},switchCatalog:function(e){e="boolean"==typeof e?e:!a.isCataShow,e?a.isCataShow=!0:a.isCataShow=!1,n.trigger("switchCatalog",e)},switchCatapage:function(e){e="boolean"==typeof e?e:!a.isCPShow,e?(a.isCPShow=!0,this.switchPlay(!1)):a.isCPShow=!1,n.trigger("switchCatapage",e)},gotoPage:function(e,t){var r=a.currentPageData.id;if(a.stopAutoPlay&&r==e)return interaction_view.play(r),a.isPlaying=!0,n.trigger("switchPlay",!0),void(a.stopAutoPlay=!1);var o=a.gotoHistory,s=o[0]&&o[0].id;if(t||!o[0]||s!=e){var l=i.doc.goToPage(e),c=a.pageDataMap[l];a.currentPageData=c,n.trigger("gotoPage",c),o.unshift(c),o.length>5&&o.pop(),this.switchPageProgress(s,!0),this.saveLastPosition(l),this.switchPlay(!0)}},switchPageProgress:function(e,t){o.pageFinishedMap[e]=t,s(),n.trigger("switchPageProgress",e,t)},saveLastPosition:function(e){o.lastPageId=e,s()},fakeDataDestory:function(){destoryFakeData()},switchPlay:function(e){e="boolean"==typeof e?e:!a.isPlaying,e?this.playPage():this.pausePage()},playPage:function(){var e=interaction_view.currentPage,t=interaction_view.getCurrentAudioModel();i.doc.continuePlay(e,t),a.isPlaying=!0,n.trigger("switchPlay",!0)},pausePage:function(){var e=interaction_view.currentPage,t=interaction_view.getCurrentAudioModel();i.doc.pause(e,t),a.isPlaying=!1,n.trigger("switchPlay",!1)},replayCurrentPage:function(){i.doc.replay(interaction_view.currentPage),n.trigger("replayCurrentPage"),a.isPlaying=!0,n.trigger("switchPlay",!0)},switchFullscreen:function(){var e=!a.isFullscreen;e?(Reveal.options.screen_mode=1,a.isFullscreen=!0):(Reveal.options.screen_mode=0,a.isFullscreen=!1),r("resize"),n.trigger("switchFullscreen",e)}};return l}),define("_e/scorm/scorm_player/scorm_player",["require","./components/taskbar/taskbar","./components/catalog/catalog","./components/catapage/catapage","./controller/player_api","./core/event_bus","./core/state"],function(e){var t=e("./components/taskbar/taskbar"),i=e("./components/catalog/catalog"),n=e("./components/catapage/catapage"),a=e("./controller/player_api"),r=e("./core/event_bus"),o=e("./core/state"),s=function(e){this.state=o,this.eventBus=r,o.set({dist:e.dist||"body",isCataShow:e.initShowCatalog,isCPShow:e.initShowCatapage,isPlaying:e.initAutoPlay,gotoHistory:[]}),this.$root=e.dist;var a={scormPlayer:this};this.taskbar=new t(a),this.catalog=new i(a),this.catapage=new n(a)};return Object.keys(a).forEach(function(e){a[e]=a[e].bind(a)}),s.prototype=a,s.prototype.setState=function(e){return o.set(e)},s}),define("_e/scorm/scorm_player_handler",["require","./scorm_player/scorm_player"],function(e){function t(){function e(){function e(e){$("<style/>").data("comp","scromPlayer").text(e).appendTo("head")}var t="					.presentation-area {						display: none;						opacity: 0;						pointer-events: none;					}					";e(t)}if(!interaction_view.foredit&&interaction_view.doc.get("scorm")){e();var t=$("<div/>").attr("id","scormPlayer").addClass("scormPlayer").appendTo("body"),n=new i({dist:t,initShowCatalog:!1,initShowCatapage:!0,initAutoPlay:!1});window.scormPlayer=n,window.scormPlayer.wrapperSpec={bottom:50},n.firstLoad(),Backbone.on("screenCalculated",function(e){var i={width:e.wrapperWidth,height:e.wrapperHeight,left:e.wrapperLeft,top:e.wrapperTop,zoom:e.wrapperZoom};t.css(i);var n=300,a={none:"0ms",swap:"0ms",tick:n+"ms",orient:n+"ms"}[window.emulateLandscape.from];window.emulateLandscape.available&&t.css({"transition-duration":a,transform:"rotate("+window.emulateLandscape.degree+"deg)","transform-origin":"center"})})}}var i=e("./scorm_player/scorm_player");e_api.event.on("ready",t)}),define("interaction_view/touchmain",["interaction_view/model/main","interaction_view/ui/main","interaction_view/ui/presentation","interaction_view/ui/control","interaction_view/ui/event","interaction_view/ui/environment","interaction_view/ui/media","interaction_view/ui/adapt","interaction_view/ui/analytics","interaction_view/ui/application","interaction_view/ui/weixin","interaction_view/modules/desktop/uploadimage_desktop","interaction_view/ui/pageslide","_g/device","_g/mousewheel","share/main","jquery.actual","interaction_view/ui/screenset","interaction_view/ui/touchinit","interaction_view/ui/timeline","interaction_view/ui/expression","interaction_view/ui/pluginmanage","interaction_view/ui/transform","interaction_view/ui/facecompose","interaction_view/ui/force_landscape","interaction_view/ui/statemanage","interaction_view/ui/util","coverFlow","_e/eraser","_e/cssanimate","_e/animate","screenfull","greensock/TweenMax","_e/scrollpage","jswait","greensock/plugins/DrawSVGPlugin","greensock/plugins/MorphSVGPlugin","greensock/plugins/TextPlugin","interaction_view/ui/scrollview","greensock/plugins/ScrollToPlugin","_g/slider","_g/file","screenfull","_e/preloadpage","_e/api","_e/queue","_e/dboperate","_e/connector","_e/stategroup","_e/orientation","_g/keyboard","thirdparty/dataEngine/dataEngine","thirdparty/clipboard/clipboard","thirdparty/mousetrap/mousetrap","thirdparty/AlloyFinger/alloy_finger","thirdparty/TimerSensor/timer_sensor","thirdparty/exif/exif","thirdparty/rivets/rivets.min","ajaximage","ajaxfile","_e/configpage","_e/cssmatrix","_e/switchdoc","_e/cms","_e/epubsdk","_e/scorm/scorm_player_handler"],function(){CSSPlugin.defaultSkewType="simple","undefined"==typeof dboperate&&(dboperate=null),"undefined"==typeof global&&(global={message:function(e,t){interaction_view.errorAlert(t)}}),"undefined"==typeof DB&&(DB=null),rivets.configure({templateDelimiters:["<%","%>"]});var e=require("interaction_view/ui/main");interaction_view.force3D=!1,interaction_view.DEBUG=_g.getUrlParameterByName("-debug"),interaction_view.LOCAL_DEBUG=_g.getUrlParameterByName("-local"),interaction_view=$.extend({},interaction_view,e),interaction_view.weixin=require("interaction_view/ui/weixin"),interaction_view.control=require("interaction_view/ui/control"),interaction_view.events=require("interaction_view/ui/event"),interaction_view.environment=require("interaction_view/ui/environment"),interaction_view.media=require("interaction_view/ui/media"),interaction_view.screenset=require("interaction_view/ui/screenset"),window._e||(window._e={}),interaction_view.adapt=require("interaction_view/ui/adapt"),interaction_view.analytics=require("interaction_view/ui/analytics"),interaction_view.application=require("interaction_view/ui/application"),(_g.device.mobile()||_g.device.tablet())&&(interaction_view.ismobile=!0),interaction_view.touchview=!0,interaction_view.isAndroid=interaction_view.android=_g.device.android(),interaction_view.isWeixin=_g.device.isWeixin(),interaction_view.isIos=_g.device.ios(),interaction_view.isWin=_g.device.windows(),interaction_view.isMac=_g.device.mac(),interaction_view.isQQ=_g.device.isQQ(),interaction_view.touchinit=require("interaction_view/ui/touchinit"),interaction_view.touchinit.init(),interaction_view.statemanage=require("interaction_view/ui/statemanage"),interaction_view.util=require("interaction_view/ui/util")}),$.presentate=function(e){return this.render(),this},$.presentate.prototype={render:function(){interaction_view.screenset.controlbarel&&(this.share_overlay=interaction_view.screenset.controlbarel.find(".action-share"),this.control=interaction_view.screenset.controlbarel,this.actualsize=this.control.find(".actualsize"),this.adaptive=this.control.find(".adaptive"),this.fullscreen=this.control.find(".fullscreen"),this.over=this.control.find(".overview")),"player"==_g.getUrlParameterByName("mode")&&(this.fullscreen.hide(),parent.postMessage&&parent.postMessage("epub360fullscreen","*"),console.log("not allowed screenfull")),this.click_event_name="click",interaction_view.screenset.controlbarel&&this.delegate_event()},size_share_overlay:function(){var e=this.share_overlay.children();$("html").width()>=600&&$("html").height()>=460?(e.width(560),e.height(220),e.find("#small_share").hide(),e.find("#normal_share").show()):(e.width($("html").width()/2),e.height($("html").height()/2),e.find("#small_share").show(),e.find("#normal_share").hide()),e.css("margin-top",-e.height()/2),e.css("margin-left",-e.width()/2)},delegate_event:function(){var e=this;this.share_overlay&&(this.share_overlay.on(e.click_event_name,function(t){t.target==$(this)[0]&&e.share_overlay.hide()}),this.share_overlay.find(".btn-close").on(e.click_event_name,function(){e.share_overlay.hide()}),this.share_overlay.find("input").mouseenter(function(){$(this).select()})),this.fullscreen.on(e.click_event_name,function(){return screenfull.enabled?void(screenfull.enabled&&!isFullscreen?screenfull.request(document.documentElement):screenfull.exit()):void window.open(window.location.href.replace("autoplay=false",""))}),_g.device.msie()?(window._IE_resize=function(){$(".reveal").css({margin:"0px",top:($("body").height()-$(".reveal").height()*$(".reveal")[0].style.zoom)/2,left:($("body").width()-$(".reveal").width()*$(".reveal")[0].style.zoom)/2})},_IE_resize(),$(window).resize(_IE_resize)):window._IE_resize=function(){},this.actualsize&&this.actualsize.on(e.click_event_name,function(){$(this).hasClass("active")||(e.over.hasClass("active")&&Reveal.toggleOverview(!1),e.state="actualsize",$(this).siblings().removeClass("active"),$(this).addClass("active"),screenSizeLock(),interaction_view.touchview||($(window).unbind("resize",_IE_resize),$(".reveal").css({top:0,left:0})),_IE_resize())}),this.adaptive&&this.adaptive.on(e.click_event_name,function(){$(this).hasClass("active")||(e.over.hasClass("active")&&Reveal.toggleOverview(!1),e.state="adaptive",$(this).siblings().removeClass("active"),$(this).addClass("active"),screenSizeRelease(),interaction_view.touchview||(_IE_resize(),$(window).resize(_IE_resize)),_IE_resize())}),this.share_overlay&&this.share_overlay.on(e.click_event_name,function(){share(interaction_view.doc.toJSON().title,context_url+"player")}),this.over&&this.over.on(e.click_event_name,function(t){interaction_view.touchview?Reveal.toggleOverview(!0):$(this).hasClass("active")?e.control.find("."+e.state).trigger(e.click_event_name):(e.adaptive.parent().children().removeClass("active"),Reveal.toggleOverview(!0))})}},define("interaction_play/presentate",["bootstrap"],function(){}),require(["interaction_view/touchmain","bootstrap","_g/base","interaction_play/presentate"],function(){window.start_player=function(){_g.browserSupport({msie:8,chrome:1,safari:1,mozilla:1})?(interaction_view.init(),$(".return a").live("click",function(){var e=location.search,t={};if(-1!=e.indexOf("?")){var i=e.substr(1);strs=i.split("&");for(var n=0;n<strs.length;n++)t[strs[n].split("=")[0]]=unescape(strs[n].split("=")[1])}return"page"==t.from&&$(window.parent.document.getElementById("PreviewWindow")).remove(),!1})):_g.ajax.get({url:"index.json",callback:function(e){if(console.log(e),200==e.code&&e.data){var t=String(e.data.slave_url);t&&t.length?window.location.href=t:window.location.href=web_url+"admin-epub360/browser-old.html"}else window.location.href=web_url+"admin-epub360/browser-old.html"}})}}),define("common/js/interaction_view/desktop.js",function(){});
